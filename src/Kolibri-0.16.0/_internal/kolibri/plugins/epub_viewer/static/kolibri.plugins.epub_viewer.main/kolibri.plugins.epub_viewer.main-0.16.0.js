/*! For license information please see kolibri.plugins.epub_viewer.main-0.16.0.js.LICENSE.txt */
!function(){var __webpack_modules__={6437:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var isValue=__webpack_require__(1707),isPlainFunction=__webpack_require__(685),assign=__webpack_require__(3203),normalizeOpts=__webpack_require__(9112),contains=__webpack_require__(8072),d=module.exports=function(dscr,value){var c,e,w,options,desc;return arguments.length<2||"string"!=typeof dscr?(options=value,value=dscr,dscr=null):options=arguments[2],isValue(dscr)?(c=contains.call(dscr,"c"),e=contains.call(dscr,"e"),w=contains.call(dscr,"w")):(c=w=!0,e=!1),desc={value:value,configurable:c,enumerable:e,writable:w},options?assign(normalizeOpts(options),desc):desc};d.gs=function(dscr,get,set){var c,e,options,desc;return"string"!=typeof dscr?(options=set,set=get,get=dscr,dscr=null):options=arguments[3],isValue(get)?isPlainFunction(get)?isValue(set)?isPlainFunction(set)||(options=set,set=void 0):set=void 0:(options=get,get=set=void 0):get=void 0,isValue(dscr)?(c=contains.call(dscr,"c"),e=contains.call(dscr,"e")):(c=!0,e=!1),desc={get:get,set:set,configurable:c,enumerable:e},options?assign(normalizeOpts(options),desc):desc}},341:function(module){var table={application:{ecmascript:["es","ecma"],javascript:"js",ogg:"ogx",pdf:"pdf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],"rdf+xml":"rdf",smil:["smi","smil"],"xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","opf","ncx"],zip:"zip","x-httpd-eruby":"rhtml","x-latex":"latex","x-maker":["frm","maker","frame","fm","fb","book","fbdoc"],"x-object":"o","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","epub+zip":"epub","font-tdpfr":"pfr","inkml+xml":["ink","inkml"],json:"json","jsonml+json":"jsonml","mathml+xml":"mathml","metalink+xml":"metalink",mp4:"mp4s","omdoc+xml":"omdoc",oxps:"oxps","vnd.amazon.ebook":"azw",widget:"wgt","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-otf":"otf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-font-woff":"woff","x-mobipocket-ebook":["prc","mobi"],"x-mspublisher":"pub","x-nzb":"nzb","x-tgif":"obj","xaml+xml":"xaml","xml-dtd":"dtd","xproc+xml":"xpl","xslt+xml":"xslt","internet-property-stream":"acx","x-compress":"z","x-compressed":"tgz","x-gzip":"gz"},audio:{flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp2","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"x-aiff":["aif","aiff","aifc"],"x-ms-wma":"wma","x-wav":"wav",adpcm:"adp",mp4:"mp4a",webm:"weba","x-aac":"aac","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",mid:["mid","rmi"]},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"x-icon":"ico",bmp:"bmp",webp:"webp","x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod"},text:{"cache-manifest":["manifest","appcache"],css:"css",csv:"csv",html:["html","htm","shtml","stm"],mathml:"mml",plain:["txt","text","brf","conf","def","list","log","in","bas"],richtext:"rtx","tab-separated-values":"tsv","x-bibtex":"bib"},video:{mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv"}},mimeTypes=function(){var type,subtype,val,index,mimeTypes={};for(type in table)if(table.hasOwnProperty(type))for(subtype in table[type])if(table[type].hasOwnProperty(subtype))if("string"==typeof(val=table[type][subtype]))mimeTypes[val]=type+"/"+subtype;else for(index=0;index<val.length;index++)mimeTypes[val[index]]=type+"/"+subtype;return mimeTypes}();module.exports={lookup:function(filename){return filename&&mimeTypes[filename.split(".").pop().toLowerCase()]||"text/plain"}}},9268:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _toPropertyKey(t){var i=function(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:String(i)}__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{RangeObject:function(){return RangeObject},blob2base64:function(){return blob2base64},borders:function(){return borders},bounds:function(){return bounds},createBase64Url:function(){return createBase64Url},createBlob:function(){return createBlob},createBlobUrl:function(){return createBlobUrl},defaults:function(){return defaults},defer:function(){return defer},documentHeight:function(){return documentHeight},extend:function(){return extend},filterChildren:function(){return filterChildren},findChildren:function(){return findChildren},getParentByTagName:function(){return getParentByTagName},indexOfElementNode:function(){return indexOfElementNode},indexOfNode:function(){return indexOfNode},indexOfSorted:function(){return indexOfSorted},indexOfTextNode:function(){return indexOfTextNode},insert:function(){return insert},isElement:function(){return isElement},isFloat:function(){return isFloat},isNumber:function(){return isNumber},isXml:function(){return isXml},locationOf:function(){return locationOf},nodeBounds:function(){return nodeBounds},parents:function(){return parents},parse:function(){return parse},prefixed:function(){return prefixed},qs:function(){return qs},qsa:function(){return qsa},qsp:function(){return qsp},querySelectorByType:function(){return querySelectorByType},requestAnimationFrame:function(){return requestAnimationFrame},revokeBlobUrl:function(){return revokeBlobUrl},sprint:function(){return sprint},treeWalker:function(){return treeWalker},type:function(){return type},uuid:function(){return uuid},walk:function(){return walk},windowBounds:function(){return windowBounds}});var requestAnimationFrame="undefined"!=typeof window&&(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame),ELEMENT_NODE=1,TEXT_NODE=3,_URL="undefined"!=typeof URL?URL:"undefined"!=typeof window?window.URL||window.webkitURL||window.mozURL:void 0;function uuid(){var d=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"==c?r:7&r|8).toString(16)}))}function documentHeight(){return Math.max(document.documentElement.clientHeight,document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight)}function isElement(obj){return!(!obj||1!=obj.nodeType)}function isNumber(n){return!isNaN(parseFloat(n))&&isFinite(n)}function isFloat(n){var f=parseFloat(n);return!1!==isNumber(n)&&("string"==typeof n&&n.indexOf(".")>-1||Math.floor(f)!==f)}function prefixed(unprefixed){var prefixes=["-webkit-","-webkit-","-moz-","-o-","-ms-"],lower=unprefixed.toLowerCase();if("undefined"==typeof document||void 0!==document.body.style[lower])return unprefixed;for(var i=0;i<5;i++)if(void 0!==document.body.style[prefixes[i]+lower])return prefixes[i]+lower;return unprefixed}function defaults(obj){for(var i=1,length=arguments.length;i<length;i++){var source=arguments[i];for(var prop in source)void 0===obj[prop]&&(obj[prop]=source[prop])}return obj}function extend(target){return[].slice.call(arguments,1).forEach((function(source){source&&Object.getOwnPropertyNames(source).forEach((function(propName){Object.defineProperty(target,propName,Object.getOwnPropertyDescriptor(source,propName))}))})),target}function insert(item,array,compareFunction){var location=locationOf(item,array,compareFunction);return array.splice(location,0,item),location}function locationOf(item,array,compareFunction,_start,_end){var compared,start=_start||0,end=_end||array.length,pivot=parseInt(start+(end-start)/2);return compareFunction||(compareFunction=function(a,b){return a>b?1:a<b?-1:a==b?0:void 0}),end-start<=0?pivot:(compared=compareFunction(array[pivot],item),end-start==1?compared>=0?pivot:pivot+1:0===compared?pivot:-1===compared?locationOf(item,array,compareFunction,pivot,end):locationOf(item,array,compareFunction,start,pivot))}function indexOfSorted(item,array,compareFunction,_start,_end){var compared,start=_start||0,end=_end||array.length,pivot=parseInt(start+(end-start)/2);return compareFunction||(compareFunction=function(a,b){return a>b?1:a<b?-1:a==b?0:void 0}),end-start<=0?-1:(compared=compareFunction(array[pivot],item),end-start==1?0===compared?pivot:-1:0===compared?pivot:-1===compared?indexOfSorted(item,array,compareFunction,pivot,end):indexOfSorted(item,array,compareFunction,start,pivot))}function bounds(el){var style=window.getComputedStyle(el),width=0,height=0;return["width","paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach((function(prop){width+=parseFloat(style[prop])||0})),["height","paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach((function(prop){height+=parseFloat(style[prop])||0})),{height:height,width:width}}function borders(el){var style=window.getComputedStyle(el),width=0,height=0;return["paddingRight","paddingLeft","marginRight","marginLeft","borderRightWidth","borderLeftWidth"].forEach((function(prop){width+=parseFloat(style[prop])||0})),["paddingTop","paddingBottom","marginTop","marginBottom","borderTopWidth","borderBottomWidth"].forEach((function(prop){height+=parseFloat(style[prop])||0})),{height:height,width:width}}function nodeBounds(node){var elPos,doc=node.ownerDocument;if(node.nodeType==Node.TEXT_NODE){var elRange=doc.createRange();elRange.selectNodeContents(node),elPos=elRange.getBoundingClientRect()}else elPos=node.getBoundingClientRect();return elPos}function windowBounds(){var width=window.innerWidth,height=window.innerHeight;return{top:0,left:0,right:width,bottom:height,width:width,height:height}}function indexOfNode(node,typeId){for(var sib,children=node.parentNode.childNodes,index=-1,i=0;i<children.length&&((sib=children[i]).nodeType===typeId&&index++,sib!=node);i++);return index}function indexOfTextNode(textNode){return indexOfNode(textNode,TEXT_NODE)}function indexOfElementNode(elementNode){return indexOfNode(elementNode,ELEMENT_NODE)}function isXml(ext){return["xml","opf","ncx"].indexOf(ext)>-1}function createBlob(content,mime){return new Blob([content],{type:mime})}function createBlobUrl(content,mime){var blob=createBlob(content,mime);return _URL.createObjectURL(blob)}function revokeBlobUrl(url){return _URL.revokeObjectURL(url)}function createBase64Url(content,mime){if("string"==typeof content)return"data:"+mime+";base64,"+btoa(encodeURIComponent(content))}function type(obj){return Object.prototype.toString.call(obj).slice(8,-1)}function parse(markup,mime,forceXMLDom){var Parser;return Parser="undefined"==typeof DOMParser||forceXMLDom?__webpack_require__(7463).a:DOMParser,65279===markup.charCodeAt(0)&&(markup=markup.slice(1)),(new Parser).parseFromString(markup,mime)}function qs(el,sel){var elements;if(!el)throw new Error("No Element Provided");return void 0!==el.querySelector?el.querySelector(sel):(elements=el.getElementsByTagName(sel)).length?elements[0]:void 0}function qsa(el,sel){return void 0!==el.querySelector?el.querySelectorAll(sel):el.getElementsByTagName(sel)}function qsp(el,sel,props){var q,filtered;if(void 0!==el.querySelector){for(var prop in sel+="[",props)sel+=prop+"~='"+props[prop]+"'";return sel+="]",el.querySelector(sel)}if(q=el.getElementsByTagName(sel),filtered=Array.prototype.slice.call(q,0).filter((function(el){for(var prop in props)if(el.getAttribute(prop)===props[prop])return!0;return!1})),filtered)return filtered[0]}function sprint(root,func){void 0!==(root.ownerDocument||root).createTreeWalker?treeWalker(root,func,NodeFilter.SHOW_TEXT):walk(root,(function(node){node&&3===node.nodeType&&func(node)}))}function treeWalker(root,func,filter){for(var node,treeWalker=document.createTreeWalker(root,filter,null,!1);node=treeWalker.nextNode();)func(node)}function walk(node,callback){if(callback(node))return!0;if(node=node.firstChild)do{if(walk(node,callback))return!0;node=node.nextSibling}while(node)}function blob2base64(blob){return new Promise((function(resolve,reject){var reader=new FileReader;reader.readAsDataURL(blob),reader.onloadend=function(){resolve(reader.result)}}))}function defer(){var _this=this;this.resolve=null,this.reject=null,this.id=uuid(),this.promise=new Promise((function(resolve,reject){_this.resolve=resolve,_this.reject=reject})),Object.freeze(this)}function querySelectorByType(html,element,type){var query;if(void 0!==html.querySelector&&(query=html.querySelector("".concat(element,'[*|type="').concat(type,'"]'))),query&&0!==query.length)return query;query=qsa(html,element);for(var i=0;i<query.length;i++)if(query[i].getAttributeNS("http://www.idpf.org/2007/ops","type")===type||query[i].getAttribute("epub:type")===type)return query[i]}function findChildren(el){for(var result=[],childNodes=el.childNodes,i=0;i<childNodes.length;i++){var node=childNodes[i];1===node.nodeType&&result.push(node)}return result}function parents(node){for(var nodes=[node];node;node=node.parentNode)nodes.unshift(node);return nodes}function filterChildren(el,nodeName,single){for(var result=[],childNodes=el.childNodes,i=0;i<childNodes.length;i++){var node=childNodes[i];if(1===node.nodeType&&node.nodeName.toLowerCase()===nodeName){if(single)return node;result.push(node)}}if(!single)return result}function getParentByTagName(node,tagname){var parent;if(null!==node&&""!==tagname)for(parent=node.parentNode;1===parent.nodeType;){if(parent.tagName.toLowerCase()===tagname)return parent;parent=parent.parentNode}}var RangeObject=function(){function RangeObject(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,RangeObject),this.collapsed=!1,this.commonAncestorContainer=void 0,this.endContainer=void 0,this.endOffset=void 0,this.startContainer=void 0,this.startOffset=void 0}var Constructor,protoProps,staticProps;return Constructor=RangeObject,(protoProps=[{key:"setStart",value:function(startNode,startOffset){this.startContainer=startNode,this.startOffset=startOffset,this.endContainer?this.commonAncestorContainer=this._commonAncestorContainer():this.collapse(!0),this._checkCollapsed()}},{key:"setEnd",value:function(endNode,endOffset){this.endContainer=endNode,this.endOffset=endOffset,this.startContainer?(this.collapsed=!1,this.commonAncestorContainer=this._commonAncestorContainer()):this.collapse(!1),this._checkCollapsed()}},{key:"collapse",value:function(toStart){this.collapsed=!0,toStart?(this.endContainer=this.startContainer,this.endOffset=this.startOffset,this.commonAncestorContainer=this.startContainer.parentNode):(this.startContainer=this.endContainer,this.startOffset=this.endOffset,this.commonAncestorContainer=this.endOffset.parentNode)}},{key:"selectNode",value:function(referenceNode){var parent=referenceNode.parentNode,index=Array.prototype.indexOf.call(parent.childNodes,referenceNode);this.setStart(parent,index),this.setEnd(parent,index+1)}},{key:"selectNodeContents",value:function(referenceNode){referenceNode.childNodes[referenceNode.childNodes-1];var endIndex=3===referenceNode.nodeType?referenceNode.textContent.length:parent.childNodes.length;this.setStart(referenceNode,0),this.setEnd(referenceNode,endIndex)}},{key:"_commonAncestorContainer",value:function(startContainer,endContainer){var startParents=parents(startContainer||this.startContainer),endParents=parents(endContainer||this.endContainer);if(startParents[0]==endParents[0])for(var i=0;i<startParents.length;i++)if(startParents[i]!=endParents[i])return startParents[i-1]}},{key:"_checkCollapsed",value:function(){this.startContainer===this.endContainer&&this.startOffset===this.endOffset?this.collapsed=!0:this.collapsed=!1}},{key:"toString",value:function(){}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),RangeObject}()},5689:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var path_webpack__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1832),path_webpack__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(path_webpack__WEBPACK_IMPORTED_MODULE_0__);function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _toPropertyKey(t){var i=function(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:String(i)}var Path=function(){function Path(pathString){var parsed;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Path),pathString.indexOf("://")>-1&&(pathString=new URL(pathString).pathname),parsed=this.parse(pathString),this.path=pathString,this.isDirectory(pathString)?this.directory=pathString:this.directory=parsed.dir+"/",this.filename=parsed.base,this.extension=parsed.ext.slice(1)}var Constructor,protoProps,staticProps;return Constructor=Path,(protoProps=[{key:"parse",value:function(what){return path_webpack__WEBPACK_IMPORTED_MODULE_0___default().parse(what)}},{key:"isAbsolute",value:function(what){return path_webpack__WEBPACK_IMPORTED_MODULE_0___default().isAbsolute(what||this.path)}},{key:"isDirectory",value:function(what){return"/"===what.charAt(what.length-1)}},{key:"resolve",value:function(what){return path_webpack__WEBPACK_IMPORTED_MODULE_0___default().resolve(this.directory,what)}},{key:"relative",value:function(what){return what&&what.indexOf("://")>-1?what:path_webpack__WEBPACK_IMPORTED_MODULE_0___default().relative(this.directory,what)}},{key:"splitPath",value:function(filename){return this.splitPathRe.exec(filename).slice(1)}},{key:"toString",value:function(){return this.path}}])&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Path}();__webpack_exports__.Z=Path},4239:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__);var _core__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(9268),_path__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(5689);__webpack_exports__.default=function(url,type,withCredentials,headers){var header,supportsURL="undefined"!=typeof window&&window.URL,BLOB_RESPONSE=supportsURL?"blob":"arraybuffer",deferred=new _core__WEBPACK_IMPORTED_MODULE_0__.defer,xhr=new XMLHttpRequest,xhrPrototype=XMLHttpRequest.prototype;for(header in"overrideMimeType"in xhrPrototype||Object.defineProperty(xhrPrototype,"overrideMimeType",{value:function(){}}),withCredentials&&(xhr.withCredentials=!0),xhr.onreadystatechange=function(){if(this.readyState===XMLHttpRequest.DONE){var responseXML=!1;if(""!==this.responseType&&"document"!==this.responseType||(responseXML=this.responseXML),200===this.status||0===this.status||responseXML){var r;if(!this.response&&!responseXML)return deferred.reject({status:this.status,message:"Empty Response",stack:(new Error).stack}),deferred.promise;if(403===this.status)return deferred.reject({status:this.status,response:this.response,message:"Forbidden",stack:(new Error).stack}),deferred.promise;r=responseXML?this.responseXML:(0,_core__WEBPACK_IMPORTED_MODULE_0__.isXml)(type)?(0,_core__WEBPACK_IMPORTED_MODULE_0__.parse)(this.response,"text/xml"):"xhtml"==type?(0,_core__WEBPACK_IMPORTED_MODULE_0__.parse)(this.response,"application/xhtml+xml"):"html"==type||"htm"==type?(0,_core__WEBPACK_IMPORTED_MODULE_0__.parse)(this.response,"text/html"):"json"==type?JSON.parse(this.response):"blob"==type?supportsURL?this.response:new Blob([this.response]):this.response,deferred.resolve(r)}else deferred.reject({status:this.status,message:this.response,stack:(new Error).stack})}},xhr.onerror=function(e){deferred.reject(e)},xhr.open("GET",url,!0),headers)xhr.setRequestHeader(header,headers[header]);return"json"==type&&xhr.setRequestHeader("Accept","application/json"),type||(type=new _path__WEBPACK_IMPORTED_MODULE_1__.Z(url).extension),"blob"==type&&(xhr.responseType=BLOB_RESPONSE),(0,_core__WEBPACK_IMPORTED_MODULE_0__.isXml)(type)&&xhr.overrideMimeType("text/xml"),"binary"==type&&(xhr.responseType="arraybuffer"),xhr.send(),deferred.promise}},9346:function(module){"use strict";module.exports=function(){}},3203:function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=__webpack_require__(8206)()?Object.assign:__webpack_require__(639)},8206:function(module){"use strict";module.exports=function(){var obj,assign=Object.assign;return"function"==typeof assign&&(assign(obj={foo:"raz"},{bar:"dwa"},{trzy:"trzy"}),obj.foo+obj.bar+obj.trzy==="razdwatrzy")}},639:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var keys=__webpack_require__(6821),value=__webpack_require__(4436),max=Math.max;module.exports=function(dest,src){var error,i,assign,length=max(arguments.length,2);for(dest=Object(value(dest)),assign=function(key){try{dest[key]=src[key]}catch(e){error||(error=e)}},i=1;i<length;++i)keys(src=arguments[i]).forEach(assign);if(void 0!==error)throw error;return dest}},2824:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var _undefined=__webpack_require__(9346)();module.exports=function(val){return val!==_undefined&&null!==val}},6821:function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=__webpack_require__(7088)()?Object.keys:__webpack_require__(5732)},7088:function(module){"use strict";module.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},5732:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var isValue=__webpack_require__(2824),keys=Object.keys;module.exports=function(object){return keys(isValue(object)?Object(object):object)}},9112:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var isValue=__webpack_require__(2824),forEach=Array.prototype.forEach,create=Object.create;module.exports=function(opts1){var result=create(null);return forEach.call(arguments,(function(options){isValue(options)&&function(src,obj){var key;for(key in src)obj[key]=src[key]}(Object(options),result)})),result}},1602:function(module){"use strict";module.exports=function(fn){if("function"!=typeof fn)throw new TypeError(fn+" is not a function");return fn}},4436:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var isValue=__webpack_require__(2824);module.exports=function(value){if(!isValue(value))throw new TypeError("Cannot use null or undefined");return value}},8072:function(module,__unused_webpack_exports,__webpack_require__){"use strict";module.exports=__webpack_require__(9889)()?String.prototype.contains:__webpack_require__(7729)},9889:function(module){"use strict";var str="razdwatrzy";module.exports=function(){return"function"==typeof str.contains&&(!0===str.contains("dwa")&&!1===str.contains("foo"))}},7729:function(module){"use strict";var indexOf=String.prototype.indexOf;module.exports=function(searchString){return indexOf.call(this,searchString,arguments[1])>-1}},6878:function(module,exports,__webpack_require__){"use strict";function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var on,_once2,off,emit,methods,descriptors,base,d=__webpack_require__(6437),callable=__webpack_require__(1602),apply=Function.prototype.apply,call=Function.prototype.call,create=Object.create,defineProperty=Object.defineProperty,defineProperties=Object.defineProperties,hasOwnProperty=Object.prototype.hasOwnProperty,descriptor={configurable:!0,enumerable:!1,writable:!0};_once2=function(type,listener){var _once,self;return callable(listener),self=this,on.call(this,type,_once=function(){off.call(self,type,_once),apply.call(listener,this,arguments)}),_once.__eeOnceListener__=listener,this},emit=function(type){var i,l,listener,listeners,args;if(hasOwnProperty.call(this,"__ee__")&&(listeners=this.__ee__[type]))if("object"===_typeof(listeners)){for(l=arguments.length,args=new Array(l-1),i=1;i<l;++i)args[i-1]=arguments[i];for(listeners=listeners.slice(),i=0;listener=listeners[i];++i)apply.call(listener,this,args)}else switch(arguments.length){case 1:call.call(listeners,this);break;case 2:call.call(listeners,this,arguments[1]);break;case 3:call.call(listeners,this,arguments[1],arguments[2]);break;default:for(l=arguments.length,args=new Array(l-1),i=1;i<l;++i)args[i-1]=arguments[i];apply.call(listeners,this,args)}},methods={on:on=function(type,listener){var data;return callable(listener),hasOwnProperty.call(this,"__ee__")?data=this.__ee__:(data=descriptor.value=create(null),defineProperty(this,"__ee__",descriptor),descriptor.value=null),data[type]?"object"===_typeof(data[type])?data[type].push(listener):data[type]=[data[type],listener]:data[type]=listener,this},once:_once2,off:off=function(type,listener){var data,listeners,candidate,i;if(callable(listener),!hasOwnProperty.call(this,"__ee__"))return this;if(!(data=this.__ee__)[type])return this;if("object"===_typeof(listeners=data[type]))for(i=0;candidate=listeners[i];++i)candidate!==listener&&candidate.__eeOnceListener__!==listener||(2===listeners.length?data[type]=listeners[i?0:1]:listeners.splice(i,1));else listeners!==listener&&listeners.__eeOnceListener__!==listener||delete data[type];return this},emit:emit},descriptors={on:d(on),once:d(_once2),off:d(off),emit:d(emit)},base=defineProperties({},descriptors),module.exports=exports=function(o){return null==o?create(base):defineProperties(Object(o),descriptors)},exports.methods=methods},2655:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,e,process=__webpack_require__(333);function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}e=function(){return function s(a,o,h){function u(r,e){if(!o[r]){if(!a[r]){if(l)return l(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=o[r]={exports:{}};a[r][0].call(i.exports,(function(e){return u(a[r][1][e]||e)}),i,i.exports,s,a,o,h)}return o[r].exports}for(var l=void 0,e=0;e<h.length;e++)u(h[e]);return u}({1:[function(e,t,r){"use strict";var d=e("./utils"),c=e("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,n,i,s,a,o,h=[],u=0,l=e.length,f=l,c="string"!==d.getTypeOf(e);u<e.length;)f=l-u,n=c?(t=e[u++],r=u<l?e[u++]:0,u<l?e[u++]:0):(t=e.charCodeAt(u++),r=u<l?e.charCodeAt(u++):0,u<l?e.charCodeAt(u++):0),i=t>>2,s=(3&t)<<4|r>>4,a=1<f?(15&r)<<2|n>>6:64,o=2<f?63&n:64,h.push(p.charAt(i)+p.charAt(s)+p.charAt(a)+p.charAt(o));return h.join("")},r.decode=function(e){var t,r,n,i,s,a,o=0,h=0,u="data:";if(e.substr(0,5)===u)throw new Error("Invalid base64 input, it looks like a data url.");var l,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===p.charAt(64)&&f--,e.charAt(e.length-2)===p.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(l=c.uint8array?new Uint8Array(0|f):new Array(0|f);o<e.length;)t=p.indexOf(e.charAt(o++))<<2|(i=p.indexOf(e.charAt(o++)))>>4,r=(15&i)<<4|(s=p.indexOf(e.charAt(o++)))>>2,n=(3&s)<<6|(a=p.indexOf(e.charAt(o++))),l[h++]=t,64!==s&&(l[h++]=r),64!==a&&(l[h++]=n);return l}},{"./support":30,"./utils":32}],2:[function(e,t,r){"use strict";var n=e("./external"),i=e("./stream/DataWorker"),s=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function o(e,t,r,n,i){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=n,this.compressedContent=i}o.prototype={getContentWorker:function(){var e=new i(n.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new i(n.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,r){return e.pipe(new s).pipe(new a("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,r){"use strict";var n=e("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new n("STORE compression")},uncompressWorker:function(){return new n("STORE decompression")}},r.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,r){"use strict";var n=e("./utils"),o=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==n.getTypeOf(e)?function(e,t,r,n){var i=o,s=0+r;e^=-1;for(var a=0;a<s;a++)e=e>>>8^i[255&(e^t[a])];return-1^e}(0|t,e,e.length):function(e,t,r,n){var i=o,s=0+r;e^=-1;for(var a=0;a<s;a++)e=e>>>8^i[255&(e^t.charCodeAt(a))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(e,t,r){"use strict";var n;n="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:n}},{lie:37}],7:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako"),s=e("./utils"),a=e("./stream/GenericWorker"),o=n?"uint8array":"array";function h(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}r.magic="\b\0",s.inherits(h,a),h.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(s.transformTo(o,e.data),!1)},h.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},h.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},h.prototype._createPako=function(){this._pako=new i[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(e){t.push({data:e,meta:t.meta})}},r.compressWorker=function(e){return new h("Deflate",e)},r.uncompressWorker=function(){return new h("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,r){"use strict";function A(e,t){var r,n="";for(r=0;r<t;r++)n+=String.fromCharCode(255&e),e>>>=8;return n}function n(e,t,r,n,i,s){var a,o,h=e.file,u=e.compression,l=s!==O.utf8encode,f=I.transformTo("string",s(h.name)),c=I.transformTo("string",O.utf8encode(h.name)),d=h.comment,p=I.transformTo("string",s(d)),m=I.transformTo("string",O.utf8encode(d)),_=c.length!==h.name.length,g=m.length!==d.length,b="",v="",y="",w=h.dir,k=h.date,x={crc32:0,compressedSize:0,uncompressedSize:0};t&&!r||(x.crc32=e.crc32,x.compressedSize=e.compressedSize,x.uncompressedSize=e.uncompressedSize);var S=0;t&&(S|=8),l||!_&&!g||(S|=2048);var z=0,C=0;w&&(z|=16),"UNIX"===i?(C=798,z|=function(e,t){var r=e;return e||(r=t?16893:33204),(65535&r)<<16}(h.unixPermissions,w)):(C=20,z|=function(e){return 63&(e||0)}(h.dosPermissions)),a=k.getUTCHours(),a<<=6,a|=k.getUTCMinutes(),a<<=5,a|=k.getUTCSeconds()/2,o=k.getUTCFullYear()-1980,o<<=4,o|=k.getUTCMonth()+1,o<<=5,o|=k.getUTCDate(),_&&(v=A(1,1)+A(B(f),4)+c,b+="up"+A(v.length,2)+v),g&&(y=A(1,1)+A(B(p),4)+m,b+="uc"+A(y.length,2)+y);var E="";return E+="\n\0",E+=A(S,2),E+=u.magic,E+=A(a,2),E+=A(o,2),E+=A(x.crc32,4),E+=A(x.compressedSize,4),E+=A(x.uncompressedSize,4),E+=A(f.length,2),E+=A(b.length,2),{fileRecord:R.LOCAL_FILE_HEADER+E+f+b,dirRecord:R.CENTRAL_FILE_HEADER+A(C,2)+E+A(p.length,2)+"\0\0\0\0"+A(z,4)+A(n,4)+f+b+p}}var I=e("../utils"),i=e("../stream/GenericWorker"),O=e("../utf8"),B=e("../crc32"),R=e("../signature");function s(e,t,r,n){i.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=n,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}I.inherits(s,i),s.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,n=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,i.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-n-1))/r:100}}))},s.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=n(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},s.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=n(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:function(e){return R.DATA_DESCRIPTOR+A(e.crc32,4)+A(e.compressedSize,4)+A(e.uncompressedSize,4)}(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},s.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,n=function(e,t,r,n,i){var s=I.transformTo("string",i(n));return R.CENTRAL_DIRECTORY_END+"\0\0\0\0"+A(e,2)+A(e,2)+A(t,4)+A(r,4)+A(s.length,2)+s}(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},s.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},s.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},s.prototype.error=function(e){var t=this._sources;if(!i.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(e){}return!0},s.prototype.lock=function(){i.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=s},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,r){"use strict";var u=e("../compressions"),n=e("./ZipFileWorker");r.generateWorker=function(e,a,t){var o=new n(a.streamFiles,t,a.platform,a.encodeFileName),h=0;try{e.forEach((function(e,t){h++;var r=function(e,t){var r=e||t,n=u[r];if(!n)throw new Error(r+" is not a valid compression method !");return n}(t.options.compression,a.compression),n=t.options.compressionOptions||a.compressionOptions||{},i=t.dir,s=t.date;t._compressWorker(r,n).withStreamInfo("file",{name:e,dir:i,date:s,comment:t.comment||"",unixPermissions:t.unixPermissions,dosPermissions:t.dosPermissions}).pipe(o)})),o.entriesCount=h}catch(e){o.error(e)}return o}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,r){"use strict";function n(){if(!(this instanceof n))return new n;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new n;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(n.prototype=e("./object")).loadAsync=e("./load"),n.support=e("./support"),n.defaults=e("./defaults"),n.version="3.10.1",n.loadAsync=function(e,t){return(new n).loadAsync(e,t)},n.external=e("./external"),t.exports=n},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,r){"use strict";var u=e("./utils"),i=e("./external"),n=e("./utf8"),s=e("./zipEntries"),a=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function f(n){return new i.Promise((function(e,t){var r=n.decompressed.getContentWorker().pipe(new a);r.on("error",(function(e){t(e)})).on("end",(function(){r.streamInfo.crc32!==n.decompressed.crc32?t(new Error("Corrupted zip : CRC32 mismatch")):e()})).resume()}))}t.exports=function(e,o){var h=this;return o=u.extend(o||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:n.utf8decode}),l.isNode&&l.isStream(e)?i.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):u.prepareContent("the loaded zip file",e,!0,o.optimizedBinaryString,o.base64).then((function(e){var t=new s(o);return t.load(e),t})).then((function(e){var t=[i.Promise.resolve(e)],r=e.files;if(o.checkCRC32)for(var n=0;n<r.length;n++)t.push(f(r[n]));return i.Promise.all(t)})).then((function(e){for(var t=e.shift(),r=t.files,n=0;n<r.length;n++){var i=r[n],s=i.fileNameStr,a=u.resolve(i.fileNameStr);h.file(a,i.decompressed,{binary:!0,optimizedBinaryString:!0,date:i.date,dir:i.dir,comment:i.fileCommentStr.length?i.fileCommentStr:null,unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions,createFolders:o.createFolders}),i.dir||(h.file(a).unsafeOriginalName=s)}return t.zipComment.length&&(h.comment=t.zipComment),h}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../stream/GenericWorker");function s(e,t){i.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}n.inherits(s,i),s.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},s.prototype.pause=function(){return!!i.prototype.pause.call(this)&&(this._stream.pause(),!0)},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=s},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,r){"use strict";var i=e("readable-stream").Readable;function n(e,t,r){i.call(this,t),this._helper=e;var n=this;e.on("data",(function(e,t){n.push(e)||n._helper.pause(),r&&r(t)})).on("error",(function(e){n.emit("error",e)})).on("end",(function(){n.push(null)}))}e("../utils").inherits(n,i),n.prototype._read=function(){this._helper.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(e,t,r){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,r){"use strict";function s(e,t,r){var n,i=u.getTypeOf(t),s=u.extend(r||{},f);s.date=s.date||new Date,null!==s.compression&&(s.compression=s.compression.toUpperCase()),"string"==typeof s.unixPermissions&&(s.unixPermissions=parseInt(s.unixPermissions,8)),s.unixPermissions&&16384&s.unixPermissions&&(s.dir=!0),s.dosPermissions&&16&s.dosPermissions&&(s.dir=!0),s.dir&&(e=g(e)),s.createFolders&&(n=_(e))&&b.call(this,n,!0);var o,a="string"===i&&!1===s.binary&&!1===s.base64;r&&void 0!==r.binary||(s.binary=!a),(t instanceof c&&0===t.uncompressedSize||s.dir||!t||0===t.length)&&(s.base64=!1,s.binary=!0,t="",s.compression="STORE",i="string"),o=t instanceof c||t instanceof l?t:p.isNode&&p.isStream(t)?new m(e,t):u.prepareContent(e,t,s.binary,s.optimizedBinaryString,s.base64);var h=new d(e,o,s);this.files[e]=h}var i=e("./utf8"),u=e("./utils"),l=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),f=e("./defaults"),c=e("./compressedObject"),d=e("./zipObject"),o=e("./generate"),p=e("./nodejsUtils"),m=e("./nodejs/NodejsStreamInputAdapter"),_=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},b=function(e,t){return t=void 0!==t?t:f.createFolders,e=g(e),this.files[e]||s.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function h(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var n={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,n;for(t in this.files)n=this.files[t],(r=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(r,n)},filter:function(r){var n=[];return this.forEach((function(e,t){r(e,t)&&n.push(t)})),n},file:function(e,t,r){if(1!==arguments.length)return e=this.root+e,s.call(this,e,t,r),this;if(h(e)){var n=e;return this.filter((function(e,t){return!t.dir&&n.test(e)}))}var i=this.files[this.root+e];return i&&!i.dir?i:null},folder:function(r){if(!r)return this;if(h(r))return this.filter((function(e,t){return t.dir&&r.test(e)}));var e=this.root+r,t=b.call(this,e),n=this.clone();return n.root=t.name,n},remove:function(r){r=this.root+r;var e=this.files[r];if(e||("/"!==r.slice(-1)&&(r+="/"),e=this.files[r]),e&&!e.dir)delete this.files[r];else for(var t=this.filter((function(e,t){return t.name.slice(0,r.length)===r})),n=0;n<t.length;n++)delete this.files[t[n].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if((r=u.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:i.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");u.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var n=r.comment||this.comment||"";t=o.generateWorker(this,r,n)}catch(e){(t=new l("error")).error(e)}return new a(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=n},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,r){"use strict";t.exports=e("stream")},{stream:void 0}],17:[function(e,t,r){"use strict";var n=e("./DataReader");function i(e){n.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),s=this.length-4;0<=s;--s)if(this.data[s]===t&&this.data[s+1]===r&&this.data[s+2]===n&&this.data[s+3]===i)return s-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),s=this.readData(4);return t===s[0]&&r===s[1]&&n===s[2]&&i===s[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,r){"use strict";var n=e("../utils");function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,r){"use strict";var n=e("./Uint8ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,r){"use strict";var n=e("./DataReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,r){"use strict";var n=e("./ArrayReader");function i(e){n.call(this,e)}e("../utils").inherits(i,n),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,r){"use strict";var n=e("../utils"),i=e("../support"),s=e("./ArrayReader"),a=e("./StringReader"),o=e("./NodeBufferReader"),h=e("./Uint8ArrayReader");t.exports=function(e){var t=n.getTypeOf(e);return n.checkSupport(t),"string"!==t||i.uint8array?"nodebuffer"===t?new o(e):i.uint8array?new h(n.transformTo("uint8array",e)):new s(n.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,r){"use strict";var n=e("./GenericWorker"),i=e("../utils");function s(e){n.call(this,"ConvertWorker to "+e),this.destType=e}i.inherits(s,n),s.prototype.processChunk=function(e){this.push({data:i.transformTo(this.destType,e.data),meta:e.meta})},t.exports=s},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,r){"use strict";var n=e("./GenericWorker"),i=e("../crc32");function s(){n.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(s,n),s.prototype.processChunk=function(e){this.streamInfo.crc32=i(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=s},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./GenericWorker");function s(e){i.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}n.inherits(s,i),s.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}i.prototype.processChunk.call(this,e)},t.exports=s},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,r){"use strict";var n=e("../utils"),i=e("./GenericWorker");function s(e){i.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=n.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}n.inherits(s,i),s.prototype.cleanUp=function(){i.prototype.cleanUp.call(this),this.data=null},s.prototype.resume=function(){return!!i.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,n.delay(this._tickAndRepeat,[],this)),!0)},s.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(n.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},s.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=s},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,r){"use strict";function n(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}n.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=n},{}],29:[function(e,t,r){"use strict";var h=e("../utils"),i=e("./ConvertWorker"),s=e("./GenericWorker"),u=e("../base64"),n=e("../support"),a=e("../external"),o=null;if(n.nodestream)try{o=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function f(e,t,r){var n=t;switch(t){case"blob":case"arraybuffer":n="uint8array";break;case"base64":n="string"}try{this._internalType=n,this._outputType=t,this._mimeType=r,h.checkSupport(n),this._worker=e.pipe(new i(n)),e.lock()}catch(e){this._worker=new s("error"),this._worker.error(e)}}f.prototype={accumulate:function(e){return function(e,o){return new a.Promise((function(t,r){var n=[],i=e._internalType,s=e._outputType,a=e._mimeType;e.on("data",(function(e,t){n.push(e),o&&o(t)})).on("error",(function(e){n=[],r(e)})).on("end",(function(){try{var e=function(e,t,r){switch(e){case"blob":return h.newBlob(h.transformTo("arraybuffer",t),r);case"base64":return u.encode(t);default:return h.transformTo(e,t)}}(s,function(e,t){var r,n=0,i=null,s=0;for(r=0;r<t.length;r++)s+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(i=new Uint8Array(s),r=0;r<t.length;r++)i.set(t[r],n),n+=t[r].length;return i;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(i,n),a);t(e)}catch(e){r(e)}n=[]})).resume()}))}(this,e)},on:function(e,t){var r=this;return"data"===e?this._worker.on(e,(function(e){t.call(r,e.data,e.meta)})):this._worker.on(e,(function(){h.delay(t,arguments,r)})),this},resume:function(){return h.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(h.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new o(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=f},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,r){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof Buffer,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var n=new ArrayBuffer(0);try{r.blob=0===new Blob([n],{type:"application/zip"}).size}catch(e){try{var i=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);i.append(n),r.blob=0===i.getBlob("application/zip").size}catch(e){r.blob=!1}}}try{r.nodestream=!!e("readable-stream").Readable}catch(e){r.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,s){"use strict";for(var o=e("./utils"),h=e("./support"),r=e("./nodejsUtils"),n=e("./stream/GenericWorker"),u=new Array(256),i=0;i<256;i++)u[i]=252<=i?6:248<=i?5:240<=i?4:224<=i?3:192<=i?2:1;function a(){n.call(this,"utf-8 decode"),this.leftOver=null}function l(){n.call(this,"utf-8 encode")}u[254]=u[254]=1,s.utf8encode=function(e){return h.nodebuffer?r.newBufferFrom(e,"utf-8"):function(e){var t,r,n,i,s,a=e.length,o=0;for(i=0;i<a;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=h.uint8array?new Uint8Array(o):new Array(o),i=s=0;s<o;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[s++]=r:(r<2048?t[s++]=192|r>>>6:(r<65536?t[s++]=224|r>>>12:(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63),t[s++]=128|r>>>6&63),t[s++]=128|63&r);return t}(e)},s.utf8decode=function(e){return h.nodebuffer?o.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,r,n,i,s=e.length,a=new Array(2*s);for(t=r=0;t<s;)if((n=e[t++])<128)a[r++]=n;else if(4<(i=u[n]))a[r++]=65533,t+=i-1;else{for(n&=2===i?31:3===i?15:7;1<i&&t<s;)n=n<<6|63&e[t++],i--;1<i?a[r++]=65533:n<65536?a[r++]=n:(n-=65536,a[r++]=55296|n>>10&1023,a[r++]=56320|1023&n)}return a.length!==r&&(a.subarray?a=a.subarray(0,r):a.length=r),o.applyFromCharCode(a)}(e=o.transformTo(h.uint8array?"uint8array":"array",e))},o.inherits(a,n),a.prototype.processChunk=function(e){var t=o.transformTo(h.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(h.uint8array){var r=t;(t=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),t.set(r,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var n=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+u[e[r]]>t?r:t}(t),i=t;n!==t.length&&(h.uint8array?(i=t.subarray(0,n),this.leftOver=t.subarray(n,t.length)):(i=t.slice(0,n),this.leftOver=t.slice(n,t.length))),this.push({data:s.utf8decode(i),meta:e.meta})},a.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=a,o.inherits(l,n),l.prototype.processChunk=function(e){this.push({data:s.utf8encode(e.data),meta:e.meta})},s.Utf8EncodeWorker=l},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,a){"use strict";var o=e("./support"),h=e("./base64"),r=e("./nodejsUtils"),u=e("./external");function n(e){return e}function l(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}e("setimmediate"),a.newBlob=function(t,r){a.checkSupport("blob");try{return new Blob([t],{type:r})}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return n.append(t),n.getBlob(r)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var i={stringifyByChunk:function(e,t,r){var n=[],i=0,s=e.length;if(s<=r)return String.fromCharCode.apply(null,e);for(;i<s;)"array"===t||"nodebuffer"===t?n.push(String.fromCharCode.apply(null,e.slice(i,Math.min(i+r,s)))):n.push(String.fromCharCode.apply(null,e.subarray(i,Math.min(i+r,s)))),i+=r;return n.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&1===String.fromCharCode.apply(null,r.allocBuffer(1)).length}catch(e){return!1}}()}};function s(e){var t=65536,r=a.getTypeOf(e),n=!0;if("uint8array"===r?n=i.applyCanBeUsed.uint8array:"nodebuffer"===r&&(n=i.applyCanBeUsed.nodebuffer),n)for(;1<t;)try{return i.stringifyByChunk(e,r,t)}catch(e){t=Math.floor(t/2)}return i.stringifyByChar(e)}function f(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}a.applyFromCharCode=s;var c={};c.string={string:n,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return c.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,r.allocBuffer(e.length))}},c.array={string:s,array:n,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(e)}},c.arraybuffer={string:function(e){return s(new Uint8Array(e))},array:function(e){return f(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:n,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(new Uint8Array(e))}},c.uint8array={string:s,array:function(e){return f(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:n,nodebuffer:function(e){return r.newBufferFrom(e)}},c.nodebuffer={string:s,array:function(e){return f(e,new Array(e.length))},arraybuffer:function(e){return c.nodebuffer.uint8array(e).buffer},uint8array:function(e){return f(e,new Uint8Array(e.length))},nodebuffer:n},a.transformTo=function(e,t){if(t=t||"",!e)return t;a.checkSupport(e);var r=a.getTypeOf(t);return c[r][e](t)},a.resolve=function(e){for(var t=e.split("/"),r=[],n=0;n<t.length;n++){var i=t[n];"."===i||""===i&&0!==n&&n!==t.length-1||(".."===i?r.pop():r.push(i))}return r.join("/")},a.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":o.nodebuffer&&r.isBuffer(e)?"nodebuffer":o.uint8array&&e instanceof Uint8Array?"uint8array":o.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(e){if(!o[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)n+="\\x"+((t=e.charCodeAt(r))<16?"0":"")+t.toString(16).toUpperCase();return n},a.delay=function(e,t,r){setImmediate((function(){e.apply(r||null,t||[])}))},a.inherits=function(e,t){function r(){}r.prototype=t.prototype,e.prototype=new r},a.extend=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===r[t]&&(r[t]=arguments[e][t]);return r},a.prepareContent=function(r,e,n,i,s){return u.Promise.resolve(e).then((function(n){return o.blob&&(n instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(n)))&&"undefined"!=typeof FileReader?new u.Promise((function(t,r){var e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=function(e){r(e.target.error)},e.readAsArrayBuffer(n)})):n})).then((function(e){var t=a.getTypeOf(e);return t?("arraybuffer"===t?e=a.transformTo("uint8array",e):"string"===t&&(s?e=h.decode(e):n&&!0!==i&&(e=function(e){return l(e,o.uint8array?new Uint8Array(e.length):new Array(e.length))}(e))),e):u.Promise.reject(new Error("Can't read the data of '"+r+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),i=e("./utils"),s=e("./signature"),a=e("./zipEntry"),o=e("./support");function h(e){this.files=[],this.loadOptions=e}h.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+i.pretty(t)+", expected "+i.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var n=this.reader.readString(4)===t;return this.reader.setIndex(r),n},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",r=i.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44;0<n;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(s.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,s.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===i.MAX_VALUE_16BITS||this.diskWithCentralDirStart===i.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===i.MAX_VALUE_16BITS||this.centralDirRecords===i.MAX_VALUE_16BITS||this.centralDirSize===i.MAX_VALUE_32BITS||this.centralDirOffset===i.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,s.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var n=t-r;if(0<n)this.isSignature(t,s.CENTRAL_FILE_HEADER)||(this.reader.zero=n);else if(n<0)throw new Error("Corrupted zip: missing "+Math.abs(n)+" bytes.")},prepareReader:function(e){this.reader=n(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=h},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,r){"use strict";var n=e("./reader/readerFor"),s=e("./utils"),i=e("./compressedObject"),a=e("./crc32"),o=e("./utf8"),h=e("./compressions"),u=e("./support");function l(e,t){this.options=e,this.loadOptions=t}l.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in h)if(Object.prototype.hasOwnProperty.call(h,t)&&h[t].magic===e)return h[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new i(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=n(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<i;)t=e.readInt(2),r=e.readInt(2),n=e.readData(r),this.extraFields[t]={id:t,length:r,value:n};e.setIndex(i)},handleUTF8:function(){var e=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var r=s.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var n=this.findExtraFieldUnicodeComment();if(null!==n)this.fileCommentStr=n;else{var i=s.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(i)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=n(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=n(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=l},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,r){"use strict";function n(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}}var s=e("./stream/StreamHelper"),i=e("./stream/DataWorker"),a=e("./utf8"),o=e("./compressedObject"),h=e("./stream/GenericWorker");n.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(r=e.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),t=this._decompressWorker();var i=!this._dataBinary;i&&!n&&(t=t.pipe(new a.Utf8EncodeWorker)),!i&&n&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(e){(t=new h("error")).error(e)}return new s(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof h?this._data:new i(this._data)}};for(var u=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],l=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},f=0;f<u.length;f++)n.prototype[u[f]]=l;t.exports=n},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,l,t){(function(t){"use strict";var r,n,e=t.MutationObserver||t.WebKitMutationObserver;if(e){var i=0,s=new e(u),a=t.document.createTextNode("");s.observe(a,{characterData:!0}),r=function(){a.data=i=++i%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var e=t.document.createElement("script");e.onreadystatechange=function(){u(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},t.document.documentElement.appendChild(e)}:function(){setTimeout(u,0)};else{var o=new t.MessageChannel;o.port1.onmessage=u,r=function(){o.port2.postMessage(0)}}var h=[];function u(){var e,t;n=!0;for(var r=h.length;r;){for(t=h,h=[],e=-1;++e<r;)t[e]();r=h.length}n=!1}l.exports=function(e){1!==h.push(e)||n||r()}}).call(this,void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,r){"use strict";var i=e("immediate");function u(){}var l={},s=["REJECTED"],a=["FULFILLED"],n=["PENDING"];function o(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=n,this.queue=[],this.outcome=void 0,e!==u&&d(this,e)}function h(e,t,r){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function f(t,r,n){i((function(){var e;try{e=r(n)}catch(e){return l.reject(t,e)}e===t?l.reject(t,new TypeError("Cannot resolve promise with itself")):l.resolve(t,e)}))}function c(e){var t=e&&e.then;if(e&&("object"==_typeof(e)||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function d(t,e){var r=!1;function n(e){r||(r=!0,l.reject(t,e))}function i(e){r||(r=!0,l.resolve(t,e))}var s=p((function(){e(i,n)}));"error"===s.status&&n(s.value)}function p(e,t){var r={};try{r.value=e(t),r.status="success"}catch(e){r.status="error",r.value=e}return r}(t.exports=o).prototype.finally=function(t){if("function"!=typeof t)return this;var r=this.constructor;return this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))}))},o.prototype.catch=function(e){return this.then(null,e)},o.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===s)return this;var r=new this.constructor(u);return this.state!==n?f(r,this.state===a?e:t,this.outcome):this.queue.push(new h(r,e,t)),r},h.prototype.callFulfilled=function(e){l.resolve(this.promise,e)},h.prototype.otherCallFulfilled=function(e){f(this.promise,this.onFulfilled,e)},h.prototype.callRejected=function(e){l.reject(this.promise,e)},h.prototype.otherCallRejected=function(e){f(this.promise,this.onRejected,e)},l.resolve=function(e,t){var r=p(c,t);if("error"===r.status)return l.reject(e,r.value);var n=r.value;if(n)d(e,n);else{e.state=a,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callFulfilled(t)}return e},l.reject=function(e,t){e.state=s,e.outcome=t;for(var r=-1,n=e.queue.length;++r<n;)e.queue[r].callRejected(t);return e},o.resolve=function(e){return e instanceof this?e:l.resolve(new this(u),e)},o.reject=function(e){var t=new this(u);return l.reject(t,e)},o.all=function(e){var r=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var n=e.length,i=!1;if(!n)return this.resolve([]);for(var s=new Array(n),a=0,t=-1,o=new this(u);++t<n;)h(e[t],t);return o;function h(e,t){r.resolve(e).then((function(e){s[t]=e,++a!==n||i||(i=!0,l.resolve(o,s))}),(function(e){i||(i=!0,l.reject(o,e))}))}},o.race=function(e){if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,n=!1;if(!r)return this.resolve([]);for(var a,i=-1,s=new this(u);++i<r;)a=e[i],this.resolve(a).then((function(e){n||(n=!0,l.resolve(s,e))}),(function(e){n||(n=!0,l.reject(s,e))}));return s}},{immediate:36}],38:[function(e,t,r){"use strict";var n={};(0,e("./lib/utils/common").assign)(n,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=n},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,r){"use strict";var a=e("./zlib/deflate"),o=e("./utils/common"),h=e("./utils/strings"),i=e("./zlib/messages"),s=e("./zlib/zstream"),u=Object.prototype.toString,l=0,f=-1,c=0,d=8;function p(e){if(!(this instanceof p))return new p(e);this.options=o.assign({level:f,method:d,chunkSize:16384,windowBits:15,memLevel:8,strategy:c,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var r=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==l)throw new Error(i[r]);if(t.header&&a.deflateSetHeader(this.strm,t.header),t.dictionary){var n;if(n="string"==typeof t.dictionary?h.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=a.deflateSetDictionary(this.strm,n))!==l)throw new Error(i[r]);this._dict_set=!0}}function n(e,t){var r=new p(t);if(r.push(e,!0),r.err)throw r.msg||i[r.err];return r.result}p.prototype.push=function(e,t){var r,n,i=this.strm,s=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:!0===t?4:0,"string"==typeof e?i.input=h.string2buf(e):"[object ArrayBuffer]"===u.call(e)?i.input=new Uint8Array(e):i.input=e,i.next_in=0,i.avail_in=i.input.length;do{if(0===i.avail_out&&(i.output=new o.Buf8(s),i.next_out=0,i.avail_out=s),1!==(r=a.deflate(i,n))&&r!==l)return this.onEnd(r),!(this.ended=!0);0!==i.avail_out&&(0!==i.avail_in||4!==n&&2!==n)||("string"===this.options.to?this.onData(h.buf2binstring(o.shrinkBuf(i.output,i.next_out))):this.onData(o.shrinkBuf(i.output,i.next_out)))}while((0<i.avail_in||0===i.avail_out)&&1!==r);return 4===n?(r=a.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===l):2!==n||(this.onEnd(l),!(i.avail_out=0))},p.prototype.onData=function(e){this.chunks.push(e)},p.prototype.onEnd=function(e){e===l&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Deflate=p,r.deflate=n,r.deflateRaw=function(e,t){return(t=t||{}).raw=!0,n(e,t)},r.gzip=function(e,t){return(t=t||{}).gzip=!0,n(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,r){"use strict";var c=e("./zlib/inflate"),d=e("./utils/common"),p=e("./utils/strings"),m=e("./zlib/constants"),n=e("./zlib/messages"),i=e("./zlib/zstream"),s=e("./zlib/gzheader"),_=Object.prototype.toString;function a(e){if(!(this instanceof a))return new a(e);this.options=d.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var r=c.inflateInit2(this.strm,t.windowBits);if(r!==m.Z_OK)throw new Error(n[r]);this.header=new s,c.inflateGetHeader(this.strm,this.header)}function o(e,t){var r=new a(t);if(r.push(e,!0),r.err)throw r.msg||n[r.err];return r.result}a.prototype.push=function(e,t){var r,n,i,s,a,o,h=this.strm,u=this.options.chunkSize,l=this.options.dictionary,f=!1;if(this.ended)return!1;n=t===~~t?t:!0===t?m.Z_FINISH:m.Z_NO_FLUSH,"string"==typeof e?h.input=p.binstring2buf(e):"[object ArrayBuffer]"===_.call(e)?h.input=new Uint8Array(e):h.input=e,h.next_in=0,h.avail_in=h.input.length;do{if(0===h.avail_out&&(h.output=new d.Buf8(u),h.next_out=0,h.avail_out=u),(r=c.inflate(h,m.Z_NO_FLUSH))===m.Z_NEED_DICT&&l&&(o="string"==typeof l?p.string2buf(l):"[object ArrayBuffer]"===_.call(l)?new Uint8Array(l):l,r=c.inflateSetDictionary(this.strm,o)),r===m.Z_BUF_ERROR&&!0===f&&(r=m.Z_OK,f=!1),r!==m.Z_STREAM_END&&r!==m.Z_OK)return this.onEnd(r),!(this.ended=!0);h.next_out&&(0!==h.avail_out&&r!==m.Z_STREAM_END&&(0!==h.avail_in||n!==m.Z_FINISH&&n!==m.Z_SYNC_FLUSH)||("string"===this.options.to?(i=p.utf8border(h.output,h.next_out),s=h.next_out-i,a=p.buf2string(h.output,i),h.next_out=s,h.avail_out=u-s,s&&d.arraySet(h.output,h.output,i,s,0),this.onData(a)):this.onData(d.shrinkBuf(h.output,h.next_out)))),0===h.avail_in&&0===h.avail_out&&(f=!0)}while((0<h.avail_in||0===h.avail_out)&&r!==m.Z_STREAM_END);return r===m.Z_STREAM_END&&(n=m.Z_FINISH),n===m.Z_FINISH?(r=c.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===m.Z_OK):n!==m.Z_SYNC_FLUSH||(this.onEnd(m.Z_OK),!(h.avail_out=0))},a.prototype.onData=function(e){this.chunks.push(e)},a.prototype.onEnd=function(e){e===m.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=d.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=a,r.inflate=o,r.inflateRaw=function(e,t){return(t=t||{}).raw=!0,o(e,t)},r.ungzip=o},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=_typeof(r))throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)e.set(t.subarray(r,r+n),i);else for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){var t,r,n,i,s,a;for(t=n=0,r=e.length;t<r;t++)n+=e[t].length;for(a=new Uint8Array(n),t=i=0,r=e.length;t<r;t++)s=e[t],a.set(s,i),i+=s.length;return a}},s={arraySet:function(e,t,r,n,i){for(var s=0;s<n;s++)e[i+s]=t[r+s]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,s))},r.setTyped(n)},{}],42:[function(e,t,r){"use strict";var h=e("./common"),i=!0,s=!0;try{String.fromCharCode.apply(null,[0])}catch(e){i=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){s=!1}for(var u=new h.Buf8(256),n=0;n<256;n++)u[n]=252<=n?6:248<=n?5:240<=n?4:224<=n?3:192<=n?2:1;function l(e,t){if(t<65537&&(e.subarray&&s||!e.subarray&&i))return String.fromCharCode.apply(null,h.shrinkBuf(e,t));for(var r="",n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r}u[254]=u[254]=1,r.string2buf=function(e){var t,r,n,i,s,a=e.length,o=0;for(i=0;i<a;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new h.Buf8(o),i=s=0;s<o;i++)55296==(64512&(r=e.charCodeAt(i)))&&i+1<a&&56320==(64512&(n=e.charCodeAt(i+1)))&&(r=65536+(r-55296<<10)+(n-56320),i++),r<128?t[s++]=r:(r<2048?t[s++]=192|r>>>6:(r<65536?t[s++]=224|r>>>12:(t[s++]=240|r>>>18,t[s++]=128|r>>>12&63),t[s++]=128|r>>>6&63),t[s++]=128|63&r);return t},r.buf2binstring=function(e){return l(e,e.length)},r.binstring2buf=function(e){for(var t=new h.Buf8(e.length),r=0,n=t.length;r<n;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,n,i,s,a=t||e.length,o=new Array(2*a);for(r=n=0;r<a;)if((i=e[r++])<128)o[n++]=i;else if(4<(s=u[i]))o[n++]=65533,r+=s-1;else{for(i&=2===s?31:3===s?15:7;1<s&&r<a;)i=i<<6|63&e[r++],s--;1<s?o[n++]=65533:i<65536?o[n++]=i:(i-=65536,o[n++]=55296|i>>10&1023,o[n++]=56320|1023&i)}return l(o,n)},r.utf8border=function(e,t){var r;for((t=t||e.length)>e.length&&(t=e.length),r=t-1;0<=r&&128==(192&e[r]);)r--;return r<0||0===r?t:r+u[e[r]]>t?r:t}},{"./common":41}],43:[function(e,t,r){"use strict";t.exports=function(e,t,r,n){for(var i=65535&e|0,s=e>>>16&65535|0,a=0;0!==r;){for(r-=a=2e3<r?2e3:r;s=s+(i=i+t[n++]|0)|0,--a;);i%=65521,s%=65521}return i|s<<16|0}},{}],44:[function(e,t,r){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,r){"use strict";var o=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();t.exports=function(e,t,r,n){var i=o,s=n+r;e^=-1;for(var a=n;a<s;a++)e=e>>>8^i[255&(e^t[a])];return-1^e}},{}],46:[function(e,t,r){"use strict";var h,c=e("../utils/common"),u=e("./trees"),d=e("./adler32"),p=e("./crc32"),n=e("./messages"),l=0,m=0,_=-2,i=2,v=8,s=286,a=30,o=19,w=2*s+1,k=15,x=3,S=258,z=S+x+1,C=42,E=113;function R(e,t){return e.msg=n[t],t}function T(e){return(e<<1)-(4<e?9:0)}function D(e){for(var t=e.length;0<=--t;)e[t]=0}function F(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(c.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function N(e,t){u._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,F(e.strm)}function U(e,t){e.pending_buf[e.pending++]=t}function P(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function L(e,t){var r,n,i=e.max_chain_length,s=e.strstart,a=e.prev_length,o=e.nice_match,h=e.strstart>e.w_size-z?e.strstart-(e.w_size-z):0,u=e.window,l=e.w_mask,f=e.prev,c=e.strstart+S,d=u[s+a-1],p=u[s+a];e.prev_length>=e.good_match&&(i>>=2),o>e.lookahead&&(o=e.lookahead);do{if(u[(r=t)+a]===p&&u[r+a-1]===d&&u[r]===u[s]&&u[++r]===u[s+1]){s+=2,r++;do{}while(u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&u[++s]===u[++r]&&s<c);if(n=S-(c-s),s=c-S,a<n){if(e.match_start=t,o<=(a=n))break;d=u[s+a-1],p=u[s+a]}}}while((t=f[t&l])>h&&0!=--i);return a<=e.lookahead?a:e.lookahead}function j(e){var t,r,n,i,s,a,o,h,u,l,f=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=f+(f-z)){for(c.arraySet(e.window,e.window,f,f,0),e.match_start-=f,e.strstart-=f,e.block_start-=f,t=r=e.hash_size;n=e.head[--t],e.head[t]=f<=n?n-f:0,--r;);for(t=r=f;n=e.prev[--t],e.prev[t]=f<=n?n-f:0,--r;);i+=f}if(0===e.strm.avail_in)break;if(a=e.strm,o=e.window,h=e.strstart+e.lookahead,l=void 0,(u=i)<(l=a.avail_in)&&(l=u),r=0===l?0:(a.avail_in-=l,c.arraySet(o,a.input,a.next_in,l,h),1===a.state.wrap?a.adler=d(a.adler,o,l,h):2===a.state.wrap&&(a.adler=p(a.adler,o,l,h)),a.next_in+=l,a.total_in+=l,l),e.lookahead+=r,e.lookahead+e.insert>=x)for(s=e.strstart-e.insert,e.ins_h=e.window[s],e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[s+x-1])&e.hash_mask,e.prev[s&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=s,s++,e.insert--,!(e.lookahead+e.insert<x)););}while(e.lookahead<z&&0!==e.strm.avail_in)}function Z(e,t){for(var r,n;;){if(e.lookahead<z){if(j(e),e.lookahead<z&&t===l)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=x&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-z&&(e.match_length=L(e,r)),e.match_length>=x)if(n=u._tr_tally(e,e.strstart-e.match_start,e.match_length-x),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=x){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=u._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(N(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<x-1?e.strstart:x-1,4===t?(N(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?1:2}function W(e,t){for(var r,n,i;;){if(e.lookahead<z){if(j(e),e.lookahead<z&&t===l)return 1;if(0===e.lookahead)break}if(r=0,e.lookahead>=x&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=x-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-z&&(e.match_length=L(e,r),e.match_length<=5&&(1===e.strategy||e.match_length===x&&4096<e.strstart-e.match_start)&&(e.match_length=x-1)),e.prev_length>=x&&e.match_length<=e.prev_length){for(i=e.strstart+e.lookahead-x,n=u._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-x),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+x-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=x-1,e.strstart++,n&&(N(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((n=u._tr_tally(e,0,e.window[e.strstart-1]))&&N(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=u._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<x-1?e.strstart:x-1,4===t?(N(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?1:2}function M(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new c.Buf16(2*w),this.dyn_dtree=new c.Buf16(2*(2*a+1)),this.bl_tree=new c.Buf16(2*(2*o+1)),D(this.dyn_ltree),D(this.dyn_dtree),D(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new c.Buf16(k+1),this.heap=new c.Buf16(2*s+1),D(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new c.Buf16(2*s+1),D(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function G(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=i,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?C:E,e.adler=2===t.wrap?0:1,t.last_flush=l,u._tr_init(t),m):R(e,_)}function K(e){var t=G(e);return t===m&&function(e){e.window_size=2*e.w_size,D(e.head),e.max_lazy_match=h[e.level].max_lazy,e.good_match=h[e.level].good_length,e.nice_match=h[e.level].nice_length,e.max_chain_length=h[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=x-1,e.match_available=0,e.ins_h=0}(e.state),t}function Y(e,t,r,n,i,s){if(!e)return _;var a=1;if(-1===t&&(t=6),n<0?(a=0,n=-n):15<n&&(a=2,n-=16),i<1||9<i||r!==v||n<8||15<n||t<0||9<t||s<0||4<s)return R(e,_);8===n&&(n=9);var o=new H;return(e.state=o).strm=e,o.wrap=a,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+x-1)/x),o.window=new c.Buf8(2*o.w_size),o.head=new c.Buf16(o.hash_size),o.prev=new c.Buf16(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=4*o.lit_bufsize,o.pending_buf=new c.Buf8(o.pending_buf_size),o.d_buf=1*o.lit_bufsize,o.l_buf=3*o.lit_bufsize,o.level=t,o.strategy=s,o.method=r,K(e)}h=[new M(0,0,0,0,(function(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(j(e),0===e.lookahead&&t===l)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,N(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-z&&(N(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(N(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(N(e,!1),e.strm.avail_out),1)})),new M(4,4,8,4,Z),new M(4,5,16,8,Z),new M(4,6,32,32,Z),new M(4,4,16,16,W),new M(8,16,32,32,W),new M(8,16,128,128,W),new M(8,32,128,256,W),new M(32,128,258,1024,W),new M(32,258,258,4096,W)],r.deflateInit=function(e,t){return Y(e,t,v,15,8,0)},r.deflateInit2=Y,r.deflateReset=K,r.deflateResetKeep=G,r.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?_:(e.state.gzhead=t,m):_},r.deflate=function(e,t){var r,n,i,s;if(!e||!e.state||5<t||t<0)return e?R(e,_):_;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&4!==t)return R(e,0===e.avail_out?-5:_);if(n.strm=e,r=n.last_flush,n.last_flush=t,n.status===C)if(2===n.wrap)e.adler=0,U(n,31),U(n,139),U(n,8),n.gzhead?(U(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),U(n,255&n.gzhead.time),U(n,n.gzhead.time>>8&255),U(n,n.gzhead.time>>16&255),U(n,n.gzhead.time>>24&255),U(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),U(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(U(n,255&n.gzhead.extra.length),U(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=p(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(U(n,0),U(n,0),U(n,0),U(n,0),U(n,0),U(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),U(n,3),n.status=E);else{var a=v+(n.w_bits-8<<4)<<8;a|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(a|=32),a+=31-a%31,n.status=E,P(n,a),0!==n.strstart&&(P(n,e.adler>>>16),P(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),F(e),i=n.pending,n.pending!==n.pending_buf_size));)U(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),F(e),i=n.pending,n.pending===n.pending_buf_size)){s=1;break}s=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,U(n,s)}while(0!==s);n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),0===s&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),F(e),i=n.pending,n.pending===n.pending_buf_size)){s=1;break}s=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,U(n,s)}while(0!==s);n.gzhead.hcrc&&n.pending>i&&(e.adler=p(e.adler,n.pending_buf,n.pending-i,i)),0===s&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&F(e),n.pending+2<=n.pending_buf_size&&(U(n,255&e.adler),U(n,e.adler>>8&255),e.adler=0,n.status=E)):n.status=E),0!==n.pending){if(F(e),0===e.avail_out)return n.last_flush=-1,m}else if(0===e.avail_in&&T(t)<=T(r)&&4!==t)return R(e,-5);if(666===n.status&&0!==e.avail_in)return R(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==l&&666!==n.status){var o=2===n.strategy?function(e,t){for(var r;;){if(0===e.lookahead&&(j(e),0===e.lookahead)){if(t===l)return 1;break}if(e.match_length=0,r=u._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(N(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(N(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var r,n,i,s,a=e.window;;){if(e.lookahead<=S){if(j(e),e.lookahead<=S&&t===l)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=x&&0<e.strstart&&(n=a[i=e.strstart-1])===a[++i]&&n===a[++i]&&n===a[++i]){s=e.strstart+S;do{}while(n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&n===a[++i]&&i<s);e.match_length=S-(s-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=x?(r=u._tr_tally(e,1,e.match_length-x),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=u._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(N(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(N(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(N(e,!1),0===e.strm.avail_out)?1:2}(n,t):h[n.level].func(n,t);if(3!==o&&4!==o||(n.status=666),1===o||3===o)return 0===e.avail_out&&(n.last_flush=-1),m;if(2===o&&(1===t?u._tr_align(n):5!==t&&(u._tr_stored_block(n,0,0,!1),3===t&&(D(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),F(e),0===e.avail_out))return n.last_flush=-1,m}return 4!==t?m:n.wrap<=0?1:(2===n.wrap?(U(n,255&e.adler),U(n,e.adler>>8&255),U(n,e.adler>>16&255),U(n,e.adler>>24&255),U(n,255&e.total_in),U(n,e.total_in>>8&255),U(n,e.total_in>>16&255),U(n,e.total_in>>24&255)):(P(n,e.adler>>>16),P(n,65535&e.adler)),F(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?m:1)},r.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==C&&69!==t&&73!==t&&91!==t&&103!==t&&t!==E&&666!==t?R(e,_):(e.state=null,t===E?R(e,-3):m):_},r.deflateSetDictionary=function(e,t){var r,n,i,s,a,o,h,u,l=t.length;if(!e||!e.state)return _;if(2===(s=(r=e.state).wrap)||1===s&&r.status!==C||r.lookahead)return _;for(1===s&&(e.adler=d(e.adler,t,l,0)),r.wrap=0,l>=r.w_size&&(0===s&&(D(r.head),r.strstart=0,r.block_start=0,r.insert=0),u=new c.Buf8(r.w_size),c.arraySet(u,t,l-r.w_size,r.w_size,0),t=u,l=r.w_size),a=e.avail_in,o=e.next_in,h=e.input,e.avail_in=l,e.next_in=0,e.input=t,j(r);r.lookahead>=x;){for(n=r.strstart,i=r.lookahead-(x-1);r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+x-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++,--i;);r.strstart=n,r.lookahead=x-1,j(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=x-1,r.match_available=0,e.next_in=o,e.input=h,e.avail_in=a,r.wrap=s,m},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,r){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,r){"use strict";t.exports=function(e,t){var r,n,i,s,a,o,h,u,l,f,c,d,p,m,_,g,b,v,y,w,k,x,S,z,C;r=e.state,n=e.next_in,z=e.input,i=n+(e.avail_in-5),s=e.next_out,C=e.output,a=s-(t-e.avail_out),o=s+(e.avail_out-257),h=r.dmax,u=r.wsize,l=r.whave,f=r.wnext,c=r.window,d=r.hold,p=r.bits,m=r.lencode,_=r.distcode,g=(1<<r.lenbits)-1,b=(1<<r.distbits)-1;e:do{p<15&&(d+=z[n++]<<p,p+=8,d+=z[n++]<<p,p+=8),v=m[d&g];t:for(;;){if(d>>>=y=v>>>24,p-=y,0==(y=v>>>16&255))C[s++]=65535&v;else{if(!(16&y)){if(0==(64&y)){v=m[(65535&v)+(d&(1<<y)-1)];continue t}if(32&y){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}w=65535&v,(y&=15)&&(p<y&&(d+=z[n++]<<p,p+=8),w+=d&(1<<y)-1,d>>>=y,p-=y),p<15&&(d+=z[n++]<<p,p+=8,d+=z[n++]<<p,p+=8),v=_[d&b];r:for(;;){if(d>>>=y=v>>>24,p-=y,!(16&(y=v>>>16&255))){if(0==(64&y)){v=_[(65535&v)+(d&(1<<y)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(k=65535&v,p<(y&=15)&&(d+=z[n++]<<p,(p+=8)<y&&(d+=z[n++]<<p,p+=8)),h<(k+=d&(1<<y)-1)){e.msg="invalid distance too far back",r.mode=30;break e}if(d>>>=y,p-=y,(y=s-a)<k){if(l<(y=k-y)&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(S=c,(x=0)===f){if(x+=u-y,y<w){for(w-=y;C[s++]=c[x++],--y;);x=s-k,S=C}}else if(f<y){if(x+=u+f-y,(y-=f)<w){for(w-=y;C[s++]=c[x++],--y;);if(x=0,f<w){for(w-=y=f;C[s++]=c[x++],--y;);x=s-k,S=C}}}else if(x+=f-y,y<w){for(w-=y;C[s++]=c[x++],--y;);x=s-k,S=C}for(;2<w;)C[s++]=S[x++],C[s++]=S[x++],C[s++]=S[x++],w-=3;w&&(C[s++]=S[x++],1<w&&(C[s++]=S[x++]))}else{for(x=s-k;C[s++]=C[x++],C[s++]=C[x++],C[s++]=C[x++],2<(w-=3););w&&(C[s++]=C[x++],1<w&&(C[s++]=C[x++]))}break}}break}}while(n<i&&s<o);n-=w=p>>3,d&=(1<<(p-=w<<3))-1,e.next_in=n,e.next_out=s,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=s<o?o-s+257:257-(s-o),r.hold=d,r.bits=p}},{}],49:[function(e,t,r){"use strict";var I=e("../utils/common"),O=e("./adler32"),B=e("./crc32"),R=e("./inffast"),T=e("./inftrees"),N=0,U=-2,P=1,n=852,i=592;function L(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function s(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new I.Buf16(320),this.work=new I.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=P,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new I.Buf32(n),t.distcode=t.distdyn=new I.Buf32(i),t.sane=1,t.back=-1,N):U}function o(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,a(e)):U}function h(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?U:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,o(e))):U}function u(e,t){var r,n;return e?(n=new s,(e.state=n).window=null,(r=h(e,t))!==N&&(e.state=null),r):U}var l,f,c=!0;function j(e){if(c){var t;for(l=new I.Buf32(512),f=new I.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(T(1,e.lens,0,288,l,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;T(2,e.lens,0,32,f,0,e.work,{bits:5}),c=!1}e.lencode=l,e.lenbits=9,e.distcode=f,e.distbits=5}function Z(e,t,r,n){var i,s=e.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new I.Buf8(s.wsize)),n>=s.wsize?(I.arraySet(s.window,t,r-s.wsize,s.wsize,0),s.wnext=0,s.whave=s.wsize):(n<(i=s.wsize-s.wnext)&&(i=n),I.arraySet(s.window,t,r-n,i,s.wnext),(n-=i)?(I.arraySet(s.window,t,r-n,n,0),s.wnext=n,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0}r.inflateReset=o,r.inflateReset2=h,r.inflateResetKeep=a,r.inflateInit=function(e){return u(e,15)},r.inflateInit2=u,r.inflate=function(e,t){var r,n,i,s,a,o,h,u,l,f,c,d,p,m,_,g,b,v,y,w,k,x,S,z,C=0,E=new I.Buf8(4),A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return U;12===(r=e.state).mode&&(r.mode=13),a=e.next_out,i=e.output,h=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,u=r.hold,l=r.bits,f=o,c=h,x=N;e:for(;;)switch(r.mode){case P:if(0===r.wrap){r.mode=13;break}for(;l<16;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(2&r.wrap&&35615===u){E[r.check=0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0),l=u=0,r.mode=2;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&u)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=30;break}if(8!=(15&u)){e.msg="unknown compression method",r.mode=30;break}if(l-=4,k=8+(15&(u>>>=4)),0===r.wbits)r.wbits=k;else if(k>r.wbits){e.msg="invalid window size",r.mode=30;break}r.dmax=1<<k,e.adler=r.check=1,r.mode=512&u?10:12,l=u=0;break;case 2:for(;l<16;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(r.flags=u,8!=(255&r.flags)){e.msg="unknown compression method",r.mode=30;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=30;break}r.head&&(r.head.text=u>>8&1),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0,r.mode=3;case 3:for(;l<32;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.head&&(r.head.time=u),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=B(r.check,E,4,0)),l=u=0,r.mode=4;case 4:for(;l<16;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.head&&(r.head.xflags=255&u,r.head.os=u>>8),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0,r.mode=5;case 5:if(1024&r.flags){for(;l<16;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.length=u,r.head&&(r.head.extra_len=u),512&r.flags&&(E[0]=255&u,E[1]=u>>>8&255,r.check=B(r.check,E,2,0)),l=u=0}else r.head&&(r.head.extra=null);r.mode=6;case 6:if(1024&r.flags&&(o<(d=r.length)&&(d=o),d&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),I.arraySet(r.head.extra,n,s,d,k)),512&r.flags&&(r.check=B(r.check,n,d,s)),o-=d,s+=d,r.length-=d),r.length))break e;r.length=0,r.mode=7;case 7:if(2048&r.flags){if(0===o)break e;for(d=0;k=n[s+d++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k)),k&&d<o;);if(512&r.flags&&(r.check=B(r.check,n,d,s)),o-=d,s+=d,k)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=8;case 8:if(4096&r.flags){if(0===o)break e;for(d=0;k=n[s+d++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k)),k&&d<o;);if(512&r.flags&&(r.check=B(r.check,n,d,s)),o-=d,s+=d,k)break e}else r.head&&(r.head.comment=null);r.mode=9;case 9:if(512&r.flags){for(;l<16;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(u!==(65535&r.check)){e.msg="header crc mismatch",r.mode=30;break}l=u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=12;break;case 10:for(;l<32;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}e.adler=r.check=L(u),l=u=0,r.mode=11;case 11:if(0===r.havedict)return e.next_out=a,e.avail_out=h,e.next_in=s,e.avail_in=o,r.hold=u,r.bits=l,2;e.adler=r.check=1,r.mode=12;case 12:if(5===t||6===t)break e;case 13:if(r.last){u>>>=7&l,l-=7&l,r.mode=27;break}for(;l<3;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}switch(r.last=1&u,l-=1,3&(u>>>=1)){case 0:r.mode=14;break;case 1:if(j(r),r.mode=20,6!==t)break;u>>>=2,l-=2;break e;case 2:r.mode=17;break;case 3:e.msg="invalid block type",r.mode=30}u>>>=2,l-=2;break;case 14:for(u>>>=7&l,l-=7&l;l<32;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if((65535&u)!=(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=30;break}if(r.length=65535&u,l=u=0,r.mode=15,6===t)break e;case 15:r.mode=16;case 16:if(d=r.length){if(o<d&&(d=o),h<d&&(d=h),0===d)break e;I.arraySet(i,n,s,d,a),o-=d,s+=d,h-=d,a+=d,r.length-=d;break}r.mode=12;break;case 17:for(;l<14;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(r.nlen=257+(31&u),u>>>=5,l-=5,r.ndist=1+(31&u),u>>>=5,l-=5,r.ncode=4+(15&u),u>>>=4,l-=4,286<r.nlen||30<r.ndist){e.msg="too many length or distance symbols",r.mode=30;break}r.have=0,r.mode=18;case 18:for(;r.have<r.ncode;){for(;l<3;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.lens[A[r.have++]]=7&u,u>>>=3,l-=3}for(;r.have<19;)r.lens[A[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},x=T(0,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,x){e.msg="invalid code lengths set",r.mode=30;break}r.have=0,r.mode=19;case 19:for(;r.have<r.nlen+r.ndist;){for(;g=(C=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(b<16)u>>>=_,l-=_,r.lens[r.have++]=b;else{if(16===b){for(z=_+2;l<z;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(u>>>=_,l-=_,0===r.have){e.msg="invalid bit length repeat",r.mode=30;break}k=r.lens[r.have-1],d=3+(3&u),u>>>=2,l-=2}else if(17===b){for(z=_+3;l<z;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}l-=_,k=0,d=3+(7&(u>>>=_)),u>>>=3,l-=3}else{for(z=_+7;l<z;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}l-=_,k=0,d=11+(127&(u>>>=_)),u>>>=7,l-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=30;break}for(;d--;)r.lens[r.have++]=k}}if(30===r.mode)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=30;break}if(r.lenbits=9,S={bits:r.lenbits},x=T(1,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,x){e.msg="invalid literal/lengths set",r.mode=30;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},x=T(2,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,x){e.msg="invalid distances set",r.mode=30;break}if(r.mode=20,6===t)break e;case 20:r.mode=21;case 21:if(6<=o&&258<=h){e.next_out=a,e.avail_out=h,e.next_in=s,e.avail_in=o,r.hold=u,r.bits=l,R(e,c),a=e.next_out,i=e.output,h=e.avail_out,s=e.next_in,n=e.input,o=e.avail_in,u=r.hold,l=r.bits,12===r.mode&&(r.back=-1);break}for(r.back=0;g=(C=r.lencode[u&(1<<r.lenbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(g&&0==(240&g)){for(v=_,y=g,w=b;g=(C=r.lencode[w+((u&(1<<v+y)-1)>>v)])>>>16&255,b=65535&C,!(v+(_=C>>>24)<=l);){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}u>>>=v,l-=v,r.back+=v}if(u>>>=_,l-=_,r.back+=_,r.length=b,0===g){r.mode=26;break}if(32&g){r.back=-1,r.mode=12;break}if(64&g){e.msg="invalid literal/length code",r.mode=30;break}r.extra=15&g,r.mode=22;case 22:if(r.extra){for(z=r.extra;l<z;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=23;case 23:for(;g=(C=r.distcode[u&(1<<r.distbits)-1])>>>16&255,b=65535&C,!((_=C>>>24)<=l);){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(0==(240&g)){for(v=_,y=g,w=b;g=(C=r.distcode[w+((u&(1<<v+y)-1)>>v)])>>>16&255,b=65535&C,!(v+(_=C>>>24)<=l);){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}u>>>=v,l-=v,r.back+=v}if(u>>>=_,l-=_,r.back+=_,64&g){e.msg="invalid distance code",r.mode=30;break}r.offset=b,r.extra=15&g,r.mode=24;case 24:if(r.extra){for(z=r.extra;l<z;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,l-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=30;break}r.mode=25;case 25:if(0===h)break e;if(d=c-h,r.offset>d){if((d=r.offset-d)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=30;break}p=d>r.wnext?(d-=r.wnext,r.wsize-d):r.wnext-d,d>r.length&&(d=r.length),m=r.window}else m=i,p=a-r.offset,d=r.length;for(h<d&&(d=h),h-=d,r.length-=d;i[a++]=m[p++],--d;);0===r.length&&(r.mode=21);break;case 26:if(0===h)break e;i[a++]=r.length,h--,r.mode=21;break;case 27:if(r.wrap){for(;l<32;){if(0===o)break e;o--,u|=n[s++]<<l,l+=8}if(c-=h,e.total_out+=c,r.total+=c,c&&(e.adler=r.check=r.flags?B(r.check,i,c,a-c):O(r.check,i,c,a-c)),c=h,(r.flags?u:L(u))!==r.check){e.msg="incorrect data check",r.mode=30;break}l=u=0}r.mode=28;case 28:if(r.wrap&&r.flags){for(;l<32;){if(0===o)break e;o--,u+=n[s++]<<l,l+=8}if(u!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=30;break}l=u=0}r.mode=29;case 29:x=1;break e;case 30:x=-3;break e;case 31:return-4;default:return U}return e.next_out=a,e.avail_out=h,e.next_in=s,e.avail_in=o,r.hold=u,r.bits=l,(r.wsize||c!==e.avail_out&&r.mode<30&&(r.mode<27||4!==t))&&Z(e,e.output,e.next_out,c-e.avail_out)?(r.mode=31,-4):(f-=e.avail_in,c-=e.avail_out,e.total_in+=f,e.total_out+=c,r.total+=c,r.wrap&&c&&(e.adler=r.check=r.flags?B(r.check,i,c,e.next_out-c):O(r.check,i,c,e.next_out-c)),e.data_type=r.bits+(r.last?64:0)+(12===r.mode?128:0)+(20===r.mode||15===r.mode?256:0),(0==f&&0===c||4===t)&&x===N&&(x=-5),x)},r.inflateEnd=function(e){if(!e||!e.state)return U;var t=e.state;return t.window&&(t.window=null),e.state=null,N},r.inflateGetHeader=function(e,t){var r;return e&&e.state?0==(2&(r=e.state).wrap)?U:((r.head=t).done=!1,N):U},r.inflateSetDictionary=function(e,t){var r,n=t.length;return e&&e.state?0!==(r=e.state).wrap&&11!==r.mode?U:11===r.mode&&O(1,t,n,0)!==r.check?-3:Z(e,t,n,n)?(r.mode=31,-4):(r.havedict=1,N):U},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,r){"use strict";var D=e("../utils/common"),F=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],N=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],U=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],P=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,r,n,i,s,a,o){var h,u,l,f,c,d,p,m,_,g=o.bits,b=0,v=0,y=0,w=0,k=0,x=0,S=0,z=0,C=0,E=0,A=null,I=0,O=new D.Buf16(16),B=new D.Buf16(16),R=null,T=0;for(b=0;b<=15;b++)O[b]=0;for(v=0;v<n;v++)O[t[r+v]]++;for(k=g,w=15;1<=w&&0===O[w];w--);if(w<k&&(k=w),0===w)return i[s++]=20971520,i[s++]=20971520,o.bits=1,0;for(y=1;y<w&&0===O[y];y++);for(k<y&&(k=y),b=z=1;b<=15;b++)if(z<<=1,(z-=O[b])<0)return-1;if(0<z&&(0===e||1!==w))return-1;for(B[1]=0,b=1;b<15;b++)B[b+1]=B[b]+O[b];for(v=0;v<n;v++)0!==t[r+v]&&(a[B[t[r+v]]++]=v);if(d=0===e?(A=R=a,19):1===e?(A=F,I-=257,R=N,T-=257,256):(A=U,R=P,-1),b=y,c=s,S=v=E=0,l=-1,f=(C=1<<(x=k))-1,1===e&&852<C||2===e&&592<C)return 1;for(;;){for(p=b-S,_=a[v]<d?(m=0,a[v]):a[v]>d?(m=R[T+a[v]],A[I+a[v]]):(m=96,0),h=1<<b-S,y=u=1<<x;i[c+(E>>S)+(u-=h)]=p<<24|m<<16|_|0,0!==u;);for(h=1<<b-1;E&h;)h>>=1;if(0!==h?(E&=h-1,E+=h):E=0,v++,0==--O[b]){if(b===w)break;b=t[r+a[v]]}if(k<b&&(E&f)!==l){for(0===S&&(S=k),c+=y,z=1<<(x=b-S);x+S<w&&!((z-=O[x+S])<=0);)x++,z<<=1;if(C+=1<<x,1===e&&852<C||2===e&&592<C)return 1;i[l=E&f]=k<<24|x<<16|c-s|0}}return 0!==E&&(i[c+E]=b-S<<24|64<<16|0),o.bits=k,0}},{"../utils/common":41}],51:[function(e,t,r){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,r){"use strict";var i=e("../utils/common");function n(e){for(var t=e.length;0<=--t;)e[t]=0}var u=256,l=286,f=30,g=15,d=16,w=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],k=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],x=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],S=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=new Array(576);n(z);var C=new Array(60);n(C);var E=new Array(512);n(E);var A=new Array(256);n(A);var I=new Array(29);n(I);var O,B,R,T=new Array(f);function D(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function F(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function N(e){return e<256?E[e]:E[256+(e>>>7)]}function U(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function P(e,t,r){e.bi_valid>d-r?(e.bi_buf|=t<<e.bi_valid&65535,U(e,e.bi_buf),e.bi_buf=t>>d-e.bi_valid,e.bi_valid+=r-d):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function L(e,t,r){P(e,r[2*t],r[2*t+1])}function j(e,t){for(var r=0;r|=1&e,e>>>=1,r<<=1,0<--t;);return r>>>1}function Z(e,t,r){var n,i,s=new Array(g+1),a=0;for(n=1;n<=g;n++)s[n]=a=a+r[n-1]<<1;for(i=0;i<=t;i++){var o=e[2*i+1];0!==o&&(e[2*i]=j(s[o]++,o))}}function W(e){var t;for(t=0;t<l;t++)e.dyn_ltree[2*t]=0;for(t=0;t<f;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function M(e){8<e.bi_valid?U(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function H(e,t,r,n){var i=2*t,s=2*r;return e[i]<e[s]||e[i]===e[s]&&n[t]<=n[r]}function G(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&H(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!H(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function K(e,t,r){var n,i,s,a,o=0;if(0!==e.last_lit)for(;n=e.pending_buf[e.d_buf+2*o]<<8|e.pending_buf[e.d_buf+2*o+1],i=e.pending_buf[e.l_buf+o],o++,0===n?L(e,i,t):(L(e,(s=A[i])+u+1,t),0!==(a=w[s])&&P(e,i-=I[s],a),L(e,s=N(--n),r),0!==(a=k[s])&&P(e,n-=T[s],a)),o<e.last_lit;);L(e,256,t)}function Y(e,t){var r,n,i,s=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,h=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=573,r=0;r<h;r++)0!==s[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):s[2*r+1]=0;for(;e.heap_len<2;)s[2*(i=e.heap[++e.heap_len]=u<2?++u:0)]=1,e.depth[i]=0,e.opt_len--,o&&(e.static_len-=a[2*i+1]);for(t.max_code=u,r=e.heap_len>>1;1<=r;r--)G(e,s,r);for(i=h;r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],G(e,s,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,s[2*i]=s[2*r]+s[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,s[2*r+1]=s[2*n+1]=i,e.heap[1]=i++,G(e,s,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var r,n,i,s,a,o,h=t.dyn_tree,u=t.max_code,l=t.stat_desc.static_tree,f=t.stat_desc.has_stree,c=t.stat_desc.extra_bits,d=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(s=0;s<=g;s++)e.bl_count[s]=0;for(h[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<573;r++)p<(s=h[2*h[2*(n=e.heap[r])+1]+1]+1)&&(s=p,m++),h[2*n+1]=s,u<n||(e.bl_count[s]++,a=0,d<=n&&(a=c[n-d]),o=h[2*n],e.opt_len+=o*(s+a),f&&(e.static_len+=o*(l[2*n+1]+a)));if(0!==m){do{for(s=p-1;0===e.bl_count[s];)s--;e.bl_count[s]--,e.bl_count[s+1]+=2,e.bl_count[p]--,m-=2}while(0<m);for(s=p;0!==s;s--)for(n=e.bl_count[s];0!==n;)u<(i=e.heap[--r])||(h[2*i+1]!==s&&(e.opt_len+=(s-h[2*i+1])*h[2*i],h[2*i+1]=s),n--)}}(e,t),Z(s,u,e.bl_count)}function X(e,t,r){var n,i,s=-1,a=t[1],o=0,h=7,u=4;for(0===a&&(h=138,u=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=a,a=t[2*(n+1)+1],++o<h&&i===a||(o<u?e.bl_tree[2*i]+=o:0!==i?(i!==s&&e.bl_tree[2*i]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=i,u=(o=0)===a?(h=138,3):i===a?(h=6,3):(h=7,4))}function V(e,t,r){var n,i,s=-1,a=t[1],o=0,h=7,u=4;for(0===a&&(h=138,u=3),n=0;n<=r;n++)if(i=a,a=t[2*(n+1)+1],!(++o<h&&i===a)){if(o<u)for(;L(e,i,e.bl_tree),0!=--o;);else 0!==i?(i!==s&&(L(e,i,e.bl_tree),o--),L(e,16,e.bl_tree),P(e,o-3,2)):o<=10?(L(e,17,e.bl_tree),P(e,o-3,3)):(L(e,18,e.bl_tree),P(e,o-11,7));s=i,u=(o=0)===a?(h=138,3):i===a?(h=6,3):(h=7,4)}}n(T);var q=!1;function J(e,t,r,n){P(e,0+(n?1:0),3),function(e,t,r,n){M(e),U(e,r),U(e,~r),i.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}(e,t,r)}r._tr_init=function(e){q||(function(){var e,t,r,n,i,s=new Array(g+1);for(n=r=0;n<28;n++)for(I[n]=r,e=0;e<1<<w[n];e++)A[r++]=n;for(A[r-1]=n,n=i=0;n<16;n++)for(T[n]=i,e=0;e<1<<k[n];e++)E[i++]=n;for(i>>=7;n<f;n++)for(T[n]=i<<7,e=0;e<1<<k[n]-7;e++)E[256+i++]=n;for(t=0;t<=g;t++)s[t]=0;for(e=0;e<=143;)z[2*e+1]=8,e++,s[8]++;for(;e<=255;)z[2*e+1]=9,e++,s[9]++;for(;e<=279;)z[2*e+1]=7,e++,s[7]++;for(;e<=287;)z[2*e+1]=8,e++,s[8]++;for(Z(z,287,s),e=0;e<f;e++)C[2*e+1]=5,C[2*e]=j(e,5);O=new D(z,w,257,l,g),B=new D(C,k,0,f,g),R=new D(new Array(0),x,0,19,7)}(),q=!0),e.l_desc=new F(e.dyn_ltree,O),e.d_desc=new F(e.dyn_dtree,B),e.bl_desc=new F(e.bl_tree,R),e.bi_buf=0,e.bi_valid=0,W(e)},r._tr_stored_block=J,r._tr_flush_block=function(e,t,r,n){var i,s,a=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<u;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),Y(e,e.l_desc),Y(e,e.d_desc),a=function(e){var t;for(X(e,e.dyn_ltree,e.l_desc.max_code),X(e,e.dyn_dtree,e.d_desc.max_code),Y(e,e.bl_desc),t=18;3<=t&&0===e.bl_tree[2*S[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),i=e.opt_len+3+7>>>3,(s=e.static_len+3+7>>>3)<=i&&(i=s)):i=s=r+5,r+4<=i&&-1!==t?J(e,t,r,n):4===e.strategy||s===i?(P(e,2+(n?1:0),3),K(e,z,C)):(P(e,4+(n?1:0),3),function(e,t,r,n){var i;for(P(e,t-257,5),P(e,r-1,5),P(e,n-4,4),i=0;i<n;i++)P(e,e.bl_tree[2*S[i]+1],3);V(e,e.dyn_ltree,t-1),V(e,e.dyn_dtree,r-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,a+1),K(e,e.dyn_ltree,e.dyn_dtree)),W(e),n&&M(e)},r._tr_tally=function(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(A[r]+u+1)]++,e.dyn_dtree[2*N(t)]++),e.last_lit===e.lit_bufsize-1},r._tr_align=function(e){P(e,2,3),L(e,256,z),function(e){16===e.bi_valid?(U(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):8<=e.bi_valid&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,r){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,r){(function(e){!function(r,n){"use strict";if(!r.setImmediate){var i,s,t,a,o=1,h={},u=!1,l=r.document,e=Object.getPrototypeOf&&Object.getPrototypeOf(r);e=e&&e.setTimeout?e:r,i="[object process]"==={}.toString.call(r.process)?function(e){process.nextTick((function(){c(e)}))}:function(){if(r.postMessage&&!r.importScripts){var e=!0,t=r.onmessage;return r.onmessage=function(){e=!1},r.postMessage("","*"),r.onmessage=t,e}}()?(a="setImmediate$"+Math.random()+"$",r.addEventListener?r.addEventListener("message",d,!1):r.attachEvent("onmessage",d),function(e){r.postMessage(a+e,"*")}):r.MessageChannel?((t=new MessageChannel).port1.onmessage=function(e){c(e.data)},function(e){t.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(s=l.documentElement,function(e){var t=l.createElement("script");t.onreadystatechange=function(){c(e),t.onreadystatechange=null,s.removeChild(t),t=null},s.appendChild(t)}):function(e){setTimeout(c,0,e)},e.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return h[o]=n,i(o),o++},e.clearImmediate=f}function f(e){delete h[e]}function c(e){if(u)setTimeout(c,0,e);else{var t=h[e];if(t){u=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(n,r)}}(t)}finally{f(e),u=!1}}}}function d(e){e.source===r&&"string"==typeof e.data&&0===e.data.indexOf(a)&&c(+e.data.slice(a.length))}}("undefined"==typeof self?void 0===e?this:e:self)}).call(this,void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},"object"==_typeof(exports)?module.exports=e():(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=e)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},5435:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,f;function _typeof2(o){return _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof2(o)}f=function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,(function(e){var n=t[o][1][e];return s(n||e)}),l,l.exports,e,t,n,r)}return n[o].exports}for(var i=void 0,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){(function(global){"use strict";var scheduleDrain,draining,Mutation=global.MutationObserver||global.WebKitMutationObserver;if(Mutation){var called=0,observer=new Mutation(nextTick),element=global.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(global.setImmediate||void 0===global.MessageChannel)scheduleDrain="document"in global&&"onreadystatechange"in global.document.createElement("script")?function(){var scriptEl=global.document.createElement("script");scriptEl.onreadystatechange=function(){nextTick(),scriptEl.onreadystatechange=null,scriptEl.parentNode.removeChild(scriptEl),scriptEl=null},global.document.documentElement.appendChild(scriptEl)}:function(){setTimeout(nextTick,0)};else{var channel=new global.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}var queue=[];function nextTick(){var i,oldQueue;draining=!0;for(var len=queue.length;len;){for(oldQueue=queue,queue=[],i=-1;++i<len;)oldQueue[i]();len=queue.length}draining=!1}module.exports=function(task){1!==queue.push(task)||draining||scheduleDrain()}}).call(this,void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(_dereq_,module,exports){"use strict";var immediate=_dereq_(1);function INTERNAL(){}var handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"];function Promise(resolver){if("function"!=typeof resolver)throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,resolver!==INTERNAL&&safelyResolveThenable(this,resolver)}function QueueItem(promise,onFulfilled,onRejected){this.promise=promise,"function"==typeof onFulfilled&&(this.onFulfilled=onFulfilled,this.callFulfilled=this.otherCallFulfilled),"function"==typeof onRejected&&(this.onRejected=onRejected,this.callRejected=this.otherCallRejected)}function unwrap(promise,func,value){immediate((function(){var returnValue;try{returnValue=func(value)}catch(e){return handlers.reject(promise,e)}returnValue===promise?handlers.reject(promise,new TypeError("Cannot resolve promise with itself")):handlers.resolve(promise,returnValue)}))}function getThen(obj){var then=obj&&obj.then;if(obj&&("object"===_typeof2(obj)||"function"==typeof obj)&&"function"==typeof then)return function(){then.apply(obj,arguments)}}function safelyResolveThenable(self,thenable){var called=!1;function onError(value){called||(called=!0,handlers.reject(self,value))}function onSuccess(value){called||(called=!0,handlers.resolve(self,value))}var result=tryCatch((function(){thenable(onSuccess,onError)}));"error"===result.status&&onError(result.value)}function tryCatch(func,value){var out={};try{out.value=func(value),out.status="success"}catch(e){out.status="error",out.value=e}return out}module.exports=Promise,Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){if("function"!=typeof onFulfilled&&this.state===FULFILLED||"function"!=typeof onRejected&&this.state===REJECTED)return this;var promise=new this.constructor(INTERNAL);return this.state!==PENDING?unwrap(promise,this.state===FULFILLED?onFulfilled:onRejected,this.outcome):this.queue.push(new QueueItem(promise,onFulfilled,onRejected)),promise},QueueItem.prototype.callFulfilled=function(value){handlers.resolve(this.promise,value)},QueueItem.prototype.otherCallFulfilled=function(value){unwrap(this.promise,this.onFulfilled,value)},QueueItem.prototype.callRejected=function(value){handlers.reject(this.promise,value)},QueueItem.prototype.otherCallRejected=function(value){unwrap(this.promise,this.onRejected,value)},handlers.resolve=function(self,value){var result=tryCatch(getThen,value);if("error"===result.status)return handlers.reject(self,result.value);var thenable=result.value;if(thenable)safelyResolveThenable(self,thenable);else{self.state=FULFILLED,self.outcome=value;for(var i=-1,len=self.queue.length;++i<len;)self.queue[i].callFulfilled(value)}return self},handlers.reject=function(self,error){self.state=REJECTED,self.outcome=error;for(var i=-1,len=self.queue.length;++i<len;)self.queue[i].callRejected(error);return self},Promise.resolve=function(value){return value instanceof this?value:handlers.resolve(new this(INTERNAL),value)},Promise.reject=function(reason){var promise=new this(INTERNAL);return handlers.reject(promise,reason)},Promise.all=function(iterable){var self=this;if("[object Array]"!==Object.prototype.toString.call(iterable))return this.reject(new TypeError("must be an array"));var len=iterable.length,called=!1;if(!len)return this.resolve([]);for(var values=new Array(len),resolved=0,i=-1,promise=new this(INTERNAL);++i<len;)allResolver(iterable[i],i);return promise;function allResolver(value,i){self.resolve(value).then((function(outValue){values[i]=outValue,++resolved!==len||called||(called=!0,handlers.resolve(promise,values))}),(function(error){called||(called=!0,handlers.reject(promise,error))}))}},Promise.race=function(iterable){var self=this;if("[object Array]"!==Object.prototype.toString.call(iterable))return this.reject(new TypeError("must be an array"));var len=iterable.length,called=!1;if(!len)return this.resolve([]);for(var value,i=-1,promise=new this(INTERNAL);++i<len;)value=iterable[i],self.resolve(value).then((function(response){called||(called=!0,handlers.resolve(promise,response))}),(function(error){called||(called=!0,handlers.reject(promise,error))}));return promise}},{1:1}],3:[function(_dereq_,module,exports){(function(global){"use strict";"function"!=typeof global.Promise&&(global.Promise=_dereq_(2))}).call(this,void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(_dereq_,module,exports){"use strict";var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},idb=function(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(e){return}}();function createBlob(parts,properties){parts=parts||[],properties=properties||{};try{return new Blob(parts,properties)}catch(e){if("TypeError"!==e.name)throw e;for(var builder=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),i=0;i<parts.length;i+=1)builder.append(parts[i]);return builder.getBlob(properties.type)}}"undefined"==typeof Promise&&_dereq_(3);var Promise$1=Promise;function executeCallback(promise,callback){callback&&promise.then((function(result){callback(null,result)}),(function(error){callback(error)}))}function executeTwoCallbacks(promise,callback,errorCallback){"function"==typeof callback&&promise.then(callback),"function"==typeof errorCallback&&promise.catch(errorCallback)}function normalizeKey(key){return"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key)),key}function getCallback(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var DETECT_BLOB_SUPPORT_STORE="local-forage-detect-blob-support",supportsBlobs=void 0,dbContexts={},toString=Object.prototype.toString,READ_WRITE="readwrite";function _checkBlobSupport(idb){return"boolean"==typeof supportsBlobs?Promise$1.resolve(supportsBlobs):function(idb){return new Promise$1((function(resolve){var txn=idb.transaction(DETECT_BLOB_SUPPORT_STORE,READ_WRITE),blob=createBlob([""]);txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob,"key"),txn.onabort=function(e){e.preventDefault(),e.stopPropagation(),resolve(!1)},txn.oncomplete=function(){var matchedChrome=navigator.userAgent.match(/Chrome\/(\d+)/),matchedEdge=navigator.userAgent.match(/Edge\//);resolve(matchedEdge||!matchedChrome||parseInt(matchedChrome[1],10)>=43)}})).catch((function(){return!1}))}(idb).then((function(value){return supportsBlobs=value}))}function _deferReadiness(dbInfo){var dbContext=dbContexts[dbInfo.name],deferredOperation={};deferredOperation.promise=new Promise$1((function(resolve,reject){deferredOperation.resolve=resolve,deferredOperation.reject=reject})),dbContext.deferredOperations.push(deferredOperation),dbContext.dbReady?dbContext.dbReady=dbContext.dbReady.then((function(){return deferredOperation.promise})):dbContext.dbReady=deferredOperation.promise}function _advanceReadiness(dbInfo){var deferredOperation=dbContexts[dbInfo.name].deferredOperations.pop();if(deferredOperation)return deferredOperation.resolve(),deferredOperation.promise}function _rejectReadiness(dbInfo,err){var deferredOperation=dbContexts[dbInfo.name].deferredOperations.pop();if(deferredOperation)return deferredOperation.reject(err),deferredOperation.promise}function _getConnection(dbInfo,upgradeNeeded){return new Promise$1((function(resolve,reject){if(dbContexts[dbInfo.name]=dbContexts[dbInfo.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},dbInfo.db){if(!upgradeNeeded)return resolve(dbInfo.db);_deferReadiness(dbInfo),dbInfo.db.close()}var dbArgs=[dbInfo.name];upgradeNeeded&&dbArgs.push(dbInfo.version);var openreq=idb.open.apply(idb,dbArgs);upgradeNeeded&&(openreq.onupgradeneeded=function(e){var db=openreq.result;try{db.createObjectStore(dbInfo.storeName),e.oldVersion<=1&&db.createObjectStore(DETECT_BLOB_SUPPORT_STORE)}catch(ex){if("ConstraintError"!==ex.name)throw ex;console.warn('The database "'+dbInfo.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+dbInfo.storeName+'" already exists.')}}),openreq.onerror=function(e){e.preventDefault(),reject(openreq.error)},openreq.onsuccess=function(){resolve(openreq.result),_advanceReadiness(dbInfo)}}))}function _getOriginalConnection(dbInfo){return _getConnection(dbInfo,!1)}function _getUpgradedConnection(dbInfo){return _getConnection(dbInfo,!0)}function _isUpgradeNeeded(dbInfo,defaultVersion){if(!dbInfo.db)return!0;var isNewStore=!dbInfo.db.objectStoreNames.contains(dbInfo.storeName),isDowngrade=dbInfo.version<dbInfo.db.version,isUpgrade=dbInfo.version>dbInfo.db.version;if(isDowngrade&&(dbInfo.version!==defaultVersion&&console.warn('The database "'+dbInfo.name+"\" can't be downgraded from version "+dbInfo.db.version+" to version "+dbInfo.version+"."),dbInfo.version=dbInfo.db.version),isUpgrade||isNewStore){if(isNewStore){var incVersion=dbInfo.db.version+1;incVersion>dbInfo.version&&(dbInfo.version=incVersion)}return!0}return!1}function _decodeBlob(encodedBlob){var arrayBuff=function(bin){for(var length=bin.length,buf=new ArrayBuffer(length),arr=new Uint8Array(buf),i=0;i<length;i++)arr[i]=bin.charCodeAt(i);return buf}(atob(encodedBlob.data));return createBlob([arrayBuff],{type:encodedBlob.type})}function _isEncodedBlob(value){return value&&value.__local_forage_encoded_blob}function _fullyReady(callback){var self=this,promise=self._initReady().then((function(){var dbContext=dbContexts[self._dbInfo.name];if(dbContext&&dbContext.dbReady)return dbContext.dbReady}));return executeTwoCallbacks(promise,callback,callback),promise}function createTransaction(dbInfo,mode,callback,retries){void 0===retries&&(retries=1);try{var tx=dbInfo.db.transaction(dbInfo.storeName,mode);callback(null,tx)}catch(err){if(retries>0&&(!dbInfo.db||"InvalidStateError"===err.name||"NotFoundError"===err.name))return Promise$1.resolve().then((function(){if(!dbInfo.db||"NotFoundError"===err.name&&!dbInfo.db.objectStoreNames.contains(dbInfo.storeName)&&dbInfo.version<=dbInfo.db.version)return dbInfo.db&&(dbInfo.version=dbInfo.db.version+1),_getUpgradedConnection(dbInfo)})).then((function(){return function(dbInfo){_deferReadiness(dbInfo);for(var dbContext=dbContexts[dbInfo.name],forages=dbContext.forages,i=0;i<forages.length;i++){var forage=forages[i];forage._dbInfo.db&&(forage._dbInfo.db.close(),forage._dbInfo.db=null)}return dbInfo.db=null,_getOriginalConnection(dbInfo).then((function(db){return dbInfo.db=db,_isUpgradeNeeded(dbInfo)?_getUpgradedConnection(dbInfo):db})).then((function(db){dbInfo.db=dbContext.db=db;for(var i=0;i<forages.length;i++)forages[i]._dbInfo.db=db})).catch((function(err){throw _rejectReadiness(dbInfo,err),err}))}(dbInfo).then((function(){createTransaction(dbInfo,mode,callback,retries-1)}))})).catch(callback);callback(err)}}var asyncStorage={_driver:"asyncStorage",_initStorage:function(options){var self=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]=options[i];var dbContext=dbContexts[dbInfo.name];dbContext||(dbContext={forages:[],db:null,dbReady:null,deferredOperations:[]},dbContexts[dbInfo.name]=dbContext),dbContext.forages.push(self),self._initReady||(self._initReady=self.ready,self.ready=_fullyReady);var initPromises=[];function ignoreErrors(){return Promise$1.resolve()}for(var j=0;j<dbContext.forages.length;j++){var forage=dbContext.forages[j];forage!==self&&initPromises.push(forage._initReady().catch(ignoreErrors))}var forages=dbContext.forages.slice(0);return Promise$1.all(initPromises).then((function(){return dbInfo.db=dbContext.db,_getOriginalConnection(dbInfo)})).then((function(db){return dbInfo.db=db,_isUpgradeNeeded(dbInfo,self._defaultConfig.version)?_getUpgradedConnection(dbInfo):db})).then((function(db){dbInfo.db=dbContext.db=db,self._dbInfo=dbInfo;for(var k=0;k<forages.length;k++){var forage=forages[k];forage!==self&&(forage._dbInfo.db=dbInfo.db,forage._dbInfo.version=dbInfo.version)}}))},_support:function(){try{if(!idb)return!1;var isSafari="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),hasFetch="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!isSafari||hasFetch)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}}(),iterate:function(iterator,callback){var self=this,promise=new Promise$1((function(resolve,reject){self.ready().then((function(){createTransaction(self._dbInfo,"readonly",(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self._dbInfo.storeName).openCursor(),iterationNumber=1;req.onsuccess=function(){var cursor=req.result;if(cursor){var value=cursor.value;_isEncodedBlob(value)&&(value=_decodeBlob(value));var result=iterator(value,cursor.key,iterationNumber++);void 0!==result?resolve(result):cursor.continue()}else resolve()},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise},getItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=new Promise$1((function(resolve,reject){self.ready().then((function(){createTransaction(self._dbInfo,"readonly",(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self._dbInfo.storeName).get(key);req.onsuccess=function(){var value=req.result;void 0===value&&(value=null),_isEncodedBlob(value)&&(value=_decodeBlob(value)),resolve(value)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise},setItem:function(key,value,callback){var self=this;key=normalizeKey(key);var promise=new Promise$1((function(resolve,reject){var dbInfo;self.ready().then((function(){return dbInfo=self._dbInfo,"[object Blob]"===toString.call(value)?_checkBlobSupport(dbInfo.db).then((function(blobSupport){return blobSupport?value:(blob=value,new Promise$1((function(resolve,reject){var reader=new FileReader;reader.onerror=reject,reader.onloadend=function(e){var base64=btoa(e.target.result||"");resolve({__local_forage_encoded_blob:!0,data:base64,type:blob.type})},reader.readAsBinaryString(blob)})));var blob})):value})).then((function(value){createTransaction(self._dbInfo,READ_WRITE,(function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self._dbInfo.storeName);null===value&&(value=void 0);var req=store.put(value,key);transaction.oncomplete=function(){void 0===value&&(value=null),resolve(value)},transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise},removeItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=new Promise$1((function(resolve,reject){self.ready().then((function(){createTransaction(self._dbInfo,READ_WRITE,(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self._dbInfo.storeName).delete(key);transaction.oncomplete=function(){resolve()},transaction.onerror=function(){reject(req.error)},transaction.onabort=function(){var err=req.error?req.error:req.transaction.error;reject(err)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise},clear:function(callback){var self=this,promise=new Promise$1((function(resolve,reject){self.ready().then((function(){createTransaction(self._dbInfo,READ_WRITE,(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self._dbInfo.storeName).clear();transaction.oncomplete=function(){resolve()},transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise},length:function(callback){var self=this,promise=new Promise$1((function(resolve,reject){self.ready().then((function(){createTransaction(self._dbInfo,"readonly",(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self._dbInfo.storeName).count();req.onsuccess=function(){resolve(req.result)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise},key:function(n,callback){var self=this,promise=new Promise$1((function(resolve,reject){n<0?resolve(null):self.ready().then((function(){createTransaction(self._dbInfo,"readonly",(function(err,transaction){if(err)return reject(err);try{var store=transaction.objectStore(self._dbInfo.storeName),advanced=!1,req=store.openCursor();req.onsuccess=function(){var cursor=req.result;cursor?0===n||advanced?resolve(cursor.key):(advanced=!0,cursor.advance(n)):resolve(null)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise},keys:function(callback){var self=this,promise=new Promise$1((function(resolve,reject){self.ready().then((function(){createTransaction(self._dbInfo,"readonly",(function(err,transaction){if(err)return reject(err);try{var req=transaction.objectStore(self._dbInfo.storeName).openCursor(),keys=[];req.onsuccess=function(){var cursor=req.result;cursor?(keys.push(cursor.key),cursor.continue()):resolve(keys)},req.onerror=function(){reject(req.error)}}catch(e){reject(e)}}))})).catch(reject)}));return executeCallback(promise,callback),promise},dropInstance:function(options,callback){callback=getCallback.apply(this,arguments);var promise,currentConfig=this.config();if((options="function"!=typeof options&&options||{}).name||(options.name=options.name||currentConfig.name,options.storeName=options.storeName||currentConfig.storeName),options.name){var dbPromise=options.name===currentConfig.name&&this._dbInfo.db?Promise$1.resolve(this._dbInfo.db):_getOriginalConnection(options).then((function(db){var dbContext=dbContexts[options.name],forages=dbContext.forages;dbContext.db=db;for(var i=0;i<forages.length;i++)forages[i]._dbInfo.db=db;return db}));promise=options.storeName?dbPromise.then((function(db){if(db.objectStoreNames.contains(options.storeName)){var newVersion=db.version+1;_deferReadiness(options);var dbContext=dbContexts[options.name],forages=dbContext.forages;db.close();for(var i=0;i<forages.length;i++){var forage=forages[i];forage._dbInfo.db=null,forage._dbInfo.version=newVersion}var dropObjectPromise=new Promise$1((function(resolve,reject){var req=idb.open(options.name,newVersion);req.onerror=function(err){req.result.close(),reject(err)},req.onupgradeneeded=function(){req.result.deleteObjectStore(options.storeName)},req.onsuccess=function(){var db=req.result;db.close(),resolve(db)}}));return dropObjectPromise.then((function(db){dbContext.db=db;for(var j=0;j<forages.length;j++){var _forage2=forages[j];_forage2._dbInfo.db=db,_advanceReadiness(_forage2._dbInfo)}})).catch((function(err){throw(_rejectReadiness(options,err)||Promise$1.resolve()).catch((function(){})),err}))}})):dbPromise.then((function(db){_deferReadiness(options);var dbContext=dbContexts[options.name],forages=dbContext.forages;db.close();for(var i=0;i<forages.length;i++)forages[i]._dbInfo.db=null;var dropDBPromise=new Promise$1((function(resolve,reject){var req=idb.deleteDatabase(options.name);req.onerror=req.onblocked=function(err){var db=req.result;db&&db.close(),reject(err)},req.onsuccess=function(){var db=req.result;db&&db.close(),resolve(db)}}));return dropDBPromise.then((function(db){dbContext.db=db;for(var i=0;i<forages.length;i++)_advanceReadiness(forages[i]._dbInfo)})).catch((function(err){throw(_rejectReadiness(options,err)||Promise$1.resolve()).catch((function(){})),err}))}))}else promise=Promise$1.reject("Invalid arguments");return executeCallback(promise,callback),promise}},BASE_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",BLOB_TYPE_PREFIX_REGEX=/^~~local_forage_type~([^~]+)~/,toString$1=Object.prototype.toString;function stringToBuffer(serializedString){var i,encoded1,encoded2,encoded3,encoded4,bufferLength=.75*serializedString.length,len=serializedString.length,p=0;"="===serializedString[serializedString.length-1]&&(bufferLength--,"="===serializedString[serializedString.length-2]&&bufferLength--);var buffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(buffer);for(i=0;i<len;i+=4)encoded1=BASE_CHARS.indexOf(serializedString[i]),encoded2=BASE_CHARS.indexOf(serializedString[i+1]),encoded3=BASE_CHARS.indexOf(serializedString[i+2]),encoded4=BASE_CHARS.indexOf(serializedString[i+3]),bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return buffer}function bufferToString(buffer){var i,bytes=new Uint8Array(buffer),base64String="";for(i=0;i<bytes.length;i+=3)base64String+=BASE_CHARS[bytes[i]>>2],base64String+=BASE_CHARS[(3&bytes[i])<<4|bytes[i+1]>>4],base64String+=BASE_CHARS[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64String+=BASE_CHARS[63&bytes[i+2]];return bytes.length%3==2?base64String=base64String.substring(0,base64String.length-1)+"=":bytes.length%3==1&&(base64String=base64String.substring(0,base64String.length-2)+"=="),base64String}var localforageSerializer={serialize:function(value,callback){var valueType="";if(value&&(valueType=toString$1.call(value)),value&&("[object ArrayBuffer]"===valueType||value.buffer&&"[object ArrayBuffer]"===toString$1.call(value.buffer))){var buffer,marker="__lfsc__:";value instanceof ArrayBuffer?(buffer=value,marker+="arbf"):(buffer=value.buffer,"[object Int8Array]"===valueType?marker+="si08":"[object Uint8Array]"===valueType?marker+="ui08":"[object Uint8ClampedArray]"===valueType?marker+="uic8":"[object Int16Array]"===valueType?marker+="si16":"[object Uint16Array]"===valueType?marker+="ur16":"[object Int32Array]"===valueType?marker+="si32":"[object Uint32Array]"===valueType?marker+="ui32":"[object Float32Array]"===valueType?marker+="fl32":"[object Float64Array]"===valueType?marker+="fl64":callback(new Error("Failed to get type for BinaryArray"))),callback(marker+bufferToString(buffer))}else if("[object Blob]"===valueType){var fileReader=new FileReader;fileReader.onload=function(){var str="~~local_forage_type~"+value.type+"~"+bufferToString(this.result);callback("__lfsc__:blob"+str)},fileReader.readAsArrayBuffer(value)}else try{callback(JSON.stringify(value))}catch(e){console.error("Couldn't convert value into a JSON string: ",value),callback(null,e)}},deserialize:function(value){if("__lfsc__:"!==value.substring(0,9))return JSON.parse(value);var blobType,serializedString=value.substring(13),type=value.substring(9,13);if("blob"===type&&BLOB_TYPE_PREFIX_REGEX.test(serializedString)){var matcher=serializedString.match(BLOB_TYPE_PREFIX_REGEX);blobType=matcher[1],serializedString=serializedString.substring(matcher[0].length)}var buffer=stringToBuffer(serializedString);switch(type){case"arbf":return buffer;case"blob":return createBlob([buffer],{type:blobType});case"si08":return new Int8Array(buffer);case"ui08":return new Uint8Array(buffer);case"uic8":return new Uint8ClampedArray(buffer);case"si16":return new Int16Array(buffer);case"ur16":return new Uint16Array(buffer);case"si32":return new Int32Array(buffer);case"ui32":return new Uint32Array(buffer);case"fl32":return new Float32Array(buffer);case"fl64":return new Float64Array(buffer);default:throw new Error("Unkown type: "+type)}},stringToBuffer:stringToBuffer,bufferToString:bufferToString};function createDbTable(t,dbInfo,callback,errorCallback){t.executeSql("CREATE TABLE IF NOT EXISTS "+dbInfo.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],callback,errorCallback)}function tryExecuteSql(t,dbInfo,sqlStatement,args,callback,errorCallback){t.executeSql(sqlStatement,args,callback,(function(t,error){error.code===error.SYNTAX_ERR?t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[dbInfo.storeName],(function(t,results){results.rows.length?errorCallback(t,error):createDbTable(t,dbInfo,(function(){t.executeSql(sqlStatement,args,callback,errorCallback)}),errorCallback)}),errorCallback):errorCallback(t,error)}),errorCallback)}function _setItem(key,value,callback,retriesLeft){var self=this;key=normalizeKey(key);var promise=new Promise$1((function(resolve,reject){self.ready().then((function(){void 0===value&&(value=null);var originalValue=value,dbInfo=self._dbInfo;dbInfo.serializer.serialize(value,(function(value,error){error?reject(error):dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"INSERT OR REPLACE INTO "+dbInfo.storeName+" (key, value) VALUES (?, ?)",[key,value],(function(){resolve(originalValue)}),(function(t,error){reject(error)}))}),(function(sqlError){if(sqlError.code===sqlError.QUOTA_ERR){if(retriesLeft>0)return void resolve(_setItem.apply(self,[key,originalValue,callback,retriesLeft-1]));reject(sqlError)}}))}))})).catch(reject)}));return executeCallback(promise,callback),promise}var webSQLStorage={_driver:"webSQLStorage",_initStorage:function(options){var self=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]="string"!=typeof options[i]?options[i].toString():options[i];var dbInfoPromise=new Promise$1((function(resolve,reject){try{dbInfo.db=openDatabase(dbInfo.name,String(dbInfo.version),dbInfo.description,dbInfo.size)}catch(e){return reject(e)}dbInfo.db.transaction((function(t){createDbTable(t,dbInfo,(function(){self._dbInfo=dbInfo,resolve()}),(function(t,error){reject(error)}))}),reject)}));return dbInfo.serializer=localforageSerializer,dbInfoPromise},_support:"function"==typeof openDatabase,iterate:function(iterator,callback){var self=this,promise=new Promise$1((function(resolve,reject){self.ready().then((function(){var dbInfo=self._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"SELECT * FROM "+dbInfo.storeName,[],(function(t,results){for(var rows=results.rows,length=rows.length,i=0;i<length;i++){var item=rows.item(i),result=item.value;if(result&&(result=dbInfo.serializer.deserialize(result)),void 0!==(result=iterator(result,item.key,i+1)))return void resolve(result)}resolve()}),(function(t,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise},getItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=new Promise$1((function(resolve,reject){self.ready().then((function(){var dbInfo=self._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"SELECT * FROM "+dbInfo.storeName+" WHERE key = ? LIMIT 1",[key],(function(t,results){var result=results.rows.length?results.rows.item(0).value:null;result&&(result=dbInfo.serializer.deserialize(result)),resolve(result)}),(function(t,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise},setItem:function(key,value,callback){return _setItem.apply(this,[key,value,callback,1])},removeItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=new Promise$1((function(resolve,reject){self.ready().then((function(){var dbInfo=self._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"DELETE FROM "+dbInfo.storeName+" WHERE key = ?",[key],(function(){resolve()}),(function(t,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise},clear:function(callback){var self=this,promise=new Promise$1((function(resolve,reject){self.ready().then((function(){var dbInfo=self._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"DELETE FROM "+dbInfo.storeName,[],(function(){resolve()}),(function(t,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise},length:function(callback){var self=this,promise=new Promise$1((function(resolve,reject){self.ready().then((function(){var dbInfo=self._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"SELECT COUNT(key) as c FROM "+dbInfo.storeName,[],(function(t,results){var result=results.rows.item(0).c;resolve(result)}),(function(t,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise},key:function(n,callback){var self=this,promise=new Promise$1((function(resolve,reject){self.ready().then((function(){var dbInfo=self._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"SELECT key FROM "+dbInfo.storeName+" WHERE id = ? LIMIT 1",[n+1],(function(t,results){var result=results.rows.length?results.rows.item(0).key:null;resolve(result)}),(function(t,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise},keys:function(callback){var self=this,promise=new Promise$1((function(resolve,reject){self.ready().then((function(){var dbInfo=self._dbInfo;dbInfo.db.transaction((function(t){tryExecuteSql(t,dbInfo,"SELECT key FROM "+dbInfo.storeName,[],(function(t,results){for(var keys=[],i=0;i<results.rows.length;i++)keys.push(results.rows.item(i).key);resolve(keys)}),(function(t,error){reject(error)}))}))})).catch(reject)}));return executeCallback(promise,callback),promise},dropInstance:function(options,callback){callback=getCallback.apply(this,arguments);var currentConfig=this.config();(options="function"!=typeof options&&options||{}).name||(options.name=options.name||currentConfig.name,options.storeName=options.storeName||currentConfig.storeName);var promise,self=this;return executeCallback(promise=options.name?new Promise$1((function(resolve){var db;db=options.name===currentConfig.name?self._dbInfo.db:openDatabase(options.name,"","",0),options.storeName?resolve({db:db,storeNames:[options.storeName]}):resolve(function(db){return new Promise$1((function(resolve,reject){db.transaction((function(t){t.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],(function(t,results){for(var storeNames=[],i=0;i<results.rows.length;i++)storeNames.push(results.rows.item(i).name);resolve({db:db,storeNames:storeNames})}),(function(t,error){reject(error)}))}),(function(sqlError){reject(sqlError)}))}))}(db))})).then((function(operationInfo){return new Promise$1((function(resolve,reject){operationInfo.db.transaction((function(t){function dropTable(storeName){return new Promise$1((function(resolve,reject){t.executeSql("DROP TABLE IF EXISTS "+storeName,[],(function(){resolve()}),(function(t,error){reject(error)}))}))}for(var operations=[],i=0,len=operationInfo.storeNames.length;i<len;i++)operations.push(dropTable(operationInfo.storeNames[i]));Promise$1.all(operations).then((function(){resolve()})).catch((function(e){reject(e)}))}),(function(sqlError){reject(sqlError)}))}))})):Promise$1.reject("Invalid arguments"),callback),promise}};function _getKeyPrefix(options,defaultConfig){var keyPrefix=options.name+"/";return options.storeName!==defaultConfig.storeName&&(keyPrefix+=options.storeName+"/"),keyPrefix}function _isLocalStorageUsable(){return!function(){try{return localStorage.setItem("_localforage_support_test",!0),localStorage.removeItem("_localforage_support_test"),!1}catch(e){return!0}}()||localStorage.length>0}var localStorageWrapper={_driver:"localStorageWrapper",_initStorage:function(options){var dbInfo={};if(options)for(var i in options)dbInfo[i]=options[i];return dbInfo.keyPrefix=_getKeyPrefix(options,this._defaultConfig),_isLocalStorageUsable()?(this._dbInfo=dbInfo,dbInfo.serializer=localforageSerializer,Promise$1.resolve()):Promise$1.reject()},_support:function(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&!!localStorage.setItem}catch(e){return!1}}(),iterate:function(iterator,callback){var self=this,promise=self.ready().then((function(){for(var dbInfo=self._dbInfo,keyPrefix=dbInfo.keyPrefix,keyPrefixLength=keyPrefix.length,length=localStorage.length,iterationNumber=1,i=0;i<length;i++){var key=localStorage.key(i);if(0===key.indexOf(keyPrefix)){var value=localStorage.getItem(key);if(value&&(value=dbInfo.serializer.deserialize(value)),void 0!==(value=iterator(value,key.substring(keyPrefixLength),iterationNumber++)))return value}}}));return executeCallback(promise,callback),promise},getItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=self.ready().then((function(){var dbInfo=self._dbInfo,result=localStorage.getItem(dbInfo.keyPrefix+key);return result&&(result=dbInfo.serializer.deserialize(result)),result}));return executeCallback(promise,callback),promise},setItem:function(key,value,callback){var self=this;key=normalizeKey(key);var promise=self.ready().then((function(){void 0===value&&(value=null);var originalValue=value;return new Promise$1((function(resolve,reject){var dbInfo=self._dbInfo;dbInfo.serializer.serialize(value,(function(value,error){if(error)reject(error);else try{localStorage.setItem(dbInfo.keyPrefix+key,value),resolve(originalValue)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||reject(e),reject(e)}}))}))}));return executeCallback(promise,callback),promise},removeItem:function(key,callback){var self=this;key=normalizeKey(key);var promise=self.ready().then((function(){var dbInfo=self._dbInfo;localStorage.removeItem(dbInfo.keyPrefix+key)}));return executeCallback(promise,callback),promise},clear:function(callback){var self=this,promise=self.ready().then((function(){for(var keyPrefix=self._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var key=localStorage.key(i);0===key.indexOf(keyPrefix)&&localStorage.removeItem(key)}}));return executeCallback(promise,callback),promise},length:function(callback){var promise=this.keys().then((function(keys){return keys.length}));return executeCallback(promise,callback),promise},key:function(n,callback){var self=this,promise=self.ready().then((function(){var result,dbInfo=self._dbInfo;try{result=localStorage.key(n)}catch(error){result=null}return result&&(result=result.substring(dbInfo.keyPrefix.length)),result}));return executeCallback(promise,callback),promise},keys:function(callback){var self=this,promise=self.ready().then((function(){for(var dbInfo=self._dbInfo,length=localStorage.length,keys=[],i=0;i<length;i++){var itemKey=localStorage.key(i);0===itemKey.indexOf(dbInfo.keyPrefix)&&keys.push(itemKey.substring(dbInfo.keyPrefix.length))}return keys}));return executeCallback(promise,callback),promise},dropInstance:function(options,callback){if(callback=getCallback.apply(this,arguments),!(options="function"!=typeof options&&options||{}).name){var currentConfig=this.config();options.name=options.name||currentConfig.name,options.storeName=options.storeName||currentConfig.storeName}var promise,self=this;return promise=options.name?new Promise$1((function(resolve){options.storeName?resolve(_getKeyPrefix(options,self._defaultConfig)):resolve(options.name+"/")})).then((function(keyPrefix){for(var i=localStorage.length-1;i>=0;i--){var key=localStorage.key(i);0===key.indexOf(keyPrefix)&&localStorage.removeItem(key)}})):Promise$1.reject("Invalid arguments"),executeCallback(promise,callback),promise}},includes=function(array,searchElement){for(var x,y,len=array.length,i=0;i<len;){if((x=array[i])===(y=searchElement)||"number"==typeof x&&"number"==typeof y&&isNaN(x)&&isNaN(y))return!0;i++}return!1},isArray=Array.isArray||function(arg){return"[object Array]"===Object.prototype.toString.call(arg)},DefinedDrivers={},DriverSupport={},DefaultDrivers={INDEXEDDB:asyncStorage,WEBSQL:webSQLStorage,LOCALSTORAGE:localStorageWrapper},DefaultDriverOrder=[DefaultDrivers.INDEXEDDB._driver,DefaultDrivers.WEBSQL._driver,DefaultDrivers.LOCALSTORAGE._driver],OptionalDriverMethods=["dropInstance"],LibraryMethods=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(OptionalDriverMethods),DefaultConfig={description:"",driver:DefaultDriverOrder.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function callWhenReady(localForageInstance,libraryMethod){localForageInstance[libraryMethod]=function(){var _args=arguments;return localForageInstance.ready().then((function(){return localForageInstance[libraryMethod].apply(localForageInstance,_args)}))}}function extend(){for(var i=1;i<arguments.length;i++){var arg=arguments[i];if(arg)for(var _key in arg)arg.hasOwnProperty(_key)&&(isArray(arg[_key])?arguments[0][_key]=arg[_key].slice():arguments[0][_key]=arg[_key])}return arguments[0]}var LocalForage=function(){function LocalForage(options){for(var driverTypeKey in function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,LocalForage),DefaultDrivers)if(DefaultDrivers.hasOwnProperty(driverTypeKey)){var driver=DefaultDrivers[driverTypeKey],driverName=driver._driver;this[driverTypeKey]=driverName,DefinedDrivers[driverName]||this.defineDriver(driver)}this._defaultConfig=extend({},DefaultConfig),this._config=extend({},this._defaultConfig,options),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch((function(){}))}return LocalForage.prototype.config=function(options){if("object"===(void 0===options?"undefined":_typeof(options))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in options){if("storeName"===i&&(options[i]=options[i].replace(/\W/g,"_")),"version"===i&&"number"!=typeof options[i])return new Error("Database version must be a number.");this._config[i]=options[i]}return!("driver"in options)||!options.driver||this.setDriver(this._config.driver)}return"string"==typeof options?this._config[options]:this._config},LocalForage.prototype.defineDriver=function(driverObject,callback,errorCallback){var promise=new Promise$1((function(resolve,reject){try{var driverName=driverObject._driver,complianceError=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!driverObject._driver)return void reject(complianceError);for(var driverMethods=LibraryMethods.concat("_initStorage"),i=0,len=driverMethods.length;i<len;i++){var driverMethodName=driverMethods[i];if((!includes(OptionalDriverMethods,driverMethodName)||driverObject[driverMethodName])&&"function"!=typeof driverObject[driverMethodName])return void reject(complianceError)}!function(){for(var methodNotImplementedFactory=function(methodName){return function(){var error=new Error("Method "+methodName+" is not implemented by the current driver"),promise=Promise$1.reject(error);return executeCallback(promise,arguments[arguments.length-1]),promise}},_i=0,_len=OptionalDriverMethods.length;_i<_len;_i++){var optionalDriverMethod=OptionalDriverMethods[_i];driverObject[optionalDriverMethod]||(driverObject[optionalDriverMethod]=methodNotImplementedFactory(optionalDriverMethod))}}();var setDriverSupport=function(support){DefinedDrivers[driverName]&&console.info("Redefining LocalForage driver: "+driverName),DefinedDrivers[driverName]=driverObject,DriverSupport[driverName]=support,resolve()};"_support"in driverObject?driverObject._support&&"function"==typeof driverObject._support?driverObject._support().then(setDriverSupport,reject):setDriverSupport(!!driverObject._support):setDriverSupport(!0)}catch(e){reject(e)}}));return executeTwoCallbacks(promise,callback,errorCallback),promise},LocalForage.prototype.driver=function(){return this._driver||null},LocalForage.prototype.getDriver=function(driverName,callback,errorCallback){var getDriverPromise=DefinedDrivers[driverName]?Promise$1.resolve(DefinedDrivers[driverName]):Promise$1.reject(new Error("Driver not found."));return executeTwoCallbacks(getDriverPromise,callback,errorCallback),getDriverPromise},LocalForage.prototype.getSerializer=function(callback){var serializerPromise=Promise$1.resolve(localforageSerializer);return executeTwoCallbacks(serializerPromise,callback),serializerPromise},LocalForage.prototype.ready=function(callback){var self=this,promise=self._driverSet.then((function(){return null===self._ready&&(self._ready=self._initDriver()),self._ready}));return executeTwoCallbacks(promise,callback,callback),promise},LocalForage.prototype.setDriver=function(drivers,callback,errorCallback){var self=this;isArray(drivers)||(drivers=[drivers]);var supportedDrivers=this._getSupportedDrivers(drivers);function setDriverToConfig(){self._config.driver=self.driver()}function extendSelfWithDriver(driver){return self._extend(driver),setDriverToConfig(),self._ready=self._initStorage(self._config),self._ready}var oldDriverSetDone=null!==this._driverSet?this._driverSet.catch((function(){return Promise$1.resolve()})):Promise$1.resolve();return this._driverSet=oldDriverSetDone.then((function(){var driverName=supportedDrivers[0];return self._dbInfo=null,self._ready=null,self.getDriver(driverName).then((function(driver){self._driver=driver._driver,setDriverToConfig(),self._wrapLibraryMethodsWithReady(),self._initDriver=function(supportedDrivers){return function(){var currentDriverIndex=0;return function driverPromiseLoop(){for(;currentDriverIndex<supportedDrivers.length;){var driverName=supportedDrivers[currentDriverIndex];return currentDriverIndex++,self._dbInfo=null,self._ready=null,self.getDriver(driverName).then(extendSelfWithDriver).catch(driverPromiseLoop)}setDriverToConfig();var error=new Error("No available storage method found.");return self._driverSet=Promise$1.reject(error),self._driverSet}()}}(supportedDrivers)}))})).catch((function(){setDriverToConfig();var error=new Error("No available storage method found.");return self._driverSet=Promise$1.reject(error),self._driverSet})),executeTwoCallbacks(this._driverSet,callback,errorCallback),this._driverSet},LocalForage.prototype.supports=function(driverName){return!!DriverSupport[driverName]},LocalForage.prototype._extend=function(libraryMethodsAndProperties){extend(this,libraryMethodsAndProperties)},LocalForage.prototype._getSupportedDrivers=function(drivers){for(var supportedDrivers=[],i=0,len=drivers.length;i<len;i++){var driverName=drivers[i];this.supports(driverName)&&supportedDrivers.push(driverName)}return supportedDrivers},LocalForage.prototype._wrapLibraryMethodsWithReady=function(){for(var i=0,len=LibraryMethods.length;i<len;i++)callWhenReady(this,LibraryMethods[i])},LocalForage.prototype.createInstance=function(options){return new LocalForage(options)},LocalForage}(),localforage_js=new LocalForage;module.exports=localforage_js},{3:3}]},{},[4])(4)},"object"===_typeof2(exports)?module.exports=f():(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=f)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},5310:function(module,exports){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module.exports&&(exports=module.exports=function(root,Lockr){"use strict";return Array.prototype.indexOf||(Array.prototype.indexOf=function(elt){var len=this.length>>>0,from=Number(arguments[1])||0;for((from=from<0?Math.ceil(from):Math.floor(from))<0&&(from+=len);from<len;from++)if(from in this&&this[from]===elt)return from;return-1}),Lockr.prefix="",Lockr._getPrefixedKey=function(key,options){return(options=options||{}).noPrefix?key:this.prefix+key},Lockr.set=function(key,value,options){var query_key=this._getPrefixedKey(key,options);try{localStorage.setItem(query_key,JSON.stringify({data:value}))}catch(e){console&&console.warn("Lockr didn't successfully save the '{"+key+": "+value+"}' pair, because the localStorage is full.")}},Lockr.get=function(key,missing,options){var value,query_key=this._getPrefixedKey(key,options);try{value=JSON.parse(localStorage.getItem(query_key))}catch(e){value=localStorage[query_key]?{data:localStorage.getItem(query_key)}:null}return value?"object"===_typeof(value)&&void 0!==value.data?value.data:void 0:missing},Lockr.sadd=function(key,value,options){var json,query_key=this._getPrefixedKey(key,options),values=Lockr.smembers(key);if(values.indexOf(value)>-1)return null;try{values.push(value),json=JSON.stringify({data:values}),localStorage.setItem(query_key,json)}catch(e){console.log(e),console&&console.warn("Lockr didn't successfully add the "+value+" to "+key+" set, because the localStorage is full.")}},Lockr.smembers=function(key,options){var value,query_key=this._getPrefixedKey(key,options);try{value=JSON.parse(localStorage.getItem(query_key))}catch(e){value=null}return value&&value.data?value.data:[]},Lockr.sismember=function(key,value,options){return Lockr.smembers(key).indexOf(value)>-1},Lockr.keys=function(){var keys=[],allKeys=Object.keys(localStorage);return 0===Lockr.prefix.length?allKeys:(allKeys.forEach((function(key){-1!==key.indexOf(Lockr.prefix)&&keys.push(key.replace(Lockr.prefix,""))})),keys)},Lockr.getAll=function(includeKeys){var keys=Lockr.keys();return includeKeys?keys.reduce((function(accum,key){var tempObj={};return tempObj[key]=Lockr.get(key),accum.push(tempObj),accum}),[]):keys.map((function(key){return Lockr.get(key)}))},Lockr.srem=function(key,value,options){var json,index,query_key=this._getPrefixedKey(key,options),values=Lockr.smembers(key,value);(index=values.indexOf(value))>-1&&values.splice(index,1),json=JSON.stringify({data:values});try{localStorage.setItem(query_key,json)}catch(e){console&&console.warn("Lockr couldn't remove the "+value+" from the set "+key)}},Lockr.rm=function(key){var queryKey=this._getPrefixedKey(key);localStorage.removeItem(queryKey)},Lockr.flush=function(){Lockr.prefix.length?Lockr.keys().forEach((function(key){localStorage.removeItem(Lockr._getPrefixedKey(key))})):localStorage.clear()},Lockr}(0,exports))},4747:function(module,__unused_webpack_exports,__webpack_require__){var DataView=__webpack_require__(9849)(__webpack_require__(3967),"DataView");module.exports=DataView},4419:function(module,__unused_webpack_exports,__webpack_require__){var hashClear=__webpack_require__(8931),hashDelete=__webpack_require__(7811),hashGet=__webpack_require__(3877),hashHas=__webpack_require__(8452),hashSet=__webpack_require__(8038);function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,module.exports=Hash},7762:function(module,__unused_webpack_exports,__webpack_require__){var listCacheClear=__webpack_require__(2266),listCacheDelete=__webpack_require__(259),listCacheGet=__webpack_require__(3878),listCacheHas=__webpack_require__(8603),listCacheSet=__webpack_require__(2371);function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,module.exports=ListCache},101:function(module,__unused_webpack_exports,__webpack_require__){var Map=__webpack_require__(9849)(__webpack_require__(3967),"Map");module.exports=Map},8283:function(module,__unused_webpack_exports,__webpack_require__){var mapCacheClear=__webpack_require__(1463),mapCacheDelete=__webpack_require__(4358),mapCacheGet=__webpack_require__(4071),mapCacheHas=__webpack_require__(3073),mapCacheSet=__webpack_require__(2447);function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,module.exports=MapCache},1169:function(module,__unused_webpack_exports,__webpack_require__){var Promise=__webpack_require__(9849)(__webpack_require__(3967),"Promise");module.exports=Promise},5784:function(module,__unused_webpack_exports,__webpack_require__){var Set=__webpack_require__(9849)(__webpack_require__(3967),"Set");module.exports=Set},7933:function(module,__unused_webpack_exports,__webpack_require__){var MapCache=__webpack_require__(8283),setCacheAdd=__webpack_require__(3968),setCacheHas=__webpack_require__(4163);function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,module.exports=SetCache},4054:function(module,__unused_webpack_exports,__webpack_require__){var ListCache=__webpack_require__(7762),stackClear=__webpack_require__(336),stackDelete=__webpack_require__(1736),stackGet=__webpack_require__(3237),stackHas=__webpack_require__(3973),stackSet=__webpack_require__(9702);function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet,module.exports=Stack},3874:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(3967).Symbol;module.exports=_Symbol},3727:function(module,__unused_webpack_exports,__webpack_require__){var Uint8Array=__webpack_require__(3967).Uint8Array;module.exports=Uint8Array},8798:function(module,__unused_webpack_exports,__webpack_require__){var WeakMap=__webpack_require__(9849)(__webpack_require__(3967),"WeakMap");module.exports=WeakMap},3352:function(module){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}},9212:function(module,__unused_webpack_exports,__webpack_require__){var baseTimes=__webpack_require__(6798),isArguments=__webpack_require__(3069),isArray=__webpack_require__(8354),isBuffer=__webpack_require__(8859),isIndex=__webpack_require__(3326),isTypedArray=__webpack_require__(9943),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}},2128:function(module){module.exports=function(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}},2218:function(module){module.exports=function(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}},7298:function(module){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}},5852:function(module,__unused_webpack_exports,__webpack_require__){var eq=__webpack_require__(5876);module.exports=function(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}},385:function(module){module.exports=function(number,lower,upper){return number==number&&(void 0!==upper&&(number=number<=upper?number:upper),void 0!==lower&&(number=number>=lower?number:lower)),number}},7889:function(module,__unused_webpack_exports,__webpack_require__){var castPath=__webpack_require__(6725),toKey=__webpack_require__(7874);module.exports=function(object,path){for(var index=0,length=(path=castPath(path,object)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:void 0}},9893:function(module,__unused_webpack_exports,__webpack_require__){var arrayPush=__webpack_require__(2218),isArray=__webpack_require__(8354);module.exports=function(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}},1859:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(3874),getRawTag=__webpack_require__(2196),objectToString=__webpack_require__(2484),symToStringTag=_Symbol?_Symbol.toStringTag:void 0;module.exports=function(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}},2914:function(module,__unused_webpack_exports,__webpack_require__){var baseGetTag=__webpack_require__(1859),isObjectLike=__webpack_require__(8112);module.exports=function(value){return isObjectLike(value)&&"[object Arguments]"==baseGetTag(value)}},1082:function(module,__unused_webpack_exports,__webpack_require__){var baseIsEqualDeep=__webpack_require__(965),isObjectLike=__webpack_require__(8112);module.exports=function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other)?value!=value&&other!=other:baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack))}},965:function(module,__unused_webpack_exports,__webpack_require__){var Stack=__webpack_require__(4054),equalArrays=__webpack_require__(3094),equalByTag=__webpack_require__(6336),equalObjects=__webpack_require__(928),getTag=__webpack_require__(5237),isArray=__webpack_require__(8354),isBuffer=__webpack_require__(8859),isTypedArray=__webpack_require__(9943),objectTag="[object Object]",hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?"[object Array]":getTag(object),othTag=othIsArr?"[object Array]":getTag(other),objIsObj=(objTag="[object Arguments]"==objTag?objectTag:objTag)==objectTag,othIsObj=(othTag="[object Arguments]"==othTag?objectTag:othTag)==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other))return!1;objIsArr=!0,objIsObj=!1}if(isSameTag&&!objIsObj)return stack||(stack=new Stack),objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(1&bitmask)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new Stack),equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}return!!isSameTag&&(stack||(stack=new Stack),equalObjects(object,other,bitmask,customizer,equalFunc,stack))}},8527:function(module,__unused_webpack_exports,__webpack_require__){var isFunction=__webpack_require__(5861),isMasked=__webpack_require__(3853),isObject=__webpack_require__(7800),toSource=__webpack_require__(7635),reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=function(value){return!(!isObject(value)||isMasked(value))&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value))}},123:function(module,__unused_webpack_exports,__webpack_require__){var baseGetTag=__webpack_require__(1859),isLength=__webpack_require__(2752),isObjectLike=__webpack_require__(8112),typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags["[object Float64Array]"]=typedArrayTags["[object Int8Array]"]=typedArrayTags["[object Int16Array]"]=typedArrayTags["[object Int32Array]"]=typedArrayTags["[object Uint8Array]"]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags["[object Uint16Array]"]=typedArrayTags["[object Uint32Array]"]=!0,typedArrayTags["[object Arguments]"]=typedArrayTags["[object Array]"]=typedArrayTags["[object ArrayBuffer]"]=typedArrayTags["[object Boolean]"]=typedArrayTags["[object DataView]"]=typedArrayTags["[object Date]"]=typedArrayTags["[object Error]"]=typedArrayTags["[object Function]"]=typedArrayTags["[object Map]"]=typedArrayTags["[object Number]"]=typedArrayTags["[object Object]"]=typedArrayTags["[object RegExp]"]=typedArrayTags["[object Set]"]=typedArrayTags["[object String]"]=typedArrayTags["[object WeakMap]"]=!1,module.exports=function(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}},5489:function(module,__unused_webpack_exports,__webpack_require__){var isPrototype=__webpack_require__(7235),nativeKeys=__webpack_require__(7648),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}},6798:function(module){module.exports=function(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}},4837:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(3874),arrayMap=__webpack_require__(2128),isArray=__webpack_require__(8354),isSymbol=__webpack_require__(6775),symbolProto=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;module.exports=function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-Infinity?"-0":result}},9957:function(module,__unused_webpack_exports,__webpack_require__){var trimmedEndIndex=__webpack_require__(8789),reTrimStart=/^\s+/;module.exports=function(string){return string?string.slice(0,trimmedEndIndex(string)+1).replace(reTrimStart,""):string}},7280:function(module){module.exports=function(func){return function(value){return func(value)}}},5755:function(module){module.exports=function(cache,key){return cache.has(key)}},6725:function(module,__unused_webpack_exports,__webpack_require__){var isArray=__webpack_require__(8354),isKey=__webpack_require__(4650),stringToPath=__webpack_require__(1397),toString=__webpack_require__(516);module.exports=function(value,object){return isArray(value)?value:isKey(value,object)?[value]:stringToPath(toString(value))}},9329:function(module,__unused_webpack_exports,__webpack_require__){var coreJsData=__webpack_require__(3967)["__core-js_shared__"];module.exports=coreJsData},3094:function(module,__unused_webpack_exports,__webpack_require__){var SetCache=__webpack_require__(7933),arraySome=__webpack_require__(7298),cacheHas=__webpack_require__(5755);module.exports=function(array,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var arrStacked=stack.get(array),othStacked=stack.get(other);if(arrStacked&&othStacked)return arrStacked==other&&othStacked==array;var index=-1,result=!0,seen=2&bitmask?new SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,(function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)}))){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}},6336:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(3874),Uint8Array=__webpack_require__(3727),eq=__webpack_require__(5876),equalArrays=__webpack_require__(3094),mapToArray=__webpack_require__(5773),setToArray=__webpack_require__(4816),symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;module.exports=function(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case"[object DataView]":if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case"[object ArrayBuffer]":return!(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other)));case"[object Boolean]":case"[object Date]":case"[object Number]":return eq(+object,+other);case"[object Error]":return object.name==other.name&&object.message==other.message;case"[object RegExp]":case"[object String]":return object==other+"";case"[object Map]":var convert=mapToArray;case"[object Set]":var isPartial=1&bitmask;if(convert||(convert=setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=2,stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case"[object Symbol]":if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}},928:function(module,__unused_webpack_exports,__webpack_require__){var getAllKeys=__webpack_require__(8980),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,objProps=getAllKeys(object),objLength=objProps.length;if(objLength!=getAllKeys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var objStacked=stack.get(object),othStacked=stack.get(other);if(objStacked&&othStacked)return objStacked==other&&othStacked==object;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){var objValue=object[key=objProps[index]],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor==othCtor||!("constructor"in object)||!("constructor"in other)||"function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor||(result=!1)}return stack.delete(object),stack.delete(other),result}},9075:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var freeGlobal="object"==(void 0===__webpack_require__.g?"undefined":_typeof(__webpack_require__.g))&&__webpack_require__.g&&__webpack_require__.g.Object===Object&&__webpack_require__.g;module.exports=freeGlobal},8980:function(module,__unused_webpack_exports,__webpack_require__){var baseGetAllKeys=__webpack_require__(9893),getSymbols=__webpack_require__(4415),keys=__webpack_require__(127);module.exports=function(object){return baseGetAllKeys(object,keys,getSymbols)}},7722:function(module,__unused_webpack_exports,__webpack_require__){var isKeyable=__webpack_require__(8880);module.exports=function(map,key){var data=map.__data__;return isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map}},9849:function(module,__unused_webpack_exports,__webpack_require__){var baseIsNative=__webpack_require__(8527),getValue=__webpack_require__(9265);module.exports=function(object,key){var value=getValue(object,key);return baseIsNative(value)?value:void 0}},2196:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(3874),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;module.exports=function(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result}},4415:function(module,__unused_webpack_exports,__webpack_require__){var arrayFilter=__webpack_require__(3352),stubArray=__webpack_require__(5990),propertyIsEnumerable=Object.prototype.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),arrayFilter(nativeGetSymbols(object),(function(symbol){return propertyIsEnumerable.call(object,symbol)})))}:stubArray;module.exports=getSymbols},5237:function(module,__unused_webpack_exports,__webpack_require__){var DataView=__webpack_require__(4747),Map=__webpack_require__(101),Promise=__webpack_require__(1169),Set=__webpack_require__(5784),WeakMap=__webpack_require__(8798),baseGetTag=__webpack_require__(1859),toSource=__webpack_require__(7635),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),getTag=baseGetTag;(DataView&&"[object DataView]"!=getTag(new DataView(new ArrayBuffer(1)))||Map&&"[object Map]"!=getTag(new Map)||Promise&&"[object Promise]"!=getTag(Promise.resolve())||Set&&"[object Set]"!=getTag(new Set)||WeakMap&&"[object WeakMap]"!=getTag(new WeakMap))&&(getTag=function(value){var result=baseGetTag(value),Ctor="[object Object]"==result?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return"[object DataView]";case mapCtorString:return"[object Map]";case promiseCtorString:return"[object Promise]";case setCtorString:return"[object Set]";case weakMapCtorString:return"[object WeakMap]"}return result}),module.exports=getTag},9265:function(module){module.exports=function(object,key){return null==object?void 0:object[key]}},8931:function(module,__unused_webpack_exports,__webpack_require__){var nativeCreate=__webpack_require__(257);module.exports=function(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}},7811:function(module){module.exports=function(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result}},3877:function(module,__unused_webpack_exports,__webpack_require__){var nativeCreate=__webpack_require__(257),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;if(nativeCreate){var result=data[key];return"__lodash_hash_undefined__"===result?void 0:result}return hasOwnProperty.call(data,key)?data[key]:void 0}},8452:function(module,__unused_webpack_exports,__webpack_require__){var nativeCreate=__webpack_require__(257),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;return nativeCreate?void 0!==data[key]:hasOwnProperty.call(data,key)}},8038:function(module,__unused_webpack_exports,__webpack_require__){var nativeCreate=__webpack_require__(257);module.exports=function(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&void 0===value?"__lodash_hash_undefined__":value,this}},3326:function(module){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var reIsUint=/^(?:0|[1-9]\d*)$/;module.exports=function(value,length){var type=_typeof(value);return!!(length=null==length?9007199254740991:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length}},4650:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var isArray=__webpack_require__(8354),isSymbol=__webpack_require__(6775),reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;module.exports=function(value,object){if(isArray(value))return!1;var type=_typeof(value);return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))}},8880:function(module){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module.exports=function(value){var type=_typeof(value);return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value}},3853:function(module,__unused_webpack_exports,__webpack_require__){var uid,coreJsData=__webpack_require__(9329),maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"";module.exports=function(func){return!!maskSrcKey&&maskSrcKey in func}},7235:function(module){var objectProto=Object.prototype;module.exports=function(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}},2266:function(module){module.exports=function(){this.__data__=[],this.size=0}},259:function(module,__unused_webpack_exports,__webpack_require__){var assocIndexOf=__webpack_require__(5852),splice=Array.prototype.splice;module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return!(index<0)&&(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,!0)}},3878:function(module,__unused_webpack_exports,__webpack_require__){var assocIndexOf=__webpack_require__(5852);module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?void 0:data[index][1]}},8603:function(module,__unused_webpack_exports,__webpack_require__){var assocIndexOf=__webpack_require__(5852);module.exports=function(key){return assocIndexOf(this.__data__,key)>-1}},2371:function(module,__unused_webpack_exports,__webpack_require__){var assocIndexOf=__webpack_require__(5852);module.exports=function(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this}},1463:function(module,__unused_webpack_exports,__webpack_require__){var Hash=__webpack_require__(4419),ListCache=__webpack_require__(7762),Map=__webpack_require__(101);module.exports=function(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}},4358:function(module,__unused_webpack_exports,__webpack_require__){var getMapData=__webpack_require__(7722);module.exports=function(key){var result=getMapData(this,key).delete(key);return this.size-=result?1:0,result}},4071:function(module,__unused_webpack_exports,__webpack_require__){var getMapData=__webpack_require__(7722);module.exports=function(key){return getMapData(this,key).get(key)}},3073:function(module,__unused_webpack_exports,__webpack_require__){var getMapData=__webpack_require__(7722);module.exports=function(key){return getMapData(this,key).has(key)}},2447:function(module,__unused_webpack_exports,__webpack_require__){var getMapData=__webpack_require__(7722);module.exports=function(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this}},5773:function(module){module.exports=function(map){var index=-1,result=Array(map.size);return map.forEach((function(value,key){result[++index]=[key,value]})),result}},5515:function(module,__unused_webpack_exports,__webpack_require__){var memoize=__webpack_require__(7915);module.exports=function(func){var result=memoize(func,(function(key){return 500===cache.size&&cache.clear(),key})),cache=result.cache;return result}},257:function(module,__unused_webpack_exports,__webpack_require__){var nativeCreate=__webpack_require__(9849)(Object,"create");module.exports=nativeCreate},7648:function(module,__unused_webpack_exports,__webpack_require__){var nativeKeys=__webpack_require__(4472)(Object.keys,Object);module.exports=nativeKeys},1905:function(module,exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module=__webpack_require__.nmd(module);var freeGlobal=__webpack_require__(9075),freeExports="object"==_typeof(exports)&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==_typeof(module)&&module&&!module.nodeType&&module,freeProcess=freeModule&&freeModule.exports===freeExports&&freeGlobal.process,nodeUtil=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;return types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();module.exports=nodeUtil},2484:function(module){var nativeObjectToString=Object.prototype.toString;module.exports=function(value){return nativeObjectToString.call(value)}},4472:function(module){module.exports=function(func,transform){return function(arg){return func(transform(arg))}}},3967:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var freeGlobal=__webpack_require__(9075),freeSelf="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")();module.exports=root},3968:function(module){module.exports=function(value){return this.__data__.set(value,"__lodash_hash_undefined__"),this}},4163:function(module){module.exports=function(value){return this.__data__.has(value)}},4816:function(module){module.exports=function(set){var index=-1,result=Array(set.size);return set.forEach((function(value){result[++index]=value})),result}},336:function(module,__unused_webpack_exports,__webpack_require__){var ListCache=__webpack_require__(7762);module.exports=function(){this.__data__=new ListCache,this.size=0}},1736:function(module){module.exports=function(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result}},3237:function(module){module.exports=function(key){return this.__data__.get(key)}},3973:function(module){module.exports=function(key){return this.__data__.has(key)}},9702:function(module,__unused_webpack_exports,__webpack_require__){var ListCache=__webpack_require__(7762),Map=__webpack_require__(101),MapCache=__webpack_require__(8283);module.exports=function(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<199)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this}},1397:function(module,__unused_webpack_exports,__webpack_require__){var memoizeCapped=__webpack_require__(5515),rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped((function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)})),result}));module.exports=stringToPath},7874:function(module,__unused_webpack_exports,__webpack_require__){var isSymbol=__webpack_require__(6775);module.exports=function(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-Infinity?"-0":result}},7635:function(module){var funcToString=Function.prototype.toString;module.exports=function(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}},8789:function(module){var reWhitespace=/\s/;module.exports=function(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index}},913:function(module,__unused_webpack_exports,__webpack_require__){var baseClamp=__webpack_require__(385),toNumber=__webpack_require__(9309);module.exports=function(number,lower,upper){return void 0===upper&&(upper=lower,lower=void 0),void 0!==upper&&(upper=(upper=toNumber(upper))==upper?upper:0),void 0!==lower&&(lower=(lower=toNumber(lower))==lower?lower:0),baseClamp(toNumber(number),lower,upper)}},2461:function(module,__unused_webpack_exports,__webpack_require__){var isObject=__webpack_require__(7800),now=__webpack_require__(3469),toNumber=__webpack_require__(9309),nativeMax=Math.max,nativeMin=Math.min;module.exports=function(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function(time){var timeWaiting=wait-(time-lastCallTime);return maxing?nativeMin(timeWaiting,maxWait-(time-lastInvokeTime)):timeWaiting}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return function(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}(lastCallTime);if(maxing)return clearTimeout(timerId),timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function(){return void 0===timerId?result:trailingEdge(now())},debounced}},5876:function(module){module.exports=function(value,other){return value===other||value!=value&&other!=other}},3117:function(module,__unused_webpack_exports,__webpack_require__){var baseGet=__webpack_require__(7889);module.exports=function(object,path,defaultValue){var result=null==object?void 0:baseGet(object,path);return void 0===result?defaultValue:result}},3069:function(module,__unused_webpack_exports,__webpack_require__){var baseIsArguments=__webpack_require__(2914),isObjectLike=__webpack_require__(8112),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};module.exports=isArguments},8354:function(module){var isArray=Array.isArray;module.exports=isArray},7133:function(module,__unused_webpack_exports,__webpack_require__){var isFunction=__webpack_require__(5861),isLength=__webpack_require__(2752);module.exports=function(value){return null!=value&&isLength(value.length)&&!isFunction(value)}},8859:function(module,exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module=__webpack_require__.nmd(module);var root=__webpack_require__(3967),stubFalse=__webpack_require__(8109),freeExports="object"==_typeof(exports)&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==_typeof(module)&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?root.Buffer:void 0,isBuffer=(Buffer?Buffer.isBuffer:void 0)||stubFalse;module.exports=isBuffer},9641:function(module,__unused_webpack_exports,__webpack_require__){var baseIsEqual=__webpack_require__(1082);module.exports=function(value,other){return baseIsEqual(value,other)}},5861:function(module,__unused_webpack_exports,__webpack_require__){var baseGetTag=__webpack_require__(1859),isObject=__webpack_require__(7800);module.exports=function(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return"[object Function]"==tag||"[object GeneratorFunction]"==tag||"[object AsyncFunction]"==tag||"[object Proxy]"==tag}},2752:function(module){module.exports=function(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}},7800:function(module){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module.exports=function(value){var type=_typeof(value);return null!=value&&("object"==type||"function"==type)}},8112:function(module){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module.exports=function(value){return null!=value&&"object"==_typeof(value)}},6775:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var baseGetTag=__webpack_require__(1859),isObjectLike=__webpack_require__(8112);module.exports=function(value){return"symbol"==_typeof(value)||isObjectLike(value)&&"[object Symbol]"==baseGetTag(value)}},9943:function(module,__unused_webpack_exports,__webpack_require__){var baseIsTypedArray=__webpack_require__(123),baseUnary=__webpack_require__(7280),nodeUtil=__webpack_require__(1905),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;module.exports=isTypedArray},127:function(module,__unused_webpack_exports,__webpack_require__){var arrayLikeKeys=__webpack_require__(9212),baseKeys=__webpack_require__(5489),isArrayLike=__webpack_require__(7133);module.exports=function(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}},7915:function(module,__unused_webpack_exports,__webpack_require__){var MapCache=__webpack_require__(8283);function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError("Expected a function");var memoized=function memoized(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize.Cache||MapCache),memoized}memoize.Cache=MapCache,module.exports=memoize},3469:function(module,__unused_webpack_exports,__webpack_require__){var root=__webpack_require__(3967);module.exports=function(){return root.Date.now()}},5990:function(module){module.exports=function(){return[]}},8109:function(module){module.exports=function(){return!1}},1984:function(module,__unused_webpack_exports,__webpack_require__){var debounce=__webpack_require__(2461),isObject=__webpack_require__(7800);module.exports=function(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");return isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:wait,trailing:trailing})}},9309:function(module,__unused_webpack_exports,__webpack_require__){var baseTrim=__webpack_require__(9957),isObject=__webpack_require__(7800),isSymbol=__webpack_require__(6775),reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;module.exports=function(value){if("number"==typeof value)return value;if(isSymbol(value))return NaN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}},516:function(module,__unused_webpack_exports,__webpack_require__){var baseToString=__webpack_require__(4837);module.exports=function(value){return null==value?"":baseToString(value)}},5029:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;function _typeof2(o){return _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof2(o)}factory=function(){"use strict";var _typeof="function"==typeof Symbol&&"symbol"===_typeof2(Symbol.iterator)?function(obj){return _typeof2(obj)}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":_typeof2(obj)},classCallCheck=function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")},createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},DOMIterator=function(){function DOMIterator(ctx){var iframes=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],exclude=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],iframesTimeout=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;classCallCheck(this,DOMIterator),this.ctx=ctx,this.iframes=iframes,this.exclude=exclude,this.iframesTimeout=iframesTimeout}return createClass(DOMIterator,[{key:"getContexts",value:function(){var filteredCtx=[];return(void 0!==this.ctx&&this.ctx?NodeList.prototype.isPrototypeOf(this.ctx)?Array.prototype.slice.call(this.ctx):Array.isArray(this.ctx)?this.ctx:"string"==typeof this.ctx?Array.prototype.slice.call(document.querySelectorAll(this.ctx)):[this.ctx]:[]).forEach((function(ctx){var isDescendant=filteredCtx.filter((function(contexts){return contexts.contains(ctx)})).length>0;-1!==filteredCtx.indexOf(ctx)||isDescendant||filteredCtx.push(ctx)})),filteredCtx}},{key:"getIframeContents",value:function(ifr,successFn){var errorFn=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},doc=void 0;try{var ifrWin=ifr.contentWindow;if(doc=ifrWin.document,!ifrWin||!doc)throw new Error("iframe inaccessible")}catch(e){errorFn()}doc&&successFn(doc)}},{key:"isIframeBlank",value:function(ifr){var bl="about:blank",src=ifr.getAttribute("src").trim();return ifr.contentWindow.location.href===bl&&src!==bl&&src}},{key:"observeIframeLoad",value:function(ifr,successFn,errorFn){var _this=this,called=!1,tout=null,listener=function listener(){if(!called){called=!0,clearTimeout(tout);try{_this.isIframeBlank(ifr)||(ifr.removeEventListener("load",listener),_this.getIframeContents(ifr,successFn,errorFn))}catch(e){errorFn()}}};ifr.addEventListener("load",listener),tout=setTimeout(listener,this.iframesTimeout)}},{key:"onIframeReady",value:function(ifr,successFn,errorFn){try{"complete"===ifr.contentWindow.document.readyState?this.isIframeBlank(ifr)?this.observeIframeLoad(ifr,successFn,errorFn):this.getIframeContents(ifr,successFn,errorFn):this.observeIframeLoad(ifr,successFn,errorFn)}catch(e){errorFn()}}},{key:"waitForIframes",value:function(ctx,done){var _this2=this,eachCalled=0;this.forEachIframe(ctx,(function(){return!0}),(function(ifr){eachCalled++,_this2.waitForIframes(ifr.querySelector("html"),(function(){--eachCalled||done()}))}),(function(handled){handled||done()}))}},{key:"forEachIframe",value:function(ctx,filter,each){var _this3=this,end=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},ifr=ctx.querySelectorAll("iframe"),open=ifr.length,handled=0;ifr=Array.prototype.slice.call(ifr);var checkEnd=function(){--open<=0&&end(handled)};open||checkEnd(),ifr.forEach((function(ifr){DOMIterator.matches(ifr,_this3.exclude)?checkEnd():_this3.onIframeReady(ifr,(function(con){filter(ifr)&&(handled++,each(con)),checkEnd()}),checkEnd)}))}},{key:"createIterator",value:function(ctx,whatToShow,filter){return document.createNodeIterator(ctx,whatToShow,filter,!1)}},{key:"createInstanceOnIframe",value:function(contents){return new DOMIterator(contents.querySelector("html"),this.iframes)}},{key:"compareNodeIframe",value:function(node,prevNode,ifr){if(node.compareDocumentPosition(ifr)&Node.DOCUMENT_POSITION_PRECEDING){if(null===prevNode)return!0;if(prevNode.compareDocumentPosition(ifr)&Node.DOCUMENT_POSITION_FOLLOWING)return!0}return!1}},{key:"getIteratorNode",value:function(itr){var prevNode=itr.previousNode();return{prevNode:prevNode,node:(null===prevNode||itr.nextNode())&&itr.nextNode()}}},{key:"checkIframeFilter",value:function(node,prevNode,currIfr,ifr){var key=!1,handled=!1;return ifr.forEach((function(ifrDict,i){ifrDict.val===currIfr&&(key=i,handled=ifrDict.handled)})),this.compareNodeIframe(node,prevNode,currIfr)?(!1!==key||handled?!1===key||handled||(ifr[key].handled=!0):ifr.push({val:currIfr,handled:!0}),!0):(!1===key&&ifr.push({val:currIfr,handled:!1}),!1)}},{key:"handleOpenIframes",value:function(ifr,whatToShow,eCb,fCb){var _this4=this;ifr.forEach((function(ifrDict){ifrDict.handled||_this4.getIframeContents(ifrDict.val,(function(con){_this4.createInstanceOnIframe(con).forEachNode(whatToShow,eCb,fCb)}))}))}},{key:"iterateThroughNodes",value:function(whatToShow,ctx,eachCb,filterCb,doneCb){for(var _getIteratorNode,_this5=this,itr=this.createIterator(ctx,whatToShow,filterCb),ifr=[],elements=[],node=void 0,prevNode=void 0;_getIteratorNode=void 0,_getIteratorNode=_this5.getIteratorNode(itr),prevNode=_getIteratorNode.prevNode,node=_getIteratorNode.node;)this.iframes&&this.forEachIframe(ctx,(function(currIfr){return _this5.checkIframeFilter(node,prevNode,currIfr,ifr)}),(function(con){_this5.createInstanceOnIframe(con).forEachNode(whatToShow,(function(ifrNode){return elements.push(ifrNode)}),filterCb)})),elements.push(node);elements.forEach((function(node){eachCb(node)})),this.iframes&&this.handleOpenIframes(ifr,whatToShow,eachCb,filterCb),doneCb()}},{key:"forEachNode",value:function(whatToShow,each,filter){var _this6=this,done=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},contexts=this.getContexts(),open=contexts.length;open||done(),contexts.forEach((function(ctx){var ready=function(){_this6.iterateThroughNodes(whatToShow,ctx,each,filter,(function(){--open<=0&&done()}))};_this6.iframes?_this6.waitForIframes(ctx,ready):ready()}))}}],[{key:"matches",value:function(element,selector){var selectors="string"==typeof selector?[selector]:selector,fn=element.matches||element.matchesSelector||element.msMatchesSelector||element.mozMatchesSelector||element.oMatchesSelector||element.webkitMatchesSelector;if(fn){var match=!1;return selectors.every((function(sel){return!fn.call(element,sel)||(match=!0,!1)})),match}return!1}}]),DOMIterator}(),Mark$1=function(){function Mark(ctx){classCallCheck(this,Mark),this.ctx=ctx,this.ie=!1;var ua=window.navigator.userAgent;(ua.indexOf("MSIE")>-1||ua.indexOf("Trident")>-1)&&(this.ie=!0)}return createClass(Mark,[{key:"log",value:function(msg){var level=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"debug",log=this.opt.log;this.opt.debug&&"object"===(void 0===log?"undefined":_typeof(log))&&"function"==typeof log[level]&&log[level]("mark.js: "+msg)}},{key:"escapeStr",value:function(str){return str.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}},{key:"createRegExp",value:function(str){return"disabled"!==this.opt.wildcards&&(str=this.setupWildcardsRegExp(str)),str=this.escapeStr(str),Object.keys(this.opt.synonyms).length&&(str=this.createSynonymsRegExp(str)),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(str=this.setupIgnoreJoinersRegExp(str)),this.opt.diacritics&&(str=this.createDiacriticsRegExp(str)),str=this.createMergedBlanksRegExp(str),(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(str=this.createJoinersRegExp(str)),"disabled"!==this.opt.wildcards&&(str=this.createWildcardsRegExp(str)),str=this.createAccuracyRegExp(str)}},{key:"createSynonymsRegExp",value:function(str){var syn=this.opt.synonyms,sens=this.opt.caseSensitive?"":"i",joinerPlaceholder=this.opt.ignoreJoiners||this.opt.ignorePunctuation.length?"\0":"";for(var index in syn)if(syn.hasOwnProperty(index)){var value=syn[index],k1="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(index):this.escapeStr(index),k2="disabled"!==this.opt.wildcards?this.setupWildcardsRegExp(value):this.escapeStr(value);""!==k1&&""!==k2&&(str=str.replace(new RegExp("("+this.escapeStr(k1)+"|"+this.escapeStr(k2)+")","gm"+sens),joinerPlaceholder+"("+this.processSynomyms(k1)+"|"+this.processSynomyms(k2)+")"+joinerPlaceholder))}return str}},{key:"processSynomyms",value:function(str){return(this.opt.ignoreJoiners||this.opt.ignorePunctuation.length)&&(str=this.setupIgnoreJoinersRegExp(str)),str}},{key:"setupWildcardsRegExp",value:function(str){return(str=str.replace(/(?:\\)*\?/g,(function(val){return"\\"===val.charAt(0)?"?":""}))).replace(/(?:\\)*\*/g,(function(val){return"\\"===val.charAt(0)?"*":""}))}},{key:"createWildcardsRegExp",value:function(str){var spaces="withSpaces"===this.opt.wildcards;return str.replace(/\u0001/g,spaces?"[\\S\\s]?":"\\S?").replace(/\u0002/g,spaces?"[\\S\\s]*?":"\\S*")}},{key:"setupIgnoreJoinersRegExp",value:function(str){return str.replace(/[^(|)\\]/g,(function(val,indx,original){var nextChar=original.charAt(indx+1);return/[(|)\\]/.test(nextChar)||""===nextChar?val:val+"\0"}))}},{key:"createJoinersRegExp",value:function(str){var joiner=[],ignorePunctuation=this.opt.ignorePunctuation;return Array.isArray(ignorePunctuation)&&ignorePunctuation.length&&joiner.push(this.escapeStr(ignorePunctuation.join(""))),this.opt.ignoreJoiners&&joiner.push("\\u00ad\\u200b\\u200c\\u200d"),joiner.length?str.split(/\u0000+/).join("["+joiner.join("")+"]*"):str}},{key:"createDiacriticsRegExp",value:function(str){var sens=this.opt.caseSensitive?"":"i",dct=this.opt.caseSensitive?["aàáảãạăằắẳẵặâầấẩẫậäåāą","AÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćč","CÇĆČ","dđď","DĐĎ","eèéẻẽẹêềếểễệëěēę","EÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïī","IÌÍỈĨỊÎÏĪ","lł","LŁ","nñňń","NÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøō","OÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rř","RŘ","sšśșş","SŠŚȘŞ","tťțţ","TŤȚŢ","uùúủũụưừứửữựûüůū","UÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿ","YÝỲỶỸỴŸ","zžżź","ZŽŻŹ"]:["aàáảãạăằắẳẵặâầấẩẫậäåāąAÀÁẢÃẠĂẰẮẲẴẶÂẦẤẨẪẬÄÅĀĄ","cçćčCÇĆČ","dđďDĐĎ","eèéẻẽẹêềếểễệëěēęEÈÉẺẼẸÊỀẾỂỄỆËĚĒĘ","iìíỉĩịîïīIÌÍỈĨỊÎÏĪ","lłLŁ","nñňńNÑŇŃ","oòóỏõọôồốổỗộơởỡớờợöøōOÒÓỎÕỌÔỒỐỔỖỘƠỞỠỚỜỢÖØŌ","rřRŘ","sšśșşSŠŚȘŞ","tťțţTŤȚŢ","uùúủũụưừứửữựûüůūUÙÚỦŨỤƯỪỨỬỮỰÛÜŮŪ","yýỳỷỹỵÿYÝỲỶỸỴŸ","zžżźZŽŻŹ"],handled=[];return str.split("").forEach((function(ch){dct.every((function(dct){if(-1!==dct.indexOf(ch)){if(handled.indexOf(dct)>-1)return!1;str=str.replace(new RegExp("["+dct+"]","gm"+sens),"["+dct+"]"),handled.push(dct)}return!0}))})),str}},{key:"createMergedBlanksRegExp",value:function(str){return str.replace(/[\s]+/gim,"[\\s]+")}},{key:"createAccuracyRegExp",value:function(str){var _this=this,acc=this.opt.accuracy,val="string"==typeof acc?acc:acc.value,ls="string"==typeof acc?[]:acc.limiters,lsJoin="";switch(ls.forEach((function(limiter){lsJoin+="|"+_this.escapeStr(limiter)})),val){case"partially":default:return"()("+str+")";case"complementary":return"()([^"+(lsJoin="\\s"+(lsJoin||this.escapeStr("!\"#$%&'()*+,-./:;<=>?@[\\]^_`{|}~¡¿")))+"]*"+str+"[^"+lsJoin+"]*)";case"exactly":return"(^|\\s"+lsJoin+")("+str+")(?=$|\\s"+lsJoin+")"}}},{key:"getSeparatedKeywords",value:function(sv){var _this2=this,stack=[];return sv.forEach((function(kw){_this2.opt.separateWordSearch?kw.split(" ").forEach((function(kwSplitted){kwSplitted.trim()&&-1===stack.indexOf(kwSplitted)&&stack.push(kwSplitted)})):kw.trim()&&-1===stack.indexOf(kw)&&stack.push(kw)})),{keywords:stack.sort((function(a,b){return b.length-a.length})),length:stack.length}}},{key:"isNumeric",value:function(value){return Number(parseFloat(value))==value}},{key:"checkRanges",value:function(array){var _this3=this;if(!Array.isArray(array)||"[object Object]"!==Object.prototype.toString.call(array[0]))return this.log("markRanges() will only accept an array of objects"),this.opt.noMatch(array),[];var stack=[],last=0;return array.sort((function(a,b){return a.start-b.start})).forEach((function(item){var _callNoMatchOnInvalid=_this3.callNoMatchOnInvalidRanges(item,last),start=_callNoMatchOnInvalid.start,end=_callNoMatchOnInvalid.end;_callNoMatchOnInvalid.valid&&(item.start=start,item.length=end-start,stack.push(item),last=end)})),stack}},{key:"callNoMatchOnInvalidRanges",value:function(range,last){var start=void 0,end=void 0,valid=!1;return range&&void 0!==range.start?(end=(start=parseInt(range.start,10))+parseInt(range.length,10),this.isNumeric(range.start)&&this.isNumeric(range.length)&&end-last>0&&end-start>0?valid=!0:(this.log("Ignoring invalid or overlapping range: "+JSON.stringify(range)),this.opt.noMatch(range))):(this.log("Ignoring invalid range: "+JSON.stringify(range)),this.opt.noMatch(range)),{start:start,end:end,valid:valid}}},{key:"checkWhitespaceRanges",value:function(range,originalLength,string){var end=void 0,valid=!0,max=string.length,offset=originalLength-max,start=parseInt(range.start,10)-offset;return(end=(start=start>max?max:start)+parseInt(range.length,10))>max&&(end=max,this.log("End range automatically set to the max value of "+max)),start<0||end-start<0||start>max||end>max?(valid=!1,this.log("Invalid range: "+JSON.stringify(range)),this.opt.noMatch(range)):""===string.substring(start,end).replace(/\s+/g,"")&&(valid=!1,this.log("Skipping whitespace only range: "+JSON.stringify(range)),this.opt.noMatch(range)),{start:start,end:end,valid:valid}}},{key:"getTextNodes",value:function(cb){var _this4=this,val="",nodes=[];this.iterator.forEachNode(NodeFilter.SHOW_TEXT,(function(node){nodes.push({start:val.length,end:(val+=node.textContent).length,node:node})}),(function(node){return _this4.matchesExclude(node.parentNode)?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}),(function(){cb({value:val,nodes:nodes})}))}},{key:"matchesExclude",value:function(el){return DOMIterator.matches(el,this.opt.exclude.concat(["script","style","title","head","html"]))}},{key:"wrapRangeInTextNode",value:function(node,start,end){var hEl=this.opt.element?this.opt.element:"mark",startNode=node.splitText(start),ret=startNode.splitText(end-start),repl=document.createElement(hEl);return repl.setAttribute("data-markjs","true"),this.opt.className&&repl.setAttribute("class",this.opt.className),repl.textContent=startNode.textContent,startNode.parentNode.replaceChild(repl,startNode),ret}},{key:"wrapRangeInMappedTextNode",value:function(dict,start,end,filterCb,eachCb){var _this5=this;dict.nodes.every((function(n,i){var sibl=dict.nodes[i+1];if(void 0===sibl||sibl.start>start){if(!filterCb(n.node))return!1;var s=start-n.start,e=(end>n.end?n.end:end)-n.start,startStr=dict.value.substr(0,n.start),endStr=dict.value.substr(e+n.start);if(n.node=_this5.wrapRangeInTextNode(n.node,s,e),dict.value=startStr+endStr,dict.nodes.forEach((function(k,j){j>=i&&(dict.nodes[j].start>0&&j!==i&&(dict.nodes[j].start-=e),dict.nodes[j].end-=e)})),end-=e,eachCb(n.node.previousSibling,n.start),!(end>n.end))return!1;start=n.end}return!0}))}},{key:"wrapMatches",value:function(regex,ignoreGroups,filterCb,eachCb,endCb){var _this6=this,matchIdx=0===ignoreGroups?0:ignoreGroups+1;this.getTextNodes((function(dict){dict.nodes.forEach((function(node){node=node.node;for(var match=void 0;null!==(match=regex.exec(node.textContent))&&""!==match[matchIdx];)if(filterCb(match[matchIdx],node)){var pos=match.index;if(0!==matchIdx)for(var i=1;i<matchIdx;i++)pos+=match[i].length;node=_this6.wrapRangeInTextNode(node,pos,pos+match[matchIdx].length),eachCb(node.previousSibling),regex.lastIndex=0}})),endCb()}))}},{key:"wrapMatchesAcrossElements",value:function(regex,ignoreGroups,filterCb,eachCb,endCb){var _this7=this,matchIdx=0===ignoreGroups?0:ignoreGroups+1;this.getTextNodes((function(dict){for(var match=void 0;null!==(match=regex.exec(dict.value))&&""!==match[matchIdx];){var start=match.index;if(0!==matchIdx)for(var i=1;i<matchIdx;i++)start+=match[i].length;var end=start+match[matchIdx].length;_this7.wrapRangeInMappedTextNode(dict,start,end,(function(node){return filterCb(match[matchIdx],node)}),(function(node,lastIndex){regex.lastIndex=lastIndex,eachCb(node)}))}endCb()}))}},{key:"wrapRangeFromIndex",value:function(ranges,filterCb,eachCb,endCb){var _this8=this;this.getTextNodes((function(dict){var originalLength=dict.value.length;ranges.forEach((function(range,counter){var _checkWhitespaceRange=_this8.checkWhitespaceRanges(range,originalLength,dict.value),start=_checkWhitespaceRange.start,end=_checkWhitespaceRange.end;_checkWhitespaceRange.valid&&_this8.wrapRangeInMappedTextNode(dict,start,end,(function(node){return filterCb(node,range,dict.value.substring(start,end),counter)}),(function(node){eachCb(node,range)}))})),endCb()}))}},{key:"unwrapMatches",value:function(node){for(var parent=node.parentNode,docFrag=document.createDocumentFragment();node.firstChild;)docFrag.appendChild(node.removeChild(node.firstChild));parent.replaceChild(docFrag,node),this.ie?this.normalizeTextNode(parent):parent.normalize()}},{key:"normalizeTextNode",value:function(node){if(node){if(3===node.nodeType)for(;node.nextSibling&&3===node.nextSibling.nodeType;)node.nodeValue+=node.nextSibling.nodeValue,node.parentNode.removeChild(node.nextSibling);else this.normalizeTextNode(node.firstChild);this.normalizeTextNode(node.nextSibling)}}},{key:"markRegExp",value:function(regexp,opt){var _this9=this;this.opt=opt,this.log('Searching with expression "'+regexp+'"');var totalMatches=0,fn="wrapMatches";this.opt.acrossElements&&(fn="wrapMatchesAcrossElements"),this[fn](regexp,this.opt.ignoreGroups,(function(match,node){return _this9.opt.filter(node,match,totalMatches)}),(function(element){totalMatches++,_this9.opt.each(element)}),(function(){0===totalMatches&&_this9.opt.noMatch(regexp),_this9.opt.done(totalMatches)}))}},{key:"mark",value:function(sv,opt){var _this10=this;this.opt=opt;var totalMatches=0,fn="wrapMatches",_getSeparatedKeywords=this.getSeparatedKeywords("string"==typeof sv?[sv]:sv),kwArr=_getSeparatedKeywords.keywords,kwArrLen=_getSeparatedKeywords.length,sens=this.opt.caseSensitive?"":"i";this.opt.acrossElements&&(fn="wrapMatchesAcrossElements"),0===kwArrLen?this.opt.done(totalMatches):function handler(kw){var regex=new RegExp(_this10.createRegExp(kw),"gm"+sens),matches=0;_this10.log('Searching with expression "'+regex+'"'),_this10[fn](regex,1,(function(term,node){return _this10.opt.filter(node,kw,totalMatches,matches)}),(function(element){matches++,totalMatches++,_this10.opt.each(element)}),(function(){0===matches&&_this10.opt.noMatch(kw),kwArr[kwArrLen-1]===kw?_this10.opt.done(totalMatches):handler(kwArr[kwArr.indexOf(kw)+1])}))}(kwArr[0])}},{key:"markRanges",value:function(rawRanges,opt){var _this11=this;this.opt=opt;var totalMatches=0,ranges=this.checkRanges(rawRanges);ranges&&ranges.length?(this.log("Starting to mark with the following ranges: "+JSON.stringify(ranges)),this.wrapRangeFromIndex(ranges,(function(node,range,match,counter){return _this11.opt.filter(node,range,match,counter)}),(function(element,range){totalMatches++,_this11.opt.each(element,range)}),(function(){_this11.opt.done(totalMatches)}))):this.opt.done(totalMatches)}},{key:"unmark",value:function(opt){var _this12=this;this.opt=opt;var sel=this.opt.element?this.opt.element:"*";sel+="[data-markjs]",this.opt.className&&(sel+="."+this.opt.className),this.log('Removal selector "'+sel+'"'),this.iterator.forEachNode(NodeFilter.SHOW_ELEMENT,(function(node){_this12.unwrapMatches(node)}),(function(node){var matchesSel=DOMIterator.matches(node,sel),matchesExclude=_this12.matchesExclude(node);return!matchesSel||matchesExclude?NodeFilter.FILTER_REJECT:NodeFilter.FILTER_ACCEPT}),this.opt.done)}},{key:"opt",set:function(val){this._opt=_extends({},{element:"",className:"",exclude:[],iframes:!1,iframesTimeout:5e3,separateWordSearch:!0,diacritics:!0,synonyms:{},accuracy:"partially",acrossElements:!1,caseSensitive:!1,ignoreJoiners:!1,ignoreGroups:0,ignorePunctuation:[],wildcards:"disabled",each:function(){},noMatch:function(){},filter:function(){return!0},done:function(){},debug:!1,log:window.console},val)},get:function(){return this._opt}},{key:"iterator",get:function(){return new DOMIterator(this.ctx,this.opt.iframes,this.opt.exclude,this.opt.iframesTimeout)}}]),Mark}();return function(ctx){var _this=this,instance=new Mark$1(ctx);return this.mark=function(sv,opt){return instance.mark(sv,opt),_this},this.markRegExp=function(sv,opt){return instance.markRegExp(sv,opt),_this},this.markRanges=function(sv,opt){return instance.markRanges(sv,opt),_this},this.unmark=function(opt){return instance.unmark(opt),_this},this}},"object"===_typeof2(exports)?module.exports=factory():void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},8516:function(__unused_webpack_module,exports){"use strict";function proxyMouse(target,tracked){function dispatch(e){for(var i=tracked.length-1;i>=0;i--){var t=tracked[i],x=e.clientX,y=e.clientY;if(e.touches&&e.touches.length&&(x=e.touches[0].clientX,y=e.touches[0].clientY),contains(t,target,x,y)){t.dispatchEvent(clone(e));break}}}if("iframe"===target.nodeName||"IFRAME"===target.nodeName)try{this.target=target.contentDocument}catch(err){this.target=target}else this.target=target;for(var _arr=["mouseup","mousedown","click","touchstart"],_i=0;_i<_arr.length;_i++){var ev=_arr[_i];this.target.addEventListener(ev,(function(e){return dispatch(e)}),!1)}}function clone(e){var opts=Object.assign({},e,{bubbles:!1});try{return new MouseEvent(e.type,opts)}catch(err){var copy=document.createEvent("MouseEvents");return copy.initMouseEvent(e.type,!1,opts.cancelable,opts.view,opts.detail,opts.screenX,opts.screenY,opts.clientX,opts.clientY,opts.ctrlKey,opts.altKey,opts.shiftKey,opts.metaKey,opts.button,opts.relatedTarget),copy}}function contains(item,target,x,y){var offset=target.getBoundingClientRect();function rectContains(r,x,y){var top=r.top-offset.top,left=r.left-offset.left,bottom=top+r.height,right=left+r.width;return top<=y&&left<=x&&bottom>y&&right>x}if(!rectContains(item.getBoundingClientRect(),x,y))return!1;for(var rects=item.getClientRects(),i=0,len=rects.length;i<len;i++)if(rectContains(rects[i],x,y))return!0;return!1}Object.defineProperty(exports,"__esModule",{value:!0}),exports.proxyMouse=proxyMouse,exports.clone=clone,exports.default={proxyMouse:proxyMouse}},6769:function(__unused_webpack_module,exports,__webpack_require__){"use strict";function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}exports.v6=exports.y$=exports.X6=void 0;var _get=function get(object,property,receiver){null===object&&(object=Function.prototype);var desc=Object.getOwnPropertyDescriptor(object,property);if(void 0===desc){var parent=Object.getPrototypeOf(object);return null===parent?void 0:get(parent,property,receiver)}if("value"in desc)return desc.value;var getter=desc.get;return void 0!==getter?getter.call(receiver):void 0},_createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}(),_svg2=_interopRequireDefault(__webpack_require__(4883)),_events2=_interopRequireDefault(__webpack_require__(8516));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}function _possibleConstructorReturn(self,call){if(!self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!call||"object"!==_typeof(call)&&"function"!=typeof call?self:call}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function, not "+_typeof(superClass));subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:!1,writable:!0,configurable:!0}}),superClass&&(Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}exports.X6=function(){function Pane(target){var container=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;_classCallCheck(this,Pane),this.target=target,this.element=_svg2.default.createElement("svg"),this.marks=[],this.element.style.position="absolute",this.element.setAttribute("pointer-events","none"),_events2.default.proxyMouse(this.target,this.marks),this.container=container,this.container.appendChild(this.element),this.render()}return _createClass(Pane,[{key:"addMark",value:function(mark){var g=_svg2.default.createElement("g");return this.element.appendChild(g),mark.bind(g,this.container),this.marks.push(mark),mark.render(),mark}},{key:"removeMark",value:function(mark){var idx=this.marks.indexOf(mark);if(-1!==idx){var el=mark.unbind();this.element.removeChild(el),this.marks.splice(idx,1)}}},{key:"render",value:function(){var el,container,offset,rect;!function(el,coords){el.style.setProperty("top",coords.top+"px","important"),el.style.setProperty("left",coords.left+"px","important"),el.style.setProperty("height",coords.height+"px","important"),el.style.setProperty("width",coords.width+"px","important")}(this.element,(el=this.target,container=this.container,offset=container.getBoundingClientRect(),rect=el.getBoundingClientRect(),{top:rect.top-offset.top,left:rect.left-offset.left,height:el.scrollHeight,width:el.scrollWidth}));var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=this.marks[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){_step.value.render()}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator.return&&_iterator.return()}finally{if(_didIteratorError)throw _iteratorError}}}}]),Pane}();var Mark=function(){function Mark(){_classCallCheck(this,Mark),this.element=null}return _createClass(Mark,[{key:"bind",value:function(element,container){this.element=element,this.container=container}},{key:"unbind",value:function(){var el=this.element;return this.element=null,el}},{key:"render",value:function(){}},{key:"dispatchEvent",value:function(e){this.element&&this.element.dispatchEvent(e)}},{key:"getBoundingClientRect",value:function(){return this.element.getBoundingClientRect()}},{key:"getClientRects",value:function(){for(var rects=[],el=this.element.firstChild;el;)rects.push(el.getBoundingClientRect()),el=el.nextSibling;return rects}},{key:"filteredRanges",value:function(){var rects=Array.from(this.range.getClientRects());return rects.filter((function(box){for(var i=0;i<rects.length;i++){if(rects[i]===box)return!0;if(rect1=rects[i],(rect2=box).right<=rect1.right&&rect2.left>=rect1.left&&rect2.top>=rect1.top&&rect2.bottom<=rect1.bottom)return!1}var rect1,rect2;return!0}))}}]),Mark}(),Highlight=exports.y$=function(_Mark){function Highlight(range,className,data,attributes){_classCallCheck(this,Highlight);var _this=_possibleConstructorReturn(this,(Highlight.__proto__||Object.getPrototypeOf(Highlight)).call(this));return _this.range=range,_this.className=className,_this.data=data||{},_this.attributes=attributes||{},_this}return _inherits(Highlight,_Mark),_createClass(Highlight,[{key:"bind",value:function(element,container){for(var attr in _get(Highlight.prototype.__proto__||Object.getPrototypeOf(Highlight.prototype),"bind",this).call(this,element,container),this.data)this.data.hasOwnProperty(attr)&&(this.element.dataset[attr]=this.data[attr]);for(var attr in this.attributes)this.attributes.hasOwnProperty(attr)&&this.element.setAttribute(attr,this.attributes[attr]);this.className&&this.element.classList.add(this.className)}},{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var docFrag=this.element.ownerDocument.createDocumentFragment(),filtered=this.filteredRanges(),offset=this.element.getBoundingClientRect(),container=this.container.getBoundingClientRect(),i=0,len=filtered.length;i<len;i++){var r=filtered[i],el=_svg2.default.createElement("rect");el.setAttribute("x",r.left-offset.left+container.left),el.setAttribute("y",r.top-offset.top+container.top),el.setAttribute("height",r.height),el.setAttribute("width",r.width),docFrag.appendChild(el)}this.element.appendChild(docFrag)}}]),Highlight}(Mark);exports.v6=function(_Highlight){function Underline(range,className,data,attributes){return _classCallCheck(this,Underline),_possibleConstructorReturn(this,(Underline.__proto__||Object.getPrototypeOf(Underline)).call(this,range,className,data,attributes))}return _inherits(Underline,_Highlight),_createClass(Underline,[{key:"render",value:function(){for(;this.element.firstChild;)this.element.removeChild(this.element.firstChild);for(var docFrag=this.element.ownerDocument.createDocumentFragment(),filtered=this.filteredRanges(),offset=this.element.getBoundingClientRect(),container=this.container.getBoundingClientRect(),i=0,len=filtered.length;i<len;i++){var r=filtered[i],rect=_svg2.default.createElement("rect");rect.setAttribute("x",r.left-offset.left+container.left),rect.setAttribute("y",r.top-offset.top+container.top),rect.setAttribute("height",r.height),rect.setAttribute("width",r.width),rect.setAttribute("fill","none");var line=_svg2.default.createElement("line");line.setAttribute("x1",r.left-offset.left+container.left),line.setAttribute("x2",r.left-offset.left+container.left+r.width),line.setAttribute("y1",r.top-offset.top+container.top+r.height-1),line.setAttribute("y2",r.top-offset.top+container.top+r.height-1),line.setAttribute("stroke-width",1),line.setAttribute("stroke","black"),line.setAttribute("stroke-linecap","square"),docFrag.appendChild(rect),docFrag.appendChild(line)}this.element.appendChild(docFrag)}}]),Underline}(Highlight)},4883:function(__unused_webpack_module,exports){"use strict";function createElement(name){return document.createElementNS("http://www.w3.org/2000/svg",name)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.createElement=createElement,exports.default={createElement:createElement}},1832:function(module){"use strict";function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}if(!process)var process={cwd:function(){return"/"}};function assertPath(path){if("string"!=typeof path)throw new TypeError("Path must be a string. Received "+path)}function normalizeStringPosix(path,allowAboveRoot){for(var code,res="",lastSlash=-1,dots=0,i=0;i<=path.length;++i){if(i<path.length)code=path.charCodeAt(i);else{if(47===code)break;code=47}if(47===code){if(lastSlash===i-1||1===dots);else if(lastSlash!==i-1&&2===dots){if(res.length<2||46!==res.charCodeAt(res.length-1)||46!==res.charCodeAt(res.length-2))if(res.length>2){for(var start=res.length-1,j=start;j>=0&&47!==res.charCodeAt(j);--j);if(j!==start){res=-1===j?"":res.slice(0,j),lastSlash=i,dots=0;continue}}else if(2===res.length||1===res.length){res="",lastSlash=i,dots=0;continue}allowAboveRoot&&(res.length>0?res+="/..":res="..")}else res.length>0?res+="/"+path.slice(lastSlash+1,i):res=path.slice(lastSlash+1,i);lastSlash=i,dots=0}else 46===code&&-1!==dots?++dots:dots=-1}return res}var posix={resolve:function(){for(var cwd,resolvedPath="",resolvedAbsolute=!1,i=arguments.length-1;i>=-1&&!resolvedAbsolute;i--){var path;i>=0?path=arguments[i]:(void 0===cwd&&(cwd=process.cwd()),path=cwd),assertPath(path),0!==path.length&&(resolvedPath=path+"/"+resolvedPath,resolvedAbsolute=47===path.charCodeAt(0))}return resolvedPath=normalizeStringPosix(resolvedPath,!resolvedAbsolute),resolvedAbsolute?resolvedPath.length>0?"/"+resolvedPath:"/":resolvedPath.length>0?resolvedPath:"."},normalize:function(path){if(assertPath(path),0===path.length)return".";var isAbsolute=47===path.charCodeAt(0),trailingSeparator=47===path.charCodeAt(path.length-1);return 0!==(path=normalizeStringPosix(path,!isAbsolute)).length||isAbsolute||(path="."),path.length>0&&trailingSeparator&&(path+="/"),isAbsolute?"/"+path:path},isAbsolute:function(path){return assertPath(path),path.length>0&&47===path.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var joined,i=0;i<arguments.length;++i){var arg=arguments[i];assertPath(arg),arg.length>0&&(void 0===joined?joined=arg:joined+="/"+arg)}return void 0===joined?".":posix.normalize(joined)},relative:function(from,to){if(assertPath(from),assertPath(to),from===to)return"";if((from=posix.resolve(from))===(to=posix.resolve(to)))return"";for(var fromStart=1;fromStart<from.length&&47===from.charCodeAt(fromStart);++fromStart);for(var fromEnd=from.length,fromLen=fromEnd-fromStart,toStart=1;toStart<to.length&&47===to.charCodeAt(toStart);++toStart);for(var toLen=to.length-toStart,length=fromLen<toLen?fromLen:toLen,lastCommonSep=-1,i=0;i<=length;++i){if(i===length){if(toLen>length){if(47===to.charCodeAt(toStart+i))return to.slice(toStart+i+1);if(0===i)return to.slice(toStart+i)}else fromLen>length&&(47===from.charCodeAt(fromStart+i)?lastCommonSep=i:0===i&&(lastCommonSep=0));break}var fromCode=from.charCodeAt(fromStart+i);if(fromCode!==to.charCodeAt(toStart+i))break;47===fromCode&&(lastCommonSep=i)}var out="";for(i=fromStart+lastCommonSep+1;i<=fromEnd;++i)i!==fromEnd&&47!==from.charCodeAt(i)||(0===out.length?out+="..":out+="/..");return out.length>0?out+to.slice(toStart+lastCommonSep):(toStart+=lastCommonSep,47===to.charCodeAt(toStart)&&++toStart,to.slice(toStart))},_makeLong:function(path){return path},dirname:function(path){if(assertPath(path),0===path.length)return".";for(var code=path.charCodeAt(0),hasRoot=47===code,end=-1,matchedSlash=!0,i=path.length-1;i>=1;--i)if(47===(code=path.charCodeAt(i))){if(!matchedSlash){end=i;break}}else matchedSlash=!1;return-1===end?hasRoot?"/":".":hasRoot&&1===end?"//":path.slice(0,end)},basename:function(path,ext){if(void 0!==ext&&"string"!=typeof ext)throw new TypeError('"ext" argument must be a string');assertPath(path);var i,start=0,end=-1,matchedSlash=!0;if(void 0!==ext&&ext.length>0&&ext.length<=path.length){if(ext.length===path.length&&ext===path)return"";var extIdx=ext.length-1,firstNonSlashEnd=-1;for(i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(47===code){if(!matchedSlash){start=i+1;break}}else-1===firstNonSlashEnd&&(matchedSlash=!1,firstNonSlashEnd=i+1),extIdx>=0&&(code===ext.charCodeAt(extIdx)?-1==--extIdx&&(end=i):(extIdx=-1,end=firstNonSlashEnd))}return start===end?end=firstNonSlashEnd:-1===end&&(end=path.length),path.slice(start,end)}for(i=path.length-1;i>=0;--i)if(47===path.charCodeAt(i)){if(!matchedSlash){start=i+1;break}}else-1===end&&(matchedSlash=!1,end=i+1);return-1===end?"":path.slice(start,end)},extname:function(path){assertPath(path);for(var startDot=-1,startPart=0,end=-1,matchedSlash=!0,preDotState=0,i=path.length-1;i>=0;--i){var code=path.charCodeAt(i);if(47!==code)-1===end&&(matchedSlash=!1,end=i+1),46===code?-1===startDot?startDot=i:1!==preDotState&&(preDotState=1):-1!==startDot&&(preDotState=-1);else if(!matchedSlash){startPart=i+1;break}}return-1===startDot||-1===end||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?"":path.slice(startDot,end)},format:function(pathObject){if(null===pathObject||"object"!==_typeof(pathObject))throw new TypeError('Parameter "pathObject" must be an object, not '+_typeof(pathObject));return function(sep,pathObject){var dir=pathObject.dir||pathObject.root,base=pathObject.base||(pathObject.name||"")+(pathObject.ext||"");return dir?dir===pathObject.root?dir+base:dir+sep+base:base}("/",pathObject)},parse:function(path){assertPath(path);var ret={root:"",dir:"",base:"",ext:"",name:""};if(0===path.length)return ret;var start,code=path.charCodeAt(0),isAbsolute=47===code;isAbsolute?(ret.root="/",start=1):start=0;for(var startDot=-1,startPart=0,end=-1,matchedSlash=!0,i=path.length-1,preDotState=0;i>=start;--i)if(47!==(code=path.charCodeAt(i)))-1===end&&(matchedSlash=!1,end=i+1),46===code?-1===startDot?startDot=i:1!==preDotState&&(preDotState=1):-1!==startDot&&(preDotState=-1);else if(!matchedSlash){startPart=i+1;break}return-1===startDot||-1===end||0===preDotState||1===preDotState&&startDot===end-1&&startDot===startPart+1?-1!==end&&(ret.base=ret.name=0===startPart&&isAbsolute?path.slice(1,end):path.slice(startPart,end)):(0===startPart&&isAbsolute?(ret.name=path.slice(1,startDot),ret.base=path.slice(1,end)):(ret.name=path.slice(startPart,startDot),ret.base=path.slice(startPart,end)),ret.ext=path.slice(startDot,end)),startPart>0?ret.dir=path.slice(0,startPart-1):isAbsolute&&(ret.dir="/"),ret},sep:"/",delimiter:":",posix:null};module.exports=posix},333:function(module){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},8081:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var isPrototype=__webpack_require__(5905);module.exports=function(value){if("function"!=typeof value)return!1;if(!hasOwnProperty.call(value,"length"))return!1;try{if("number"!=typeof value.length)return!1;if("function"!=typeof value.call)return!1;if("function"!=typeof value.apply)return!1}catch(error){return!1}return!isPrototype(value)}},520:function(module,__unused_webpack_exports,__webpack_require__){"use strict";function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var isValue=__webpack_require__(1707),possibleTypes={object:!0,function:!0,undefined:!0};module.exports=function(value){return!!isValue(value)&&hasOwnProperty.call(possibleTypes,_typeof(value))}},685:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var isFunction=__webpack_require__(8081),classRe=/^\s*class[\s{/}]/,functionToString=Function.prototype.toString;module.exports=function(value){return!!isFunction(value)&&!classRe.test(functionToString.call(value))}},5905:function(module,__unused_webpack_exports,__webpack_require__){"use strict";var isObject=__webpack_require__(520);module.exports=function(value){if(!isObject(value))return!1;try{return!!value.constructor&&value.constructor.prototype===value}catch(error){return!1}}},1707:function(module){"use strict";module.exports=function(value){return null!=value}},6908:function(__unused_webpack_module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}!function(global){var iteratorSupported=function(){try{return!!Symbol.iterator}catch(error){return!1}}(),createIterator=function(items){var iterator={next:function(){var value=items.shift();return{done:void 0===value,value:value}}};return iteratorSupported&&(iterator[Symbol.iterator]=function(){return iterator}),iterator},serializeParam=function(value){return encodeURIComponent(value).replace(/%20/g,"+")},deserializeParam=function(value){return decodeURIComponent(String(value).replace(/\+/g," "))};(function(){try{var URLSearchParams=global.URLSearchParams;return"a=1"===new URLSearchParams("?a=1").toString()&&"function"==typeof URLSearchParams.prototype.set}catch(e){return!1}})()||function(){var URLSearchParams=function URLSearchParams(searchString){Object.defineProperty(this,"_entries",{writable:!0,value:{}});var typeofSearchString=_typeof(searchString);if("undefined"===typeofSearchString);else if("string"===typeofSearchString)""!==searchString&&this._fromString(searchString);else if(searchString instanceof URLSearchParams){var _this=this;searchString.forEach((function(value,name){_this.append(name,value)}))}else{if(null===searchString||"object"!==typeofSearchString)throw new TypeError("Unsupported input's type for URLSearchParams");if("[object Array]"===Object.prototype.toString.call(searchString))for(var i=0;i<searchString.length;i++){var entry=searchString[i];if("[object Array]"!==Object.prototype.toString.call(entry)&&2===entry.length)throw new TypeError("Expected [string, any] as entry at index "+i+" of URLSearchParams's input");this.append(entry[0],entry[1])}else for(var key in searchString)searchString.hasOwnProperty(key)&&this.append(key,searchString[key])}},proto=URLSearchParams.prototype;proto.append=function(name,value){name in this._entries?this._entries[name].push(String(value)):this._entries[name]=[String(value)]},proto.delete=function(name){delete this._entries[name]},proto.get=function(name){return name in this._entries?this._entries[name][0]:null},proto.getAll=function(name){return name in this._entries?this._entries[name].slice(0):[]},proto.has=function(name){return name in this._entries},proto.set=function(name,value){this._entries[name]=[String(value)]},proto.forEach=function(callback,thisArg){var entries;for(var name in this._entries)if(this._entries.hasOwnProperty(name)){entries=this._entries[name];for(var i=0;i<entries.length;i++)callback.call(thisArg,entries[i],name,this)}},proto.keys=function(){var items=[];return this.forEach((function(value,name){items.push(name)})),createIterator(items)},proto.values=function(){var items=[];return this.forEach((function(value){items.push(value)})),createIterator(items)},proto.entries=function(){var items=[];return this.forEach((function(value,name){items.push([name,value])})),createIterator(items)},iteratorSupported&&(proto[Symbol.iterator]=proto.entries),proto.toString=function(){var searchArray=[];return this.forEach((function(value,name){searchArray.push(serializeParam(name)+"="+serializeParam(value))})),searchArray.join("&")},global.URLSearchParams=URLSearchParams}();var proto=global.URLSearchParams.prototype;"function"!=typeof proto.sort&&(proto.sort=function(){var _this=this,items=[];this.forEach((function(value,name){items.push([name,value]),_this._entries||_this.delete(name)})),items.sort((function(a,b){return a[0]<b[0]?-1:a[0]>b[0]?1:0})),_this._entries&&(_this._entries={});for(var i=0;i<items.length;i++)this.append(items[i][0],items[i][1])}),"function"!=typeof proto._fromString&&Object.defineProperty(proto,"_fromString",{enumerable:!1,configurable:!1,writable:!1,value:function(searchString){if(this._entries)this._entries={};else{var keys=[];this.forEach((function(value,name){keys.push(name)}));for(var i=0;i<keys.length;i++)this.delete(keys[i])}var attribute,attributes=(searchString=searchString.replace(/^\?/,"")).split("&");for(i=0;i<attributes.length;i++)attribute=attributes[i].split("="),this.append(deserializeParam(attribute[0]),attribute.length>1?deserializeParam(attribute[1]):"")}})}(void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this),function(global){if(function(){try{var u=new global.URL("b","http://a");return u.pathname="c d","http://a/c%20d"===u.href&&u.searchParams}catch(e){return!1}}()||function(){var _URL=global.URL,URL=function(url,base){"string"!=typeof url&&(url=String(url));var baseElement,doc=document;if(base&&(void 0===global.location||base!==global.location.href)){(baseElement=(doc=document.implementation.createHTMLDocument("")).createElement("base")).href=base,doc.head.appendChild(baseElement);try{if(0!==baseElement.href.indexOf(base))throw new Error(baseElement.href)}catch(err){throw new Error("URL unable to set base "+base+" due to "+err)}}var anchorElement=doc.createElement("a");anchorElement.href=url,baseElement&&(doc.body.appendChild(anchorElement),anchorElement.href=anchorElement.href);var inputElement=doc.createElement("input");if(inputElement.type="url",inputElement.value=url,":"===anchorElement.protocol||!/:/.test(anchorElement.href)||!inputElement.checkValidity()&&!base)throw new TypeError("Invalid URL");Object.defineProperty(this,"_anchorElement",{value:anchorElement});var searchParams=new global.URLSearchParams(this.search),enableSearchUpdate=!0,enableSearchParamsUpdate=!0,_this=this;["append","delete","set"].forEach((function(methodName){var method=searchParams[methodName];searchParams[methodName]=function(){method.apply(searchParams,arguments),enableSearchUpdate&&(enableSearchParamsUpdate=!1,_this.search=searchParams.toString(),enableSearchParamsUpdate=!0)}})),Object.defineProperty(this,"searchParams",{value:searchParams,enumerable:!0});var search=void 0;Object.defineProperty(this,"_updateSearchParams",{enumerable:!1,configurable:!1,writable:!1,value:function(){this.search!==search&&(search=this.search,enableSearchParamsUpdate&&(enableSearchUpdate=!1,this.searchParams._fromString(this.search),enableSearchUpdate=!0))}})},proto=URL.prototype;["hash","host","hostname","port","protocol"].forEach((function(attributeName){!function(attributeName){Object.defineProperty(proto,attributeName,{get:function(){return this._anchorElement[attributeName]},set:function(value){this._anchorElement[attributeName]=value},enumerable:!0})}(attributeName)})),Object.defineProperty(proto,"search",{get:function(){return this._anchorElement.search},set:function(value){this._anchorElement.search=value,this._updateSearchParams()},enumerable:!0}),Object.defineProperties(proto,{toString:{get:function(){var _this=this;return function(){return _this.href}}},href:{get:function(){return this._anchorElement.href.replace(/\?$/,"")},set:function(value){this._anchorElement.href=value,this._updateSearchParams()},enumerable:!0},pathname:{get:function(){return this._anchorElement.pathname.replace(/(^\/?)/,"/")},set:function(value){this._anchorElement.pathname=value},enumerable:!0},origin:{get:function(){var expectedPort={"http:":80,"https:":443,"ftp:":21}[this._anchorElement.protocol],addPortToOrigin=this._anchorElement.port!=expectedPort&&""!==this._anchorElement.port;return this._anchorElement.protocol+"//"+this._anchorElement.hostname+(addPortToOrigin?":"+this._anchorElement.port:"")},enumerable:!0},password:{get:function(){return""},set:function(value){},enumerable:!0},username:{get:function(){return""},set:function(value){},enumerable:!0}}),URL.createObjectURL=function(blob){return _URL.createObjectURL.apply(_URL,arguments)},URL.revokeObjectURL=function(url){return _URL.revokeObjectURL.apply(_URL,arguments)},global.URL=URL}(),void 0!==global.location&&!("origin"in global.location)){var getOrigin=function(){return global.location.protocol+"//"+global.location.hostname+(global.location.port?":"+global.location.port:"")};try{Object.defineProperty(global.location,"origin",{get:getOrigin,enumerable:!0})}catch(e){setInterval((function(){global.location.origin=getOrigin()}),100)}}}(void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:this)},5599:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module=__webpack_require__.nmd(module),factory=function(){return function(modules){var installedModules={};function __nested_webpack_require_1060__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={i:moduleId,l:!1,exports:{}};return modules[moduleId].call(module.exports,module,module.exports,__nested_webpack_require_1060__),module.l=!0,module.exports}return __nested_webpack_require_1060__.m=modules,__nested_webpack_require_1060__.c=installedModules,__nested_webpack_require_1060__.i=function(value){return value},__nested_webpack_require_1060__.d=function(exports,name,getter){__nested_webpack_require_1060__.o(exports,name)||Object.defineProperty(exports,name,{configurable:!1,enumerable:!0,get:getter})},__nested_webpack_require_1060__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __nested_webpack_require_1060__.d(getter,"a",getter),getter},__nested_webpack_require_1060__.o=function(object,property){return Object.prototype.hasOwnProperty.call(object,property)},__nested_webpack_require_1060__.p="",__nested_webpack_require_1060__(__nested_webpack_require_1060__.s=6)}([function(module,__nested_webpack_exports__,__nested_webpack_require_3909__){"use strict";__nested_webpack_require_3909__.d(__nested_webpack_exports__,"a",(function(){return toArray})),__nested_webpack_require_3909__.d(__nested_webpack_exports__,"b",(function(){return arrayFind}));var toArray=function(a){for(var ret=Array(a.length),i=0;i<a.length;++i)ret[i]=a[i];return ret},arrayFind=function(array,search){return array.filter((function(a){return a===search}))[0]}},function(module,__nested_webpack_exports__,__nested_webpack_require_4606__){"use strict";Object.defineProperty(__nested_webpack_exports__,"__esModule",{value:!0}),__nested_webpack_require_4606__.d(__nested_webpack_exports__,"FOCUS_GROUP",(function(){return FOCUS_GROUP})),__nested_webpack_require_4606__.d(__nested_webpack_exports__,"FOCUS_DISABLED",(function(){return FOCUS_DISABLED})),__nested_webpack_require_4606__.d(__nested_webpack_exports__,"FOCUS_ALLOW",(function(){return FOCUS_ALLOW})),__nested_webpack_require_4606__.d(__nested_webpack_exports__,"FOCUS_AUTO",(function(){return FOCUS_AUTO}));var FOCUS_GROUP="data-focus-lock",FOCUS_DISABLED="data-focus-lock-disabled",FOCUS_ALLOW="data-no-focus-lock",FOCUS_AUTO="data-autofocus-inside"},function(module,__nested_webpack_exports__,__nested_webpack_require_5578__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__constants__=__nested_webpack_require_5578__(1),__WEBPACK_IMPORTED_MODULE_1__array__=__nested_webpack_require_5578__(0),filterNested=function filterNested(nodes){var l=nodes.length,i=void 0,j=void 0;for(i=0;i<l;i+=1)for(j=0;j<l;j+=1)if(i!==j&&nodes[i].contains(nodes[j]))return filterNested(nodes.filter((function(x){return x!==nodes[j]})));return nodes},getTopParent=function getTopParent(node){return node.parentNode?getTopParent(node.parentNode):node};__nested_webpack_exports__.a=function(node){var group=node.getAttribute(__WEBPACK_IMPORTED_MODULE_0__constants__.FOCUS_GROUP);return group?filterNested(__nested_webpack_require_5578__.i(__WEBPACK_IMPORTED_MODULE_1__array__.a)(getTopParent(node).querySelectorAll("["+__WEBPACK_IMPORTED_MODULE_0__constants__.FOCUS_GROUP+'="'+group+'"]:not(['+__WEBPACK_IMPORTED_MODULE_0__constants__.FOCUS_DISABLED+'="disabled"])'))):[node]}},function(module,__nested_webpack_exports__,__nested_webpack_require_7097__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__utils_DOMutils__=__nested_webpack_require_7097__(12),__WEBPACK_IMPORTED_MODULE_1__utils_firstFocus__=__nested_webpack_require_7097__(13),__WEBPACK_IMPORTED_MODULE_2__utils_all_affected__=__nested_webpack_require_7097__(2),notAGuard=function(node){return!(node.dataset&&node.dataset.focusGuard)};__nested_webpack_exports__.a=function(topNode,lastNode){var activeElement=document&&document.activeElement,entries=__nested_webpack_require_7097__.i(__WEBPACK_IMPORTED_MODULE_2__utils_all_affected__.a)(topNode).filter(notAGuard),commonParent=function(activeElement,entry,entries){var topCommon=entry;return entries.forEach((function(subEntry){var common=__nested_webpack_require_7097__.i(__WEBPACK_IMPORTED_MODULE_0__utils_DOMutils__.a)(activeElement,subEntry);common&&(topCommon=common.contains(topCommon)?common:__nested_webpack_require_7097__.i(__WEBPACK_IMPORTED_MODULE_0__utils_DOMutils__.a)(common,topCommon))})),topCommon}(activeElement||topNode,topNode,entries),innerElements=__nested_webpack_require_7097__.i(__WEBPACK_IMPORTED_MODULE_0__utils_DOMutils__.c)(entries).filter((function(_ref){var node=_ref.node;return notAGuard(node)}));if(innerElements[0]||(innerElements=__nested_webpack_require_7097__.i(__WEBPACK_IMPORTED_MODULE_0__utils_DOMutils__.d)(entries).filter((function(_ref2){var node=_ref2.node;return notAGuard(node)})))[0]){var autoFocusables,innerNodes=innerElements.map((function(_ref3){return _ref3.node})),newId=function(innerNodes,outerNodes,activeElement,lastNode,autoFocused){var cnt=innerNodes.length,firstFocus=innerNodes[0],lastFocus=innerNodes[cnt-1];if(!(innerNodes.indexOf(activeElement)>=0)){var activeIndex=outerNodes.indexOf(activeElement),lastIndex=outerNodes.indexOf(lastNode||activeIndex),lastNodeInside=innerNodes.indexOf(lastNode),indexDiff=activeIndex-lastIndex,firstNodeIndex=outerNodes.indexOf(firstFocus),lastNodeIndex=outerNodes.indexOf(lastFocus);return-1===activeIndex||-1===lastNodeInside?innerNodes.indexOf(autoFocused.length?__nested_webpack_require_7097__.i(__WEBPACK_IMPORTED_MODULE_1__utils_firstFocus__.a)(autoFocused):__nested_webpack_require_7097__.i(__WEBPACK_IMPORTED_MODULE_1__utils_firstFocus__.a)(innerNodes)):!indexDiff&&lastNodeInside>=0||indexDiff&&Math.abs(indexDiff)>1?lastNodeInside:activeIndex<=firstNodeIndex?cnt-1:activeIndex>lastNodeIndex?0:indexDiff?Math.abs(indexDiff)>1?lastNodeInside:(cnt+lastNodeInside+indexDiff)%cnt:void 0}}(innerNodes,__nested_webpack_require_7097__.i(__WEBPACK_IMPORTED_MODULE_0__utils_DOMutils__.c)([commonParent]).map((function(_ref4){return _ref4.node})),activeElement,lastNode,innerNodes.filter((autoFocusables=function(entries){return entries.reduce((function(acc,node){return acc.concat(__nested_webpack_require_7097__.i(__WEBPACK_IMPORTED_MODULE_0__utils_DOMutils__.b)(node))}),[])}(entries),function(node){return!!node.autofocus||node.dataset&&!!node.dataset.autofocus||autoFocusables.indexOf(node)>=0})));return void 0===newId?newId:innerElements[newId]}}},function(module,exports,__nested_webpack_require_12131__){var Component=__nested_webpack_require_12131__(17)(__nested_webpack_require_12131__(5),__nested_webpack_require_12131__(18),null,null);Component.options.__file="/Users/akorzunov/dev/Z/mellis/github/focus/vue-focus-lock/src/Lock.vue",Component.esModule&&Object.keys(Component.esModule).some((function(key){return"default"!==key&&"__esModule"!==key}))&&console.error("named exports are not supported in *.vue files."),Component.options.functional&&console.error("[vue-loader] Lock.vue: functional components are not supported with templates, they should use render functions."),module.exports=Component.exports},function(module,exports,__nested_webpack_require_13390__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_focusLock=__nested_webpack_require_13390__(9),_focusLock2=(obj=_focusLock)&&obj.__esModule?obj:{default:obj};function deferAction(action){var setImmediate=window.setImmediate;void 0!==setImmediate?setImmediate(action):setTimeout(action,1)}var lastActiveTrap=0,lastActiveFocus=null,focusWasOutsideWindow=!1,isFreeFocus=function(){return document&&document.activeElement===document.body||(0,_focusLock.focusIsHidden)()},activateTrap=function(){var result=!1;if(lastActiveTrap){var _lastActiveTrap=lastActiveTrap,observed=_lastActiveTrap.observed,onActivation=_lastActiveTrap.onActivation;!focusWasOutsideWindow&&isFreeFocus()&&lastActiveFocus||(observed&&!(0,_focusLock.focusInside)(observed)&&(onActivation(),result=(0,_focusLock2.default)(observed,lastActiveFocus)),focusWasOutsideWindow=!1,lastActiveFocus=document&&document.activeElement)}return result},instances=[],emitChange=function(){var trap;trap=instances.filter((function(_ref){return!_ref.disabled})).slice(-1)[0],lastActiveTrap!==trap&&(lastActiveTrap=null),lastActiveTrap=trap,trap&&(activateTrap(),deferAction(activateTrap))},onTrap=function(event){activateTrap()&&event&&(event.stopPropagation(),event.preventDefault())},onBlur=function(){deferAction(activateTrap)},onWindowBlur=function(){focusWasOutsideWindow=!0};exports.default={name:"Lock",props:{returnFocus:{type:Boolean},disabled:{type:Boolean},noFocusGuards:{type:[Boolean,String],default:!1},group:{type:String}},data:function(){return{data:{},hidden:""}},computed:{groupAttr:function(){return function(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}({},_focusLock.constants.FOCUS_GROUP,this.group)},hasLeadingGuards:function(){return!0!==this.noFocusGuards},hasTailingGuards:function(){return this.hasLeadingGuards&&"tail"!==this.noFocusGuards}},watch:{disabled:function(){this.data.disabled=this.disabled,emitChange()}},methods:{onBlur:function(){deferAction(emitChange)}},mounted:function(){var _this=this;this.data.vue=this,this.data.observed=this.$el.querySelector("[data-lock]"),this.data.disabled=this.disabled,this.data.onActivation=function(){_this.originalFocusedElement=_this.originalFocusedElement||document&&document.activeElement},instances.length||(document.addEventListener("focusin",onTrap,!0),document.addEventListener("focusout",onBlur),window.addEventListener("blur",onWindowBlur)),instances.push(this.data),emitChange()},destroyed:function(){var _this2=this;(instances=instances.filter((function(_ref3){return _ref3.vue!==_this2}))).length||(document.removeEventListener("focusin",onTrap,!0),document.removeEventListener("focusout",onBlur),window.removeEventListener("blur",onWindowBlur)),this.returnFocus&&this.originalFocusedElement&&this.originalFocusedElement.focus&&this.originalFocusedElement.focus(),emitChange()}}},function(module,exports,__nested_webpack_require_19010__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var obj,_Lock=__nested_webpack_require_19010__(4),_Lock2=(obj=_Lock)&&obj.__esModule?obj:{default:obj};exports.default=_Lock2.default},function(module,__nested_webpack_exports__,__nested_webpack_require_19452__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__utils_all_affected__=__nested_webpack_require_19452__(2),__WEBPACK_IMPORTED_MODULE_1__utils_array__=__nested_webpack_require_19452__(0),focusInFrame=function(frame){return frame===document.activeElement};__nested_webpack_exports__.a=function(topNode){var activeElement=document&&document.activeElement;return!(!activeElement||activeElement.dataset&&activeElement.dataset.focusGuard)&&__nested_webpack_require_19452__.i(__WEBPACK_IMPORTED_MODULE_0__utils_all_affected__.a)(topNode).reduce((function(result,node){return result||node.contains(activeElement)||function(topNode){return __nested_webpack_require_19452__.i(__WEBPACK_IMPORTED_MODULE_0__utils_all_affected__.a)(topNode).reduce((function(result,node){return result||!!__nested_webpack_require_19452__.i(__WEBPACK_IMPORTED_MODULE_1__utils_array__.b)(__nested_webpack_require_19452__.i(__WEBPACK_IMPORTED_MODULE_1__utils_array__.a)(node.querySelectorAll("iframe")),focusInFrame)}),!1)}(topNode)}),!1)}},function(module,__nested_webpack_exports__,__nested_webpack_require_20940__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__utils_array__=__nested_webpack_require_20940__(0),__WEBPACK_IMPORTED_MODULE_1__constants__=__nested_webpack_require_20940__(1);__nested_webpack_exports__.a=function(){return document&&__nested_webpack_require_20940__.i(__WEBPACK_IMPORTED_MODULE_0__utils_array__.a)(document.querySelectorAll("["+__WEBPACK_IMPORTED_MODULE_1__constants__.FOCUS_ALLOW+"]")).some((function(node){return node.contains(document.activeElement)}))}},function(module,__nested_webpack_exports__,__nested_webpack_require_21688__){"use strict";Object.defineProperty(__nested_webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0__tabHook__=__nested_webpack_require_21688__(11),__WEBPACK_IMPORTED_MODULE_1__focusMerge__=__nested_webpack_require_21688__(3),__WEBPACK_IMPORTED_MODULE_2__focusInside__=__nested_webpack_require_21688__(7),__WEBPACK_IMPORTED_MODULE_3__focusIsHidden__=__nested_webpack_require_21688__(8),__WEBPACK_IMPORTED_MODULE_4__setFocus__=__nested_webpack_require_21688__(10),__WEBPACK_IMPORTED_MODULE_5__constants__=__nested_webpack_require_21688__(1),__WEBPACK_IMPORTED_MODULE_6__utils_all_affected__=__nested_webpack_require_21688__(2);__nested_webpack_require_21688__.d(__nested_webpack_exports__,"tabHook",(function(){return __WEBPACK_IMPORTED_MODULE_0__tabHook__.a})),__nested_webpack_require_21688__.d(__nested_webpack_exports__,"focusInside",(function(){return __WEBPACK_IMPORTED_MODULE_2__focusInside__.a})),__nested_webpack_require_21688__.d(__nested_webpack_exports__,"focusIsHidden",(function(){return __WEBPACK_IMPORTED_MODULE_3__focusIsHidden__.a})),__nested_webpack_require_21688__.d(__nested_webpack_exports__,"focusMerge",(function(){return __WEBPACK_IMPORTED_MODULE_1__focusMerge__.a})),__nested_webpack_require_21688__.d(__nested_webpack_exports__,"constants",(function(){return __WEBPACK_IMPORTED_MODULE_5__constants__})),__nested_webpack_require_21688__.d(__nested_webpack_exports__,"getAllAffectedNodes",(function(){return __WEBPACK_IMPORTED_MODULE_6__utils_all_affected__.a})),__nested_webpack_exports__.default=__WEBPACK_IMPORTED_MODULE_4__setFocus__.a},function(module,__nested_webpack_exports__,__nested_webpack_require_23843__){"use strict";var __WEBPACK_IMPORTED_MODULE_0__focusMerge__=__nested_webpack_require_23843__(3),guardCount=0;__nested_webpack_exports__.a=function(topNode,lastNode){var target,focusable=__nested_webpack_require_23843__.i(__WEBPACK_IMPORTED_MODULE_0__focusMerge__.a)(topNode,lastNode);if(focusable){if(guardCount>2)return;guardCount++,(target=focusable.node).focus(),target.contentWindow&&target.contentWindow.focus(),guardCount--}}},function(module,__nested_webpack_exports__,__webpack_require__){"use strict";__nested_webpack_exports__.a={attach:function(node,enabled){},detach:function(){}}},function(module,__nested_webpack_exports__,__nested_webpack_require_25450__){"use strict";__nested_webpack_require_25450__.d(__nested_webpack_exports__,"a",(function(){return getCommonParent})),__nested_webpack_require_25450__.d(__nested_webpack_exports__,"c",(function(){return getTabbableNodes})),__nested_webpack_require_25450__.d(__nested_webpack_exports__,"d",(function(){return getAllTabbableNodes})),__nested_webpack_require_25450__.d(__nested_webpack_exports__,"b",(function(){return parentAutofocusables}));var __WEBPACK_IMPORTED_MODULE_0__tabOrder__=__nested_webpack_require_25450__(14),__WEBPACK_IMPORTED_MODULE_1__tabUtils__=__nested_webpack_require_25450__(15),__WEBPACK_IMPORTED_MODULE_2__array__=__nested_webpack_require_25450__(0),isVisible=function isVisible(node){return!node||node===document||!((computedStyle=window.getComputedStyle(node,null))&&computedStyle.getPropertyValue&&("none"===computedStyle.getPropertyValue("display")||"hidden"===computedStyle.getPropertyValue("visibility")))&&isVisible(node.parentNode);var computedStyle},getParents=function getParents(node){var parents=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return parents.push(node),node.parentNode&&getParents(node.parentNode,parents),parents},getCommonParent=function(nodea,nodeb){for(var parentsA=getParents(nodea),parentsB=getParents(nodeb),i=0;i<parentsA.length;i+=1){var currentParent=parentsA[i];if(parentsB.indexOf(currentParent)>=0)return currentParent}return!1},filterFocusable=function(nodes){return __nested_webpack_require_25450__.i(__WEBPACK_IMPORTED_MODULE_2__array__.a)(nodes).filter((function(node){return isVisible(node)})).filter((function(node){return function(node){return!(("INPUT"===node.tagName||"BUTTON"===node.tagName)&&("hidden"===node.type||node.disabled))}(node)}))},getTabbableNodes=function(topNodes){return __nested_webpack_require_25450__.i(__WEBPACK_IMPORTED_MODULE_0__tabOrder__.a)(filterFocusable(__nested_webpack_require_25450__.i(__WEBPACK_IMPORTED_MODULE_1__tabUtils__.a)(topNodes)),!0)},getAllTabbableNodes=function(topNodes){return __nested_webpack_require_25450__.i(__WEBPACK_IMPORTED_MODULE_0__tabOrder__.a)(filterFocusable(__nested_webpack_require_25450__.i(__WEBPACK_IMPORTED_MODULE_1__tabUtils__.a)(topNodes)),!1)},parentAutofocusables=function(topNode){return filterFocusable(__nested_webpack_require_25450__.i(__WEBPACK_IMPORTED_MODULE_1__tabUtils__.b)(topNode))}},function(module,__nested_webpack_exports__,__webpack_require__){"use strict";var isRadio=function(node){return"INPUT"===node.tagName&&"radio"===node.type};__nested_webpack_exports__.a=function(nodes){return nodes[0]&&nodes.length>1&&isRadio(nodes[0])&&nodes[0].name?function(node,nodes){return nodes.filter(isRadio).filter((function(el){return el.name===node.name})).filter((function(el){return el.checked}))[0]||node}(nodes[0],nodes):nodes[0]}},function(module,__nested_webpack_exports__,__nested_webpack_require_29813__){"use strict";__nested_webpack_require_29813__.d(__nested_webpack_exports__,"a",(function(){return orderByTabIndex}));var __WEBPACK_IMPORTED_MODULE_0__array__=__nested_webpack_require_29813__(0),tabSort=function(a,b){var tabDiff=a.tabIndex-b.tabIndex,indexDiff=a.index-b.index;if(tabDiff){if(!a.tabIndex)return 1;if(!b.tabIndex)return-1}return tabDiff||indexDiff},orderByTabIndex=function(nodes,filterNegative){return __nested_webpack_require_29813__.i(__WEBPACK_IMPORTED_MODULE_0__array__.a)(nodes).map((function(node,index){return{node:node,index:index,tabIndex:node.tabIndex}})).filter((function(data){return!filterNegative||data.tabIndex>=0})).sort(tabSort)}},function(module,__nested_webpack_exports__,__nested_webpack_require_30906__){"use strict";__nested_webpack_require_30906__.d(__nested_webpack_exports__,"a",(function(){return getFocusables})),__nested_webpack_require_30906__.d(__nested_webpack_exports__,"b",(function(){return getParentAutofocusables}));var __WEBPACK_IMPORTED_MODULE_0__tabbables__=__nested_webpack_require_30906__(16),__WEBPACK_IMPORTED_MODULE_1__array__=__nested_webpack_require_30906__(0),__WEBPACK_IMPORTED_MODULE_2__constants__=__nested_webpack_require_30906__(1),getFocusables=function(parents){return parents.reduce((function(acc,parent){return acc.concat(__nested_webpack_require_30906__.i(__WEBPACK_IMPORTED_MODULE_1__array__.a)(parent.querySelectorAll(__WEBPACK_IMPORTED_MODULE_0__tabbables__.a.join(","))))}),[])},getParentAutofocusables=function(parent){var parentFocus=parent.querySelectorAll("["+__WEBPACK_IMPORTED_MODULE_2__constants__.FOCUS_AUTO+"]");return __nested_webpack_require_30906__.i(__WEBPACK_IMPORTED_MODULE_1__array__.a)(parentFocus).map((function(node){return getFocusables([node])})).reduce((function(acc,nodes){return acc.concat(nodes)}),[])}},function(module,__nested_webpack_exports__,__webpack_require__){"use strict";__nested_webpack_exports__.a=["button:enabled:not([readonly])","select:enabled:not([readonly])","textarea:enabled:not([readonly])","input:enabled:not([readonly])","a[href]","area[href]","iframe","object","embed","[tabindex]","[contenteditable]","[autofocus]"]},function(module,exports){module.exports=function(rawScriptExports,compiledTemplate,scopeId,cssModules){var esModule,scriptExports=rawScriptExports=rawScriptExports||{},type=_typeof(rawScriptExports.default);"object"!==type&&"function"!==type||(esModule=rawScriptExports,scriptExports=rawScriptExports.default);var options="function"==typeof scriptExports?scriptExports.options:scriptExports;if(compiledTemplate&&(options.render=compiledTemplate.render,options.staticRenderFns=compiledTemplate.staticRenderFns),scopeId&&(options._scopeId=scopeId),cssModules){var computed=Object.create(options.computed||null);Object.keys(cssModules).forEach((function(key){var module=cssModules[key];computed[key]=function(){return module}})),options.computed=computed}return{esModule:esModule,exports:scriptExports,options:options}}},function(module,exports,__webpack_require__){module.exports={render:function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_vm.hasLeadingGuards?_c("div",{style:_vm.hidden,attrs:{tabIndex:_vm.disabled?-1:0}}):_vm._e(),_vm._v(" "),_vm.hasLeadingGuards?_c("div",{style:_vm.hidden,attrs:{tabIndex:_vm.disabled?-1:1}}):_vm._e(),_vm._v(" "),_c("div",_vm._b({attrs:{"data-lock":""},on:{focusout:_vm.onBlur}},"div",_vm.groupAttr,!1),[_vm._t("default")],2),_vm._v(" "),_vm.hasTailingGuards?_c("div",{style:_vm.hidden,attrs:{tabIndex:_vm.disabled?-1:0}}):_vm._e()])},staticRenderFns:[]},module.exports.render._withStripped=!0}])},"object"===_typeof(exports)&&"object"===_typeof(module)?module.exports=factory():(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},7463:function(__unused_webpack_module,exports,__webpack_require__){function DOMParser(options){this.options=options||{locator:{}}}function DOMHandler(){this.cdata=!1}function position(locator,node){node.lineNumber=locator.lineNumber,node.columnNumber=locator.columnNumber}function _locator(l){if(l)return"\n@"+(l.systemId||"")+"#[line:"+l.lineNumber+",col:"+l.columnNumber+"]"}function _toString(chars,start,length){return"string"==typeof chars?chars.substr(start,length):chars.length>=start+length||start?new java.lang.String(chars,start,length)+"":chars}function appendElement(hander,node){hander.currentElement?hander.currentElement.appendChild(node):hander.doc.appendChild(node)}DOMParser.prototype.parseFromString=function(source,mimeType){var options=this.options,sax=new XMLReader,domBuilder=options.domBuilder||new DOMHandler,errorHandler=options.errorHandler,locator=options.locator,defaultNSMap=options.xmlns||{},entityMap={lt:"<",gt:">",amp:"&",quot:'"',apos:"'"};return locator&&domBuilder.setDocumentLocator(locator),sax.errorHandler=function(errorImpl,domBuilder,locator){if(!errorImpl){if(domBuilder instanceof DOMHandler)return domBuilder;errorImpl=domBuilder}var errorHandler={},isCallback=errorImpl instanceof Function;function build(key){var fn=errorImpl[key];!fn&&isCallback&&(fn=2==errorImpl.length?function(msg){errorImpl(key,msg)}:errorImpl),errorHandler[key]=fn&&function(msg){fn("[xmldom "+key+"]\t"+msg+_locator(locator))}||function(){}}return locator=locator||{},build("warning"),build("error"),build("fatalError"),errorHandler}(errorHandler,domBuilder,locator),sax.domBuilder=options.domBuilder||domBuilder,/\/x?html?$/.test(mimeType)&&(entityMap.nbsp=" ",entityMap.copy="©",defaultNSMap[""]="http://www.w3.org/1999/xhtml"),defaultNSMap.xml=defaultNSMap.xml||"http://www.w3.org/XML/1998/namespace",source?sax.parse(source,defaultNSMap,entityMap):sax.errorHandler.error("invalid doc source"),domBuilder.doc},DOMHandler.prototype={startDocument:function(){this.doc=(new DOMImplementation).createDocument(null,null,null),this.locator&&(this.doc.documentURI=this.locator.systemId)},startElement:function(namespaceURI,localName,qName,attrs){var doc=this.doc,el=doc.createElementNS(namespaceURI,qName||localName),len=attrs.length;appendElement(this,el),this.currentElement=el,this.locator&&position(this.locator,el);for(var i=0;i<len;i++){namespaceURI=attrs.getURI(i);var value=attrs.getValue(i),attr=(qName=attrs.getQName(i),doc.createAttributeNS(namespaceURI,qName));this.locator&&position(attrs.getLocator(i),attr),attr.value=attr.nodeValue=value,el.setAttributeNode(attr)}},endElement:function(namespaceURI,localName,qName){var current=this.currentElement;current.tagName;this.currentElement=current.parentNode},startPrefixMapping:function(prefix,uri){},endPrefixMapping:function(prefix){},processingInstruction:function(target,data){var ins=this.doc.createProcessingInstruction(target,data);this.locator&&position(this.locator,ins),appendElement(this,ins)},ignorableWhitespace:function(ch,start,length){},characters:function(chars,start,length){if(chars=_toString.apply(this,arguments)){if(this.cdata)var charNode=this.doc.createCDATASection(chars);else charNode=this.doc.createTextNode(chars);this.currentElement?this.currentElement.appendChild(charNode):/^\s*$/.test(chars)&&this.doc.appendChild(charNode),this.locator&&position(this.locator,charNode)}},skippedEntity:function(name){},endDocument:function(){this.doc.normalize()},setDocumentLocator:function(locator){(this.locator=locator)&&(locator.lineNumber=0)},comment:function(chars,start,length){chars=_toString.apply(this,arguments);var comm=this.doc.createComment(chars);this.locator&&position(this.locator,comm),appendElement(this,comm)},startCDATA:function(){this.cdata=!0},endCDATA:function(){this.cdata=!1},startDTD:function(name,publicId,systemId){var impl=this.doc.implementation;if(impl&&impl.createDocumentType){var dt=impl.createDocumentType(name,publicId,systemId);this.locator&&position(this.locator,dt),appendElement(this,dt)}},warning:function(error){console.warn("[xmldom warning]\t"+error,_locator(this.locator))},error:function(_error){console.error("[xmldom error]\t"+_error,_locator(this.locator))},fatalError:function(error){throw console.error("[xmldom fatalError]\t"+error,_locator(this.locator)),error}},"endDTD,startEntity,endEntity,attributeDecl,elementDecl,externalEntityDecl,internalEntityDecl,resolveEntity,getExternalSubset,notationDecl,unparsedEntityDecl".replace(/\w+/g,(function(key){DOMHandler.prototype[key]=function(){return null}}));var XMLReader=__webpack_require__(2583).G,DOMImplementation=__webpack_require__(192).DOMImplementation;exports.XMLSerializer=__webpack_require__(192).XMLSerializer,exports.a=DOMParser},192:function(__unused_webpack_module,exports){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function copy(src,dest){for(var p in src)dest[p]=src[p]}function _extends(Class,Super){var pt=Class.prototype;if(Object.create){var ppt=Object.create(Super.prototype);pt.__proto__=ppt}if(!(pt instanceof Super)){var t=function(){};t.prototype=Super.prototype,copy(pt,t=new t),Class.prototype=pt=t}pt.constructor!=Class&&("function"!=typeof Class&&console.error("unknow Class:"+Class),pt.constructor=Class)}var htmlns="http://www.w3.org/1999/xhtml",NodeType={},ELEMENT_NODE=NodeType.ELEMENT_NODE=1,ATTRIBUTE_NODE=NodeType.ATTRIBUTE_NODE=2,TEXT_NODE=NodeType.TEXT_NODE=3,CDATA_SECTION_NODE=NodeType.CDATA_SECTION_NODE=4,ENTITY_REFERENCE_NODE=NodeType.ENTITY_REFERENCE_NODE=5,ENTITY_NODE=NodeType.ENTITY_NODE=6,PROCESSING_INSTRUCTION_NODE=NodeType.PROCESSING_INSTRUCTION_NODE=7,COMMENT_NODE=NodeType.COMMENT_NODE=8,DOCUMENT_NODE=NodeType.DOCUMENT_NODE=9,DOCUMENT_TYPE_NODE=NodeType.DOCUMENT_TYPE_NODE=10,DOCUMENT_FRAGMENT_NODE=NodeType.DOCUMENT_FRAGMENT_NODE=11,NOTATION_NODE=NodeType.NOTATION_NODE=12,ExceptionCode={},ExceptionMessage={},HIERARCHY_REQUEST_ERR=(ExceptionCode.INDEX_SIZE_ERR=(ExceptionMessage[1]="Index size error",1),ExceptionCode.DOMSTRING_SIZE_ERR=(ExceptionMessage[2]="DOMString size error",2),ExceptionCode.HIERARCHY_REQUEST_ERR=(ExceptionMessage[3]="Hierarchy request error",3)),NOT_FOUND_ERR=(ExceptionCode.WRONG_DOCUMENT_ERR=(ExceptionMessage[4]="Wrong document",4),ExceptionCode.INVALID_CHARACTER_ERR=(ExceptionMessage[5]="Invalid character",5),ExceptionCode.NO_DATA_ALLOWED_ERR=(ExceptionMessage[6]="No data allowed",6),ExceptionCode.NO_MODIFICATION_ALLOWED_ERR=(ExceptionMessage[7]="No modification allowed",7),ExceptionCode.NOT_FOUND_ERR=(ExceptionMessage[8]="Not found",8)),INUSE_ATTRIBUTE_ERR=(ExceptionCode.NOT_SUPPORTED_ERR=(ExceptionMessage[9]="Not supported",9),ExceptionCode.INUSE_ATTRIBUTE_ERR=(ExceptionMessage[10]="Attribute in use",10));ExceptionCode.INVALID_STATE_ERR=(ExceptionMessage[11]="Invalid state",11),ExceptionCode.SYNTAX_ERR=(ExceptionMessage[12]="Syntax error",12),ExceptionCode.INVALID_MODIFICATION_ERR=(ExceptionMessage[13]="Invalid modification",13),ExceptionCode.NAMESPACE_ERR=(ExceptionMessage[14]="Invalid namespace",14),ExceptionCode.INVALID_ACCESS_ERR=(ExceptionMessage[15]="Invalid access",15);function DOMException(code,message){if(message instanceof Error)var error=message;else error=this,Error.call(this,ExceptionMessage[code]),this.message=ExceptionMessage[code],Error.captureStackTrace&&Error.captureStackTrace(this,DOMException);return error.code=code,message&&(this.message=this.message+": "+message),error}function NodeList(){}function LiveNodeList(node,refresh){this._node=node,this._refresh=refresh,_updateLiveList(this)}function _updateLiveList(list){var inc=list._node._inc||list._node.ownerDocument._inc;if(list._inc!=inc){var ls=list._refresh(list._node);__set__(list,"length",ls.length),copy(ls,list),list._inc=inc}}function NamedNodeMap(){}function _findNodeIndex(list,node){for(var i=list.length;i--;)if(list[i]===node)return i}function _addNamedNode(el,list,newAttr,oldAttr){if(oldAttr?list[_findNodeIndex(list,oldAttr)]=newAttr:list[list.length++]=newAttr,el){newAttr.ownerElement=el;var doc=el.ownerDocument;doc&&(oldAttr&&_onRemoveAttribute(doc,el,oldAttr),function(doc,el,newAttr){doc&&doc._inc++;var ns=newAttr.namespaceURI;"http://www.w3.org/2000/xmlns/"==ns&&(el._nsMap[newAttr.prefix?newAttr.localName:""]=newAttr.value)}(doc,el,newAttr))}}function _removeNamedNode(el,list,attr){var i=_findNodeIndex(list,attr);if(!(i>=0))throw DOMException(NOT_FOUND_ERR,new Error(el.tagName+"@"+attr));for(var lastIndex=list.length-1;i<lastIndex;)list[i]=list[++i];if(list.length=lastIndex,el){var doc=el.ownerDocument;doc&&(_onRemoveAttribute(doc,el,attr),attr.ownerElement=null)}}function DOMImplementation(features){if(this._features={},features)for(var feature in features)this._features=features[feature]}function Node(){}function _xmlEncoder(c){return("<"==c?"&lt;":">"==c&&"&gt;")||"&"==c&&"&amp;"||'"'==c&&"&quot;"||"&#"+c.charCodeAt()+";"}function _visitNode(node,callback){if(callback(node))return!0;if(node=node.firstChild)do{if(_visitNode(node,callback))return!0}while(node=node.nextSibling)}function Document(){}function _onRemoveAttribute(doc,el,newAttr,remove){doc&&doc._inc++,"http://www.w3.org/2000/xmlns/"==newAttr.namespaceURI&&delete el._nsMap[newAttr.prefix?newAttr.localName:""]}function _onUpdateChild(doc,el,newChild){if(doc&&doc._inc){doc._inc++;var cs=el.childNodes;if(newChild)cs[cs.length++]=newChild;else{for(var child=el.firstChild,i=0;child;)cs[i++]=child,child=child.nextSibling;cs.length=i}}}function _removeChild(parentNode,child){var previous=child.previousSibling,next=child.nextSibling;return previous?previous.nextSibling=next:parentNode.firstChild=next,next?next.previousSibling=previous:parentNode.lastChild=previous,_onUpdateChild(parentNode.ownerDocument,parentNode),child}function _insertBefore(parentNode,newChild,nextChild){var cp=newChild.parentNode;if(cp&&cp.removeChild(newChild),newChild.nodeType===DOCUMENT_FRAGMENT_NODE){var newFirst=newChild.firstChild;if(null==newFirst)return newChild;var newLast=newChild.lastChild}else newFirst=newLast=newChild;var pre=nextChild?nextChild.previousSibling:parentNode.lastChild;newFirst.previousSibling=pre,newLast.nextSibling=nextChild,pre?pre.nextSibling=newFirst:parentNode.firstChild=newFirst,null==nextChild?parentNode.lastChild=newLast:nextChild.previousSibling=newLast;do{newFirst.parentNode=parentNode}while(newFirst!==newLast&&(newFirst=newFirst.nextSibling));return _onUpdateChild(parentNode.ownerDocument||parentNode,parentNode),newChild.nodeType==DOCUMENT_FRAGMENT_NODE&&(newChild.firstChild=newChild.lastChild=null),newChild}function Element(){this._nsMap={}}function Attr(){}function CharacterData(){}function Text(){}function Comment(){}function CDATASection(){}function DocumentType(){}function Notation(){}function Entity(){}function EntityReference(){}function DocumentFragment(){}function ProcessingInstruction(){}function XMLSerializer(){}function nodeSerializeToString(isHtml,nodeFilter){var buf=[],refNode=9==this.nodeType?this.documentElement:this,prefix=refNode.prefix,uri=refNode.namespaceURI;if(uri&&null==prefix&&null==(prefix=refNode.lookupPrefix(uri)))var visibleNamespaces=[{namespace:uri,prefix:null}];return serializeToString(this,buf,isHtml,nodeFilter,visibleNamespaces),buf.join("")}function needNamespaceDefine(node,isHTML,visibleNamespaces){var prefix=node.prefix||"",uri=node.namespaceURI;if(!prefix&&!uri)return!1;if("xml"===prefix&&"http://www.w3.org/XML/1998/namespace"===uri||"http://www.w3.org/2000/xmlns/"==uri)return!1;for(var i=visibleNamespaces.length;i--;){var ns=visibleNamespaces[i];if(ns.prefix==prefix)return ns.namespace!=uri}return!0}function serializeToString(node,buf,isHTML,nodeFilter,visibleNamespaces){if(nodeFilter){if(!(node=nodeFilter(node)))return;if("string"==typeof node)return void buf.push(node)}switch(node.nodeType){case ELEMENT_NODE:visibleNamespaces||(visibleNamespaces=[]);visibleNamespaces.length;var attrs=node.attributes,len=attrs.length,child=node.firstChild,nodeName=node.tagName;isHTML=htmlns===node.namespaceURI||isHTML,buf.push("<",nodeName);for(var i=0;i<len;i++){"xmlns"==(attr=attrs.item(i)).prefix?visibleNamespaces.push({prefix:attr.localName,namespace:attr.value}):"xmlns"==attr.nodeName&&visibleNamespaces.push({prefix:"",namespace:attr.value})}for(i=0;i<len;i++){var attr;if(needNamespaceDefine(attr=attrs.item(i),0,visibleNamespaces)){var prefix=attr.prefix||"",uri=attr.namespaceURI,ns=prefix?" xmlns:"+prefix:" xmlns";buf.push(ns,'="',uri,'"'),visibleNamespaces.push({prefix:prefix,namespace:uri})}serializeToString(attr,buf,isHTML,nodeFilter,visibleNamespaces)}if(needNamespaceDefine(node,0,visibleNamespaces)){prefix=node.prefix||"",uri=node.namespaceURI,ns=prefix?" xmlns:"+prefix:" xmlns";buf.push(ns,'="',uri,'"'),visibleNamespaces.push({prefix:prefix,namespace:uri})}if(child||isHTML&&!/^(?:meta|link|img|br|hr|input)$/i.test(nodeName)){if(buf.push(">"),isHTML&&/^script$/i.test(nodeName))for(;child;)child.data?buf.push(child.data):serializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces),child=child.nextSibling;else for(;child;)serializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces),child=child.nextSibling;buf.push("</",nodeName,">")}else buf.push("/>");return;case DOCUMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(child=node.firstChild;child;)serializeToString(child,buf,isHTML,nodeFilter,visibleNamespaces),child=child.nextSibling;return;case ATTRIBUTE_NODE:return buf.push(" ",node.name,'="',node.value.replace(/[<&"]/g,_xmlEncoder),'"');case TEXT_NODE:return buf.push(node.data.replace(/[<&]/g,_xmlEncoder));case CDATA_SECTION_NODE:return buf.push("<![CDATA[",node.data,"]]>");case COMMENT_NODE:return buf.push("\x3c!--",node.data,"--\x3e");case DOCUMENT_TYPE_NODE:var pubid=node.publicId,sysid=node.systemId;if(buf.push("<!DOCTYPE ",node.name),pubid)buf.push(' PUBLIC "',pubid),sysid&&"."!=sysid&&buf.push('" "',sysid),buf.push('">');else if(sysid&&"."!=sysid)buf.push(' SYSTEM "',sysid,'">');else{var sub=node.internalSubset;sub&&buf.push(" [",sub,"]"),buf.push(">")}return;case PROCESSING_INSTRUCTION_NODE:return buf.push("<?",node.target," ",node.data,"?>");case ENTITY_REFERENCE_NODE:return buf.push("&",node.nodeName,";");default:buf.push("??",node.nodeName)}}function _importNode(doc,node,deep){var node2;switch(node.nodeType){case ELEMENT_NODE:(node2=node.cloneNode(!1)).ownerDocument=doc;case DOCUMENT_FRAGMENT_NODE:break;case ATTRIBUTE_NODE:deep=!0}if(node2||(node2=node.cloneNode(!1)),node2.ownerDocument=doc,node2.parentNode=null,deep)for(var child=node.firstChild;child;)node2.appendChild(_importNode(doc,child,deep)),child=child.nextSibling;return node2}function _cloneNode(doc,node,deep){var node2=new node.constructor;for(var n in node){var v=node[n];"object"!=_typeof(v)&&v!=node2[n]&&(node2[n]=v)}switch(node.childNodes&&(node2.childNodes=new NodeList),node2.ownerDocument=doc,node2.nodeType){case ELEMENT_NODE:var attrs=node.attributes,attrs2=node2.attributes=new NamedNodeMap,len=attrs.length;attrs2._ownerElement=node2;for(var i=0;i<len;i++)node2.setAttributeNode(_cloneNode(doc,attrs.item(i),!0));break;case ATTRIBUTE_NODE:deep=!0}if(deep)for(var child=node.firstChild;child;)node2.appendChild(_cloneNode(doc,child,deep)),child=child.nextSibling;return node2}function __set__(object,key,value){object[key]=value}DOMException.prototype=Error.prototype,copy(ExceptionCode,DOMException),NodeList.prototype={length:0,item:function(index){return this[index]||null},toString:function(isHTML,nodeFilter){for(var buf=[],i=0;i<this.length;i++)serializeToString(this[i],buf,isHTML,nodeFilter);return buf.join("")}},LiveNodeList.prototype.item=function(i){return _updateLiveList(this),this[i]},_extends(LiveNodeList,NodeList),NamedNodeMap.prototype={length:0,item:NodeList.prototype.item,getNamedItem:function(key){for(var i=this.length;i--;){var attr=this[i];if(attr.nodeName==key)return attr}},setNamedItem:function(attr){var el=attr.ownerElement;if(el&&el!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);var oldAttr=this.getNamedItem(attr.nodeName);return _addNamedNode(this._ownerElement,this,attr,oldAttr),oldAttr},setNamedItemNS:function(attr){var oldAttr,el=attr.ownerElement;if(el&&el!=this._ownerElement)throw new DOMException(INUSE_ATTRIBUTE_ERR);return oldAttr=this.getNamedItemNS(attr.namespaceURI,attr.localName),_addNamedNode(this._ownerElement,this,attr,oldAttr),oldAttr},removeNamedItem:function(key){var attr=this.getNamedItem(key);return _removeNamedNode(this._ownerElement,this,attr),attr},removeNamedItemNS:function(namespaceURI,localName){var attr=this.getNamedItemNS(namespaceURI,localName);return _removeNamedNode(this._ownerElement,this,attr),attr},getNamedItemNS:function(namespaceURI,localName){for(var i=this.length;i--;){var node=this[i];if(node.localName==localName&&node.namespaceURI==namespaceURI)return node}return null}},DOMImplementation.prototype={hasFeature:function(feature,version){var versions=this._features[feature.toLowerCase()];return!(!versions||version&&!(version in versions))},createDocument:function(namespaceURI,qualifiedName,doctype){var doc=new Document;if(doc.implementation=this,doc.childNodes=new NodeList,doc.doctype=doctype,doctype&&doc.appendChild(doctype),qualifiedName){var root=doc.createElementNS(namespaceURI,qualifiedName);doc.appendChild(root)}return doc},createDocumentType:function(qualifiedName,publicId,systemId){var node=new DocumentType;return node.name=qualifiedName,node.nodeName=qualifiedName,node.publicId=publicId,node.systemId=systemId,node}},Node.prototype={firstChild:null,lastChild:null,previousSibling:null,nextSibling:null,attributes:null,parentNode:null,childNodes:null,ownerDocument:null,nodeValue:null,namespaceURI:null,prefix:null,localName:null,insertBefore:function(newChild,refChild){return _insertBefore(this,newChild,refChild)},replaceChild:function(newChild,oldChild){this.insertBefore(newChild,oldChild),oldChild&&this.removeChild(oldChild)},removeChild:function(oldChild){return _removeChild(this,oldChild)},appendChild:function(newChild){return this.insertBefore(newChild,null)},hasChildNodes:function(){return null!=this.firstChild},cloneNode:function(deep){return _cloneNode(this.ownerDocument||this,this,deep)},normalize:function(){for(var child=this.firstChild;child;){var next=child.nextSibling;next&&next.nodeType==TEXT_NODE&&child.nodeType==TEXT_NODE?(this.removeChild(next),child.appendData(next.data)):(child.normalize(),child=next)}},isSupported:function(feature,version){return this.ownerDocument.implementation.hasFeature(feature,version)},hasAttributes:function(){return this.attributes.length>0},lookupPrefix:function(namespaceURI){for(var el=this;el;){var map=el._nsMap;if(map)for(var n in map)if(map[n]==namespaceURI)return n;el=el.nodeType==ATTRIBUTE_NODE?el.ownerDocument:el.parentNode}return null},lookupNamespaceURI:function(prefix){for(var el=this;el;){var map=el._nsMap;if(map&&prefix in map)return map[prefix];el=el.nodeType==ATTRIBUTE_NODE?el.ownerDocument:el.parentNode}return null},isDefaultNamespace:function(namespaceURI){return null==this.lookupPrefix(namespaceURI)}},copy(NodeType,Node),copy(NodeType,Node.prototype),Document.prototype={nodeName:"#document",nodeType:DOCUMENT_NODE,doctype:null,documentElement:null,_inc:1,insertBefore:function(newChild,refChild){if(newChild.nodeType==DOCUMENT_FRAGMENT_NODE){for(var child=newChild.firstChild;child;){var next=child.nextSibling;this.insertBefore(child,refChild),child=next}return newChild}return null==this.documentElement&&newChild.nodeType==ELEMENT_NODE&&(this.documentElement=newChild),_insertBefore(this,newChild,refChild),newChild.ownerDocument=this,newChild},removeChild:function(oldChild){return this.documentElement==oldChild&&(this.documentElement=null),_removeChild(this,oldChild)},importNode:function(importedNode,deep){return _importNode(this,importedNode,deep)},getElementById:function(id){var rtv=null;return _visitNode(this.documentElement,(function(node){if(node.nodeType==ELEMENT_NODE&&node.getAttribute("id")==id)return rtv=node,!0})),rtv},createElement:function(tagName){var node=new Element;return node.ownerDocument=this,node.nodeName=tagName,node.tagName=tagName,node.childNodes=new NodeList,(node.attributes=new NamedNodeMap)._ownerElement=node,node},createDocumentFragment:function(){var node=new DocumentFragment;return node.ownerDocument=this,node.childNodes=new NodeList,node},createTextNode:function(data){var node=new Text;return node.ownerDocument=this,node.appendData(data),node},createComment:function(data){var node=new Comment;return node.ownerDocument=this,node.appendData(data),node},createCDATASection:function(data){var node=new CDATASection;return node.ownerDocument=this,node.appendData(data),node},createProcessingInstruction:function(target,data){var node=new ProcessingInstruction;return node.ownerDocument=this,node.tagName=node.target=target,node.nodeValue=node.data=data,node},createAttribute:function(name){var node=new Attr;return node.ownerDocument=this,node.name=name,node.nodeName=name,node.localName=name,node.specified=!0,node},createEntityReference:function(name){var node=new EntityReference;return node.ownerDocument=this,node.nodeName=name,node},createElementNS:function(namespaceURI,qualifiedName){var node=new Element,pl=qualifiedName.split(":"),attrs=node.attributes=new NamedNodeMap;return node.childNodes=new NodeList,node.ownerDocument=this,node.nodeName=qualifiedName,node.tagName=qualifiedName,node.namespaceURI=namespaceURI,2==pl.length?(node.prefix=pl[0],node.localName=pl[1]):node.localName=qualifiedName,attrs._ownerElement=node,node},createAttributeNS:function(namespaceURI,qualifiedName){var node=new Attr,pl=qualifiedName.split(":");return node.ownerDocument=this,node.nodeName=qualifiedName,node.name=qualifiedName,node.namespaceURI=namespaceURI,node.specified=!0,2==pl.length?(node.prefix=pl[0],node.localName=pl[1]):node.localName=qualifiedName,node}},_extends(Document,Node),Element.prototype={nodeType:ELEMENT_NODE,hasAttribute:function(name){return null!=this.getAttributeNode(name)},getAttribute:function(name){var attr=this.getAttributeNode(name);return attr&&attr.value||""},getAttributeNode:function(name){return this.attributes.getNamedItem(name)},setAttribute:function(name,value){var attr=this.ownerDocument.createAttribute(name);attr.value=attr.nodeValue=""+value,this.setAttributeNode(attr)},removeAttribute:function(name){var attr=this.getAttributeNode(name);attr&&this.removeAttributeNode(attr)},appendChild:function(newChild){return newChild.nodeType===DOCUMENT_FRAGMENT_NODE?this.insertBefore(newChild,null):function(parentNode,newChild){var cp=newChild.parentNode;if(cp){var pre=parentNode.lastChild;cp.removeChild(newChild),pre=parentNode.lastChild}return pre=parentNode.lastChild,newChild.parentNode=parentNode,newChild.previousSibling=pre,newChild.nextSibling=null,pre?pre.nextSibling=newChild:parentNode.firstChild=newChild,parentNode.lastChild=newChild,_onUpdateChild(parentNode.ownerDocument,parentNode,newChild),newChild}(this,newChild)},setAttributeNode:function(newAttr){return this.attributes.setNamedItem(newAttr)},setAttributeNodeNS:function(newAttr){return this.attributes.setNamedItemNS(newAttr)},removeAttributeNode:function(oldAttr){return this.attributes.removeNamedItem(oldAttr.nodeName)},removeAttributeNS:function(namespaceURI,localName){var old=this.getAttributeNodeNS(namespaceURI,localName);old&&this.removeAttributeNode(old)},hasAttributeNS:function(namespaceURI,localName){return null!=this.getAttributeNodeNS(namespaceURI,localName)},getAttributeNS:function(namespaceURI,localName){var attr=this.getAttributeNodeNS(namespaceURI,localName);return attr&&attr.value||""},setAttributeNS:function(namespaceURI,qualifiedName,value){var attr=this.ownerDocument.createAttributeNS(namespaceURI,qualifiedName);attr.value=attr.nodeValue=""+value,this.setAttributeNode(attr)},getAttributeNodeNS:function(namespaceURI,localName){return this.attributes.getNamedItemNS(namespaceURI,localName)},getElementsByTagName:function(tagName){return new LiveNodeList(this,(function(base){var ls=[];return _visitNode(base,(function(node){node===base||node.nodeType!=ELEMENT_NODE||"*"!==tagName&&node.tagName!=tagName||ls.push(node)})),ls}))},getElementsByTagNameNS:function(namespaceURI,localName){return new LiveNodeList(this,(function(base){var ls=[];return _visitNode(base,(function(node){node===base||node.nodeType!==ELEMENT_NODE||"*"!==namespaceURI&&node.namespaceURI!==namespaceURI||"*"!==localName&&node.localName!=localName||ls.push(node)})),ls}))}},Document.prototype.getElementsByTagName=Element.prototype.getElementsByTagName,Document.prototype.getElementsByTagNameNS=Element.prototype.getElementsByTagNameNS,_extends(Element,Node),Attr.prototype.nodeType=ATTRIBUTE_NODE,_extends(Attr,Node),CharacterData.prototype={data:"",substringData:function(offset,count){return this.data.substring(offset,offset+count)},appendData:function(text){text=this.data+text,this.nodeValue=this.data=text,this.length=text.length},insertData:function(offset,text){this.replaceData(offset,0,text)},appendChild:function(newChild){throw new Error(ExceptionMessage[HIERARCHY_REQUEST_ERR])},deleteData:function(offset,count){this.replaceData(offset,count,"")},replaceData:function(offset,count,text){text=this.data.substring(0,offset)+text+this.data.substring(offset+count),this.nodeValue=this.data=text,this.length=text.length}},_extends(CharacterData,Node),Text.prototype={nodeName:"#text",nodeType:TEXT_NODE,splitText:function(offset){var text=this.data,newText=text.substring(offset);text=text.substring(0,offset),this.data=this.nodeValue=text,this.length=text.length;var newNode=this.ownerDocument.createTextNode(newText);return this.parentNode&&this.parentNode.insertBefore(newNode,this.nextSibling),newNode}},_extends(Text,CharacterData),Comment.prototype={nodeName:"#comment",nodeType:COMMENT_NODE},_extends(Comment,CharacterData),CDATASection.prototype={nodeName:"#cdata-section",nodeType:CDATA_SECTION_NODE},_extends(CDATASection,CharacterData),DocumentType.prototype.nodeType=DOCUMENT_TYPE_NODE,_extends(DocumentType,Node),Notation.prototype.nodeType=NOTATION_NODE,_extends(Notation,Node),Entity.prototype.nodeType=ENTITY_NODE,_extends(Entity,Node),EntityReference.prototype.nodeType=ENTITY_REFERENCE_NODE,_extends(EntityReference,Node),DocumentFragment.prototype.nodeName="#document-fragment",DocumentFragment.prototype.nodeType=DOCUMENT_FRAGMENT_NODE,_extends(DocumentFragment,Node),ProcessingInstruction.prototype.nodeType=PROCESSING_INSTRUCTION_NODE,_extends(ProcessingInstruction,Node),XMLSerializer.prototype.serializeToString=function(node,isHtml,nodeFilter){return nodeSerializeToString.call(node,isHtml,nodeFilter)},Node.prototype.toString=nodeSerializeToString;try{if(Object.defineProperty){var getTextContent=function getTextContent(node){switch(node.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:var buf=[];for(node=node.firstChild;node;)7!==node.nodeType&&8!==node.nodeType&&buf.push(getTextContent(node)),node=node.nextSibling;return buf.join("");default:return node.nodeValue}};Object.defineProperty(LiveNodeList.prototype,"length",{get:function(){return _updateLiveList(this),this.$$length}}),Object.defineProperty(Node.prototype,"textContent",{get:function(){return getTextContent(this)},set:function(data){switch(this.nodeType){case ELEMENT_NODE:case DOCUMENT_FRAGMENT_NODE:for(;this.firstChild;)this.removeChild(this.firstChild);(data||String(data))&&this.appendChild(this.ownerDocument.createTextNode(data));break;default:this.data=data,this.value=data,this.nodeValue=data}}}),__set__=function(object,key,value){object["$$"+key]=value}}}catch(e){}exports.DOMImplementation=DOMImplementation,exports.XMLSerializer=XMLSerializer},2583:function(__unused_webpack_module,exports){var nameStartChar=/[A-Z_a-z\xC0-\xD6\xD8-\xF6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,nameChar=new RegExp("[\\-\\.0-9"+nameStartChar.source.slice(1,-1)+"\\u00B7\\u0300-\\u036F\\u203F-\\u2040]"),tagNamePattern=new RegExp("^"+nameStartChar.source+nameChar.source+"*(?::"+nameStartChar.source+nameChar.source+"*)?$"),S_TAG=0,S_ATTR=1,S_ATTR_SPACE=2,S_EQ=3,S_ATTR_NOQUOT_VALUE=4,S_ATTR_END=5,S_TAG_SPACE=6,S_TAG_CLOSE=7;function XMLReader(){}function copyLocator(f,t){return t.lineNumber=f.lineNumber,t.columnNumber=f.columnNumber,t}function parseElementStartPart(source,start,el,currentNSMap,entityReplacer,errorHandler){for(var attrName,p=++start,s=S_TAG;;){var c=source.charAt(p);switch(c){case"=":if(s===S_ATTR)attrName=source.slice(start,p),s=S_EQ;else{if(s!==S_ATTR_SPACE)throw new Error("attribute equal must after attrName");s=S_EQ}break;case"'":case'"':if(s===S_EQ||s===S_ATTR){if(s===S_ATTR&&(errorHandler.warning('attribute value must after "="'),attrName=source.slice(start,p)),start=p+1,!((p=source.indexOf(c,start))>0))throw new Error("attribute value no end '"+c+"' match");value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer),el.add(attrName,value,start-1),s=S_ATTR_END}else{if(s!=S_ATTR_NOQUOT_VALUE)throw new Error('attribute value must after "="');value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer),el.add(attrName,value,start),errorHandler.warning('attribute "'+attrName+'" missed start quot('+c+")!!"),start=p+1,s=S_ATTR_END}break;case"/":switch(s){case S_TAG:el.setTagName(source.slice(start,p));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:s=S_TAG_CLOSE,el.closed=!0;case S_ATTR_NOQUOT_VALUE:case S_ATTR:case S_ATTR_SPACE:break;default:throw new Error("attribute invalid close char('/')")}break;case"":return errorHandler.error("unexpected end of input"),s==S_TAG&&el.setTagName(source.slice(start,p)),p;case">":switch(s){case S_TAG:el.setTagName(source.slice(start,p));case S_ATTR_END:case S_TAG_SPACE:case S_TAG_CLOSE:break;case S_ATTR_NOQUOT_VALUE:case S_ATTR:"/"===(value=source.slice(start,p)).slice(-1)&&(el.closed=!0,value=value.slice(0,-1));case S_ATTR_SPACE:s===S_ATTR_SPACE&&(value=attrName),s==S_ATTR_NOQUOT_VALUE?(errorHandler.warning('attribute "'+value+'" missed quot(")!!'),el.add(attrName,value.replace(/&#?\w+;/g,entityReplacer),start)):("http://www.w3.org/1999/xhtml"===currentNSMap[""]&&value.match(/^(?:disabled|checked|selected)$/i)||errorHandler.warning('attribute "'+value+'" missed value!! "'+value+'" instead!!'),el.add(value,value,start));break;case S_EQ:throw new Error("attribute value missed!!")}return p;case"":c=" ";default:if(c<=" ")switch(s){case S_TAG:el.setTagName(source.slice(start,p)),s=S_TAG_SPACE;break;case S_ATTR:attrName=source.slice(start,p),s=S_ATTR_SPACE;break;case S_ATTR_NOQUOT_VALUE:var value=source.slice(start,p).replace(/&#?\w+;/g,entityReplacer);errorHandler.warning('attribute "'+value+'" missed quot(")!!'),el.add(attrName,value,start);case S_ATTR_END:s=S_TAG_SPACE}else switch(s){case S_ATTR_SPACE:el.tagName;"http://www.w3.org/1999/xhtml"===currentNSMap[""]&&attrName.match(/^(?:disabled|checked|selected)$/i)||errorHandler.warning('attribute "'+attrName+'" missed value!! "'+attrName+'" instead2!!'),el.add(attrName,attrName,start),start=p,s=S_ATTR;break;case S_ATTR_END:errorHandler.warning('attribute space is required"'+attrName+'"!!');case S_TAG_SPACE:s=S_ATTR,start=p;break;case S_EQ:s=S_ATTR_NOQUOT_VALUE,start=p;break;case S_TAG_CLOSE:throw new Error("elements closed character '/' and '>' must be connected to")}}p++}}function appendElement(el,domBuilder,currentNSMap){for(var tagName=el.tagName,localNSMap=null,i=el.length;i--;){var a=el[i],qName=a.qName,value=a.value;if((nsp=qName.indexOf(":"))>0)var prefix=a.prefix=qName.slice(0,nsp),localName=qName.slice(nsp+1),nsPrefix="xmlns"===prefix&&localName;else localName=qName,prefix=null,nsPrefix="xmlns"===qName&&"";a.localName=localName,!1!==nsPrefix&&(null==localNSMap&&(localNSMap={},_copy(currentNSMap,currentNSMap={})),currentNSMap[nsPrefix]=localNSMap[nsPrefix]=value,a.uri="http://www.w3.org/2000/xmlns/",domBuilder.startPrefixMapping(nsPrefix,value))}for(i=el.length;i--;){(prefix=(a=el[i]).prefix)&&("xml"===prefix&&(a.uri="http://www.w3.org/XML/1998/namespace"),"xmlns"!==prefix&&(a.uri=currentNSMap[prefix||""]))}var nsp;(nsp=tagName.indexOf(":"))>0?(prefix=el.prefix=tagName.slice(0,nsp),localName=el.localName=tagName.slice(nsp+1)):(prefix=null,localName=el.localName=tagName);var ns=el.uri=currentNSMap[prefix||""];if(domBuilder.startElement(ns,localName,tagName,el),!el.closed)return el.currentNSMap=currentNSMap,el.localNSMap=localNSMap,!0;if(domBuilder.endElement(ns,localName,tagName),localNSMap)for(prefix in localNSMap)domBuilder.endPrefixMapping(prefix)}function parseHtmlSpecialContent(source,elStartEnd,tagName,entityReplacer,domBuilder){if(/^(?:script|textarea)$/i.test(tagName)){var elEndStart=source.indexOf("</"+tagName+">",elStartEnd),text=source.substring(elStartEnd+1,elEndStart);if(/[&<]/.test(text))return/^script$/i.test(tagName)?(domBuilder.characters(text,0,text.length),elEndStart):(text=text.replace(/&#?\w+;/g,entityReplacer),domBuilder.characters(text,0,text.length),elEndStart)}return elStartEnd+1}function fixSelfClosed(source,elStartEnd,tagName,closeMap){var pos=closeMap[tagName];return null==pos&&((pos=source.lastIndexOf("</"+tagName+">"))<elStartEnd&&(pos=source.lastIndexOf("</"+tagName)),closeMap[tagName]=pos),pos<elStartEnd}function _copy(source,target){for(var n in source)target[n]=source[n]}function parseDCC(source,start,domBuilder,errorHandler){if("-"===source.charAt(start+2))return"-"===source.charAt(start+3)?(end=source.indexOf("--\x3e",start+4))>start?(domBuilder.comment(source,start+4,end-start-4),end+3):(errorHandler.error("Unclosed comment"),-1):-1;if("CDATA["==source.substr(start+3,6)){var end=source.indexOf("]]>",start+9);return domBuilder.startCDATA(),domBuilder.characters(source,start+9,end-start-9),domBuilder.endCDATA(),end+3}var matchs=function(source,start){var match,buf=[],reg=/'[^']+'|"[^"]+"|[^\s<>\/=]+=?|(\/?\s*>|<)/g;reg.lastIndex=start,reg.exec(source);for(;match=reg.exec(source);)if(buf.push(match),match[1])return buf}(source,start),len=matchs.length;if(len>1&&/!doctype/i.test(matchs[0][0])){var name=matchs[1][0],pubid=len>3&&/^public$/i.test(matchs[2][0])&&matchs[3][0],sysid=len>4&&matchs[4][0],lastMatch=matchs[len-1];return domBuilder.startDTD(name,pubid&&pubid.replace(/^(['"])(.*?)\1$/,"$2"),sysid&&sysid.replace(/^(['"])(.*?)\1$/,"$2")),domBuilder.endDTD(),lastMatch.index+lastMatch[0].length}return-1}function parseInstruction(source,start,domBuilder){var end=source.indexOf("?>",start);if(end){var match=source.substring(start,end).match(/^<\?(\S*)\s*([\s\S]*?)\s*$/);if(match){match[0].length;return domBuilder.processingInstruction(match[1],match[2]),end+2}return-1}return-1}function ElementAttributes(source){}function _set_proto_(thiz,parent){return thiz.__proto__=parent,thiz}XMLReader.prototype={parse:function(source,defaultNSMap,entityMap){var domBuilder=this.domBuilder;domBuilder.startDocument(),_copy(defaultNSMap,defaultNSMap={}),function(source,defaultNSMapCopy,entityMap,domBuilder,errorHandler){function fixedFromCharCode(code){if(code>65535){var surrogate1=55296+((code-=65536)>>10),surrogate2=56320+(1023&code);return String.fromCharCode(surrogate1,surrogate2)}return String.fromCharCode(code)}function entityReplacer(a){var k=a.slice(1,-1);return k in entityMap?entityMap[k]:"#"===k.charAt(0)?fixedFromCharCode(parseInt(k.substr(1).replace("x","0x"))):(errorHandler.error("entity not found:"+a),a)}function appendText(end){if(end>start){var xt=source.substring(start,end).replace(/&#?\w+;/g,entityReplacer);locator&&position(start),domBuilder.characters(xt,0,end-start),start=end}}function position(p,m){for(;p>=lineEnd&&(m=linePattern.exec(source));)lineStart=m.index,lineEnd=lineStart+m[0].length,locator.lineNumber++;locator.columnNumber=p-lineStart+1}var lineStart=0,lineEnd=0,linePattern=/.*(?:\r\n?|\n)|.*$/g,locator=domBuilder.locator,parseStack=[{currentNSMap:defaultNSMapCopy}],closeMap={},start=0;for(;;){try{var tagStart=source.indexOf("<",start);if(tagStart<0){if(!source.substr(start).match(/^\s*$/)){var doc=domBuilder.doc,text=doc.createTextNode(source.substr(start));doc.appendChild(text),domBuilder.currentElement=text}return}switch(tagStart>start&&appendText(tagStart),source.charAt(tagStart+1)){case"/":var end=source.indexOf(">",tagStart+3),tagName=source.substring(tagStart+2,end),config=parseStack.pop();end<0?(tagName=source.substring(tagStart+2).replace(/[\s<].*/,""),errorHandler.error("end tag name: "+tagName+" is not complete:"+config.tagName),end=tagStart+1+tagName.length):tagName.match(/\s</)&&(tagName=tagName.replace(/[\s<].*/,""),errorHandler.error("end tag name: "+tagName+" maybe not complete"),end=tagStart+1+tagName.length);var localNSMap=config.localNSMap,endMatch=config.tagName==tagName;if(endMatch||config.tagName&&config.tagName.toLowerCase()==tagName.toLowerCase()){if(domBuilder.endElement(config.uri,config.localName,tagName),localNSMap)for(var prefix in localNSMap)domBuilder.endPrefixMapping(prefix);endMatch||errorHandler.fatalError("end tag name: "+tagName+" is not match the current start tagName:"+config.tagName)}else parseStack.push(config);end++;break;case"?":locator&&position(tagStart),end=parseInstruction(source,tagStart,domBuilder);break;case"!":locator&&position(tagStart),end=parseDCC(source,tagStart,domBuilder,errorHandler);break;default:locator&&position(tagStart);var el=new ElementAttributes,currentNSMap=parseStack[parseStack.length-1].currentNSMap,len=(end=parseElementStartPart(source,tagStart,el,currentNSMap,entityReplacer,errorHandler),el.length);if(!el.closed&&fixSelfClosed(source,end,el.tagName,closeMap)&&(el.closed=!0,entityMap.nbsp||errorHandler.warning("unclosed xml attribute")),locator&&len){for(var locator2=copyLocator(locator,{}),i=0;i<len;i++){var a=el[i];position(a.offset),a.locator=copyLocator(locator,{})}domBuilder.locator=locator2,appendElement(el,domBuilder,currentNSMap)&&parseStack.push(el),domBuilder.locator=locator}else appendElement(el,domBuilder,currentNSMap)&&parseStack.push(el);"http://www.w3.org/1999/xhtml"!==el.uri||el.closed?end++:end=parseHtmlSpecialContent(source,end,el.tagName,entityReplacer,domBuilder)}}catch(e){errorHandler.error("element parse error: "+e),end=-1}end>start?start=end:appendText(Math.max(tagStart,start)+1)}}(source,defaultNSMap,entityMap,domBuilder,this.errorHandler),domBuilder.endDocument()}},ElementAttributes.prototype={setTagName:function(tagName){if(!tagNamePattern.test(tagName))throw new Error("invalid tagName:"+tagName);this.tagName=tagName},add:function(qName,value,offset){if(!tagNamePattern.test(qName))throw new Error("invalid attribute:"+qName);this[this.length++]={qName:qName,value:value,offset:offset}},length:0,getLocalName:function(i){return this[i].localName},getLocator:function(i){return this[i].locator},getQName:function(i){return this[i].qName},getURI:function(i){return this[i].uri},getValue:function(i){return this[i].value}},_set_proto_({},_set_proto_.prototype)instanceof _set_proto_||(_set_proto_=function(thiz,parent){function p(){}for(parent in p.prototype=parent,p=new p,thiz)p[parent]=thiz[parent];return p}),exports.G=XMLReader}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={id:moduleId,loaded:!1,exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,{a:getter}),getter},__webpack_require__.d=function(exports,definition){for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.nmd=function(module){return module.paths=[],module.children||(module.children=[]),module},function(){var scriptUrl;__webpack_require__.g.importScripts&&(scriptUrl=__webpack_require__.g.location+"");var document=__webpack_require__.g.document;if(!scriptUrl&&document&&(document.currentScript&&(scriptUrl=document.currentScript.src),!scriptUrl)){var scripts=document.getElementsByTagName("script");if(scripts.length)for(var i=scripts.length-1;i>-1&&!scriptUrl;)scriptUrl=scripts[i--].src}if(!scriptUrl)throw new Error("Automatic publicPath is not supported in this browser");scriptUrl=scriptUrl.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=scriptUrl}(),function(){"use strict";var urls,external_kolibriCoreAppGlobal_namespaceObject=kolibriCoreAppGlobal,external_kolibriCoreAppGlobal_default=__webpack_require__.n(external_kolibriCoreAppGlobal_namespaceObject),external_kolibriCoreAppGlobal_urls_namespaceObject=kolibriCoreAppGlobal.urls;function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _toPropertyKey(t){var i=function(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:String(i)}urls=__webpack_require__.n(external_kolibriCoreAppGlobal_urls_namespaceObject)(),__webpack_require__.p=urls.static("".concat("kolibri.plugins.epub_viewer.main","/"));var KolibriModule=function(){function KolibriModule(options){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,KolibriModule),this.name="kolibri.plugins.epub_viewer.main";var safeOptions={};this.kolibriModuleOptions.forEach((function(option){options[option]&&(safeOptions[option]=options[option])})),Object.assign(this,safeOptions);for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];this.initialize.apply(this,[options].concat(args)),this._registerKolibriModule()}var Constructor,protoProps,staticProps;return Constructor=KolibriModule,protoProps=[{key:"kolibriModuleOptions",get:function(){return[]}},{key:"_registerKolibriModule",value:function(){external_kolibriCoreAppGlobal_default().registerKolibriModuleSync(this)}},{key:"initialize",value:function(){}},{key:"ready",value:function(){}},{key:"stopListening",value:function(event,method){external_kolibriCoreAppGlobal_default().stopListening(event,this,method)}},{key:"emit",value:function(){external_kolibriCoreAppGlobal_default().emit.apply(external_kolibriCoreAppGlobal_default(),arguments)}},{key:"Kolibri",get:function(){return external_kolibriCoreAppGlobal_default()}}],protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),KolibriModule}();function content_renderer_module_typeof(o){return content_renderer_module_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},content_renderer_module_typeof(o)}function content_renderer_module_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,content_renderer_module_toPropertyKey(descriptor.key),descriptor)}}function content_renderer_module_toPropertyKey(t){var i=function(t,r){if("object"!=content_renderer_module_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=content_renderer_module_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==content_renderer_module_typeof(i)?i:String(i)}function _callSuper(_this,derived,args){return derived=_getPrototypeOf(derived),function(self,call){if(call&&("object"===content_renderer_module_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(_this,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(derived,args||[],_getPrototypeOf(_this).constructor):derived.apply(_this,args))}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}var ContentRenderer=function(_KolibriModule){function ContentRenderer(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ContentRenderer),_callSuper(this,ContentRenderer,arguments)}var Constructor,protoProps,staticProps;return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(ContentRenderer,_KolibriModule),Constructor=ContentRenderer,(protoProps=[{key:"rendererComponent",get:function(){return null}},{key:"loadDirectionalCSS",value:function(direction){return this.Kolibri.loadDirectionalCSS(this,direction)}}])&&content_renderer_module_defineProperties(Constructor.prototype,protoProps),staticProps&&content_renderer_module_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),ContentRenderer}(KolibriModule),render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("CoreFullscreen",{ref:"epubRenderer",staticClass:"epub-renderer",class:{small:_vm.windowIsSmall,scrolled:_vm.scrolled},style:_vm.epubRendererStyle,on:{changeFullscreen:function($event){_vm.isInFullscreen=$event}}},[_vm.errorLoading?_c("LoadingError",{attrs:{loaded:_vm.loaded}}):_vm.loaded?_vm._e():_c("LoadingScreen"),_c("div",{staticClass:"epub-renderer-content",style:{"border-color":_vm.$themeTokens.fineLine},attrs:{dir:_vm.contentDirection},on:{mousedown:function($event){return $event.stopPropagation(),_vm.handleMouseDown.apply(null,arguments)},keyup:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"esc",27,$event.key,["Esc","Escape"])?null:_vm.closeSideBar.apply(null,arguments)}}},[_c("TopBar",{ref:"topBar",staticClass:"top-bar-component",attrs:{isInFullscreen:_vm.isInFullscreen,hideSearchButton:_vm.searchSideBarIsOpen},on:{tableOfContentsButtonClicked:_vm.handleTocToggle,settingsButtonClicked:_vm.handleSettingToggle,searchButtonClicked:_vm.handleSearchToggle,fullscreenButtonClicked:function($event){return _vm.$refs.epubRenderer.toggleFullscreen()}}}),_c("FocusLock",{attrs:{disabled:!_vm.tocSideBarIsOpen,returnFocus:!0}},[_vm.tocSideBarIsOpen?_c("TocButton",{staticClass:"toc-button",on:{click:_vm.handleTocToggle}}):_vm._e(),_c("TableOfContentsSideBar",{directives:[{name:"show",rawName:"v-show",value:_vm.tocSideBarIsOpen,expression:"tocSideBarIsOpen"}],ref:"tocSideBar",staticClass:"side-bar side-bar-left",attrs:{toc:_vm.toc,currentSection:_vm.currentSection},on:{tocNavigation:_vm.handleTocNavigation}})],1),_c("FocusLock",{attrs:{disabled:!_vm.settingsSideBarIsOpen,returnFocus:!1}},[_vm.settingsSideBarIsOpen?_c("SettingsButton",{staticClass:"settings-button",on:{click:_vm.handleSettingToggle}}):_vm._e(),_c("SettingsSideBar",{directives:[{name:"show",rawName:"v-show",value:_vm.settingsSideBarIsOpen,expression:"settingsSideBarIsOpen"}],ref:"settingsSideBar",staticClass:"side-bar side-bar-right",attrs:{theme:_vm.theme,decreaseFontSizeDisabled:_vm.decreaseFontSizeDisabled,increaseFontSizeDisabled:_vm.increaseFontSizeDisabled},on:{decreaseFontSize:function($event){return _vm.handleChangeFontSize(-1)},increaseFontSize:function($event){return _vm.handleChangeFontSize(1)},setTheme:_vm.setTheme}})],1),_c("FocusLock",{attrs:{disabled:!_vm.searchSideBarIsOpen,returnFocus:!1}},[_vm.searchSideBarIsOpen?_c("SearchButton",{staticClass:"search-button",on:{click:_vm.handleSearchToggle}}):_vm._e(),_c("SearchSideBar",{directives:[{name:"show",rawName:"v-show",value:_vm.searchSideBarIsOpen,expression:"searchSideBarIsOpen"}],ref:"searchSideBar",staticClass:"side-bar side-bar-right",attrs:{book:_vm.book},on:{newSearchQuery:_vm.handleNewSearchQuery,navigateToSearchResult:_vm.handleNavigateToSearchResult}})],1),_c("div",{staticClass:"navigation-and-epubjs",style:{backgroundColor:_vm.backgroundColor}},[_c("div",{staticClass:"column epubjs-navigation"},[_vm.contentIsRtl?_c("NextButton",{directives:[{name:"show",rawName:"v-show",value:!_vm.isAtEnd,expression:"!isAtEnd"}],style:{backgroundColor:_vm.backgroundColor},attrs:{disabled:!_vm.locationsAreReady,color:_vm.navigationButtonColor,isRtl:_vm.contentIsRtl},on:{goToNextPage:_vm.goToNextPage}}):_c("PreviousButton",{directives:[{name:"show",rawName:"v-show",value:!_vm.isAtStart,expression:"!isAtStart"}],style:{backgroundColor:_vm.backgroundColor},attrs:{disabled:!_vm.locationsAreReady,color:_vm.navigationButtonColor,isRtl:_vm.contentIsRtl},on:{goToPreviousPage:_vm.goToPreviousPage}})],1),_c("div",{ref:"epubjsContainer",staticClass:"column epubjs-parent",style:{backgroundColor:_vm.backgroundColor}}),_c("div",{staticClass:"column epubjs-navigation"},[_vm.contentIsRtl?_c("PreviousButton",{directives:[{name:"show",rawName:"v-show",value:!_vm.isAtStart,expression:"!isAtStart"}],style:{backgroundColor:_vm.backgroundColor},attrs:{disabled:!_vm.locationsAreReady,color:_vm.navigationButtonColor,isRtl:_vm.contentIsRtl},on:{goToPreviousPage:_vm.goToPreviousPage}}):_c("NextButton",{directives:[{name:"show",rawName:"v-show",value:!_vm.isAtEnd,expression:"!isAtEnd"}],style:{backgroundColor:_vm.backgroundColor},attrs:{disabled:!_vm.locationsAreReady,color:_vm.navigationButtonColor,isRtl:_vm.contentIsRtl},on:{goToNextPage:_vm.goToNextPage}})],1)]),_c("BottomBar",{staticClass:"bottom-bar",attrs:{locationsAreReady:_vm.locationsAreReady,heading:_vm.bottomBarHeading,sliderValue:_vm.sliderValue,sliderStep:_vm.sliderStep},on:{sliderChanged:_vm.handleSliderChanged}})],1)],1)};render._withStripped=!0;var event_emitter=__webpack_require__(6878),event_emitter_default=__webpack_require__.n(event_emitter),core=__webpack_require__(9268),utils_path=__webpack_require__(5689),path=__webpack_require__(1832),path_default=__webpack_require__.n(path);function url_typeof(o){return url_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},url_typeof(o)}function url_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,url_toPropertyKey(descriptor.key),descriptor)}}function url_toPropertyKey(t){var i=function(t,r){if("object"!=url_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=url_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==url_typeof(i)?i:String(i)}var utils_url=function(){function Url(urlString,baseString){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Url);var absolute=urlString.indexOf("://")>-1,pathname=urlString;if(this.Url=void 0,this.href=urlString,this.protocol="",this.origin="",this.hash="",this.hash="",this.search="",this.base=baseString,!absolute&&!1!==baseString&&"string"!=typeof baseString&&window&&window.location&&(this.base=window.location.href),absolute||this.base)try{this.base?this.Url=new URL(urlString,this.base):this.Url=new URL(urlString),this.href=this.Url.href,this.protocol=this.Url.protocol,this.origin=this.Url.origin,this.hash=this.Url.hash,this.search=this.Url.search,pathname=this.Url.pathname}catch(e){this.Url=void 0,this.base&&(pathname=new utils_path.Z(this.base).resolve(pathname))}this.Path=new utils_path.Z(pathname),this.directory=this.Path.directory,this.filename=this.Path.filename,this.extension=this.Path.extension}var Constructor,protoProps,staticProps;return Constructor=Url,(protoProps=[{key:"path",value:function(){return this.Path}},{key:"resolve",value:function(what){var fullpath;return what.indexOf("://")>-1?what:(fullpath=path_default().resolve(this.directory,what),this.origin+fullpath)}},{key:"relative",value:function(what){return path_default().relative(what,this.directory)}},{key:"toString",value:function(){return this.href}}])&&url_defineProperties(Constructor.prototype,protoProps),staticProps&&url_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Url}();function epubcfi_typeof(o){return epubcfi_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},epubcfi_typeof(o)}function epubcfi_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,epubcfi_toPropertyKey(descriptor.key),descriptor)}}function epubcfi_toPropertyKey(t){var i=function(t,r){if("object"!=epubcfi_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=epubcfi_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==epubcfi_typeof(i)?i:String(i)}var EpubCFI=function(){function EpubCFI(cfiFrom,base,ignoreClass){var type;if(function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,EpubCFI),this.str="",this.base={},this.spinePos=0,this.range=!1,this.path={},this.start=null,this.end=null,!(this instanceof EpubCFI))return new EpubCFI(cfiFrom,base,ignoreClass);if("string"==typeof base?this.base=this.parseComponent(base):"object"===epubcfi_typeof(base)&&base.steps&&(this.base=base),"string"===(type=this.checkType(cfiFrom)))return this.str=cfiFrom,(0,core.extend)(this,this.parse(cfiFrom));if("range"===type)return(0,core.extend)(this,this.fromRange(cfiFrom,this.base,ignoreClass));if("node"===type)return(0,core.extend)(this,this.fromNode(cfiFrom,this.base,ignoreClass));if("EpubCFI"===type&&cfiFrom.path)return cfiFrom;if(cfiFrom)throw new TypeError("not a valid argument for EpubCFI");return this}var Constructor,protoProps,staticProps;return Constructor=EpubCFI,protoProps=[{key:"checkType",value:function(cfi){return this.isCfiString(cfi)?"string":!cfi||"object"!==epubcfi_typeof(cfi)||"Range"!==(0,core.type)(cfi)&&void 0===cfi.startContainer?cfi&&"object"===epubcfi_typeof(cfi)&&void 0!==cfi.nodeType?"node":!!(cfi&&"object"===epubcfi_typeof(cfi)&&cfi instanceof EpubCFI)&&"EpubCFI":"range"}},{key:"parse",value:function(cfiStr){var baseComponent,pathComponent,range,cfi={spinePos:-1,range:!1,base:{},path:{},start:null,end:null};return"string"!=typeof cfiStr?{spinePos:-1}:(0===cfiStr.indexOf("epubcfi(")&&")"===cfiStr[cfiStr.length-1]&&(cfiStr=cfiStr.slice(8,cfiStr.length-1)),(baseComponent=this.getChapterComponent(cfiStr))?(cfi.base=this.parseComponent(baseComponent),pathComponent=this.getPathComponent(cfiStr),cfi.path=this.parseComponent(pathComponent),(range=this.getRange(cfiStr))&&(cfi.range=!0,cfi.start=this.parseComponent(range[0]),cfi.end=this.parseComponent(range[1])),cfi.spinePos=cfi.base.steps[1].index,cfi):{spinePos:-1})}},{key:"parseComponent",value:function(componentStr){var terminal,component={steps:[],terminal:{offset:null,assertion:null}},parts=componentStr.split(":"),steps=parts[0].split("/");return parts.length>1&&(terminal=parts[1],component.terminal=this.parseTerminal(terminal)),""===steps[0]&&steps.shift(),component.steps=steps.map(function(step){return this.parseStep(step)}.bind(this)),component}},{key:"parseStep",value:function(stepStr){var type,num,index,has_brackets,id;if((has_brackets=stepStr.match(/\[(.*)\]/))&&has_brackets[1]&&(id=has_brackets[1]),num=parseInt(stepStr),!isNaN(num))return num%2==0?(type="element",index=num/2-1):(type="text",index=(num-1)/2),{type:type,index:index,id:id||null}}},{key:"parseTerminal",value:function(termialStr){var characterOffset,textLocationAssertion,assertion=termialStr.match(/\[(.*)\]/);return assertion&&assertion[1]?(characterOffset=parseInt(termialStr.split("[")[0]),textLocationAssertion=assertion[1]):characterOffset=parseInt(termialStr),(0,core.isNumber)(characterOffset)||(characterOffset=null),{offset:characterOffset,assertion:textLocationAssertion}}},{key:"getChapterComponent",value:function(cfiStr){return cfiStr.split("!")[0]}},{key:"getPathComponent",value:function(cfiStr){var indirection=cfiStr.split("!");if(indirection[1])return indirection[1].split(",")[0]}},{key:"getRange",value:function(cfiStr){var ranges=cfiStr.split(",");return 3===ranges.length&&[ranges[1],ranges[2]]}},{key:"getCharecterOffsetComponent",value:function(cfiStr){return cfiStr.split(":")[1]||""}},{key:"joinSteps",value:function(steps){return steps?steps.map((function(part){var segment="";return"element"===part.type&&(segment+=2*(part.index+1)),"text"===part.type&&(segment+=1+2*part.index),part.id&&(segment+="["+part.id+"]"),segment})).join("/"):""}},{key:"segmentString",value:function(segment){var segmentString="/";return segmentString+=this.joinSteps(segment.steps),segment.terminal&&null!=segment.terminal.offset&&(segmentString+=":"+segment.terminal.offset),segment.terminal&&null!=segment.terminal.assertion&&(segmentString+="["+segment.terminal.assertion+"]"),segmentString}},{key:"toString",value:function(){var cfiString="epubcfi(";return cfiString+=this.segmentString(this.base),cfiString+="!",cfiString+=this.segmentString(this.path),this.range&&this.start&&(cfiString+=",",cfiString+=this.segmentString(this.start)),this.range&&this.end&&(cfiString+=",",cfiString+=this.segmentString(this.end)),cfiString+=")"}},{key:"compare",value:function(cfiOne,cfiTwo){var stepsA,stepsB,terminalA,terminalB;if("string"==typeof cfiOne&&(cfiOne=new EpubCFI(cfiOne)),"string"==typeof cfiTwo&&(cfiTwo=new EpubCFI(cfiTwo)),cfiOne.spinePos>cfiTwo.spinePos)return 1;if(cfiOne.spinePos<cfiTwo.spinePos)return-1;cfiOne.range?(stepsA=cfiOne.path.steps.concat(cfiOne.start.steps),terminalA=cfiOne.start.terminal):(stepsA=cfiOne.path.steps,terminalA=cfiOne.path.terminal),cfiTwo.range?(stepsB=cfiTwo.path.steps.concat(cfiTwo.start.steps),terminalB=cfiTwo.start.terminal):(stepsB=cfiTwo.path.steps,terminalB=cfiTwo.path.terminal);for(var i=0;i<stepsA.length;i++){if(!stepsA[i])return-1;if(!stepsB[i])return 1;if(stepsA[i].index>stepsB[i].index)return 1;if(stepsA[i].index<stepsB[i].index)return-1}return stepsA.length<stepsB.length?-1:terminalA.offset>terminalB.offset?1:terminalA.offset<terminalB.offset?-1:0}},{key:"step",value:function(node){var nodeType=3===node.nodeType?"text":"element";return{id:node.id,tagName:node.tagName,type:nodeType,index:this.position(node)}}},{key:"filteredStep",value:function(node,ignoreClass){var nodeType,filteredNode=this.filter(node,ignoreClass);if(filteredNode)return nodeType=3===filteredNode.nodeType?"text":"element",{id:filteredNode.id,tagName:filteredNode.tagName,type:nodeType,index:this.filteredPosition(filteredNode,ignoreClass)}}},{key:"pathTo",value:function(node,offset,ignoreClass){for(var step,segment={steps:[],terminal:{offset:null,assertion:null}},currentNode=node;currentNode&&currentNode.parentNode&&9!=currentNode.parentNode.nodeType;)(step=ignoreClass?this.filteredStep(currentNode,ignoreClass):this.step(currentNode))&&segment.steps.unshift(step),currentNode=currentNode.parentNode;return null!=offset&&offset>=0&&(segment.terminal.offset=offset,"text"!=segment.steps[segment.steps.length-1].type&&segment.steps.push({type:"text",index:0})),segment}},{key:"equalStep",value:function(stepA,stepB){return!(!stepA||!stepB)&&stepA.index===stepB.index&&stepA.id===stepB.id&&stepA.type===stepB.type}},{key:"fromRange",value:function(range,base,ignoreClass){var cfi={range:!1,base:{},path:{},start:null,end:null},start=range.startContainer,end=range.endContainer,startOffset=range.startOffset,endOffset=range.endOffset,needsIgnoring=!1;if(ignoreClass&&(needsIgnoring=null!=start.ownerDocument.querySelector("."+ignoreClass)),"string"==typeof base?(cfi.base=this.parseComponent(base),cfi.spinePos=cfi.base.steps[1].index):"object"===epubcfi_typeof(base)&&(cfi.base=base),range.collapsed)needsIgnoring&&(startOffset=this.patchOffset(start,startOffset,ignoreClass)),cfi.path=this.pathTo(start,startOffset,ignoreClass);else{cfi.range=!0,needsIgnoring&&(startOffset=this.patchOffset(start,startOffset,ignoreClass)),cfi.start=this.pathTo(start,startOffset,ignoreClass),needsIgnoring&&(endOffset=this.patchOffset(end,endOffset,ignoreClass)),cfi.end=this.pathTo(end,endOffset,ignoreClass),cfi.path={steps:[],terminal:null};var i,len=cfi.start.steps.length;for(i=0;i<len&&this.equalStep(cfi.start.steps[i],cfi.end.steps[i]);i++)i===len-1?cfi.start.terminal===cfi.end.terminal&&(cfi.path.steps.push(cfi.start.steps[i]),cfi.range=!1):cfi.path.steps.push(cfi.start.steps[i]);cfi.start.steps=cfi.start.steps.slice(cfi.path.steps.length),cfi.end.steps=cfi.end.steps.slice(cfi.path.steps.length)}return cfi}},{key:"fromNode",value:function(anchor,base,ignoreClass){var cfi={range:!1,base:{},path:{},start:null,end:null};return"string"==typeof base?(cfi.base=this.parseComponent(base),cfi.spinePos=cfi.base.steps[1].index):"object"===epubcfi_typeof(base)&&(cfi.base=base),cfi.path=this.pathTo(anchor,null,ignoreClass),cfi}},{key:"filter",value:function(anchor,ignoreClass){var needsIgnoring,sibling,parent,previousSibling,nextSibling,isText=!1;return 3===anchor.nodeType?(isText=!0,parent=anchor.parentNode,needsIgnoring=anchor.parentNode.classList.contains(ignoreClass)):(isText=!1,needsIgnoring=anchor.classList.contains(ignoreClass)),needsIgnoring&&isText?(previousSibling=parent.previousSibling,nextSibling=parent.nextSibling,previousSibling&&3===previousSibling.nodeType?sibling=previousSibling:nextSibling&&3===nextSibling.nodeType&&(sibling=nextSibling),sibling||anchor):!(needsIgnoring&&!isText)&&anchor}},{key:"patchOffset",value:function(anchor,offset,ignoreClass){if(3!=anchor.nodeType)throw new Error("Anchor must be a text node");var curr=anchor,totalOffset=offset;for(anchor.parentNode.classList.contains(ignoreClass)&&(curr=anchor.parentNode);curr.previousSibling;){if(1===curr.previousSibling.nodeType){if(!curr.previousSibling.classList.contains(ignoreClass))break;totalOffset+=curr.previousSibling.textContent.length}else totalOffset+=curr.previousSibling.textContent.length;curr=curr.previousSibling}return totalOffset}},{key:"normalizedMap",value:function(children,nodeType,ignoreClass){var i,currNodeType,prevNodeType,output={},prevIndex=-1,len=children.length;for(i=0;i<len;i++)1===(currNodeType=children[i].nodeType)&&children[i].classList.contains(ignoreClass)&&(currNodeType=3),i>0&&3===currNodeType&&3===prevNodeType?output[i]=prevIndex:nodeType===currNodeType&&(prevIndex+=1,output[i]=prevIndex),prevNodeType=currNodeType;return output}},{key:"position",value:function(anchor){var children,index;return 1===anchor.nodeType?((children=anchor.parentNode.children)||(children=(0,core.findChildren)(anchor.parentNode)),index=Array.prototype.indexOf.call(children,anchor)):index=(children=this.textNodes(anchor.parentNode)).indexOf(anchor),index}},{key:"filteredPosition",value:function(anchor,ignoreClass){var children,map;return 1===anchor.nodeType?(children=anchor.parentNode.children,map=this.normalizedMap(children,1,ignoreClass)):(children=anchor.parentNode.childNodes,anchor.parentNode.classList.contains(ignoreClass)&&(children=(anchor=anchor.parentNode).parentNode.childNodes),map=this.normalizedMap(children,3,ignoreClass)),map[Array.prototype.indexOf.call(children,anchor)]}},{key:"stepsToXpath",value:function(steps){var xpath=[".","*"];return steps.forEach((function(step){var position=step.index+1;step.id?xpath.push("*[position()="+position+" and @id='"+step.id+"']"):"text"===step.type?xpath.push("text()["+position+"]"):xpath.push("*["+position+"]")})),xpath.join("/")}},{key:"stepsToQuerySelector",value:function(steps){var query=["html"];return steps.forEach((function(step){var position=step.index+1;step.id?query.push("#"+step.id):"text"===step.type||query.push("*:nth-child("+position+")")})),query.join(">")}},{key:"textNodes",value:function(container,ignoreClass){return Array.prototype.slice.call(container.childNodes).filter((function(node){return 3===node.nodeType||!(!ignoreClass||!node.classList.contains(ignoreClass))}))}},{key:"walkToNode",value:function(steps,_doc,ignoreClass){var step,i,doc=_doc||document,container=doc.documentElement,len=steps.length;for(i=0;i<len&&("element"===(step=steps[i]).type?container=step.id?doc.getElementById(step.id):(container.children||(0,core.findChildren)(container))[step.index]:"text"===step.type&&(container=this.textNodes(container,ignoreClass)[step.index]),container);i++);return container}},{key:"findNode",value:function(steps,_doc,ignoreClass){var container,xpath,doc=_doc||document;return ignoreClass||void 0===doc.evaluate?container=ignoreClass?this.walkToNode(steps,doc,ignoreClass):this.walkToNode(steps,doc):(xpath=this.stepsToXpath(steps),container=doc.evaluate(xpath,doc,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue),container}},{key:"fixMiss",value:function(steps,offset,_doc,ignoreClass){var child,len,container=this.findNode(steps.slice(0,-1),_doc,ignoreClass),children=container.childNodes,map=this.normalizedMap(children,3,ignoreClass),lastStepIndex=steps[steps.length-1].index;for(var childIndex in map){if(!map.hasOwnProperty(childIndex))return;if(map[childIndex]===lastStepIndex){if(!(offset>(len=(child=children[childIndex]).textContent.length))){container=1===child.nodeType?child.childNodes[0]:child;break}offset-=len}}return{container:container,offset:offset}}},{key:"toRange",value:function(_doc,ignoreClass){var range,start,end,startContainer,endContainer,startSteps,endSteps,missed,doc=_doc||document,needsIgnoring=!!ignoreClass&&null!=doc.querySelector("."+ignoreClass);if(range=void 0!==doc.createRange?doc.createRange():new core.RangeObject,this.range?(start=this.start,startSteps=this.path.steps.concat(start.steps),startContainer=this.findNode(startSteps,doc,needsIgnoring?ignoreClass:null),end=this.end,endSteps=this.path.steps.concat(end.steps),endContainer=this.findNode(endSteps,doc,needsIgnoring?ignoreClass:null)):(start=this.path,startSteps=this.path.steps,startContainer=this.findNode(this.path.steps,doc,needsIgnoring?ignoreClass:null)),!startContainer)return console.log("No startContainer found for",this.toString()),null;try{null!=start.terminal.offset?range.setStart(startContainer,start.terminal.offset):range.setStart(startContainer,0)}catch(e){missed=this.fixMiss(startSteps,start.terminal.offset,doc,needsIgnoring?ignoreClass:null),range.setStart(missed.container,missed.offset)}if(endContainer)try{null!=end.terminal.offset?range.setEnd(endContainer,end.terminal.offset):range.setEnd(endContainer,0)}catch(e){missed=this.fixMiss(endSteps,this.end.terminal.offset,doc,needsIgnoring?ignoreClass:null),range.setEnd(missed.container,missed.offset)}return range}},{key:"isCfiString",value:function(str){return"string"==typeof str&&0===str.indexOf("epubcfi(")&&")"===str[str.length-1]}},{key:"generateChapterComponent",value:function(_spineNodeIndex,_pos,id){var cfi="/"+2*(_spineNodeIndex+1)+"/";return cfi+=2*(parseInt(_pos)+1),id&&(cfi+="["+id+"]"),cfi}},{key:"collapse",value:function(toStart){this.range&&(this.range=!1,toStart?(this.path.steps=this.path.steps.concat(this.start.steps),this.path.terminal=this.start.terminal):(this.path.steps=this.path.steps.concat(this.end.steps),this.path.terminal=this.end.terminal))}}],protoProps&&epubcfi_defineProperties(Constructor.prototype,protoProps),staticProps&&epubcfi_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),EpubCFI}(),epubcfi=EpubCFI;function hook_typeof(o){return hook_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},hook_typeof(o)}function hook_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,hook_toPropertyKey(descriptor.key),descriptor)}}function hook_toPropertyKey(t){var i=function(t,r){if("object"!=hook_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=hook_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==hook_typeof(i)?i:String(i)}var Hook=function(){function Hook(context){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Hook),this.context=context||this,this.hooks=[]}var Constructor,protoProps,staticProps;return Constructor=Hook,protoProps=[{key:"register",value:function(){for(var i=0;i<arguments.length;++i)if("function"==typeof arguments[i])this.hooks.push(arguments[i]);else for(var j=0;j<arguments[i].length;++j)this.hooks.push(arguments[i][j])}},{key:"deregister",value:function(func){for(var i=0;i<this.hooks.length;i++)if(this.hooks[i]===func){this.hooks.splice(i,1);break}}},{key:"trigger",value:function(){var args=arguments,context=this.context,promises=[];return this.hooks.forEach((function(task){var executing=task.apply(context,args);executing&&"function"==typeof executing.then&&promises.push(executing)})),Promise.all(promises)}},{key:"list",value:function(){return this.hooks}},{key:"clear",value:function(){return this.hooks=[]}}],protoProps&&hook_defineProperties(Constructor.prototype,protoProps),staticProps&&hook_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Hook}(),hook=Hook;function replaceBase(doc,section){var base,head,url=section.url,absolute=url.indexOf("://")>-1;doc&&(head=(0,core.qs)(doc,"head"),(base=(0,core.qs)(head,"base"))||(base=doc.createElement("base"),head.insertBefore(base,head.firstChild)),!absolute&&window&&window.location&&(url=window.location.origin+url),base.setAttribute("href",url))}function replaceCanonical(doc,section){var head,link,url=section.canonical;doc&&(head=(0,core.qs)(doc,"head"),(link=(0,core.qs)(head,"link[rel='canonical']"))?link.setAttribute("href",url):((link=doc.createElement("link")).setAttribute("rel","canonical"),link.setAttribute("href",url),head.appendChild(link)))}function replaceMeta(doc,section){var head,meta,id=section.idref;doc&&(head=(0,core.qs)(doc,"head"),(meta=(0,core.qs)(head,"link[property='dc.identifier']"))?meta.setAttribute("content",id):((meta=doc.createElement("meta")).setAttribute("name","dc.identifier"),meta.setAttribute("content",id),head.appendChild(meta)))}function replacements_substitute(content,urls,replacements){return urls.forEach((function(url,i){url&&replacements[i]&&(content=content.replace(new RegExp(url,"g"),replacements[i]))})),content}function section_typeof(o){return section_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},section_typeof(o)}function section_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,section_toPropertyKey(descriptor.key),descriptor)}}function section_toPropertyKey(t){var i=function(t,r){if("object"!=section_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=section_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==section_typeof(i)?i:String(i)}var Section=function(){function Section(item,hooks){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Section),this.idref=item.idref,this.linear="yes"===item.linear,this.properties=item.properties,this.index=item.index,this.href=item.href,this.url=item.url,this.canonical=item.canonical,this.next=item.next,this.prev=item.prev,this.cfiBase=item.cfiBase,hooks?this.hooks=hooks:(this.hooks={},this.hooks.serialize=new hook(this),this.hooks.content=new hook(this)),this.document=void 0,this.contents=void 0,this.output=void 0}var Constructor,protoProps,staticProps;return Constructor=Section,protoProps=[{key:"load",value:function(_request){var request=_request||this.request||__webpack_require__(4239),loading=new core.defer,loaded=loading.promise;return this.contents?loading.resolve(this.contents):request(this.url).then(function(xml){return this.document=xml,this.contents=xml.documentElement,this.hooks.content.trigger(this.document,this)}.bind(this)).then(function(){loading.resolve(this.contents)}.bind(this)).catch((function(error){loading.reject(error)})),loaded}},{key:"base",value:function(){return replaceBase(this.document,this)}},{key:"render",value:function(_request){var rendering=new core.defer,rendered=rendering.promise;return this.output,this.load(_request).then(function(contents){var isIE=("undefined"!=typeof navigator&&navigator.userAgent||"").indexOf("Trident")>=0,serializer=new("undefined"==typeof XMLSerializer||isIE?__webpack_require__(7463).XMLSerializer:XMLSerializer);return this.output=serializer.serializeToString(contents),this.output}.bind(this)).then(function(){return this.hooks.serialize.trigger(this.output,this)}.bind(this)).then(function(){rendering.resolve(this.output)}.bind(this)).catch((function(error){rendering.reject(error)})),rendered}},{key:"find",value:function(_query){var section=this,matches=[],query=_query.toLowerCase(),find=function(node){for(var cfi,pos,excerpt,text=node.textContent.toLowerCase(),range=section.document.createRange(),last=-1;-1!=pos;)-1!=(pos=text.indexOf(query,last+1))&&((range=section.document.createRange()).setStart(node,pos),range.setEnd(node,pos+query.length),cfi=section.cfiFromRange(range),excerpt=node.textContent.length<150?node.textContent:"..."+(excerpt=node.textContent.substring(pos-75,pos+75))+"...",matches.push({cfi:cfi,excerpt:excerpt})),last=pos};return(0,core.sprint)(section.document,(function(node){find(node)})),matches}},{key:"reconcileLayoutSettings",value:function(globalLayout){var settings={layout:globalLayout.layout,spread:globalLayout.spread,orientation:globalLayout.orientation};return this.properties.forEach((function(prop){var property,value,rendition=prop.replace("rendition:",""),split=rendition.indexOf("-");-1!=split&&(property=rendition.slice(0,split),value=rendition.slice(split+1),settings[property]=value)})),settings}},{key:"cfiFromRange",value:function(_range){return new epubcfi(_range,this.cfiBase).toString()}},{key:"cfiFromElement",value:function(el){return new epubcfi(el,this.cfiBase).toString()}},{key:"unload",value:function(){this.document=void 0,this.contents=void 0,this.output=void 0}},{key:"destroy",value:function(){this.unload(),this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.idref=void 0,this.linear=void 0,this.properties=void 0,this.index=void 0,this.href=void 0,this.url=void 0,this.next=void 0,this.prev=void 0,this.cfiBase=void 0}}],protoProps&&section_defineProperties(Constructor.prototype,protoProps),staticProps&&section_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Section}(),section=Section;function spine_typeof(o){return spine_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},spine_typeof(o)}function spine_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,spine_toPropertyKey(descriptor.key),descriptor)}}function spine_toPropertyKey(t){var i=function(t,r){if("object"!=spine_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=spine_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==spine_typeof(i)?i:String(i)}var Spine=function(){function Spine(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Spine),this.spineItems=[],this.spineByHref={},this.spineById={},this.hooks={},this.hooks.serialize=new hook,this.hooks.content=new hook,this.hooks.content.register(replaceBase),this.hooks.content.register(replaceCanonical),this.hooks.content.register(replaceMeta),this.epubcfi=new epubcfi,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}var Constructor,protoProps,staticProps;return Constructor=Spine,protoProps=[{key:"unpack",value:function(_package,resolver,canonical){var _this=this;this.items=_package.spine,this.manifest=_package.manifest,this.spineNodeIndex=_package.spineNodeIndex,this.baseUrl=_package.baseUrl||_package.basePath||"",this.length=this.items.length,this.items.forEach((function(item,index){var spineItem,manifestItem=_this.manifest[item.idref];item.index=index,item.cfiBase=_this.epubcfi.generateChapterComponent(_this.spineNodeIndex,item.index,item.idref),item.href&&(item.url=resolver(item.href,!0),item.canonical=canonical(item.href)),manifestItem&&(item.href=manifestItem.href,item.url=resolver(item.href,!0),item.canonical=canonical(item.href),manifestItem.properties.length&&item.properties.push.apply(item.properties,manifestItem.properties)),"yes"===item.linear?(item.prev=function(){for(var prevIndex=item.index;prevIndex>0;){var prev=this.get(prevIndex-1);if(prev&&prev.linear)return prev;prevIndex-=1}}.bind(_this),item.next=function(){for(var nextIndex=item.index;nextIndex<this.spineItems.length-1;){var next=this.get(nextIndex+1);if(next&&next.linear)return next;nextIndex+=1}}.bind(_this)):(item.prev=function(){},item.next=function(){}),spineItem=new section(item,_this.hooks),_this.append(spineItem)})),this.loaded=!0}},{key:"get",value:function(target){var index=0;if(void 0===target)for(;index<this.spineItems.length;){var next=this.spineItems[index];if(next&&next.linear)break;index+=1}else this.epubcfi.isCfiString(target)?index=new epubcfi(target).spinePos:"number"==typeof target||!1===isNaN(target)?index=target:"string"==typeof target&&0===target.indexOf("#")?index=this.spineById[target.substring(1)]:"string"==typeof target&&(target=target.split("#")[0],index=this.spineByHref[target]||this.spineByHref[encodeURI(target)]);return this.spineItems[index]||null}},{key:"append",value:function(section){var index=this.spineItems.length;return section.index=index,this.spineItems.push(section),this.spineByHref[decodeURI(section.href)]=index,this.spineByHref[encodeURI(section.href)]=index,this.spineByHref[section.href]=index,this.spineById[section.idref]=index,index}},{key:"prepend",value:function(section){return this.spineByHref[section.href]=0,this.spineById[section.idref]=0,this.spineItems.forEach((function(item,index){item.index=index})),0}},{key:"remove",value:function(section){var index=this.spineItems.indexOf(section);if(index>-1)return delete this.spineByHref[section.href],delete this.spineById[section.idref],this.spineItems.splice(index,1)}},{key:"each",value:function(){return this.spineItems.forEach.apply(this.spineItems,arguments)}},{key:"first",value:function(){var index=0;do{var next=this.get(index);if(next&&next.linear)return next;index+=1}while(index<this.spineItems.length)}},{key:"last",value:function(){var index=this.spineItems.length-1;do{var prev=this.get(index);if(prev&&prev.linear)return prev;index-=1}while(index>=0)}},{key:"destroy",value:function(){this.each((function(section){return section.destroy()})),this.spineItems=void 0,this.spineByHref=void 0,this.spineById=void 0,this.hooks.serialize.clear(),this.hooks.content.clear(),this.hooks=void 0,this.epubcfi=void 0,this.loaded=!1,this.items=void 0,this.manifest=void 0,this.spineNodeIndex=void 0,this.baseUrl=void 0,this.length=void 0}}],protoProps&&spine_defineProperties(Constructor.prototype,protoProps),staticProps&&spine_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Spine}(),spine=Spine;function queue_typeof(o){return queue_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},queue_typeof(o)}function queue_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function queue_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,queue_toPropertyKey(descriptor.key),descriptor)}}function queue_createClass(Constructor,protoProps,staticProps){return protoProps&&queue_defineProperties(Constructor.prototype,protoProps),staticProps&&queue_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function queue_toPropertyKey(t){var i=function(t,r){if("object"!=queue_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=queue_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==queue_typeof(i)?i:String(i)}var Queue=function(){function Queue(context){queue_classCallCheck(this,Queue),this._q=[],this.context=context,this.tick=core.requestAnimationFrame,this.running=!1,this.paused=!1}return queue_createClass(Queue,[{key:"enqueue",value:function(){var deferred,queued,task=[].shift.call(arguments),args=arguments;if(!task)throw new Error("No Task Provided");return queued="function"==typeof task?{task:task,args:args,deferred:deferred=new core.defer,promise:deferred.promise}:{promise:task},this._q.push(queued),0!=this.paused||this.running||this.run(),queued.promise}},{key:"dequeue",value:function(){var inwait,task,result;return!this._q.length||this.paused?((inwait=new core.defer).deferred.resolve(),inwait.promise):(task=(inwait=this._q.shift()).task)?(result=task.apply(this.context,inwait.args))&&"function"==typeof result.then?result.then(function(){inwait.deferred.resolve.apply(this.context,arguments)}.bind(this),function(){inwait.deferred.reject.apply(this.context,arguments)}.bind(this)):(inwait.deferred.resolve.apply(this.context,result),inwait.promise):inwait.promise?inwait.promise:void 0}},{key:"dump",value:function(){for(;this._q.length;)this.dequeue()}},{key:"run",value:function(){var _this=this;return this.running||(this.running=!0,this.defered=new core.defer),this.tick.call(window,(function(){_this._q.length?_this.dequeue().then(function(){this.run()}.bind(_this)):(_this.defered.resolve(),_this.running=void 0)})),1==this.paused&&(this.paused=!1),this.defered.promise}},{key:"flush",value:function(){return this.running?this.running:this._q.length?(this.running=this.dequeue().then(function(){return this.running=void 0,this.flush()}.bind(this)),this.running):void 0}},{key:"clear",value:function(){this._q=[]}},{key:"length",value:function(){return this._q.length}},{key:"pause",value:function(){this.paused=!0}},{key:"stop",value:function(){this._q=[],this.running=!1,this.paused=!0}}]),Queue}(),queue=Queue,DOM_EVENTS=["keydown","keyup","keypressed","mouseup","mousedown","click","touchend","touchstart","touchmove"],EVENTS_BOOK={OPEN_FAILED:"openFailed"},EVENTS_CONTENTS={EXPAND:"expand",RESIZE:"resize",SELECTED:"selected",SELECTED_RANGE:"selectedRange",LINK_CLICKED:"linkClicked"},EVENTS_LOCATIONS={CHANGED:"changed"},EVENTS_MANAGERS={RESIZE:"resize",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",ADDED:"added",SCROLL:"scroll",SCROLLED:"scrolled",REMOVED:"removed"},EVENTS_VIEWS={AXIS:"axis",LOAD_ERROR:"loaderror",RENDERED:"rendered",RESIZED:"resized",DISPLAYED:"displayed",SHOWN:"shown",HIDDEN:"hidden",MARK_CLICKED:"markClicked"},EVENTS_RENDITION={STARTED:"started",ATTACHED:"attached",DISPLAYED:"displayed",DISPLAY_ERROR:"displayerror",RENDERED:"rendered",REMOVED:"removed",RESIZED:"resized",ORIENTATION_CHANGE:"orientationchange",LOCATION_CHANGED:"locationChanged",RELOCATED:"relocated",MARK_CLICKED:"markClicked",SELECTED:"selected",LAYOUT:"layout"},EVENTS_LAYOUT={UPDATED:"updated"},EVENTS_ANNOTATION={ATTACH:"attach",DETACH:"detach"};function locations_typeof(o){return locations_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},locations_typeof(o)}function locations_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,locations_toPropertyKey(descriptor.key),descriptor)}}function locations_toPropertyKey(t){var i=function(t,r){if("object"!=locations_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=locations_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==locations_typeof(i)?i:String(i)}var Locations=function(){function Locations(spine,request,pause){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Locations),this.spine=spine,this.request=request,this.pause=pause||100,this.q=new queue(this),this.epubcfi=new epubcfi,this._locations=[],this.total=0,this.break=150,this._current=0,this.currentLocation="",this._currentCfi="",this.processingTimeout=void 0}var Constructor,protoProps,staticProps;return Constructor=Locations,protoProps=[{key:"generate",value:function(chars){return chars&&(this.break=chars),this.q.pause(),this.spine.each(function(section){section.linear&&this.q.enqueue(this.process.bind(this),section)}.bind(this)),this.q.run().then(function(){return this.total=this._locations.length-1,this._currentCfi&&(this.currentLocation=this._currentCfi),this._locations}.bind(this))}},{key:"createRange",value:function(){return{startContainer:void 0,startOffset:void 0,endContainer:void 0,endOffset:void 0}}},{key:"process",value:function(section){return section.load(this.request).then(function(contents){var completed=new core.defer,locations=this.parse(contents,section.cfiBase);return this._locations=this._locations.concat(locations),section.unload(),this.processingTimeout=setTimeout((function(){return completed.resolve(locations)}),this.pause),completed.promise}.bind(this))}},{key:"parse",value:function(contents,cfiBase,chars){var range,prev,locations=[],doc=contents.ownerDocument,body=(0,core.qs)(doc,"body"),counter=0,_break=chars||this.break;if((0,core.sprint)(body,function(node){var dist,len=node.length,pos=0;if(0===node.textContent.trim().length)return!1;for(0==counter&&((range=this.createRange()).startContainer=node,range.startOffset=0),(dist=_break-counter)>len&&(counter+=len,pos=len);pos<len;)if(dist=_break-counter,0===counter&&(pos+=1,(range=this.createRange()).startContainer=node,range.startOffset=pos),pos+dist>=len)counter+=len-pos,pos=len;else{pos+=dist,range.endContainer=node,range.endOffset=pos;var cfi=new epubcfi(range,cfiBase).toString();locations.push(cfi),counter=0}prev=node}.bind(this)),range&&range.startContainer&&prev){range.endContainer=prev,range.endOffset=prev.length;var cfi=new epubcfi(range,cfiBase).toString();locations.push(cfi),counter=0}return locations}},{key:"locationFromCfi",value:function(cfi){var loc;return epubcfi.prototype.isCfiString(cfi)&&(cfi=new epubcfi(cfi)),0===this._locations.length?-1:(loc=(0,core.locationOf)(cfi,this._locations,this.epubcfi.compare))>this.total?this.total:loc}},{key:"percentageFromCfi",value:function(cfi){if(0===this._locations.length)return null;var loc=this.locationFromCfi(cfi);return this.percentageFromLocation(loc)}},{key:"percentageFromLocation",value:function(loc){return loc&&this.total?loc/this.total:0}},{key:"cfiFromLocation",value:function(loc){var cfi=-1;return"number"!=typeof loc&&(loc=parseInt(loc)),loc>=0&&loc<this._locations.length&&(cfi=this._locations[loc]),cfi}},{key:"cfiFromPercentage",value:function(percentage){var loc;if(percentage>1&&console.warn("Normalize cfiFromPercentage value to between 0 - 1"),percentage>=1){var cfi=new epubcfi(this._locations[this.total]);return cfi.collapse(),cfi.toString()}return loc=Math.ceil(this.total*percentage),this.cfiFromLocation(loc)}},{key:"load",value:function(locations){return this._locations="string"==typeof locations?JSON.parse(locations):locations,this.total=this._locations.length-1,this._locations}},{key:"save",value:function(){return JSON.stringify(this._locations)}},{key:"getCurrent",value:function(){return this._current}},{key:"setCurrent",value:function(curr){var loc;if("string"==typeof curr)this._currentCfi=curr;else{if("number"!=typeof curr)return;this._current=curr}0!==this._locations.length&&("string"==typeof curr?(loc=this.locationFromCfi(curr),this._current=loc):loc=curr,this.emit(EVENTS_LOCATIONS.CHANGED,{percentage:this.percentageFromLocation(loc)}))}},{key:"currentLocation",get:function(){return this._current},set:function(curr){this.setCurrent(curr)}},{key:"length",value:function(){return this._locations.length}},{key:"destroy",value:function(){this.spine=void 0,this.request=void 0,this.pause=void 0,this.q.stop(),this.q=void 0,this.epubcfi=void 0,this._locations=void 0,this.total=void 0,this.break=void 0,this._current=void 0,this.currentLocation=void 0,this._currentCfi=void 0,clearTimeout(this.processingTimeout)}}],protoProps&&locations_defineProperties(Constructor.prototype,protoProps),staticProps&&locations_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Locations}();event_emitter_default()(Locations.prototype);var locations=Locations;function container_typeof(o){return container_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},container_typeof(o)}function container_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,container_toPropertyKey(descriptor.key),descriptor)}}function container_toPropertyKey(t){var i=function(t,r){if("object"!=container_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=container_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==container_typeof(i)?i:String(i)}var container=function(){function Container(containerDocument){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Container),this.packagePath="",this.directory="",this.encoding="",containerDocument&&this.parse(containerDocument)}var Constructor,protoProps,staticProps;return Constructor=Container,(protoProps=[{key:"parse",value:function(containerDocument){var rootfile;if(!containerDocument)throw new Error("Container File Not Found");if(!(rootfile=(0,core.qs)(containerDocument,"rootfile")))throw new Error("No RootFile Found");this.packagePath=rootfile.getAttribute("full-path"),this.directory=path_default().dirname(this.packagePath),this.encoding=containerDocument.xmlEncoding}},{key:"destroy",value:function(){this.packagePath=void 0,this.directory=void 0,this.encoding=void 0}}])&&container_defineProperties(Constructor.prototype,protoProps),staticProps&&container_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Container}();function packaging_typeof(o){return packaging_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},packaging_typeof(o)}function packaging_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,packaging_toPropertyKey(descriptor.key),descriptor)}}function packaging_toPropertyKey(t){var i=function(t,r){if("object"!=packaging_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=packaging_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==packaging_typeof(i)?i:String(i)}var Packaging=function(){function Packaging(packageDocument){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Packaging),this.manifest={},this.navPath="",this.ncxPath="",this.coverPath="",this.spineNodeIndex=0,this.spine=[],this.metadata={},packageDocument&&this.parse(packageDocument)}var Constructor,protoProps,staticProps;return Constructor=Packaging,protoProps=[{key:"parse",value:function(packageDocument){var metadataNode,manifestNode,spineNode;if(!packageDocument)throw new Error("Package File Not Found");if(!(metadataNode=(0,core.qs)(packageDocument,"metadata")))throw new Error("No Metadata Found");if(!(manifestNode=(0,core.qs)(packageDocument,"manifest")))throw new Error("No Manifest Found");if(!(spineNode=(0,core.qs)(packageDocument,"spine")))throw new Error("No Spine Found");return this.manifest=this.parseManifest(manifestNode),this.navPath=this.findNavPath(manifestNode),this.ncxPath=this.findNcxPath(manifestNode,spineNode),this.coverPath=this.findCoverPath(packageDocument),this.spineNodeIndex=(0,core.indexOfElementNode)(spineNode),this.spine=this.parseSpine(spineNode,this.manifest),this.uniqueIdentifier=this.findUniqueIdentifier(packageDocument),this.metadata=this.parseMetadata(metadataNode),this.metadata.direction=spineNode.getAttribute("page-progression-direction"),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex}}},{key:"parseMetadata",value:function(xml){var metadata={};return metadata.title=this.getElementText(xml,"title"),metadata.creator=this.getElementText(xml,"creator"),metadata.description=this.getElementText(xml,"description"),metadata.pubdate=this.getElementText(xml,"date"),metadata.publisher=this.getElementText(xml,"publisher"),metadata.identifier=this.getElementText(xml,"identifier"),metadata.language=this.getElementText(xml,"language"),metadata.rights=this.getElementText(xml,"rights"),metadata.modified_date=this.getPropertyText(xml,"dcterms:modified"),metadata.layout=this.getPropertyText(xml,"rendition:layout"),metadata.orientation=this.getPropertyText(xml,"rendition:orientation"),metadata.flow=this.getPropertyText(xml,"rendition:flow"),metadata.viewport=this.getPropertyText(xml,"rendition:viewport"),metadata.media_active_class=this.getPropertyText(xml,"media:active-class"),metadata}},{key:"parseManifest",value:function(manifestXml){var manifest={},selected=(0,core.qsa)(manifestXml,"item");return Array.prototype.slice.call(selected).forEach((function(item){var id=item.getAttribute("id"),href=item.getAttribute("href")||"",type=item.getAttribute("media-type")||"",overlay=item.getAttribute("media-overlay")||"",properties=item.getAttribute("properties")||"";manifest[id]={href:href,type:type,overlay:overlay,properties:properties.length?properties.split(" "):[]}})),manifest}},{key:"parseSpine",value:function(spineXml,manifest){var spine=[],selected=(0,core.qsa)(spineXml,"itemref");return Array.prototype.slice.call(selected).forEach((function(item,index){var idref=item.getAttribute("idref"),props=item.getAttribute("properties")||"",propArray=props.length?props.split(" "):[],itemref={idref:idref,linear:item.getAttribute("linear")||"yes",properties:propArray,index:index};spine.push(itemref)})),spine}},{key:"findUniqueIdentifier",value:function(packageXml){var uniqueIdentifierId=packageXml.documentElement.getAttribute("unique-identifier");if(!uniqueIdentifierId)return"";var identifier=packageXml.getElementById(uniqueIdentifierId);return identifier&&"identifier"===identifier.localName&&"http://purl.org/dc/elements/1.1/"===identifier.namespaceURI?identifier.childNodes[0].nodeValue.trim():""}},{key:"findNavPath",value:function(manifestNode){var node=(0,core.qsp)(manifestNode,"item",{properties:"nav"});return!!node&&node.getAttribute("href")}},{key:"findNcxPath",value:function(manifestNode,spineNode){var tocId,node=(0,core.qsp)(manifestNode,"item",{"media-type":"application/x-dtbncx+xml"});return node||(tocId=spineNode.getAttribute("toc"))&&(node=manifestNode.querySelector("#".concat(tocId))),!!node&&node.getAttribute("href")}},{key:"findCoverPath",value:function(packageXml){if("2.0"===(0,core.qs)(packageXml,"package").getAttribute("version")){var metaCover=(0,core.qsp)(packageXml,"meta",{name:"cover"});if(metaCover){var coverId=metaCover.getAttribute("content"),cover=packageXml.getElementById(coverId);return cover?cover.getAttribute("href"):""}return!1}var node=(0,core.qsp)(packageXml,"item",{properties:"cover-image"});return node?node.getAttribute("href"):""}},{key:"getElementText",value:function(xml,tag){var el,found=xml.getElementsByTagNameNS("http://purl.org/dc/elements/1.1/",tag);return found&&0!==found.length&&(el=found[0]).childNodes.length?el.childNodes[0].nodeValue:""}},{key:"getPropertyText",value:function(xml,property){var el=(0,core.qsp)(xml,"meta",{property:property});return el&&el.childNodes.length?el.childNodes[0].nodeValue:""}},{key:"load",value:function(json){var _this=this;this.metadata=json.metadata;var spine=json.readingOrder||json.spine;return this.spine=spine.map((function(item,index){return item.index=index,item.linear=item.linear||"yes",item})),json.resources.forEach((function(item,index){_this.manifest[index]=item,item.rel&&"cover"===item.rel[0]&&(_this.coverPath=item.href)})),this.spineNodeIndex=0,this.toc=json.toc.map((function(item,index){return item.label=item.title,item})),{metadata:this.metadata,spine:this.spine,manifest:this.manifest,navPath:this.navPath,ncxPath:this.ncxPath,coverPath:this.coverPath,spineNodeIndex:this.spineNodeIndex,toc:this.toc}}},{key:"destroy",value:function(){this.manifest=void 0,this.navPath=void 0,this.ncxPath=void 0,this.coverPath=void 0,this.spineNodeIndex=void 0,this.spine=void 0,this.metadata=void 0}}],protoProps&&packaging_defineProperties(Constructor.prototype,protoProps),staticProps&&packaging_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Packaging}(),packaging=Packaging;function navigation_typeof(o){return navigation_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},navigation_typeof(o)}function navigation_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,navigation_toPropertyKey(descriptor.key),descriptor)}}function navigation_toPropertyKey(t){var i=function(t,r){if("object"!=navigation_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=navigation_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==navigation_typeof(i)?i:String(i)}var Navigation=function(){function Navigation(xml){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Navigation),this.toc=[],this.tocByHref={},this.tocById={},this.landmarks=[],this.landmarksByType={},this.length=0,xml&&this.parse(xml)}var Constructor,protoProps,staticProps;return Constructor=Navigation,protoProps=[{key:"parse",value:function(xml){var html,ncx,isXml=xml.nodeType;isXml&&(html=(0,core.qs)(xml,"html"),ncx=(0,core.qs)(xml,"ncx")),isXml?html?(this.toc=this.parseNav(xml),this.landmarks=this.parseLandmarks(xml)):ncx&&(this.toc=this.parseNcx(xml)):this.toc=this.load(xml),this.length=0,this.unpack(this.toc)}},{key:"unpack",value:function(toc){for(var item,i=0;i<toc.length;i++)(item=toc[i]).href&&(this.tocByHref[item.href]=i),item.id&&(this.tocById[item.id]=i),this.length++,item.subitems.length&&this.unpack(item.subitems)}},{key:"get",value:function(target){var index;return target?(0===target.indexOf("#")?index=this.tocById[target.substring(1)]:target in this.tocByHref&&(index=this.tocByHref[target]),this.toc[index]):this.toc}},{key:"landmark",value:function(type){var index;return type?(index=this.landmarksByType[type],this.landmarks[index]):this.landmarks}},{key:"parseNav",value:function(navHtml){var i,item,navElement=(0,core.querySelectorByType)(navHtml,"nav","toc"),navItems=navElement?(0,core.qsa)(navElement,"li"):[],length=navItems.length,toc={},list=[];if(!navItems||0===length)return list;for(i=0;i<length;++i)(item=this.navItem(navItems[i]))&&(toc[item.id]=item,item.parent?toc[item.parent].subitems.push(item):list.push(item));return list}},{key:"navItem",value:function(item){var id=item.getAttribute("id")||void 0,content=(0,core.filterChildren)(item,"a",!0);if(content){var src=content.getAttribute("href")||"";id||(id=src);var parent,text=content.textContent||"",parentItem=(0,core.getParentByTagName)(item,"li");if(parentItem&&!(parent=parentItem.getAttribute("id"))){var parentContent=(0,core.filterChildren)(parentItem,"a",!0);parent=parentContent&&parentContent.getAttribute("href")}for(;!parent&&parentItem;)if((parentItem=(0,core.getParentByTagName)(parentItem,"li"))&&!(parent=parentItem.getAttribute("id"))){var _parentContent=(0,core.filterChildren)(parentItem,"a",!0);parent=_parentContent&&_parentContent.getAttribute("href")}return{id:id,href:src,label:text,subitems:[],parent:parent}}}},{key:"parseLandmarks",value:function(navHtml){var i,item,navElement=(0,core.querySelectorByType)(navHtml,"nav","landmarks"),navItems=navElement?(0,core.qsa)(navElement,"li"):[],length=navItems.length,list=[];if(!navItems||0===length)return list;for(i=0;i<length;++i)(item=this.landmarkItem(navItems[i]))&&(list.push(item),this.landmarksByType[item.type]=i);return list}},{key:"landmarkItem",value:function(item){var content=(0,core.filterChildren)(item,"a",!0);if(content){var type=content.getAttributeNS("http://www.idpf.org/2007/ops","type")||void 0;return{href:content.getAttribute("href")||"",label:content.textContent||"",type:type}}}},{key:"parseNcx",value:function(tocXml){var i,item,navPoints=(0,core.qsa)(tocXml,"navPoint"),length=navPoints.length,toc={},list=[];if(!navPoints||0===length)return list;for(i=0;i<length;++i)toc[(item=this.ncxItem(navPoints[i])).id]=item,item.parent?toc[item.parent].subitems.push(item):list.push(item);return list}},{key:"ncxItem",value:function(item){var parent,id=item.getAttribute("id")||!1,src=(0,core.qs)(item,"content").getAttribute("src"),navLabel=(0,core.qs)(item,"navLabel"),text=navLabel.textContent?navLabel.textContent:"",parentNode=item.parentNode;return!parentNode||"navPoint"!==parentNode.nodeName&&"navPoint"!==parentNode.nodeName.split(":").slice(-1)[0]||(parent=parentNode.getAttribute("id")),{id:id,href:src,label:text,subitems:[],parent:parent}}},{key:"load",value:function(json){var _this=this;return json.map((function(item){return item.label=item.title,item.subitems=item.children?_this.load(item.children):[],item}))}},{key:"forEach",value:function(fn){return this.toc.forEach(fn)}}],protoProps&&navigation_defineProperties(Constructor.prototype,protoProps),staticProps&&navigation_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Navigation}(),navigation=Navigation,mime=__webpack_require__(341),mime_default=__webpack_require__.n(mime);function resources_typeof(o){return resources_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},resources_typeof(o)}function resources_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,resources_toPropertyKey(descriptor.key),descriptor)}}function resources_toPropertyKey(t){var i=function(t,r){if("object"!=resources_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=resources_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==resources_typeof(i)?i:String(i)}var Resources=function(){function Resources(manifest,options){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Resources),this.settings={replacements:options&&options.replacements||"base64",archive:options&&options.archive,resolver:options&&options.resolver,request:options&&options.request},this.process(manifest)}var Constructor,protoProps,staticProps;return Constructor=Resources,protoProps=[{key:"process",value:function(manifest){this.manifest=manifest,this.resources=Object.keys(manifest).map((function(key){return manifest[key]})),this.replacementUrls=[],this.html=[],this.assets=[],this.css=[],this.urls=[],this.cssUrls=[],this.split(),this.splitUrls()}},{key:"split",value:function(){this.html=this.resources.filter((function(item){if("application/xhtml+xml"===item.type||"text/html"===item.type)return!0})),this.assets=this.resources.filter((function(item){if("application/xhtml+xml"!==item.type&&"text/html"!==item.type)return!0})),this.css=this.resources.filter((function(item){if("text/css"===item.type)return!0}))}},{key:"splitUrls",value:function(){this.urls=this.assets.map(function(item){return item.href}.bind(this)),this.cssUrls=this.css.map((function(item){return item.href}))}},{key:"createUrl",value:function(url){var parsedUrl=new utils_url(url),mimeType=mime_default().lookup(parsedUrl.filename);return this.settings.archive?this.settings.archive.createUrl(url,{base64:"base64"===this.settings.replacements}):"base64"===this.settings.replacements?this.settings.request(url,"blob").then((function(blob){return(0,core.blob2base64)(blob)})).then((function(blob){return(0,core.createBase64Url)(blob,mimeType)})):this.settings.request(url,"blob").then((function(blob){return(0,core.createBlobUrl)(blob,mimeType)}))}},{key:"replacements",value:function(){var _this=this;if("none"===this.settings.replacements)return new Promise(function(resolve){resolve(this.urls)}.bind(this));var replacements=this.urls.map((function(url){var absolute=_this.settings.resolver(url);return _this.createUrl(absolute).catch((function(err){return console.error(err),null}))}));return Promise.all(replacements).then((function(replacementUrls){return _this.replacementUrls=replacementUrls.filter((function(url){return"string"==typeof url})),replacementUrls}))}},{key:"replaceCss",value:function(archive,resolver){var replaced=[];return archive=archive||this.settings.archive,resolver=resolver||this.settings.resolver,this.cssUrls.forEach(function(href){var replacement=this.createCssFile(href,archive,resolver).then(function(replacementUrl){var indexInUrls=this.urls.indexOf(href);indexInUrls>-1&&(this.replacementUrls[indexInUrls]=replacementUrl)}.bind(this));replaced.push(replacement)}.bind(this)),Promise.all(replaced)}},{key:"createCssFile",value:function(href){var _this2=this;if(path_default().isAbsolute(href))return new Promise((function(resolve){resolve()}));var textResponse,absolute=this.settings.resolver(href);textResponse=this.settings.archive?this.settings.archive.getText(absolute):this.settings.request(absolute,"text");var relUrls=this.urls.map((function(assetHref){var resolved=_this2.settings.resolver(assetHref);return new utils_path.Z(absolute).relative(resolved)}));return textResponse?textResponse.then((function(text){return text=replacements_substitute(text,relUrls,_this2.replacementUrls),"base64"===_this2.settings.replacements?(0,core.createBase64Url)(text,"text/css"):(0,core.createBlobUrl)(text,"text/css")}),(function(err){return new Promise((function(resolve){resolve()}))})):new Promise((function(resolve){resolve()}))}},{key:"relativeTo",value:function(absolute,resolver){return resolver=resolver||this.settings.resolver,this.urls.map(function(href){var resolved=resolver(href);return new utils_path.Z(absolute).relative(resolved)}.bind(this))}},{key:"get",value:function(path){var indexInUrls=this.urls.indexOf(path);if(-1!==indexInUrls)return this.replacementUrls.length?new Promise(function(resolve,reject){resolve(this.replacementUrls[indexInUrls])}.bind(this)):this.createUrl(path)}},{key:"substitute",value:function(content,url){return replacements_substitute(content,url?this.relativeTo(url):this.urls,this.replacementUrls)}},{key:"destroy",value:function(){this.settings=void 0,this.manifest=void 0,this.resources=void 0,this.replacementUrls=void 0,this.html=void 0,this.assets=void 0,this.css=void 0,this.urls=void 0,this.cssUrls=void 0}}],protoProps&&resources_defineProperties(Constructor.prototype,protoProps),staticProps&&resources_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Resources}(),resources=Resources;function pagelist_typeof(o){return pagelist_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},pagelist_typeof(o)}function pagelist_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,pagelist_toPropertyKey(descriptor.key),descriptor)}}function pagelist_toPropertyKey(t){var i=function(t,r){if("object"!=pagelist_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=pagelist_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==pagelist_typeof(i)?i:String(i)}var pagelist=function(){function PageList(xml){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,PageList),this.pages=[],this.locations=[],this.epubcfi=new epubcfi,this.firstPage=0,this.lastPage=0,this.totalPages=0,this.toc=void 0,this.ncx=void 0,xml&&(this.pageList=this.parse(xml)),this.pageList&&this.pageList.length&&this.process(this.pageList)}var Constructor,protoProps,staticProps;return Constructor=PageList,(protoProps=[{key:"parse",value:function(xml){var html=(0,core.qs)(xml,"html"),ncx=(0,core.qs)(xml,"ncx");return html?this.parseNav(xml):ncx?this.parseNcx(xml):void 0}},{key:"parseNav",value:function(navHtml){var i,item,navElement=(0,core.querySelectorByType)(navHtml,"nav","page-list"),navItems=navElement?(0,core.qsa)(navElement,"li"):[],length=navItems.length,list=[];if(!navItems||0===length)return list;for(i=0;i<length;++i)item=this.item(navItems[i]),list.push(item);return list}},{key:"parseNcx",value:function(navXml){var item,pageList,pageTargets,length,list=[],i=0;if(!(pageList=(0,core.qs)(navXml,"pageList")))return list;if(length=(pageTargets=(0,core.qsa)(pageList,"pageTarget")).length,!pageTargets||0===pageTargets.length)return list;for(i=0;i<length;++i)item=this.ncxItem(pageTargets[i]),list.push(item);return list}},{key:"ncxItem",value:function(item){var navLabel=(0,core.qs)(item,"navLabel"),pageText=(0,core.qs)(navLabel,"text").textContent;return{href:(0,core.qs)(item,"content").getAttribute("src"),page:parseInt(pageText,10)}}},{key:"item",value:function(_item){var split,packageUrl,content=(0,core.qs)(_item,"a"),href=content.getAttribute("href")||"",text=content.textContent||"",page=parseInt(text);return-1!=href.indexOf("epubcfi")?(packageUrl=(split=href.split("#"))[0],{cfi:split.length>1&&split[1],href:href,packageUrl:packageUrl,page:page}):{href:href,page:page}}},{key:"process",value:function(pageList){pageList.forEach((function(item){this.pages.push(item.page),item.cfi&&this.locations.push(item.cfi)}),this),this.firstPage=parseInt(this.pages[0]),this.lastPage=parseInt(this.pages[this.pages.length-1]),this.totalPages=this.lastPage-this.firstPage}},{key:"pageFromCfi",value:function(cfi){var pg=-1;if(0===this.locations.length)return-1;var index=(0,core.indexOfSorted)(cfi,this.locations,this.epubcfi.compare);return-1!=index?pg=this.pages[index]:void 0!==(pg=(index=(0,core.locationOf)(cfi,this.locations,this.epubcfi.compare))-1>=0?this.pages[index-1]:this.pages[0])||(pg=-1),pg}},{key:"cfiFromPage",value:function(pg){var cfi=-1;"number"!=typeof pg&&(pg=parseInt(pg));var index=this.pages.indexOf(pg);return-1!=index&&(cfi=this.locations[index]),cfi}},{key:"pageFromPercentage",value:function(percent){return Math.round(this.totalPages*percent)}},{key:"percentageFromPage",value:function(pg){var percentage=(pg-this.firstPage)/this.totalPages;return Math.round(1e3*percentage)/1e3}},{key:"percentageFromCfi",value:function(cfi){var pg=this.pageFromCfi(cfi);return this.percentageFromPage(pg)}},{key:"destroy",value:function(){this.pages=void 0,this.locations=void 0,this.epubcfi=void 0,this.pageList=void 0,this.toc=void 0,this.ncx=void 0}}])&&pagelist_defineProperties(Constructor.prototype,protoProps),staticProps&&pagelist_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),PageList}();function layout_typeof(o){return layout_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},layout_typeof(o)}function layout_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,layout_toPropertyKey(descriptor.key),descriptor)}}function layout_toPropertyKey(t){var i=function(t,r){if("object"!=layout_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=layout_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==layout_typeof(i)?i:String(i)}var Layout=function(){function Layout(settings){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Layout),this.settings=settings,this.name=settings.layout||"reflowable",this._spread="none"!==settings.spread,this._minSpreadWidth=settings.minSpreadWidth||800,this._evenSpreads=settings.evenSpreads||!1,"scrolled"===settings.flow||"scrolled-continuous"===settings.flow||"scrolled-doc"===settings.flow?this._flow="scrolled":this._flow="paginated",this.width=0,this.height=0,this.spreadWidth=0,this.delta=0,this.columnWidth=0,this.gap=0,this.divisor=1,this.props={name:this.name,spread:this._spread,flow:this._flow,width:0,height:0,spreadWidth:0,delta:0,columnWidth:0,gap:0,divisor:1}}var Constructor,protoProps,staticProps;return Constructor=Layout,protoProps=[{key:"flow",value:function(_flow){return void 0!==_flow&&(this._flow="scrolled"===_flow||"scrolled-continuous"===_flow||"scrolled-doc"===_flow?"scrolled":"paginated",this.update({flow:this._flow})),this._flow}},{key:"spread",value:function(_spread,min){return _spread&&(this._spread="none"!==_spread,this.update({spread:this._spread})),min>=0&&(this._minSpreadWidth=min),this._spread}},{key:"calculate",value:function(_width,_height,_gap){var columnWidth,spreadWidth,pageWidth,delta,divisor=1,gap=_gap||0,width=_width,height=_height,section=Math.floor(width/12);divisor=this._spread&&width>=this._minSpreadWidth?2:1,"reflowable"!==this.name||"paginated"!==this._flow||_gap>=0||(gap=section%2==0?section:section-1),"pre-paginated"===this.name&&(gap=0),divisor>1?pageWidth=(columnWidth=width/divisor-gap)+gap:(columnWidth=width,pageWidth=width),"pre-paginated"===this.name&&divisor>1&&(width=columnWidth),spreadWidth=columnWidth*divisor+gap,delta=width,this.width=width,this.height=height,this.spreadWidth=spreadWidth,this.pageWidth=pageWidth,this.delta=delta,this.columnWidth=columnWidth,this.gap=gap,this.divisor=divisor,this.update({width:width,height:height,spreadWidth:spreadWidth,pageWidth:pageWidth,delta:delta,columnWidth:columnWidth,gap:gap,divisor:divisor})}},{key:"format",value:function(contents){return"pre-paginated"===this.name?contents.fit(this.columnWidth,this.height):"paginated"===this._flow?contents.columns(this.width,this.height,this.columnWidth,this.gap):contents.size(this.width,null)}},{key:"count",value:function(totalLength,pageLength){var spreads,pages;return"pre-paginated"===this.name?(spreads=1,pages=1):"paginated"===this._flow?(pageLength=pageLength||this.delta,pages=(spreads=Math.ceil(totalLength/pageLength))*this.divisor):(pageLength=pageLength||this.height,pages=spreads=Math.ceil(totalLength/pageLength)),{spreads:spreads,pages:pages}}},{key:"update",value:function(props){var _this=this;if(Object.keys(props).forEach((function(propName){_this.props[propName]===props[propName]&&delete props[propName]})),Object.keys(props).length>0){var newProps=(0,core.extend)(this.props,props);this.emit(EVENTS_LAYOUT.UPDATED,newProps,props)}}}],protoProps&&layout_defineProperties(Constructor.prototype,protoProps),staticProps&&layout_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Layout}();event_emitter_default()(Layout.prototype);var src_layout=Layout;function themes_typeof(o){return themes_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},themes_typeof(o)}function themes_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,themes_toPropertyKey(descriptor.key),descriptor)}}function themes_toPropertyKey(t){var i=function(t,r){if("object"!=themes_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=themes_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==themes_typeof(i)?i:String(i)}var Themes=function(){function Themes(rendition){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Themes),this.rendition=rendition,this._themes={default:{rules:{},url:"",serialized:""}},this._overrides={},this._current="default",this._injected=[],this.rendition.hooks.content.register(this.inject.bind(this)),this.rendition.hooks.content.register(this.overrides.bind(this))}var Constructor,protoProps,staticProps;return Constructor=Themes,protoProps=[{key:"register",value:function(){if(0!==arguments.length)return 1===arguments.length&&"object"===themes_typeof(arguments[0])?this.registerThemes(arguments[0]):1===arguments.length&&"string"==typeof arguments[0]?this.default(arguments[0]):2===arguments.length&&"string"==typeof arguments[1]?this.registerUrl(arguments[0],arguments[1]):2===arguments.length&&"object"===themes_typeof(arguments[1])?this.registerRules(arguments[0],arguments[1]):void 0}},{key:"default",value:function(theme){if(theme)return"string"==typeof theme?this.registerUrl("default",theme):"object"===themes_typeof(theme)?this.registerRules("default",theme):void 0}},{key:"registerThemes",value:function(themes){for(var theme in themes)themes.hasOwnProperty(theme)&&("string"==typeof themes[theme]?this.registerUrl(theme,themes[theme]):this.registerRules(theme,themes[theme]))}},{key:"registerUrl",value:function(name,input){var url=new utils_url(input);this._themes[name]={url:url.toString()},this._injected[name]&&this.update(name)}},{key:"registerRules",value:function(name,rules){this._themes[name]={rules:rules},this._injected[name]&&this.update(name)}},{key:"select",value:function(name){var prev=this._current;this._current=name,this.update(name),this.rendition.getContents().forEach((function(content){content.removeClass(prev),content.addClass(name)}))}},{key:"update",value:function(name){var _this=this;this.rendition.getContents().forEach((function(content){_this.add(name,content)}))}},{key:"inject",value:function(contents){var theme,links=[],themes=this._themes;for(var name in themes)!themes.hasOwnProperty(name)||name!==this._current&&"default"!==name||(((theme=themes[name]).rules&&Object.keys(theme.rules).length>0||theme.url&&-1===links.indexOf(theme.url))&&this.add(name,contents),this._injected.push(name));"default"!=this._current&&contents.addClass(this._current)}},{key:"add",value:function(name,contents){var theme=this._themes[name];theme&&contents&&(theme.url?contents.addStylesheet(theme.url):theme.serialized||theme.rules&&(contents.addStylesheetRules(theme.rules),theme.injected=!0))}},{key:"override",value:function(name,value,priority){var _this2=this,contents=this.rendition.getContents();this._overrides[name]={value:value,priority:!0===priority},contents.forEach((function(content){content.css(name,_this2._overrides[name].value,_this2._overrides[name].priority)}))}},{key:"overrides",value:function(contents){var overrides=this._overrides;for(var rule in overrides)overrides.hasOwnProperty(rule)&&contents.css(rule,overrides[rule].value,overrides[rule].priority)}},{key:"fontSize",value:function(size){this.override("font-size",size)}},{key:"font",value:function(f){this.override("font-family",f,!0)}},{key:"destroy",value:function(){this.rendition=void 0,this._themes=void 0,this._overrides=void 0,this._current=void 0,this._injected=void 0}}],protoProps&&themes_defineProperties(Constructor.prototype,protoProps),staticProps&&themes_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Themes}(),themes=Themes;function mapping_typeof(o){return mapping_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},mapping_typeof(o)}function mapping_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,mapping_toPropertyKey(descriptor.key),descriptor)}}function mapping_toPropertyKey(t){var i=function(t,r){if("object"!=mapping_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=mapping_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==mapping_typeof(i)?i:String(i)}var Mapping=function(){function Mapping(layout,direction,axis,dev){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Mapping),this.layout=layout,this.horizontal="horizontal"===axis,this.direction=direction||"ltr",this._dev=dev}var Constructor,protoProps,staticProps;return Constructor=Mapping,protoProps=[{key:"section",value:function(view){var ranges=this.findRanges(view);return this.rangeListToCfiList(view.section.cfiBase,ranges)}},{key:"page",value:function(contents,cfiBase,start,end){var result,root=!(!contents||!contents.document)&&contents.document.body;if(root){if(result=this.rangePairToCfiPair(cfiBase,{start:this.findStart(root,start,end),end:this.findEnd(root,start,end)}),!0===this._dev){var doc=contents.document,startRange=new epubcfi(result.start).toRange(doc),endRange=new epubcfi(result.end).toRange(doc),selection=doc.defaultView.getSelection(),r=doc.createRange();selection.removeAllRanges(),r.setStart(startRange.startContainer,startRange.startOffset),r.setEnd(endRange.endContainer,endRange.endOffset),selection.addRange(r)}return result}}},{key:"walk",value:function(root,func){if(!root||root.nodeType!==Node.TEXT_NODE){var filter_acceptNode=function(node){return node.data.trim().length>0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT},safeFilter=filter_acceptNode;safeFilter.acceptNode=filter_acceptNode;for(var node,result,treeWalker=document.createTreeWalker(root,NodeFilter.SHOW_TEXT,safeFilter,!1);(node=treeWalker.nextNode())&&!(result=func(node)););return result}}},{key:"findRanges",value:function(view){for(var start,end,columns=[],scrollWidth=view.contents.scrollWidth(),count=Math.ceil(scrollWidth/this.layout.spreadWidth)*this.layout.divisor,columnWidth=this.layout.columnWidth,gap=this.layout.gap,i=0;i<count.pages;i++)start=(columnWidth+gap)*i,end=columnWidth*(i+1)+gap*i,columns.push({start:this.findStart(view.document.body,start,end),end:this.findEnd(view.document.body,start,end)});return columns}},{key:"findStart",value:function(root,start,end){for(var $el,found,_this=this,stack=[root],$prev=root;stack.length;)if($el=stack.shift(),found=this.walk($el,(function(node){var left,right,top,bottom,elPos;if(elPos=(0,core.nodeBounds)(node),_this.horizontal&&"ltr"===_this.direction){if(left=_this.horizontal?elPos.left:elPos.top,right=_this.horizontal?elPos.right:elPos.bottom,left>=start&&left<=end)return node;if(right>start)return node;$prev=node,stack.push(node)}else if(_this.horizontal&&"rtl"===_this.direction){if(left=elPos.left,(right=elPos.right)<=end&&right>=start)return node;if(left<end)return node;$prev=node,stack.push(node)}else{if(top=elPos.top,bottom=elPos.bottom,top>=start&&top<=end)return node;if(bottom>start)return node;$prev=node,stack.push(node)}})))return this.findTextStartRange(found,start,end);return this.findTextStartRange($prev,start,end)}},{key:"findEnd",value:function(root,start,end){for(var $el,found,_this2=this,stack=[root],$prev=root;stack.length;)if($el=stack.shift(),found=this.walk($el,(function(node){var left,right,top,bottom,elPos;if(elPos=(0,core.nodeBounds)(node),_this2.horizontal&&"ltr"===_this2.direction){if(left=Math.round(elPos.left),right=Math.round(elPos.right),left>end&&$prev)return $prev;if(right>end)return node;$prev=node,stack.push(node)}else if(_this2.horizontal&&"rtl"===_this2.direction){if(left=Math.round(_this2.horizontal?elPos.left:elPos.top),(right=Math.round(_this2.horizontal?elPos.right:elPos.bottom))<start&&$prev)return $prev;if(left<start)return node;$prev=node,stack.push(node)}else{if(top=Math.round(elPos.top),bottom=Math.round(elPos.bottom),top>end&&$prev)return $prev;if(bottom>end)return node;$prev=node,stack.push(node)}})))return this.findTextEndRange(found,start,end);return this.findTextEndRange($prev,start,end)}},{key:"findTextStartRange",value:function(node,start,end){for(var range,pos,ranges=this.splitTextNodeIntoRanges(node),i=0;i<ranges.length;i++)if(pos=(range=ranges[i]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(pos.left>=start)return range}else if(this.horizontal&&"rtl"===this.direction){if(pos.right<=end)return range}else if(pos.top>=start)return range;return ranges[0]}},{key:"findTextEndRange",value:function(node,start,end){for(var prev,range,pos,left,right,top,bottom,ranges=this.splitTextNodeIntoRanges(node),i=0;i<ranges.length;i++){if(pos=(range=ranges[i]).getBoundingClientRect(),this.horizontal&&"ltr"===this.direction){if(left=pos.left,right=pos.right,left>end&&prev)return prev;if(right>end)return range}else if(this.horizontal&&"rtl"===this.direction){if(left=pos.left,(right=pos.right)<start&&prev)return prev;if(left<start)return range}else{if(top=pos.top,bottom=pos.bottom,top>end&&prev)return prev;if(bottom>end)return range}prev=range}return ranges[ranges.length-1]}},{key:"splitTextNodeIntoRanges",value:function(node,_splitter){var range,ranges=[],text=(node.textContent||"").trim(),doc=node.ownerDocument,splitter=_splitter||" ",pos=text.indexOf(splitter);if(-1===pos||node.nodeType!=Node.TEXT_NODE)return(range=doc.createRange()).selectNodeContents(node),[range];for((range=doc.createRange()).setStart(node,0),range.setEnd(node,pos),ranges.push(range),range=!1;-1!=pos;)(pos=text.indexOf(splitter,pos+1))>0&&(range&&(range.setEnd(node,pos),ranges.push(range)),(range=doc.createRange()).setStart(node,pos+1));return range&&(range.setEnd(node,text.length),ranges.push(range)),ranges}},{key:"rangePairToCfiPair",value:function(cfiBase,rangePair){var startRange=rangePair.start,endRange=rangePair.end;return startRange.collapse(!0),endRange.collapse(!1),{start:new epubcfi(startRange,cfiBase).toString(),end:new epubcfi(endRange,cfiBase).toString()}}},{key:"rangeListToCfiList",value:function(cfiBase,columns){for(var cifPair,map=[],i=0;i<columns.length;i++)cifPair=this.rangePairToCfiPair(cfiBase,columns[i]),map.push(cifPair);return map}},{key:"axis",value:function(_axis){return _axis&&(this.horizontal="horizontal"===_axis),this.horizontal}}],protoProps&&mapping_defineProperties(Constructor.prototype,protoProps),staticProps&&mapping_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Mapping}(),src_mapping=Mapping;function contents_typeof(o){return contents_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},contents_typeof(o)}function contents_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,contents_toPropertyKey(descriptor.key),descriptor)}}function contents_toPropertyKey(t){var i=function(t,r){if("object"!=contents_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=contents_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==contents_typeof(i)?i:String(i)}var hasNavigator="undefined"!=typeof navigator,isChrome=hasNavigator&&/Chrome/.test(navigator.userAgent),isWebkit=hasNavigator&&!isChrome&&/AppleWebKit/.test(navigator.userAgent),Contents=function(){function Contents(doc,content,cfiBase,sectionIndex){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Contents),this.epubcfi=new epubcfi,this.document=doc,this.documentElement=this.document.documentElement,this.content=content||this.document.body,this.window=this.document.defaultView,this._size={width:0,height:0},this.sectionIndex=sectionIndex||0,this.cfiBase=cfiBase||"",this.epubReadingSystem("epub.js","0.3"),this.listeners()}var Constructor,protoProps,staticProps;return Constructor=Contents,protoProps=[{key:"width",value:function(w){var frame=this.content;return w&&(0,core.isNumber)(w)&&(w+="px"),w&&(frame.style.width=w),this.window.getComputedStyle(frame).width}},{key:"height",value:function(h){var frame=this.content;return h&&(0,core.isNumber)(h)&&(h+="px"),h&&(frame.style.height=h),this.window.getComputedStyle(frame).height}},{key:"contentWidth",value:function(w){var content=this.content||this.document.body;return w&&(0,core.isNumber)(w)&&(w+="px"),w&&(content.style.width=w),this.window.getComputedStyle(content).width}},{key:"contentHeight",value:function(h){var content=this.content||this.document.body;return h&&(0,core.isNumber)(h)&&(h+="px"),h&&(content.style.height=h),this.window.getComputedStyle(content).height}},{key:"textWidth",value:function(){var width,range=this.document.createRange(),content=this.content||this.document.body,border=(0,core.borders)(content);return range.selectNodeContents(content),width=range.getBoundingClientRect().width,border&&border.width&&(width+=border.width),Math.round(width)}},{key:"textHeight",value:function(){var rect,height,range=this.document.createRange(),content=this.content||this.document.body,border=(0,core.borders)(content);return range.selectNodeContents(content),(height=(rect=range.getBoundingClientRect()).height)&&border.height&&(height+=border.height),height&&rect.top&&(height+=rect.top),Math.round(height)}},{key:"scrollWidth",value:function(){return this.documentElement.scrollWidth}},{key:"scrollHeight",value:function(){return this.documentElement.scrollHeight}},{key:"overflow",value:function(_overflow){return _overflow&&(this.documentElement.style.overflow=_overflow),this.window.getComputedStyle(this.documentElement).overflow}},{key:"overflowX",value:function(overflow){return overflow&&(this.documentElement.style.overflowX=overflow),this.window.getComputedStyle(this.documentElement).overflowX}},{key:"overflowY",value:function(overflow){return overflow&&(this.documentElement.style.overflowY=overflow),this.window.getComputedStyle(this.documentElement).overflowY}},{key:"css",value:function(property,value,priority){var content=this.content||this.document.body;return value&&content.style.setProperty(property,value,priority?"important":""),this.window.getComputedStyle(content)[property]}},{key:"viewport",value:function(options){var settings,$viewport=this.document.querySelector("meta[name='viewport']"),parsed={width:void 0,height:void 0,scale:void 0,minimum:void 0,maximum:void 0,scalable:void 0},newContent=[];if($viewport&&$viewport.hasAttribute("content")){var content=$viewport.getAttribute("content"),_width2=content.match(/width\s*=\s*([^,]*)/),_height2=content.match(/height\s*=\s*([^,]*)/),_scale2=content.match(/initial-scale\s*=\s*([^,]*)/),_minimum2=content.match(/minimum-scale\s*=\s*([^,]*)/),_maximum2=content.match(/maximum-scale\s*=\s*([^,]*)/),_scalable2=content.match(/user-scalable\s*=\s*([^,]*)/);_width2&&_width2.length&&void 0!==_width2[1]&&(parsed.width=_width2[1]),_height2&&_height2.length&&void 0!==_height2[1]&&(parsed.height=_height2[1]),_scale2&&_scale2.length&&void 0!==_scale2[1]&&(parsed.scale=_scale2[1]),_minimum2&&_minimum2.length&&void 0!==_minimum2[1]&&(parsed.minimum=_minimum2[1]),_maximum2&&_maximum2.length&&void 0!==_maximum2[1]&&(parsed.maximum=_maximum2[1]),_scalable2&&_scalable2.length&&void 0!==_scalable2[1]&&(parsed.scalable=_scalable2[1])}return settings=(0,core.defaults)(options||{},parsed),options&&(settings.width&&newContent.push("width="+settings.width),settings.height&&newContent.push("height="+settings.height),settings.scale&&newContent.push("initial-scale="+settings.scale),"no"===settings.scalable?(newContent.push("minimum-scale="+settings.scale),newContent.push("maximum-scale="+settings.scale),newContent.push("user-scalable="+settings.scalable)):(settings.scalable&&newContent.push("user-scalable="+settings.scalable),settings.minimum&&newContent.push("minimum-scale="+settings.minimum),settings.maximum&&newContent.push("minimum-scale="+settings.maximum)),$viewport||(($viewport=this.document.createElement("meta")).setAttribute("name","viewport"),this.document.querySelector("head").appendChild($viewport)),$viewport.setAttribute("content",newContent.join(", ")),this.window.scrollTo(0,0)),settings}},{key:"expand",value:function(){this.emit(EVENTS_CONTENTS.EXPAND)}},{key:"listeners",value:function(){this.imageLoadListeners(),this.mediaQueryListeners(),this.addEventListeners(),this.addSelectionListeners(),this.resizeListeners(),this.linksHandler()}},{key:"removeListeners",value:function(){this.removeEventListeners(),this.removeSelectionListeners(),clearTimeout(this.expanding)}},{key:"resizeCheck",value:function(){var width=this.textWidth(),height=this.textHeight();width==this._size.width&&height==this._size.height||(this._size={width:width,height:height},this.onResize&&this.onResize(this._size),this.emit(EVENTS_CONTENTS.RESIZE,this._size))}},{key:"resizeListeners",value:function(){clearTimeout(this.expanding),requestAnimationFrame(this.resizeCheck.bind(this)),this.expanding=setTimeout(this.resizeListeners.bind(this),350)}},{key:"transitionListeners",value:function(){var body=this.content;body.style.transitionProperty="font, font-size, font-size-adjust, font-stretch, font-variation-settings, font-weight, width, height",body.style.transitionDuration="0.001ms",body.style.transitionTimingFunction="linear",body.style.transitionDelay="0",this._resizeCheck=this.resizeCheck.bind(this),this.document.addEventListener("transitionend",this._resizeCheck)}},{key:"mediaQueryListeners",value:function(){for(var sheets=this.document.styleSheets,mediaChangeHandler=function(m){m.matches&&!this._expanding&&setTimeout(this.expand.bind(this),1)}.bind(this),i=0;i<sheets.length;i+=1){var rules;try{rules=sheets[i].cssRules}catch(e){return}if(!rules)return;for(var j=0;j<rules.length;j+=1)rules[j].media&&this.window.matchMedia(rules[j].media.mediaText).addListener(mediaChangeHandler)}}},{key:"resizeObservers",value:function(){var _this=this;this.observer=new MutationObserver((function(mutations){_this.resizeCheck()})),this.observer.observe(this.document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})}},{key:"imageLoadListeners",value:function(){for(var img,images=this.document.querySelectorAll("img"),i=0;i<images.length;i++)void 0!==(img=images[i]).naturalWidth&&0===img.naturalWidth&&(img.onload=this.expand.bind(this))}},{key:"fontLoadListeners",value:function(){this.document&&this.document.fonts&&this.document.fonts.ready.then(function(){this.resizeCheck()}.bind(this))}},{key:"root",value:function(){return this.document?this.document.documentElement:null}},{key:"locationOf",value:function(target,ignoreClass){var position,targetPos={left:0,top:0};if(!this.document)return targetPos;if(this.epubcfi.isCfiString(target)){var range=new epubcfi(target).toRange(this.document,ignoreClass);if(range)if(range.startContainer.nodeType===Node.ELEMENT_NODE)position=range.startContainer.getBoundingClientRect(),targetPos.left=position.left,targetPos.top=position.top;else if(isWebkit){var container=range.startContainer,newRange=new Range;try{1===container.nodeType?position=container.getBoundingClientRect():range.startOffset+2<container.length?(newRange.setStart(container,range.startOffset),newRange.setEnd(container,range.startOffset+2),position=newRange.getBoundingClientRect()):range.startOffset-2>0?(newRange.setStart(container,range.startOffset-2),newRange.setEnd(container,range.startOffset),position=newRange.getBoundingClientRect()):position=container.parentNode.getBoundingClientRect()}catch(e){console.error(e,e.stack)}}else position=range.getBoundingClientRect()}else if("string"==typeof target&&target.indexOf("#")>-1){var id=target.substring(target.indexOf("#")+1),el=this.document.getElementById(id);if(el)if(isWebkit){var _newRange=new Range;_newRange.selectNode(el),position=_newRange.getBoundingClientRect()}else position=el.getBoundingClientRect()}return position&&(targetPos.left=position.left,targetPos.top=position.top),targetPos}},{key:"addStylesheet",value:function(src){return new Promise(function(resolve,reject){var $stylesheet,ready=!1;this.document?($stylesheet=this.document.querySelector("link[href='"+src+"']"))?resolve(!0):(($stylesheet=this.document.createElement("link")).type="text/css",$stylesheet.rel="stylesheet",$stylesheet.href=src,$stylesheet.onload=$stylesheet.onreadystatechange=function(){ready||this.readyState&&"complete"!=this.readyState||(ready=!0,setTimeout((function(){resolve(!0)}),1))},this.document.head.appendChild($stylesheet)):resolve(!1)}.bind(this))}},{key:"addStylesheetRules",value:function(rules){var styleEl,styleSheet,key="epubjs-inserted-css";if(this.document&&rules&&0!==rules.length)if((styleEl=this.document.getElementById("#"+key))||((styleEl=this.document.createElement("style")).id=key),this.document.head.appendChild(styleEl),styleSheet=styleEl.sheet,"[object Array]"===Object.prototype.toString.call(rules))for(var i=0,rl=rules.length;i<rl;i++){var j=1,rule=rules[i],selector=rules[i][0],propStr="";"[object Array]"===Object.prototype.toString.call(rule[1][0])&&(rule=rule[1],j=0);for(var pl=rule.length;j<pl;j++){var prop=rule[j];propStr+=prop[0]+":"+prop[1]+(prop[2]?" !important":"")+";\n"}styleSheet.insertRule(selector+"{"+propStr+"}",styleSheet.cssRules.length)}else Object.keys(rules).forEach((function(selector){var definition=rules[selector];if(Array.isArray(definition))definition.forEach((function(item){var result=Object.keys(item).map((function(rule){return"".concat(rule,":").concat(item[rule])})).join(";");styleSheet.insertRule("".concat(selector,"{").concat(result,"}"),styleSheet.cssRules.length)}));else{var result=Object.keys(definition).map((function(rule){return"".concat(rule,":").concat(definition[rule])})).join(";");styleSheet.insertRule("".concat(selector,"{").concat(result,"}"),styleSheet.cssRules.length)}}))}},{key:"addScript",value:function(src){return new Promise(function(resolve,reject){var $script,ready=!1;this.document?(($script=this.document.createElement("script")).type="text/javascript",$script.async=!0,$script.src=src,$script.onload=$script.onreadystatechange=function(){ready||this.readyState&&"complete"!=this.readyState||(ready=!0,setTimeout((function(){resolve(!0)}),1))},this.document.head.appendChild($script)):resolve(!1)}.bind(this))}},{key:"addClass",value:function(className){var content;this.document&&(content=this.content||this.document.body)&&content.classList.add(className)}},{key:"removeClass",value:function(className){var content;this.document&&(content=this.content||this.document.body)&&content.classList.remove(className)}},{key:"addEventListeners",value:function(){this.document&&(this._triggerEvent=this.triggerEvent.bind(this),DOM_EVENTS.forEach((function(eventName){this.document.addEventListener(eventName,this._triggerEvent,{passive:!0})}),this))}},{key:"removeEventListeners",value:function(){this.document&&(DOM_EVENTS.forEach((function(eventName){this.document.removeEventListener(eventName,this._triggerEvent,{passive:!0})}),this),this._triggerEvent=void 0)}},{key:"triggerEvent",value:function(e){this.emit(e.type,e)}},{key:"addSelectionListeners",value:function(){this.document&&(this._onSelectionChange=this.onSelectionChange.bind(this),this.document.addEventListener("selectionchange",this._onSelectionChange,{passive:!0}))}},{key:"removeSelectionListeners",value:function(){this.document&&(this.document.removeEventListener("selectionchange",this._onSelectionChange,{passive:!0}),this._onSelectionChange=void 0)}},{key:"onSelectionChange",value:function(e){this.selectionEndTimeout&&clearTimeout(this.selectionEndTimeout),this.selectionEndTimeout=setTimeout(function(){var selection=this.window.getSelection();this.triggerSelectedEvent(selection)}.bind(this),250)}},{key:"triggerSelectedEvent",value:function(selection){var range,cfirange;selection&&selection.rangeCount>0&&((range=selection.getRangeAt(0)).collapsed||(cfirange=new epubcfi(range,this.cfiBase).toString(),this.emit(EVENTS_CONTENTS.SELECTED,cfirange),this.emit(EVENTS_CONTENTS.SELECTED_RANGE,range)))}},{key:"range",value:function(_cfi,ignoreClass){return new epubcfi(_cfi).toRange(this.document,ignoreClass)}},{key:"cfiFromRange",value:function(range,ignoreClass){return new epubcfi(range,this.cfiBase,ignoreClass).toString()}},{key:"cfiFromNode",value:function(node,ignoreClass){return new epubcfi(node,this.cfiBase,ignoreClass).toString()}},{key:"map",value:function(layout){var map=new src_mapping(layout);return map.section()}},{key:"size",value:function(width,height){var viewport={scale:1,scalable:"no"};this.layoutStyle("scrolling"),width>=0&&(this.width(width),viewport.width=width,this.css("padding","0 "+width/12+"px")),height>=0&&(this.height(height),viewport.height=height),this.css("margin","0"),this.css("box-sizing","border-box"),this.viewport(viewport)}},{key:"columns",value:function(width,height,columnWidth,gap){var COLUMN_AXIS=(0,core.prefixed)("column-axis"),COLUMN_GAP=(0,core.prefixed)("column-gap"),COLUMN_WIDTH=(0,core.prefixed)("column-width"),COLUMN_FILL=(0,core.prefixed)("column-fill"),axis=0===this.writingMode().indexOf("vertical")?"vertical":"horizontal";this.layoutStyle("paginated"),"rtl"===this.content.dir&&this.direction("rtl"),this.width(width),this.height(height),this.viewport({width:width,height:height,scale:1,scalable:"no"}),this.css("overflow-y","hidden"),this.css("margin","0",!0),"vertical"===axis?(this.css("padding-top",gap/2+"px",!0),this.css("padding-bottom",gap/2+"px",!0),this.css("padding-left","20px"),this.css("padding-right","20px")):(this.css("padding-top","20px"),this.css("padding-bottom","20px"),this.css("padding-left",gap/2+"px",!0),this.css("padding-right",gap/2+"px",!0)),this.css("box-sizing","border-box"),this.css("max-width","inherit"),this.css(COLUMN_AXIS,"horizontal"),this.css(COLUMN_FILL,"auto"),this.css(COLUMN_GAP,gap+"px"),this.css(COLUMN_WIDTH,columnWidth+"px")}},{key:"scaler",value:function(scale,offsetX,offsetY){var scaleStr="scale("+scale+")",translateStr="";this.css("transform-origin","top left"),(offsetX>=0||offsetY>=0)&&(translateStr=" translate("+(offsetX||0)+"px, "+(offsetY||0)+"px )"),this.css("transform",scaleStr+translateStr)}},{key:"fit",value:function(width,height){var viewport=this.viewport(),viewportWidth=parseInt(viewport.width),viewportHeight=parseInt(viewport.height),widthScale=width/viewportWidth,heightScale=height/viewportHeight,scale=widthScale<heightScale?widthScale:heightScale;this.layoutStyle("paginated"),this.width(viewportWidth),this.height(viewportHeight),this.overflow("hidden"),this.scaler(scale,0,0),this.css("background-size",viewportWidth*scale+"px "+viewportHeight*scale+"px"),this.css("background-color","transparent")}},{key:"direction",value:function(dir){this.documentElement&&(this.documentElement.style.direction=dir)}},{key:"mapPage",value:function(cfiBase,layout,start,end,dev){return new src_mapping(layout,dev).page(this,cfiBase,start,end)}},{key:"linksHandler",value:function(){var _this2=this;!function(contents,fn){var links=contents.querySelectorAll("a[href]");if(links.length)for(var base=(0,core.qs)(contents.ownerDocument,"base"),location=base?base.getAttribute("href"):void 0,replaceLink=function(link){var href=link.getAttribute("href");if(0!==href.indexOf("mailto:"))if(href.indexOf("://")>-1)link.setAttribute("target","_blank");else{var linkUrl;try{linkUrl=new utils_url(href,location)}catch(error){}link.onclick=function(){return linkUrl&&linkUrl.hash?fn(linkUrl.Path.path+linkUrl.hash):fn(linkUrl?linkUrl.Path.path:href),!1}}}.bind(this),i=0;i<links.length;i++)replaceLink(links[i])}(this.content,(function(href){_this2.emit(EVENTS_CONTENTS.LINK_CLICKED,href)}))}},{key:"writingMode",value:function(mode){var WRITING_MODE=(0,core.prefixed)("writing-mode");return mode&&this.documentElement&&(this.documentElement.style[WRITING_MODE]=mode),this.window.getComputedStyle(this.documentElement)[WRITING_MODE]||""}},{key:"layoutStyle",value:function(style){return style&&(this._layoutStyle=style,navigator.epubReadingSystem.layoutStyle=this._layoutStyle),this._layoutStyle||"paginated"}},{key:"epubReadingSystem",value:function(name,version){return navigator.epubReadingSystem={name:name,version:version,layoutStyle:this.layoutStyle(),hasFeature:function(feature){switch(feature){case"dom-manipulation":case"layout-changes":case"touch-events":case"mouse-events":case"keyboard-events":return!0;default:return!1}}},navigator.epubReadingSystem}},{key:"destroy",value:function(){this.observer&&this.observer.disconnect(),this.document.removeEventListener("transitionend",this._resizeCheck),this.removeListeners()}}],staticProps=[{key:"listenedEvents",get:function(){return DOM_EVENTS}}],protoProps&&contents_defineProperties(Constructor.prototype,protoProps),staticProps&&contents_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Contents}();event_emitter_default()(Contents.prototype);var contents=Contents;function annotations_typeof(o){return annotations_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},annotations_typeof(o)}function annotations_classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function annotations_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,annotations_toPropertyKey(descriptor.key),descriptor)}}function annotations_createClass(Constructor,protoProps,staticProps){return protoProps&&annotations_defineProperties(Constructor.prototype,protoProps),staticProps&&annotations_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function annotations_toPropertyKey(t){var i=function(t,r){if("object"!=annotations_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=annotations_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==annotations_typeof(i)?i:String(i)}var Annotations=function(){function Annotations(rendition){annotations_classCallCheck(this,Annotations),this.rendition=rendition,this.highlights=[],this.underlines=[],this.marks=[],this._annotations={},this._annotationsBySectionIndex={},this.rendition.hooks.render.register(this.inject.bind(this)),this.rendition.hooks.unloaded.register(this.clear.bind(this))}return annotations_createClass(Annotations,[{key:"add",value:function(type,cfiRange,data,cb,className,styles){var hash=encodeURI(cfiRange+type),sectionIndex=new epubcfi(cfiRange).spinePos,annotation=new Annotation({type:type,cfiRange:cfiRange,data:data,sectionIndex:sectionIndex,cb:cb,className:className,styles:styles});return this._annotations[hash]=annotation,sectionIndex in this._annotationsBySectionIndex?this._annotationsBySectionIndex[sectionIndex].push(hash):this._annotationsBySectionIndex[sectionIndex]=[hash],this.rendition.views().forEach((function(view){annotation.sectionIndex===view.index&&annotation.attach(view)})),annotation}},{key:"remove",value:function(cfiRange,type){var _this=this,hash=encodeURI(cfiRange+type);if(hash in this._annotations){var annotation=this._annotations[hash];if(type&&annotation.type!==type)return;this.rendition.views().forEach((function(view){_this._removeFromAnnotationBySectionIndex(annotation.sectionIndex,hash),annotation.sectionIndex===view.index&&annotation.detach(view)})),delete this._annotations[hash]}}},{key:"_removeFromAnnotationBySectionIndex",value:function(sectionIndex,hash){this._annotationsBySectionIndex[sectionIndex]=this._annotationsAt(sectionIndex).filter((function(h){return h!==hash}))}},{key:"_annotationsAt",value:function(index){return this._annotationsBySectionIndex[index]}},{key:"highlight",value:function(cfiRange,data,cb,className,styles){return this.add("highlight",cfiRange,data,cb,className,styles)}},{key:"underline",value:function(cfiRange,data,cb,className,styles){return this.add("underline",cfiRange,data,cb,className,styles)}},{key:"mark",value:function(cfiRange,data,cb){return this.add("mark",cfiRange,data,cb)}},{key:"each",value:function(){return this._annotations.forEach.apply(this._annotations,arguments)}},{key:"inject",value:function(view){var _this2=this,sectionIndex=view.index;sectionIndex in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[sectionIndex].forEach((function(hash){_this2._annotations[hash].attach(view)}))}},{key:"clear",value:function(view){var _this3=this,sectionIndex=view.index;sectionIndex in this._annotationsBySectionIndex&&this._annotationsBySectionIndex[sectionIndex].forEach((function(hash){_this3._annotations[hash].detach(view)}))}},{key:"show",value:function(){}},{key:"hide",value:function(){}}]),Annotations}(),Annotation=function(){function Annotation(_ref){var type=_ref.type,cfiRange=_ref.cfiRange,data=_ref.data,sectionIndex=_ref.sectionIndex,cb=_ref.cb,className=_ref.className,styles=_ref.styles;annotations_classCallCheck(this,Annotation),this.type=type,this.cfiRange=cfiRange,this.data=data,this.sectionIndex=sectionIndex,this.mark=void 0,this.cb=cb,this.className=className,this.styles=styles}return annotations_createClass(Annotation,[{key:"update",value:function(data){this.data=data}},{key:"attach",value:function(view){var result,cfiRange=this.cfiRange,data=this.data,type=this.type,cb=(this.mark,this.cb),className=this.className,styles=this.styles;return"highlight"===type?result=view.highlight(cfiRange,data,cb,className,styles):"underline"===type?result=view.underline(cfiRange,data,cb,className,styles):"mark"===type&&(result=view.mark(cfiRange,data,cb)),this.mark=result,this.emit(EVENTS_ANNOTATION.ATTACH,result),result}},{key:"detach",value:function(view){var result,cfiRange=this.cfiRange,type=this.type;return view&&("highlight"===type?result=view.unhighlight(cfiRange):"underline"===type?result=view.ununderline(cfiRange):"mark"===type&&(result=view.unmark(cfiRange))),this.mark=void 0,this.emit(EVENTS_ANNOTATION.DETACH,result),result}},{key:"text",value:function(){}}]),Annotation}();event_emitter_default()(Annotation.prototype);var annotations=Annotations,marks=__webpack_require__(6769);function iframe_typeof(o){return iframe_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},iframe_typeof(o)}function iframe_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,iframe_toPropertyKey(descriptor.key),descriptor)}}function iframe_toPropertyKey(t){var i=function(t,r){if("object"!=iframe_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=iframe_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==iframe_typeof(i)?i:String(i)}var IframeView=function(){function IframeView(section,options){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,IframeView),this.settings=(0,core.extend)({ignoreClass:"",axis:options.layout&&"scrolled"===options.layout.props.flow?"vertical":"horizontal",direction:void 0,width:0,height:0,layout:void 0,globalLayoutProperties:{},method:void 0},options||{}),this.id="epubjs-view-"+(0,core.uuid)(),this.section=section,this.index=section.index,this.element=this.container(this.settings.axis),this.added=!1,this.displayed=!1,this.rendered=!1,this.fixedWidth=0,this.fixedHeight=0,this.epubcfi=new epubcfi,this.layout=this.settings.layout,this.pane=void 0,this.highlights={},this.underlines={},this.marks={}}var Constructor,protoProps,staticProps;return Constructor=IframeView,protoProps=[{key:"container",value:function(axis){var element=document.createElement("div");return element.classList.add("epub-view"),element.style.height="0px",element.style.width="0px",element.style.overflow="hidden",element.style.position="relative",element.style.display="block",element.style.flex=axis&&"horizontal"==axis?"none":"initial",element}},{key:"create",value:function(){return this.iframe||(this.element||(this.element=this.createContainer()),this.iframe=document.createElement("iframe"),this.iframe.id=this.id,this.iframe.scrolling="no",this.iframe.style.overflow="hidden",this.iframe.seamless="seamless",this.iframe.style.border="none",this.iframe.setAttribute("enable-annotation","true"),this.resizing=!0,this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this.element.setAttribute("ref",this.index),this.added=!0,this.elementBounds=(0,core.bounds)(this.element),"srcdoc"in this.iframe?this.supportsSrcdoc=!0:this.supportsSrcdoc=!1,this.settings.method||(this.settings.method=this.supportsSrcdoc?"srcdoc":"write")),this.iframe}},{key:"render",value:function(request,show){return this.create(),this.size(),this.sectionRender||(this.sectionRender=this.section.render(request)),this.sectionRender.then(function(contents){return this.load(contents)}.bind(this)).then(function(){var _this=this;this.layout.format(this.contents);var axis=0===this.contents.writingMode().indexOf("vertical")?"vertical":"horizontal";return this.setAxis(axis),this.emit(EVENTS_VIEWS.AXIS,axis),this.addListeners(),new Promise((function(resolve,reject){_this.expand(),resolve()}))}.bind(this),function(e){return this.emit(EVENTS_VIEWS.LOAD_ERROR,e),new Promise((function(resolve,reject){reject(e)}))}.bind(this)).then(function(){this.emit(EVENTS_VIEWS.RENDERED,this.section)}.bind(this))}},{key:"reset",value:function(){this.iframe&&(this.iframe.style.width="0",this.iframe.style.height="0",this._width=0,this._height=0,this._textWidth=void 0,this._contentWidth=void 0,this._textHeight=void 0,this._contentHeight=void 0),this._needsReframe=!0}},{key:"size",value:function(_width,_height){var width=_width||this.settings.width,height=_height||this.settings.height;"pre-paginated"===this.layout.name?this.lock("both",width,height):"horizontal"===this.settings.axis?this.lock("height",width,height):this.lock("width",width,height),this.settings.width=width,this.settings.height=height}},{key:"lock",value:function(what,width,height){var iframeBorders,elBorders=(0,core.borders)(this.element);iframeBorders=this.iframe?(0,core.borders)(this.iframe):{width:0,height:0},"width"==what&&(0,core.isNumber)(width)&&(this.lockedWidth=width-elBorders.width-iframeBorders.width),"height"==what&&(0,core.isNumber)(height)&&(this.lockedHeight=height-elBorders.height-iframeBorders.height),"both"===what&&(0,core.isNumber)(width)&&(0,core.isNumber)(height)&&(this.lockedWidth=width-elBorders.width-iframeBorders.width,this.lockedHeight=height-elBorders.height-iframeBorders.height),this.displayed&&this.iframe&&this.expand()}},{key:"expand",value:function(force){var columns,width=this.lockedWidth,height=this.lockedHeight;this.iframe&&!this._expanding&&(this._expanding=!0,"pre-paginated"===this.layout.name?(width=this.layout.columnWidth,height=this.layout.height):"horizontal"===this.settings.axis?((width=this.contents.textWidth())%this.layout.pageWidth>0&&(width=Math.ceil(width/this.layout.pageWidth)*this.layout.pageWidth),this.settings.forceEvenPages&&(columns=width/this.layout.pageWidth,this.layout.divisor>1&&"reflowable"===this.layout.name&&columns%2>0&&(width+=this.layout.pageWidth))):"vertical"===this.settings.axis&&(height=this.contents.textHeight()),(this._needsReframe||width!=this._width||height!=this._height)&&this.reframe(width,height),this._expanding=!1)}},{key:"reframe",value:function(width,height){var size,_this2=this;(0,core.isNumber)(width)&&(this.element.style.width=width+"px",this.iframe.style.width=width+"px",this._width=width),(0,core.isNumber)(height)&&(this.element.style.height=height+"px",this.iframe.style.height=height+"px",this._height=height),size={width:width,height:height,widthDelta:this.prevBounds?width-this.prevBounds.width:width,heightDelta:this.prevBounds?height-this.prevBounds.height:height},this.pane&&this.pane.render(),requestAnimationFrame((function(){var mark;for(var m in _this2.marks)_this2.marks.hasOwnProperty(m)&&(mark=_this2.marks[m],_this2.placeMark(mark.element,mark.range))})),this.onResize(this,size),this.emit(EVENTS_VIEWS.RESIZED,size),this.prevBounds=size,this.elementBounds=(0,core.bounds)(this.element)}},{key:"load",value:function(contents){var loading=new core.defer,loaded=loading.promise;if(!this.iframe)return loading.reject(new Error("No Iframe Available")),loaded;if(this.iframe.onload=function(event){this.onLoad(event,loading)}.bind(this),"blobUrl"===this.settings.method)this.blobUrl=(0,core.createBlobUrl)(contents,"application/xhtml+xml"),this.iframe.src=this.blobUrl,this.element.appendChild(this.iframe);else if("srcdoc"===this.settings.method)this.iframe.srcdoc=contents,this.element.appendChild(this.iframe);else{if(this.element.appendChild(this.iframe),this.document=this.iframe.contentDocument,!this.document)return loading.reject(new Error("No Document Available")),loaded;this.iframe.contentDocument.open(),this.iframe.contentDocument.write(contents),this.iframe.contentDocument.close()}return loaded}},{key:"onLoad",value:function(event,promise){var _this3=this;this.window=this.iframe.contentWindow,this.document=this.iframe.contentDocument,this.contents=new contents(this.document,this.document.body,this.section.cfiBase,this.section.index),this.rendering=!1;var link=this.document.querySelector("link[rel='canonical']");link?link.setAttribute("href",this.section.canonical):((link=this.document.createElement("link")).setAttribute("rel","canonical"),link.setAttribute("href",this.section.canonical),this.document.querySelector("head").appendChild(link)),this.contents.on(EVENTS_CONTENTS.EXPAND,(function(){_this3.displayed&&_this3.iframe&&(_this3.expand(),_this3.contents&&_this3.layout.format(_this3.contents))})),this.contents.on(EVENTS_CONTENTS.RESIZE,(function(e){_this3.displayed&&_this3.iframe&&(_this3.expand(),_this3.contents&&_this3.layout.format(_this3.contents))})),promise.resolve(this.contents)}},{key:"setLayout",value:function(layout){this.layout=layout,this.contents&&(this.layout.format(this.contents),this.expand())}},{key:"setAxis",value:function(axis){"scrolled"===this.layout.props.flow&&(axis="vertical"),this.settings.axis=axis,this.element.style.flex="horizontal"==axis?"none":"initial",this.size()}},{key:"addListeners",value:function(){}},{key:"removeListeners",value:function(layoutFunc){}},{key:"display",value:function(request){var displayed=new core.defer;return this.displayed?displayed.resolve(this):this.render(request).then(function(){this.emit(EVENTS_VIEWS.DISPLAYED,this),this.onDisplayed(this),this.displayed=!0,displayed.resolve(this)}.bind(this),(function(err){displayed.reject(err,this)})),displayed.promise}},{key:"show",value:function(){this.element.style.visibility="visible",this.iframe&&(this.iframe.style.visibility="visible",this.iframe.style.transform="translateZ(0)",this.iframe.offsetWidth,this.iframe.style.transform=null),this.emit(EVENTS_VIEWS.SHOWN,this)}},{key:"hide",value:function(){this.element.style.visibility="hidden",this.iframe.style.visibility="hidden",this.stopExpanding=!0,this.emit(EVENTS_VIEWS.HIDDEN,this)}},{key:"offset",value:function(){return{top:this.element.offsetTop,left:this.element.offsetLeft}}},{key:"width",value:function(){return this._width}},{key:"height",value:function(){return this._height}},{key:"position",value:function(){return this.element.getBoundingClientRect()}},{key:"locationOf",value:function(target){this.iframe.getBoundingClientRect();var targetPos=this.contents.locationOf(target,this.settings.ignoreClass);return{left:targetPos.left,top:targetPos.top}}},{key:"onDisplayed",value:function(view){}},{key:"onResize",value:function(view,e){}},{key:"bounds",value:function(force){return!force&&this.elementBounds||(this.elementBounds=(0,core.bounds)(this.element)),this.elementBounds}},{key:"highlight",value:function(cfiRange){var _this4=this,data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},cb=arguments.length>2?arguments[2]:void 0,className=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"epubjs-hl",styles=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(this.contents){var attributes=Object.assign({fill:"yellow","fill-opacity":"0.3","mix-blend-mode":"multiply"},styles),range=this.contents.range(cfiRange),emitter=function(){_this4.emit(EVENTS_VIEWS.MARK_CLICKED,cfiRange,data)};data.epubcfi=cfiRange,this.pane||(this.pane=new marks.X6(this.iframe,this.element));var m=new marks.y$(range,className,data,attributes),h=this.pane.addMark(m);return this.highlights[cfiRange]={mark:h,element:h.element,listeners:[emitter,cb]},h.element.setAttribute("ref",className),h.element.addEventListener("click",emitter),h.element.addEventListener("touchstart",emitter),cb&&(h.element.addEventListener("click",cb),h.element.addEventListener("touchstart",cb)),h}}},{key:"underline",value:function(cfiRange){var _this5=this,data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},cb=arguments.length>2?arguments[2]:void 0,className=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"epubjs-ul",styles=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(this.contents){var attributes=Object.assign({stroke:"black","stroke-opacity":"0.3","mix-blend-mode":"multiply"},styles),range=this.contents.range(cfiRange),emitter=function(){_this5.emit(EVENTS_VIEWS.MARK_CLICKED,cfiRange,data)};data.epubcfi=cfiRange,this.pane||(this.pane=new marks.X6(this.iframe,this.element));var m=new marks.v6(range,className,data,attributes),h=this.pane.addMark(m);return this.underlines[cfiRange]={mark:h,element:h.element,listeners:[emitter,cb]},h.element.setAttribute("ref",className),h.element.addEventListener("click",emitter),h.element.addEventListener("touchstart",emitter),cb&&(h.element.addEventListener("click",cb),h.element.addEventListener("touchstart",cb)),h}}},{key:"mark",value:function(cfiRange){var _this6=this,data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},cb=arguments.length>2?arguments[2]:void 0;if(this.contents){if(cfiRange in this.marks)return this.marks[cfiRange];var range=this.contents.range(cfiRange);if(range){var container=range.commonAncestorContainer,parent=1===container.nodeType?container:container.parentNode,emitter=function(e){_this6.emit(EVENTS_VIEWS.MARK_CLICKED,cfiRange,data)};range.collapsed&&1===container.nodeType?(range=new Range).selectNodeContents(container):range.collapsed&&(range=new Range).selectNodeContents(parent);var mark=this.document.createElement("a");return mark.setAttribute("ref","epubjs-mk"),mark.style.position="absolute",mark.dataset.epubcfi=cfiRange,data&&Object.keys(data).forEach((function(key){mark.dataset[key]=data[key]})),cb&&(mark.addEventListener("click",cb),mark.addEventListener("touchstart",cb)),mark.addEventListener("click",emitter),mark.addEventListener("touchstart",emitter),this.placeMark(mark,range),this.element.appendChild(mark),this.marks[cfiRange]={element:mark,range:range,listeners:[emitter,cb]},parent}}}},{key:"placeMark",value:function(element,range){var top,right,left;if("pre-paginated"===this.layout.name||"horizontal"!==this.settings.axis){var pos=range.getBoundingClientRect();top=pos.top,right=pos.right}else for(var rect,rects=range.getClientRects(),i=0;i!=rects.length;i++)rect=rects[i],(!left||rect.left<left)&&(left=rect.left,right=Math.ceil(left/this.layout.props.pageWidth)*this.layout.props.pageWidth-this.layout.gap/2,top=rect.top);element.style.top="".concat(top,"px"),element.style.left="".concat(right,"px")}},{key:"unhighlight",value:function(cfiRange){var item;cfiRange in this.highlights&&(item=this.highlights[cfiRange],this.pane.removeMark(item.mark),item.listeners.forEach((function(l){l&&(item.element.removeEventListener("click",l),item.element.removeEventListener("touchstart",l))})),delete this.highlights[cfiRange])}},{key:"ununderline",value:function(cfiRange){var item;cfiRange in this.underlines&&(item=this.underlines[cfiRange],this.pane.removeMark(item.mark),item.listeners.forEach((function(l){l&&(item.element.removeEventListener("click",l),item.element.removeEventListener("touchstart",l))})),delete this.underlines[cfiRange])}},{key:"unmark",value:function(cfiRange){var item;cfiRange in this.marks&&(item=this.marks[cfiRange],this.element.removeChild(item.element),item.listeners.forEach((function(l){l&&(item.element.removeEventListener("click",l),item.element.removeEventListener("touchstart",l))})),delete this.marks[cfiRange])}},{key:"destroy",value:function(){for(var cfiRange in this.highlights)this.unhighlight(cfiRange);for(var _cfiRange in this.underlines)this.ununderline(_cfiRange);for(var _cfiRange2 in this.marks)this.unmark(_cfiRange2);this.blobUrl&&(0,core.revokeBlobUrl)(this.blobUrl),this.displayed&&(this.displayed=!1,this.removeListeners(),this.contents.destroy(),this.stopExpanding=!0,this.element.removeChild(this.iframe),this.iframe=void 0,this.contents=void 0,this._textWidth=null,this._textHeight=null,this._width=null,this._height=null)}}],protoProps&&iframe_defineProperties(Constructor.prototype,protoProps),staticProps&&iframe_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),IframeView}();event_emitter_default()(IframeView.prototype);var iframe=IframeView,throttle=__webpack_require__(1984),throttle_default=__webpack_require__.n(throttle);function stage_typeof(o){return stage_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},stage_typeof(o)}function stage_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,stage_toPropertyKey(descriptor.key),descriptor)}}function stage_toPropertyKey(t){var i=function(t,r){if("object"!=stage_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=stage_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==stage_typeof(i)?i:String(i)}var Stage=function(){function Stage(_options){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Stage),this.settings=_options||{},this.id="epubjs-container-"+(0,core.uuid)(),this.container=this.create(this.settings),this.settings.hidden&&(this.wrapper=this.wrap(this.container))}var Constructor,protoProps,staticProps;return Constructor=Stage,protoProps=[{key:"create",value:function(options){var height=options.height,width=options.width,overflow=options.overflow||!1,axis=options.axis||"vertical",direction=options.direction;(0,core.extend)(this.settings,options),options.height&&(0,core.isNumber)(options.height)&&(height=options.height+"px"),options.width&&(0,core.isNumber)(options.width)&&(width=options.width+"px");var container=document.createElement("div");return container.id=this.id,container.classList.add("epub-container"),container.style.wordSpacing="0",container.style.lineHeight="0",container.style.verticalAlign="top",container.style.position="relative","horizontal"===axis&&(container.style.display="flex",container.style.flexDirection="row",container.style.flexWrap="nowrap"),width&&(container.style.width=width),height&&(container.style.height=height),overflow&&("scroll"===overflow&&"vertical"===axis?(container.style["overflow-y"]=overflow,container.style["overflow-x"]="hidden"):"scroll"===overflow&&"horizontal"===axis?(container.style["overflow-y"]="hidden",container.style["overflow-x"]=overflow):container.style.overflow=overflow),direction&&(container.dir=direction,container.style.direction=direction),direction&&this.settings.fullsize&&(document.body.style.direction=direction),container}},{key:"wrap",value:function(container){var wrapper=document.createElement("div");return wrapper.style.visibility="hidden",wrapper.style.overflow="hidden",wrapper.style.width="0",wrapper.style.height="0",wrapper.appendChild(container),wrapper}},{key:"getElement",value:function(_element){var element;if((0,core.isElement)(_element)?element=_element:"string"==typeof _element&&(element=document.getElementById(_element)),!element)throw new Error("Not an Element");return element}},{key:"attachTo",value:function(what){var base,element=this.getElement(what);if(element)return base=this.settings.hidden?this.wrapper:this.container,element.appendChild(base),this.element=element,element}},{key:"getContainer",value:function(){return this.container}},{key:"onResize",value:function(func){(0,core.isNumber)(this.settings.width)&&(0,core.isNumber)(this.settings.height)||(this.resizeFunc=throttle_default()(func,50),window.addEventListener("resize",this.resizeFunc,!1))}},{key:"onOrientationChange",value:function(func){this.orientationChangeFunc=func,window.addEventListener("orientationchange",this.orientationChangeFunc,!1)}},{key:"size",value:function(width,height){var bounds,_width=width||this.settings.width,_height=height||this.settings.height;null===width?(bounds=this.element.getBoundingClientRect()).width&&(width=Math.floor(bounds.width),this.container.style.width=width+"px"):(0,core.isNumber)(width)?this.container.style.width=width+"px":this.container.style.width=width,null===height?(bounds=bounds||this.element.getBoundingClientRect()).height&&(height=bounds.height,this.container.style.height=height+"px"):(0,core.isNumber)(height)?this.container.style.height=height+"px":this.container.style.height=height,(0,core.isNumber)(width)||(width=this.container.clientWidth),(0,core.isNumber)(height)||(height=this.container.clientHeight),this.containerStyles=window.getComputedStyle(this.container),this.containerPadding={left:parseFloat(this.containerStyles["padding-left"])||0,right:parseFloat(this.containerStyles["padding-right"])||0,top:parseFloat(this.containerStyles["padding-top"])||0,bottom:parseFloat(this.containerStyles["padding-bottom"])||0};var _windowBounds=(0,core.windowBounds)(),bodyStyles=window.getComputedStyle(document.body),bodyPadding_left=parseFloat(bodyStyles["padding-left"])||0,bodyPadding_right=parseFloat(bodyStyles["padding-right"])||0,bodyPadding_top=parseFloat(bodyStyles["padding-top"])||0,bodyPadding_bottom=parseFloat(bodyStyles["padding-bottom"])||0;return _width||(width=_windowBounds.width-bodyPadding_left-bodyPadding_right),(this.settings.fullsize&&!_height||!_height)&&(height=_windowBounds.height-bodyPadding_top-bodyPadding_bottom),{width:width-this.containerPadding.left-this.containerPadding.right,height:height-this.containerPadding.top-this.containerPadding.bottom}}},{key:"bounds",value:function(){var box;return"visible"!==this.container.style.overflow&&(box=this.container&&this.container.getBoundingClientRect()),box&&box.width&&box.height?box:(0,core.windowBounds)()}},{key:"getSheet",value:function(){var style=document.createElement("style");return style.appendChild(document.createTextNode("")),document.head.appendChild(style),style.sheet}},{key:"addStyleRules",value:function(selector,rulesArray){var scope="#"+this.id+" ",rules="";this.sheet||(this.sheet=this.getSheet()),rulesArray.forEach((function(set){for(var prop in set)set.hasOwnProperty(prop)&&(rules+=prop+":"+set[prop]+";")})),this.sheet.insertRule(scope+selector+" {"+rules+"}",0)}},{key:"axis",value:function(_axis){"horizontal"===_axis?(this.container.style.display="flex",this.container.style.flexDirection="row",this.container.style.flexWrap="nowrap"):this.container.style.display="block",this.settings.axis=_axis}},{key:"direction",value:function(dir){this.container&&(this.container.dir=dir,this.container.style.direction=dir),this.settings.fullsize&&(document.body.style.direction=dir),this.settings.dir=dir}},{key:"overflow",value:function(_overflow){this.container&&("scroll"===_overflow&&"vertical"===this.settings.axis?(this.container.style["overflow-y"]=_overflow,this.container.style["overflow-x"]="hidden"):"scroll"===_overflow&&"horizontal"===this.settings.axis?(this.container.style["overflow-y"]="hidden",this.container.style["overflow-x"]=_overflow):this.container.style.overflow=_overflow),this.settings.overflow=_overflow}},{key:"destroy",value:function(){this.element&&(this.settings.hidden?this.wrapper:this.container,this.element.contains(this.container)&&this.element.removeChild(this.container),window.removeEventListener("resize",this.resizeFunc),window.removeEventListener("orientationChange",this.orientationChangeFunc))}}],protoProps&&stage_defineProperties(Constructor.prototype,protoProps),staticProps&&stage_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Stage}(),stage=Stage;function views_typeof(o){return views_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},views_typeof(o)}function views_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,views_toPropertyKey(descriptor.key),descriptor)}}function views_toPropertyKey(t){var i=function(t,r){if("object"!=views_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=views_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==views_typeof(i)?i:String(i)}var Views=function(){function Views(container){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Views),this.container=container,this._views=[],this.length=0,this.hidden=!1}var Constructor,protoProps,staticProps;return Constructor=Views,protoProps=[{key:"all",value:function(){return this._views}},{key:"first",value:function(){return this._views[0]}},{key:"last",value:function(){return this._views[this._views.length-1]}},{key:"indexOf",value:function(view){return this._views.indexOf(view)}},{key:"slice",value:function(){return this._views.slice.apply(this._views,arguments)}},{key:"get",value:function(i){return this._views[i]}},{key:"append",value:function(view){return this._views.push(view),this.container&&this.container.appendChild(view.element),this.length++,view}},{key:"prepend",value:function(view){return this._views.unshift(view),this.container&&this.container.insertBefore(view.element,this.container.firstChild),this.length++,view}},{key:"insert",value:function(view,index){return this._views.splice(index,0,view),this.container&&(index<this.container.children.length?this.container.insertBefore(view.element,this.container.children[index]):this.container.appendChild(view.element)),this.length++,view}},{key:"remove",value:function(view){var index=this._views.indexOf(view);index>-1&&this._views.splice(index,1),this.destroy(view),this.length--}},{key:"destroy",value:function(view){view.displayed&&view.destroy(),this.container&&this.container.removeChild(view.element),view=null}},{key:"forEach",value:function(){return this._views.forEach.apply(this._views,arguments)}},{key:"clear",value:function(){var view,len=this.length;if(this.length){for(var i=0;i<len;i++)view=this._views[i],this.destroy(view);this._views=[],this.length=0}}},{key:"find",value:function(section){for(var view,len=this.length,i=0;i<len;i++)if((view=this._views[i]).displayed&&view.section.index==section.index)return view}},{key:"displayed",value:function(){for(var view,displayed=[],len=this.length,i=0;i<len;i++)(view=this._views[i]).displayed&&displayed.push(view);return displayed}},{key:"show",value:function(){for(var view,len=this.length,i=0;i<len;i++)(view=this._views[i]).displayed&&view.show();this.hidden=!1}},{key:"hide",value:function(){for(var view,len=this.length,i=0;i<len;i++)(view=this._views[i]).displayed&&view.hide();this.hidden=!0}}],protoProps&&views_defineProperties(Constructor.prototype,protoProps),staticProps&&views_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Views}(),views=Views;function default_typeof(o){return default_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},default_typeof(o)}function default_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,default_toPropertyKey(descriptor.key),descriptor)}}function default_toPropertyKey(t){var i=function(t,r){if("object"!=default_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=default_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==default_typeof(i)?i:String(i)}var DefaultViewManager=function(){function DefaultViewManager(options){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DefaultViewManager),this.name="default",this.optsSettings=options.settings,this.View=options.view,this.request=options.request,this.renditionQueue=options.queue,this.q=new queue(this),this.settings=(0,core.extend)(this.settings||{},{infinite:!0,hidden:!1,width:void 0,height:void 0,axis:void 0,flow:"scrolled",ignoreClass:"",fullsize:void 0}),(0,core.extend)(this.settings,options.settings||{}),this.viewSettings={ignoreClass:this.settings.ignoreClass,axis:this.settings.axis,flow:this.settings.flow,layout:this.layout,method:this.settings.method,width:0,height:0,forceEvenPages:!0},this.rendered=!1}var Constructor,protoProps,staticProps;return Constructor=DefaultViewManager,protoProps=[{key:"render",value:function(element,size){var tag=element.tagName;void 0!==this.settings.fullsize||!tag||"body"!=tag.toLowerCase()&&"html"!=tag.toLowerCase()||(this.settings.fullsize=!0),this.settings.fullsize&&(this.settings.overflow="visible",this.overflow=this.settings.overflow),this.settings.size=size,this.stage=new stage({width:size.width,height:size.height,overflow:this.overflow,hidden:this.settings.hidden,axis:this.settings.axis,fullsize:this.settings.fullsize,direction:this.settings.direction}),this.stage.attachTo(element),this.container=this.stage.getContainer(),this.views=new views(this.container),this._bounds=this.bounds(),this._stageSize=this.stage.size(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.stage.onResize(this.onResized.bind(this)),this.stage.onOrientationChange(this.onOrientationChange.bind(this)),this.addEventListeners(),this.layout&&this.updateLayout(),this.rendered=!0}},{key:"addEventListeners",value:function(){var scroller;window.addEventListener("unload",function(e){this.destroy()}.bind(this)),scroller=this.settings.fullsize?window:this.container,this._onScroll=this.onScroll.bind(this),scroller.addEventListener("scroll",this._onScroll)}},{key:"removeEventListeners",value:function(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}},{key:"destroy",value:function(){clearTimeout(this.orientationTimeout),clearTimeout(this.resizeTimeout),clearTimeout(this.afterScrolled),this.clear(),this.removeEventListeners(),this.stage.destroy(),this.rendered=!1}},{key:"onOrientationChange",value:function(e){var orientation=window.orientation;this.optsSettings.resizeOnOrientationChange&&this.resize(),clearTimeout(this.orientationTimeout),this.orientationTimeout=setTimeout(function(){this.orientationTimeout=void 0,this.optsSettings.resizeOnOrientationChange&&this.resize(),this.emit(EVENTS_MANAGERS.ORIENTATION_CHANGE,orientation)}.bind(this),500)}},{key:"onResized",value:function(e){this.resize()}},{key:"resize",value:function(width,height){var stageSize=this.stage.size(width,height);this.winBounds=(0,core.windowBounds)(),this.orientationTimeout&&this.winBounds.width===this.winBounds.height?this._stageSize=void 0:this._stageSize&&this._stageSize.width===stageSize.width&&this._stageSize.height===stageSize.height||(this._stageSize=stageSize,this._bounds=this.bounds(),this.clear(),this.viewSettings.width=this._stageSize.width,this.viewSettings.height=this._stageSize.height,this.updateLayout(),this.emit(EVENTS_MANAGERS.RESIZED,{width:this._stageSize.width,height:this._stageSize.height}))}},{key:"createView",value:function(section){return new this.View(section,this.viewSettings)}},{key:"display",value:function(section,target){var displaying=new core.defer,displayed=displaying.promise;(target===section.href||(0,core.isNumber)(target))&&(target=void 0);var visible=this.views.find(section);if(visible&&section){var offset=visible.offset();if("ltr"===this.settings.direction)this.scrollTo(offset.left,offset.top,!0);else{var width=visible.width();this.scrollTo(offset.left+width,offset.top,!0)}if(target){var _offset=visible.locationOf(target);this.moveTo(_offset)}return displaying.resolve(),displayed}return this.clear(),this.add(section).then(function(view){if(target){var _offset2=view.locationOf(target);this.moveTo(_offset2)}}.bind(this),(function(err){displaying.reject(err)})).then(function(){var next;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&section.index>0&&(next=section.next()))return this.add(next)}.bind(this)).then(function(){this.views.show(),displaying.resolve()}.bind(this)),displayed}},{key:"afterDisplayed",value:function(view){this.emit(EVENTS_MANAGERS.ADDED,view)}},{key:"afterResized",value:function(view){this.emit(EVENTS_MANAGERS.RESIZE,view.section)}},{key:"moveTo",value:function(offset){var distX=0,distY=0;this.isPaginated?(distX=Math.floor(offset.left/this.layout.delta)*this.layout.delta)+this.layout.delta>this.container.scrollWidth&&(distX=this.container.scrollWidth-this.layout.delta):distY=offset.top,this.scrollTo(distX,distY,!0)}},{key:"add",value:function(section){var _this=this,view=this.createView(section);return this.views.append(view),view.onDisplayed=this.afterDisplayed.bind(this),view.onResize=this.afterResized.bind(this),view.on(EVENTS_VIEWS.AXIS,(function(axis){_this.updateAxis(axis)})),view.display(this.request)}},{key:"append",value:function(section){var _this2=this,view=this.createView(section);return this.views.append(view),view.onDisplayed=this.afterDisplayed.bind(this),view.onResize=this.afterResized.bind(this),view.on(EVENTS_VIEWS.AXIS,(function(axis){_this2.updateAxis(axis)})),view.display(this.request)}},{key:"prepend",value:function(section){var _this3=this,view=this.createView(section);return view.on(EVENTS_VIEWS.RESIZED,(function(bounds){_this3.counter(bounds)})),this.views.prepend(view),view.onDisplayed=this.afterDisplayed.bind(this),view.onResize=this.afterResized.bind(this),view.on(EVENTS_VIEWS.AXIS,(function(axis){_this3.updateAxis(axis)})),view.display(this.request)}},{key:"counter",value:function(bounds){"vertical"===this.settings.axis?this.scrollBy(0,bounds.heightDelta,!0):this.scrollBy(bounds.widthDelta,0,!0)}},{key:"next",value:function(){var next,dir=this.settings.direction;if(this.views.length)return!this.isPaginated||"horizontal"!==this.settings.axis||dir&&"ltr"!==dir?this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===dir?(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft>0?this.scrollBy(this.layout.delta,0,!0):next=this.views.last().section.next()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop+this.container.offsetHeight<this.container.scrollHeight?this.scrollBy(0,this.layout.height,!0):next=this.views.last().section.next()):next=this.views.last().section.next():(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft+this.container.offsetWidth+this.layout.delta<=this.container.scrollWidth?this.scrollBy(this.layout.delta,0,!0):next=this.views.last().section.next()),next?(this.clear(),this.append(next).then(function(){var right;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&(right=next.next()))return this.append(right)}.bind(this),(function(err){return err})).then(function(){this.views.show()}.bind(this))):void 0}},{key:"prev",value:function(){var prev,dir=this.settings.direction;if(this.views.length)return!this.isPaginated||"horizontal"!==this.settings.axis||dir&&"ltr"!==dir?this.isPaginated&&"horizontal"===this.settings.axis&&"rtl"===dir?(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft+this.container.offsetWidth+this.layout.delta<=this.container.scrollWidth?this.scrollBy(-this.layout.delta,0,!0):prev=this.views.first().section.prev()):this.isPaginated&&"vertical"===this.settings.axis?(this.scrollTop=this.container.scrollTop,this.container.scrollTop>0?this.scrollBy(0,-this.layout.height,!0):prev=this.views.first().section.prev()):prev=this.views.first().section.prev():(this.scrollLeft=this.container.scrollLeft,this.container.scrollLeft>0?this.scrollBy(-this.layout.delta,0,!0):prev=this.views.first().section.prev()),prev?(this.clear(),this.prepend(prev).then(function(){var left;if("pre-paginated"===this.layout.name&&this.layout.divisor>1&&(left=prev.prev()))return this.prepend(left)}.bind(this),(function(err){return err})).then(function(){this.isPaginated&&"horizontal"===this.settings.axis&&("rtl"===this.settings.direction?this.scrollTo(0,0,!0):this.scrollTo(this.container.scrollWidth-this.layout.delta,0,!0)),this.views.show()}.bind(this))):void 0}},{key:"current",value:function(){var visible=this.visible();return visible.length?visible[visible.length-1]:null}},{key:"clear",value:function(){this.views&&(this.views.hide(),this.scrollTo(0,0,!0),this.views.clear())}},{key:"currentLocation",value:function(){return"vertical"===this.settings.axis?this.location=this.scrolledLocation():this.location=this.paginatedLocation(),this.location}},{key:"scrolledLocation",value:function(){var _this4=this,visible=this.visible(),container=this.container.getBoundingClientRect(),pageHeight=container.height<window.innerHeight?container.height:window.innerHeight,offset=0,used=0;return this.settings.fullsize&&(offset=window.scrollY),visible.map((function(view){var _view$section=view.section,index=_view$section.index,href=_view$section.href,position=view.position(),height=view.height(),startPos=offset+container.top-position.top+used,endPos=startPos+pageHeight-used;endPos>height&&(used=(endPos=height)-startPos);var totalPages=_this4.layout.count(height,pageHeight).pages,currPage=Math.ceil(startPos/pageHeight),pages=[],endPage=Math.ceil(endPos/pageHeight);pages=[];for(var i=currPage;i<=endPage;i++){var pg=i+1;pages.push(pg)}return{index:index,href:href,pages:pages,totalPages:totalPages,mapping:_this4.mapping.page(view.contents,view.section.cfiBase,startPos,endPos)}}))}},{key:"paginatedLocation",value:function(){var _this5=this,visible=this.visible(),container=this.container.getBoundingClientRect(),left=0;return this.settings.fullsize&&(left=window.scrollX),visible.map((function(view){var _view$section2=view.section,index=_view$section2.index,href=_view$section2.href,position=(view.offset().left,view.position().left),width=view.width(),start=left+container.left-position+0,end=start+_this5.layout.width-0,mapping=_this5.mapping.page(view.contents,view.section.cfiBase,start,end),totalPages=_this5.layout.count(width).pages,startPage=Math.floor(start/_this5.layout.pageWidth),pages=[],endPage=Math.floor(end/_this5.layout.pageWidth);if(startPage<0&&(startPage=0,endPage+=1),"rtl"===_this5.settings.direction){var tempStartPage=startPage;startPage=totalPages-endPage,endPage=totalPages-tempStartPage}for(var i=startPage+1;i<=endPage;i++){var pg=i;pages.push(pg)}return{index:index,href:href,pages:pages,totalPages:totalPages,mapping:mapping}}))}},{key:"isVisible",value:function(view,offsetPrev,offsetNext,_container){var position=view.position(),container=_container||this.bounds();return"horizontal"===this.settings.axis&&position.right>container.left-offsetPrev&&position.left<container.right+offsetNext||"vertical"===this.settings.axis&&position.bottom>container.top-offsetPrev&&position.top<container.bottom+offsetNext}},{key:"visible",value:function(){for(var view,container=this.bounds(),views=this.views.displayed(),viewsLength=views.length,visible=[],i=0;i<viewsLength;i++)view=views[i],!0===this.isVisible(view,0,0,container)&&visible.push(view);return visible}},{key:"scrollBy",value:function(x,y,silent){var dir="rtl"===this.settings.direction?-1:1;silent&&(this.ignore=!0),this.settings.fullsize?window.scrollBy(x*dir,y*dir):(x&&(this.container.scrollLeft+=x*dir),y&&(this.container.scrollTop+=y)),this.scrolled=!0}},{key:"scrollTo",value:function(x,y,silent){silent&&(this.ignore=!0),this.settings.fullsize?window.scrollTo(x,y):(this.container.scrollLeft=x,this.container.scrollTop=y),this.scrolled=!0}},{key:"onScroll",value:function(){var scrollTop,scrollLeft;this.settings.fullsize?(scrollTop=window.scrollY,scrollLeft=window.scrollX):(scrollTop=this.container.scrollTop,scrollLeft=this.container.scrollLeft),this.scrollTop=scrollTop,this.scrollLeft=scrollLeft,this.ignore?this.ignore=!1:(this.emit(EVENTS_MANAGERS.SCROLL,{top:scrollTop,left:scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.emit(EVENTS_MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),20))}},{key:"bounds",value:function(){var bounds;return bounds=this.stage.bounds(),bounds}},{key:"applyLayout",value:function(layout){this.layout=layout,this.updateLayout()}},{key:"updateLayout",value:function(){this.stage&&(this._stageSize=this.stage.size(),this.isPaginated?(this.layout.calculate(this._stageSize.width,this._stageSize.height,this.settings.gap),this.settings.offset=this.layout.delta):this.layout.calculate(this._stageSize.width,this._stageSize.height),this.viewSettings.width=this.layout.width,this.viewSettings.height=this.layout.height,this.setLayout(this.layout))}},{key:"setLayout",value:function(layout){this.viewSettings.layout=layout,this.mapping=new src_mapping(layout.props,this.settings.direction,this.settings.axis),this.views&&this.views.forEach((function(view){view&&view.setLayout(layout)}))}},{key:"updateAxis",value:function(axis,forceUpdate){this.isPaginated||(axis="vertical"),(forceUpdate||axis!==this.settings.axis)&&(this.settings.axis=axis,this.stage&&this.stage.axis(axis),this.viewSettings.axis=axis,this.mapping&&(this.mapping=new src_mapping(this.layout.props,this.settings.direction,this.settings.axis)),this.layout&&("vertical"===axis?this.layout.spread("none"):this.layout.spread(this.layout.settings.spread)))}},{key:"updateFlow",value:function(flow){var defaultScrolledOverflow=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto",isPaginated="paginated"===flow||"auto"===flow;this.isPaginated=isPaginated,"scrolled-doc"===flow||"scrolled-continuous"===flow||"scrolled"===flow?this.updateAxis("vertical"):this.updateAxis("horizontal"),this.viewSettings.flow=flow,this.settings.overflow?this.overflow=this.settings.overflow:this.overflow=isPaginated?"hidden":defaultScrolledOverflow,this.stage&&this.stage.overflow(this.overflow),this.updateLayout()}},{key:"getContents",value:function(){var contents=[];return this.views?(this.views.forEach((function(view){var viewContents=view&&view.contents;viewContents&&contents.push(viewContents)})),contents):contents}},{key:"direction",value:function(){var dir=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ltr";this.settings.direction=dir,this.stage&&this.stage.direction(dir),this.viewSettings.direction=dir,this.updateLayout()}},{key:"isRendered",value:function(){return this.rendered}}],protoProps&&default_defineProperties(Constructor.prototype,protoProps),staticProps&&default_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),DefaultViewManager}();event_emitter_default()(DefaultViewManager.prototype);var managers_default=DefaultViewManager;function snap_typeof(o){return snap_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},snap_typeof(o)}function snap_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,snap_toPropertyKey(descriptor.key),descriptor)}}function snap_toPropertyKey(t){var i=function(t,r){if("object"!=snap_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=snap_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==snap_typeof(i)?i:String(i)}var PI_D2=Math.PI/2,EASING_EQUATIONS={easeOutSine:function(pos){return Math.sin(pos*PI_D2)},easeInOutSine:function(pos){return-.5*(Math.cos(Math.PI*pos)-1)},easeInOutQuint:function(pos){return(pos/=.5)<1?.5*Math.pow(pos,5):.5*(Math.pow(pos-2,5)+2)},easeInCubic:function(pos){return Math.pow(pos,3)}},Snap=function(){function Snap(manager,options){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Snap),this.settings=(0,core.extend)({duration:80,minVelocity:.2,minDistance:10,easing:EASING_EQUATIONS.easeInCubic},options||{}),this.supportsTouch=this.supportsTouch(),this.supportsTouch&&this.setup(manager)}var Constructor,protoProps,staticProps;return Constructor=Snap,protoProps=[{key:"setup",value:function(manager){this.manager=manager,this.layout=this.manager.layout,this.fullsize=this.manager.settings.fullsize,this.fullsize?(this.element=this.manager.stage.element,this.scroller=window,this.disableScroll()):(this.element=this.manager.stage.container,this.scroller=this.element,this.element.style.WebkitOverflowScrolling="touch"),this.manager.settings.offset=this.layout.width,this.manager.settings.afterScrolledTimeout=2*this.settings.duration,this.isVertical="vertical"===this.manager.settings.axis,this.manager.isPaginated&&!this.isVertical&&(this.touchCanceler=!1,this.resizeCanceler=!1,this.snapping=!1,this.scrollLeft,this.scrollTop,this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0,this.addListeners())}},{key:"supportsTouch",value:function(){return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}},{key:"disableScroll",value:function(){this.element.style.overflow="hidden"}},{key:"enableScroll",value:function(){this.element.style.overflow=""}},{key:"addListeners",value:function(){this._onResize=this.onResize.bind(this),window.addEventListener("resize",this._onResize),this._onScroll=this.onScroll.bind(this),this.scroller.addEventListener("scroll",this._onScroll),this._onTouchStart=this.onTouchStart.bind(this),this.scroller.addEventListener("touchstart",this._onTouchStart,{passive:!0}),this.on("touchstart",this._onTouchStart),this._onTouchMove=this.onTouchMove.bind(this),this.scroller.addEventListener("touchmove",this._onTouchMove,{passive:!0}),this.on("touchmove",this._onTouchMove),this._onTouchEnd=this.onTouchEnd.bind(this),this.scroller.addEventListener("touchend",this._onTouchEnd,{passive:!0}),this.on("touchend",this._onTouchEnd),this._afterDisplayed=this.afterDisplayed.bind(this),this.manager.on(EVENTS_MANAGERS.ADDED,this._afterDisplayed)}},{key:"removeListeners",value:function(){window.removeEventListener("resize",this._onResize),this._onResize=void 0,this.scroller.removeEventListener("scroll",this._onScroll),this._onScroll=void 0,this.scroller.removeEventListener("touchstart",this._onTouchStart,{passive:!0}),this.off("touchstart",this._onTouchStart),this._onTouchStart=void 0,this.scroller.removeEventListener("touchmove",this._onTouchMove,{passive:!0}),this.off("touchmove",this._onTouchMove),this._onTouchMove=void 0,this.scroller.removeEventListener("touchend",this._onTouchEnd,{passive:!0}),this.off("touchend",this._onTouchEnd),this._onTouchEnd=void 0,this.manager.off(EVENTS_MANAGERS.ADDED,this._afterDisplayed),this._afterDisplayed=void 0}},{key:"afterDisplayed",value:function(view){var _this=this,contents=view.contents;["touchstart","touchmove","touchend"].forEach((function(e){contents.on(e,(function(ev){return _this.triggerViewEvent(ev,contents)}))}))}},{key:"triggerViewEvent",value:function(e,contents){this.emit(e.type,e,contents)}},{key:"onScroll",value:function(e){this.scrollLeft=this.fullsize?window.scrollX:this.scroller.scrollLeft,this.scrollTop=this.fullsize?window.scrollY:this.scroller.scrollTop}},{key:"onResize",value:function(e){this.resizeCanceler=!0}},{key:"onTouchStart",value:function(e){var _e$touches$=e.touches[0],screenX=_e$touches$.screenX,screenY=_e$touches$.screenY;this.fullsize&&this.enableScroll(),this.touchCanceler=!0,this.startTouchX||(this.startTouchX=screenX,this.startTouchY=screenY,this.startTime=this.now()),this.endTouchX=screenX,this.endTouchY=screenY,this.endTime=this.now()}},{key:"onTouchMove",value:function(e){var _e$touches$2=e.touches[0],screenX=_e$touches$2.screenX,screenY=_e$touches$2.screenY,deltaY=Math.abs(screenY-this.endTouchY);this.touchCanceler=!0,!this.fullsize&&deltaY<10&&(this.element.scrollLeft-=screenX-this.endTouchX),this.endTouchX=screenX,this.endTouchY=screenY,this.endTime=this.now()}},{key:"onTouchEnd",value:function(e){this.fullsize&&this.disableScroll(),this.touchCanceler=!1;var swipped=this.wasSwiped();0!==swipped?this.snap(swipped):this.snap(),this.startTouchX=void 0,this.startTouchY=void 0,this.startTime=void 0,this.endTouchX=void 0,this.endTouchY=void 0,this.endTime=void 0}},{key:"wasSwiped",value:function(){var snapWidth=this.layout.pageWidth*this.layout.divisor,distance=this.endTouchX-this.startTouchX,absolute=Math.abs(distance),velocity=distance/(this.endTime-this.startTime),minVelocity=this.settings.minVelocity;return absolute<=this.settings.minDistance||absolute>=snapWidth?0:velocity>minVelocity?-1:velocity<-minVelocity?1:void 0}},{key:"needsSnap",value:function(){return this.scrollLeft%(this.layout.pageWidth*this.layout.divisor)!=0}},{key:"snap",value:function(){var howMany=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,left=this.scrollLeft,snapWidth=this.layout.pageWidth*this.layout.divisor,snapTo=Math.round(left/snapWidth)*snapWidth;return howMany&&(snapTo+=howMany*snapWidth),this.smoothScrollTo(snapTo)}},{key:"smoothScrollTo",value:function(destination){var deferred=new core.defer,start=this.scrollLeft,startTime=this.now(),duration=this.settings.duration,easing=this.settings.easing;return this.snapping=!0,function tick(){var now=this.now(),time=Math.min(1,(now-startTime)/duration);if(easing(time),this.touchCanceler||this.resizeCanceler)return this.resizeCanceler=!1,this.snapping=!1,void deferred.resolve();time<1?(window.requestAnimationFrame(tick.bind(this)),this.scrollTo(start+(destination-start)*time,0)):(this.scrollTo(destination,0),this.snapping=!1,deferred.resolve())}.call(this),deferred.promise}},{key:"scrollTo",value:function(){var left=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,top=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.fullsize?window.scroll(left,top):(this.scroller.scrollLeft=left,this.scroller.scrollTop=top)}},{key:"now",value:function(){return"now"in window.performance?performance.now():(new Date).getTime()}},{key:"destroy",value:function(){this.scroller&&(this.fullsize&&this.enableScroll(),this.removeListeners(),this.scroller=void 0)}}],protoProps&&snap_defineProperties(Constructor.prototype,protoProps),staticProps&&snap_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Snap}();event_emitter_default()(Snap.prototype);var snap=Snap,debounce=__webpack_require__(2461),debounce_default=__webpack_require__.n(debounce);function continuous_typeof(o){return continuous_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},continuous_typeof(o)}function continuous_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,continuous_toPropertyKey(descriptor.key),descriptor)}}function continuous_toPropertyKey(t){var i=function(t,r){if("object"!=continuous_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=continuous_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==continuous_typeof(i)?i:String(i)}function continuous_callSuper(_this,derived,args){return derived=continuous_getPrototypeOf(derived),function(self,call){if(call&&("object"===continuous_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(_this,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(derived,args||[],continuous_getPrototypeOf(_this).constructor):derived.apply(_this,args))}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=continuous_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},_get.apply(this,arguments)}function continuous_getPrototypeOf(o){return continuous_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},continuous_getPrototypeOf(o)}function continuous_setPrototypeOf(o,p){return continuous_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},continuous_setPrototypeOf(o,p)}var ContinuousViewManager=function(_DefaultViewManager){function ContinuousViewManager(options){var _this;return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ContinuousViewManager),(_this=continuous_callSuper(this,ContinuousViewManager,[options])).name="continuous",_this.settings=(0,core.extend)(_this.settings||{},{infinite:!0,overflow:void 0,axis:void 0,flow:"scrolled",offset:500,offsetDelta:250,width:void 0,height:void 0,snap:!1,afterScrolledTimeout:10}),(0,core.extend)(_this.settings,options.settings||{}),"undefined"!=options.settings.gap&&0===options.settings.gap&&(_this.settings.gap=options.settings.gap),_this.viewSettings={ignoreClass:_this.settings.ignoreClass,axis:_this.settings.axis,flow:_this.settings.flow,layout:_this.layout,width:0,height:0,forceEvenPages:!1},_this.scrollTop=0,_this.scrollLeft=0,_this}var Constructor,protoProps,staticProps;return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&continuous_setPrototypeOf(subClass,superClass)}(ContinuousViewManager,_DefaultViewManager),Constructor=ContinuousViewManager,protoProps=[{key:"display",value:function(section,target){return managers_default.prototype.display.call(this,section,target).then(function(){return this.fill()}.bind(this))}},{key:"fill",value:function(_full){var _this2=this,full=_full||new core.defer;return this.q.enqueue((function(){return _this2.check()})).then((function(result){result?_this2.fill(full):full.resolve()})),full.promise}},{key:"moveTo",value:function(offset){var distX=0,distY=0;this.isPaginated?(distX=Math.floor(offset.left/this.layout.delta)*this.layout.delta,this.settings.offsetDelta):(distY=offset.top,offset.top,this.settings.offsetDelta),(distX>0||distY>0)&&this.scrollBy(distX,distY,!0)}},{key:"afterResized",value:function(view){this.emit(EVENTS_MANAGERS.RESIZE,view.section)}},{key:"removeShownListeners",value:function(view){view.onDisplayed=function(){}}},{key:"add",value:function(section){var _this3=this,view=this.createView(section);return this.views.append(view),view.on(EVENTS_VIEWS.RESIZED,(function(bounds){view.expanded=!0})),view.on(EVENTS_VIEWS.AXIS,(function(axis){_this3.updateAxis(axis)})),view.onDisplayed=this.afterDisplayed.bind(this),view.onResize=this.afterResized.bind(this),view.display(this.request)}},{key:"append",value:function(section){var _this4=this,view=this.createView(section);return view.on(EVENTS_VIEWS.RESIZED,(function(bounds){view.expanded=!0})),view.on(EVENTS_VIEWS.AXIS,(function(axis){_this4.updateAxis(axis)})),this.views.append(view),view.onDisplayed=this.afterDisplayed.bind(this),view}},{key:"prepend",value:function(section){var _this5=this,view=this.createView(section);return view.on(EVENTS_VIEWS.RESIZED,(function(bounds){_this5.counter(bounds),view.expanded=!0})),view.on(EVENTS_VIEWS.AXIS,(function(axis){_this5.updateAxis(axis)})),this.views.prepend(view),view.onDisplayed=this.afterDisplayed.bind(this),view}},{key:"counter",value:function(bounds){"vertical"===this.settings.axis?this.scrollBy(0,bounds.heightDelta,!0):this.scrollBy(bounds.widthDelta,0,!0)}},{key:"update",value:function(_offset){for(var view,container=this.bounds(),views=this.views.all(),viewsLength=views.length,visible=[],offset=void 0!==_offset?_offset:this.settings.offset||0,updating=new core.defer,promises=[],i=0;i<viewsLength;i++)if(view=views[i],!0===this.isVisible(view,offset,offset,container)){if(view.displayed)view.show();else{var displayed=view.display(this.request).then((function(view){view.show()}),(function(err){view.hide()}));promises.push(displayed)}visible.push(view)}else this.q.enqueue(view.destroy.bind(view)),clearTimeout(this.trimTimeout),this.trimTimeout=setTimeout(function(){this.q.enqueue(this.trim.bind(this))}.bind(this),250);return promises.length?Promise.all(promises).catch((function(err){updating.reject(err)})):(updating.resolve(),updating.promise)}},{key:"check",value:function(_offsetLeft,_offsetTop){var _this6=this,checking=new core.defer,newViews=[],horizontal="horizontal"===this.settings.axis,delta=this.settings.offset||0;_offsetLeft&&horizontal&&(delta=_offsetLeft),_offsetTop&&!horizontal&&(delta=_offsetTop);var bounds=this._bounds,rtl="rtl"===this.settings.direction,dir=horizontal&&rtl?-1:1,offset=horizontal?this.scrollLeft:this.scrollTop*dir,visibleLength=horizontal?Math.floor(bounds.width):bounds.height,contentLength=horizontal?this.container.scrollWidth:this.container.scrollHeight,prepend=function(){var first=_this6.views.first(),prev=first&&first.section.prev();prev&&newViews.push(_this6.prepend(prev))},append=function(){var last=_this6.views.last(),next=last&&last.section.next();next&&newViews.push(_this6.append(next))};offset+visibleLength+delta>=contentLength&&(horizontal&&rtl?prepend():append()),offset-delta<0&&(horizontal&&rtl?append():prepend());var promises=newViews.map((function(view){return view.displayed}));return newViews.length?Promise.all(promises).then((function(){if("pre-paginated"===_this6.layout.name&&_this6.layout.props.spread)return _this6.check()})).then((function(){return _this6.update(delta)}),(function(err){return err})):(this.q.enqueue(function(){this.update()}.bind(this)),checking.resolve(!1),checking.promise)}},{key:"trim",value:function(){for(var task=new core.defer,displayed=this.views.displayed(),first=displayed[0],last=displayed[displayed.length-1],firstIndex=this.views.indexOf(first),lastIndex=this.views.indexOf(last),above=this.views.slice(0,firstIndex),below=this.views.slice(lastIndex+1),i=0;i<above.length-1;i++)this.erase(above[i],above);for(var j=1;j<below.length;j++)this.erase(below[j]);return task.resolve(),task.promise}},{key:"erase",value:function(view,above){var prevTop,prevLeft;this.settings.fullsize?(prevTop=window.scrollY,prevLeft=window.scrollX):(prevTop=this.container.scrollTop,prevLeft=this.container.scrollLeft);var bounds=view.bounds();this.views.remove(view),above&&("vertical"===this.settings.axis?this.scrollTo(0,prevTop-bounds.height,!0):this.scrollTo(prevLeft-Math.floor(bounds.width),0,!0))}},{key:"addEventListeners",value:function(stage){window.addEventListener("unload",function(e){this.ignore=!0,this.destroy()}.bind(this)),this.addScrollListeners(),this.isPaginated&&this.settings.snap&&(this.snapper=new snap(this,this.settings.snap&&"object"===continuous_typeof(this.settings.snap)&&this.settings.snap))}},{key:"addScrollListeners",value:function(){var scroller;this.tick=core.requestAnimationFrame,this.settings.fullsize?(this.prevScrollTop=window.scrollY,this.prevScrollLeft=window.scrollX):(this.prevScrollTop=this.container.scrollTop,this.prevScrollLeft=this.container.scrollLeft),this.scrollDeltaVert=0,this.scrollDeltaHorz=0,this.settings.fullsize?(scroller=window,this.scrollTop=window.scrollY,this.scrollLeft=window.scrollX):(scroller=this.container,this.scrollTop=this.container.scrollTop,this.scrollLeft=this.container.scrollLeft),this._onScroll=this.onScroll.bind(this),scroller.addEventListener("scroll",this._onScroll),this._scrolled=debounce_default()(this.scrolled.bind(this),30),this.didScroll=!1}},{key:"removeEventListeners",value:function(){(this.settings.fullsize?window:this.container).removeEventListener("scroll",this._onScroll),this._onScroll=void 0}},{key:"onScroll",value:function(){var scrollTop,scrollLeft,dir="rtl"===this.settings.direction?-1:1;this.settings.fullsize?(scrollTop=window.scrollY*dir,scrollLeft=window.scrollX*dir):(scrollTop=this.container.scrollTop,scrollLeft=this.container.scrollLeft),this.scrollTop=scrollTop,this.scrollLeft=scrollLeft,this.ignore?this.ignore=!1:this._scrolled(),this.scrollDeltaVert+=Math.abs(scrollTop-this.prevScrollTop),this.scrollDeltaHorz+=Math.abs(scrollLeft-this.prevScrollLeft),this.prevScrollTop=scrollTop,this.prevScrollLeft=scrollLeft,clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(function(){this.scrollDeltaVert=0,this.scrollDeltaHorz=0}.bind(this),150),clearTimeout(this.afterScrolled),this.didScroll=!1}},{key:"scrolled",value:function(){this.q.enqueue(function(){this.check()}.bind(this)),this.emit(EVENTS_MANAGERS.SCROLL,{top:this.scrollTop,left:this.scrollLeft}),clearTimeout(this.afterScrolled),this.afterScrolled=setTimeout(function(){this.snapper&&this.snapper.supportsTouch&&this.snapper.needsSnap()||this.emit(EVENTS_MANAGERS.SCROLLED,{top:this.scrollTop,left:this.scrollLeft})}.bind(this),this.settings.afterScrolledTimeout)}},{key:"next",value:function(){this.settings.direction;var delta="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(delta,0,!0):this.scrollBy(0,this.layout.height,!0),this.q.enqueue(function(){this.check()}.bind(this)))}},{key:"prev",value:function(){this.settings.direction;var delta="pre-paginated"===this.layout.props.name&&this.layout.props.spread?2*this.layout.props.delta:this.layout.props.delta;this.views.length&&(this.isPaginated&&"horizontal"===this.settings.axis?this.scrollBy(-delta,0,!0):this.scrollBy(0,-this.layout.height,!0),this.q.enqueue(function(){this.check()}.bind(this)))}},{key:"updateFlow",value:function(flow){this.rendered&&this.snapper&&(this.snapper.destroy(),this.snapper=void 0),_get(continuous_getPrototypeOf(ContinuousViewManager.prototype),"updateFlow",this).call(this,flow,"scroll"),this.rendered&&this.isPaginated&&this.settings.snap&&(this.snapper=new snap(this,this.settings.snap&&"object"===continuous_typeof(this.settings.snap)&&this.settings.snap))}},{key:"destroy",value:function(){_get(continuous_getPrototypeOf(ContinuousViewManager.prototype),"destroy",this).call(this),this.snapper&&this.snapper.destroy()}}],protoProps&&continuous_defineProperties(Constructor.prototype,protoProps),staticProps&&continuous_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),ContinuousViewManager}(managers_default),continuous=ContinuousViewManager;function rendition_typeof(o){return rendition_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},rendition_typeof(o)}function rendition_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,rendition_toPropertyKey(descriptor.key),descriptor)}}function rendition_toPropertyKey(t){var i=function(t,r){if("object"!=rendition_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=rendition_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==rendition_typeof(i)?i:String(i)}var Rendition=function(){function Rendition(book,options){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Rendition),this.settings=(0,core.extend)(this.settings||{},{width:null,height:null,ignoreClass:"",manager:"default",view:"iframe",flow:null,layout:null,spread:null,minSpreadWidth:800,stylesheet:null,resizeOnOrientationChange:!0,script:null,snap:!1}),(0,core.extend)(this.settings,options),"object"===rendition_typeof(this.settings.manager)&&(this.manager=this.settings.manager),this.book=book,this.hooks={},this.hooks.display=new hook(this),this.hooks.serialize=new hook(this),this.hooks.content=new hook(this),this.hooks.unloaded=new hook(this),this.hooks.layout=new hook(this),this.hooks.render=new hook(this),this.hooks.show=new hook(this),this.hooks.content.register(this.handleLinks.bind(this)),this.hooks.content.register(this.passEvents.bind(this)),this.hooks.content.register(this.adjustImages.bind(this)),this.book.spine.hooks.content.register(this.injectIdentifier.bind(this)),this.settings.stylesheet&&this.book.spine.hooks.content.register(this.injectStylesheet.bind(this)),this.settings.script&&this.book.spine.hooks.content.register(this.injectScript.bind(this)),this.themes=new themes(this),this.annotations=new annotations(this),this.epubcfi=new epubcfi,this.q=new queue(this),this.location=void 0,this.q.enqueue(this.book.opened),this.starting=new core.defer,this.started=this.starting.promise,this.q.enqueue(this.start)}var Constructor,protoProps,staticProps;return Constructor=Rendition,protoProps=[{key:"setManager",value:function(manager){this.manager=manager}},{key:"requireManager",value:function(manager){return"string"==typeof manager&&"default"===manager?managers_default:"string"==typeof manager&&"continuous"===manager?continuous:manager}},{key:"requireView",value:function(view){return"string"==typeof view&&"iframe"===view?iframe:view}},{key:"start",value:function(){this.settings.layout||"pre-paginated"!==this.book.package.metadata.layout&&"true"!==this.book.displayOptions.fixedLayout||(this.settings.layout="pre-paginated"),this.manager||(this.ViewManager=this.requireManager(this.settings.manager),this.View=this.requireView(this.settings.view),this.manager=new this.ViewManager({view:this.View,queue:this.q,request:this.book.load.bind(this.book),settings:this.settings})),this.direction(this.book.package.metadata.direction),this.settings.globalLayoutProperties=this.determineLayoutProperties(this.book.package.metadata),this.flow(this.settings.globalLayoutProperties.flow),this.layout(this.settings.globalLayoutProperties),this.manager.on(EVENTS_MANAGERS.ADDED,this.afterDisplayed.bind(this)),this.manager.on(EVENTS_MANAGERS.REMOVED,this.afterRemoved.bind(this)),this.manager.on(EVENTS_MANAGERS.RESIZED,this.onResized.bind(this)),this.manager.on(EVENTS_MANAGERS.ORIENTATION_CHANGE,this.onOrientationChange.bind(this)),this.manager.on(EVENTS_MANAGERS.SCROLLED,this.reportLocation.bind(this)),this.emit(EVENTS_RENDITION.STARTED),this.starting.resolve()}},{key:"attachTo",value:function(element){return this.q.enqueue(function(){this.manager.render(element,{width:this.settings.width,height:this.settings.height}),this.emit(EVENTS_RENDITION.ATTACHED)}.bind(this))}},{key:"display",value:function(target){return this.displaying&&this.displaying.resolve(),this.q.enqueue(this._display,target)}},{key:"_display",value:function(target){var _this=this;if(this.book){this.epubcfi.isCfiString(target);var section,displaying=new core.defer,displayed=displaying.promise;return this.displaying=displaying,this.book.locations.length()&&(0,core.isFloat)(target)&&(target=this.book.locations.cfiFromPercentage(parseFloat(target))),(section=this.book.spine.get(target))?(this.manager.display(section,target).then((function(){displaying.resolve(section),_this.displaying=void 0,_this.emit(EVENTS_RENDITION.DISPLAYED,section),_this.reportLocation()}),(function(err){_this.emit(EVENTS_RENDITION.DISPLAY_ERROR,err)})),displayed):(displaying.reject(new Error("No Section Found")),displayed)}}},{key:"afterDisplayed",value:function(view){var _this2=this;view.on(EVENTS_VIEWS.MARK_CLICKED,(function(cfiRange,data){return _this2.triggerMarkEvent(cfiRange,data,view.contents)})),this.hooks.render.trigger(view,this).then((function(){view.contents?_this2.hooks.content.trigger(view.contents,_this2).then((function(){_this2.emit(EVENTS_RENDITION.RENDERED,view.section,view)})):_this2.emit(EVENTS_RENDITION.RENDERED,view.section,view)}))}},{key:"afterRemoved",value:function(view){var _this3=this;this.hooks.unloaded.trigger(view,this).then((function(){_this3.emit(EVENTS_RENDITION.REMOVED,view.section,view)}))}},{key:"onResized",value:function(size){this.emit(EVENTS_RENDITION.RESIZED,{width:size.width,height:size.height}),this.location&&this.location.start&&this.display(this.location.start.cfi)}},{key:"onOrientationChange",value:function(orientation){this.emit(EVENTS_RENDITION.ORIENTATION_CHANGE,orientation)}},{key:"moveTo",value:function(offset){this.manager.moveTo(offset)}},{key:"resize",value:function(width,height){width&&(this.settings.width=width),height&&(this.settings.height=height),this.manager.resize(width,height)}},{key:"clear",value:function(){this.manager.clear()}},{key:"next",value:function(){return this.q.enqueue(this.manager.next.bind(this.manager)).then(this.reportLocation.bind(this))}},{key:"prev",value:function(){return this.q.enqueue(this.manager.prev.bind(this.manager)).then(this.reportLocation.bind(this))}},{key:"determineLayoutProperties",value:function(metadata){var layout=this.settings.layout||metadata.layout||"reflowable",spread=this.settings.spread||metadata.spread||"auto",orientation=this.settings.orientation||metadata.orientation||"auto",flow=this.settings.flow||metadata.flow||"auto",viewport=metadata.viewport||"",minSpreadWidth=this.settings.minSpreadWidth||metadata.minSpreadWidth||800,direction=this.settings.direction||metadata.direction||"ltr";return(0===this.settings.width||this.settings.width>0)&&(0===this.settings.height||this.settings.height),{layout:layout,spread:spread,orientation:orientation,flow:flow,viewport:viewport,minSpreadWidth:minSpreadWidth,direction:direction}}},{key:"flow",value:function(_flow2){var _flow=_flow2;"scrolled"!==_flow2&&"scrolled-doc"!==_flow2&&"scrolled-continuous"!==_flow2||(_flow="scrolled"),"auto"!==_flow2&&"paginated"!==_flow2||(_flow="paginated"),this.settings.flow=_flow2,this._layout&&this._layout.flow(_flow),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this.manager&&this.manager.updateFlow(_flow),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}},{key:"layout",value:function(settings){var _this4=this;return settings&&(this._layout=new src_layout(settings),this._layout.spread(settings.spread,this.settings.minSpreadWidth),this._layout.on(EVENTS_LAYOUT.UPDATED,(function(props,changed){_this4.emit(EVENTS_RENDITION.LAYOUT,props,changed)}))),this.manager&&this._layout&&this.manager.applyLayout(this._layout),this._layout}},{key:"spread",value:function(_spread,min){this.settings.spread=_spread,min&&(this.settings.minSpreadWidth=min),this._layout&&this._layout.spread(_spread,min),this.manager&&this.manager.isRendered()&&this.manager.updateLayout()}},{key:"direction",value:function(dir){this.settings.direction=dir||"ltr",this.manager&&this.manager.direction(this.settings.direction),this.manager&&this.manager.isRendered()&&this.location&&(this.manager.clear(),this.display(this.location.start.cfi))}},{key:"reportLocation",value:function(){return this.q.enqueue(function(){requestAnimationFrame(function(){var location=this.manager.currentLocation();if(location&&location.then&&"function"==typeof location.then)location.then(function(result){var located=this.located(result);located&&located.start&&located.end&&(this.location=located,this.emit(EVENTS_RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(EVENTS_RENDITION.RELOCATED,this.location))}.bind(this));else if(location){var located=this.located(location);if(!located||!located.start||!located.end)return;this.location=located,this.emit(EVENTS_RENDITION.LOCATION_CHANGED,{index:this.location.start.index,href:this.location.start.href,start:this.location.start.cfi,end:this.location.end.cfi,percentage:this.location.start.percentage}),this.emit(EVENTS_RENDITION.RELOCATED,this.location)}}.bind(this))}.bind(this))}},{key:"currentLocation",value:function(){var location=this.manager.currentLocation();if(location&&location.then&&"function"==typeof location.then)location.then(function(result){return this.located(result)}.bind(this));else if(location)return this.located(location)}},{key:"located",value:function(location){if(!location.length)return{};var start=location[0],end=location[location.length-1],located={start:{index:start.index,href:start.href,cfi:start.mapping.start,displayed:{page:start.pages[0]||1,total:start.totalPages}},end:{index:end.index,href:end.href,cfi:end.mapping.end,displayed:{page:end.pages[end.pages.length-1]||1,total:end.totalPages}}},locationStart=this.book.locations.locationFromCfi(start.mapping.start),locationEnd=this.book.locations.locationFromCfi(end.mapping.end);null!=locationStart&&(located.start.location=locationStart,located.start.percentage=this.book.locations.percentageFromLocation(locationStart)),null!=locationEnd&&(located.end.location=locationEnd,located.end.percentage=this.book.locations.percentageFromLocation(locationEnd));var pageStart=this.book.pageList.pageFromCfi(start.mapping.start),pageEnd=this.book.pageList.pageFromCfi(end.mapping.end);return-1!=pageStart&&(located.start.page=pageStart),-1!=pageEnd&&(located.end.page=pageEnd),end.index===this.book.spine.last().index&&located.end.displayed.page>=located.end.displayed.total&&(located.atEnd=!0),start.index===this.book.spine.first().index&&1===located.start.displayed.page&&(located.atStart=!0),located}},{key:"destroy",value:function(){this.manager&&this.manager.destroy(),this.book=void 0}},{key:"passEvents",value:function(contents){var _this5=this;DOM_EVENTS.forEach((function(e){contents.on(e,(function(ev){return _this5.triggerViewEvent(ev,contents)}))})),contents.on(EVENTS_CONTENTS.SELECTED,(function(e){return _this5.triggerSelectedEvent(e,contents)}))}},{key:"triggerViewEvent",value:function(e,contents){this.emit(e.type,e,contents)}},{key:"triggerSelectedEvent",value:function(cfirange,contents){this.emit(EVENTS_RENDITION.SELECTED,cfirange,contents)}},{key:"triggerMarkEvent",value:function(cfiRange,data,contents){this.emit(EVENTS_RENDITION.MARK_CLICKED,cfiRange,data,contents)}},{key:"getRange",value:function(cfi,ignoreClass){var _cfi=new epubcfi(cfi),found=this.manager.visible().filter((function(view){if(_cfi.spinePos===view.index)return!0}));if(found.length)return found[0].contents.range(_cfi,ignoreClass)}},{key:"adjustImages",value:function(contents){if("pre-paginated"===this._layout.name)return new Promise((function(resolve){resolve()}));var computed=contents.window.getComputedStyle(contents.content,null),height=.95*(contents.content.offsetHeight-(parseFloat(computed.paddingTop)+parseFloat(computed.paddingBottom))),verticalPadding=parseFloat(computed.verticalPadding);return contents.addStylesheetRules({img:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-verticalPadding+"px":"100%")+"!important","max-height":height+"px!important","object-fit":"contain","page-break-inside":"avoid","break-inside":"avoid","box-sizing":"border-box"},svg:{"max-width":(this._layout.columnWidth?this._layout.columnWidth-verticalPadding+"px":"100%")+"!important","max-height":height+"px!important","page-break-inside":"avoid","break-inside":"avoid"}}),new Promise((function(resolve,reject){setTimeout((function(){resolve()}),1)}))}},{key:"getContents",value:function(){return this.manager?this.manager.getContents():[]}},{key:"views",value:function(){var views=this.manager?this.manager.views:void 0;return views||[]}},{key:"handleLinks",value:function(contents){var _this6=this;contents&&contents.on(EVENTS_CONTENTS.LINK_CLICKED,(function(href){var relative=_this6.book.path.relative(href);_this6.display(relative)}))}},{key:"injectStylesheet",value:function(doc,section){var style=doc.createElement("link");style.setAttribute("type","text/css"),style.setAttribute("rel","stylesheet"),style.setAttribute("href",this.settings.stylesheet),doc.getElementsByTagName("head")[0].appendChild(style)}},{key:"injectScript",value:function(doc,section){var script=doc.createElement("script");script.setAttribute("type","text/javascript"),script.setAttribute("src",this.settings.script),script.textContent=" ",doc.getElementsByTagName("head")[0].appendChild(script)}},{key:"injectIdentifier",value:function(doc,section){var ident=this.book.packaging.metadata.identifier,meta=doc.createElement("meta");meta.setAttribute("name","dc.relation.ispartof"),ident&&meta.setAttribute("content",ident),doc.getElementsByTagName("head")[0].appendChild(meta)}}],protoProps&&rendition_defineProperties(Constructor.prototype,protoProps),staticProps&&rendition_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Rendition}();event_emitter_default()(Rendition.prototype);var rendition=Rendition,request=__webpack_require__(4239);function archive_typeof(o){return archive_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},archive_typeof(o)}function archive_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,archive_toPropertyKey(descriptor.key),descriptor)}}function archive_toPropertyKey(t){var i=function(t,r){if("object"!=archive_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=archive_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==archive_typeof(i)?i:String(i)}var Archive=function(){function Archive(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Archive),this.zip=void 0,this.urlCache={},this.checkRequirements()}var Constructor,protoProps,staticProps;return Constructor=Archive,protoProps=[{key:"checkRequirements",value:function(){try{if("undefined"==typeof JSZip){var _JSZip=__webpack_require__(2655);this.zip=new _JSZip}else this.zip=new JSZip}catch(e){throw new Error("JSZip lib not loaded")}}},{key:"open",value:function(input,isBase64){return this.zip.loadAsync(input,{base64:isBase64})}},{key:"openUrl",value:function(zipUrl,isBase64){return(0,request.default)(zipUrl,"binary").then(function(data){return this.zip.loadAsync(data,{base64:isBase64})}.bind(this))}},{key:"request",value:function(url,type){var response,deferred=new core.defer,path=new utils_path.Z(url);return type||(type=path.extension),(response="blob"==type?this.getBlob(url):this.getText(url))?response.then(function(r){var result=this.handleResponse(r,type);deferred.resolve(result)}.bind(this)):deferred.reject({message:"File not found in the epub: "+url,stack:(new Error).stack}),deferred.promise}},{key:"handleResponse",value:function(response,type){return"json"==type?JSON.parse(response):(0,core.isXml)(type)?(0,core.parse)(response,"text/xml"):"xhtml"==type?(0,core.parse)(response,"application/xhtml+xml"):"html"==type||"htm"==type?(0,core.parse)(response,"text/html"):response}},{key:"getBlob",value:function(url,mimeType){var decodededUrl=window.decodeURIComponent(url.substr(1)),entry=this.zip.file(decodededUrl);if(entry)return mimeType=mimeType||mime_default().lookup(entry.name),entry.async("uint8array").then((function(uint8array){return new Blob([uint8array],{type:mimeType})}))}},{key:"getText",value:function(url,encoding){var decodededUrl=window.decodeURIComponent(url.substr(1)),entry=this.zip.file(decodededUrl);if(entry)return entry.async("string").then((function(text){return text}))}},{key:"getBase64",value:function(url,mimeType){var decodededUrl=window.decodeURIComponent(url.substr(1)),entry=this.zip.file(decodededUrl);if(entry)return mimeType=mimeType||mime_default().lookup(entry.name),entry.async("base64").then((function(data){return"data:"+mimeType+";base64,"+data}))}},{key:"createUrl",value:function(url,options){var tempUrl,response,deferred=new core.defer,_URL=window.URL||window.webkitURL||window.mozURL,useBase64=options&&options.base64;return url in this.urlCache?(deferred.resolve(this.urlCache[url]),deferred.promise):(useBase64?(response=this.getBase64(url))&&response.then(function(tempUrl){this.urlCache[url]=tempUrl,deferred.resolve(tempUrl)}.bind(this)):(response=this.getBlob(url))&&response.then(function(blob){tempUrl=_URL.createObjectURL(blob),this.urlCache[url]=tempUrl,deferred.resolve(tempUrl)}.bind(this)),response||deferred.reject({message:"File not found in the epub: "+url,stack:(new Error).stack}),deferred.promise)}},{key:"revokeUrl",value:function(url){var _URL=window.URL||window.webkitURL||window.mozURL,fromCache=this.urlCache[url];fromCache&&_URL.revokeObjectURL(fromCache)}},{key:"destroy",value:function(){var _URL=window.URL||window.webkitURL||window.mozURL;for(var fromCache in this.urlCache)_URL.revokeObjectURL(fromCache);this.zip=void 0,this.urlCache={}}}],protoProps&&archive_defineProperties(Constructor.prototype,protoProps),staticProps&&archive_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Archive}(),archive=Archive;function store_typeof(o){return store_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},store_typeof(o)}function store_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,store_toPropertyKey(descriptor.key),descriptor)}}function store_toPropertyKey(t){var i=function(t,r){if("object"!=store_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=store_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==store_typeof(i)?i:String(i)}var Store=function(){function Store(name,requester,resolver){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Store),this.urlCache={},this.storage=void 0,this.name=name,this.requester=requester||request.default,this.resolver=resolver,this.online=!0,this.checkRequirements(),this.addListeners()}var Constructor,protoProps,staticProps;return Constructor=Store,protoProps=[{key:"checkRequirements",value:function(){try{var store;store="undefined"==typeof localforage?__webpack_require__(5435):localforage,this.storage=store.createInstance({name:this.name})}catch(e){throw new Error("localForage lib not loaded")}}},{key:"addListeners",value:function(){this._status=this.status.bind(this),window.addEventListener("online",this._status),window.addEventListener("offline",this._status)}},{key:"removeListeners",value:function(){window.removeEventListener("online",this._status),window.removeEventListener("offline",this._status),this._status=void 0}},{key:"status",value:function(event){var online=navigator.onLine;this.online=online,online?this.emit("online",this):this.emit("offline",this)}},{key:"add",value:function(resources,force){var _this=this,mapped=resources.resources.map((function(item){var href=item.href,url=_this.resolver(href),encodedUrl=window.encodeURIComponent(url);return _this.storage.getItem(encodedUrl).then((function(item){return!item||force?_this.requester(url,"binary").then((function(data){return _this.storage.setItem(encodedUrl,data)})):item}))}));return Promise.all(mapped)}},{key:"put",value:function(url,withCredentials,headers){var _this2=this,encodedUrl=window.encodeURIComponent(url);return this.storage.getItem(encodedUrl).then((function(result){return result||_this2.requester(url,"binary",withCredentials,headers).then((function(data){return _this2.storage.setItem(encodedUrl,data)}))}))}},{key:"request",value:function(url,type,withCredentials,headers){var _this3=this;return this.online?this.requester(url,type,withCredentials,headers).then((function(data){return _this3.put(url),data})):this.retrieve(url,type)}},{key:"retrieve",value:function(url,type){var _this4=this,path=(new core.defer,new utils_path.Z(url));return type||(type=path.extension),("blob"==type?this.getBlob(url):this.getText(url)).then((function(r){var result,deferred=new core.defer;return r?(result=_this4.handleResponse(r,type),deferred.resolve(result)):deferred.reject({message:"File not found in storage: "+url,stack:(new Error).stack}),deferred.promise}))}},{key:"handleResponse",value:function(response,type){return"json"==type?JSON.parse(response):(0,core.isXml)(type)?(0,core.parse)(response,"text/xml"):"xhtml"==type?(0,core.parse)(response,"application/xhtml+xml"):"html"==type||"htm"==type?(0,core.parse)(response,"text/html"):response}},{key:"getBlob",value:function(url,mimeType){var encodedUrl=window.encodeURIComponent(url);return this.storage.getItem(encodedUrl).then((function(uint8array){if(uint8array)return mimeType=mimeType||mime_default().lookup(url),new Blob([uint8array],{type:mimeType})}))}},{key:"getText",value:function(url,mimeType){var encodedUrl=window.encodeURIComponent(url);return mimeType=mimeType||mime_default().lookup(url),this.storage.getItem(encodedUrl).then((function(uint8array){var blob,deferred=new core.defer,reader=new FileReader;if(uint8array)return blob=new Blob([uint8array],{type:mimeType}),reader.addEventListener("loadend",(function(){deferred.resolve(reader.result)})),reader.readAsText(blob,mimeType),deferred.promise}))}},{key:"getBase64",value:function(url,mimeType){var encodedUrl=window.encodeURIComponent(url);return mimeType=mimeType||mime_default().lookup(url),this.storage.getItem(encodedUrl).then((function(uint8array){var blob,deferred=new core.defer,reader=new FileReader;if(uint8array)return blob=new Blob([uint8array],{type:mimeType}),reader.addEventListener("loadend",(function(){deferred.resolve(reader.result)})),reader.readAsDataURL(blob,mimeType),deferred.promise}))}},{key:"createUrl",value:function(url,options){var tempUrl,response,deferred=new core.defer,_URL=window.URL||window.webkitURL||window.mozURL,useBase64=options&&options.base64;return url in this.urlCache?(deferred.resolve(this.urlCache[url]),deferred.promise):(useBase64?(response=this.getBase64(url))&&response.then(function(tempUrl){this.urlCache[url]=tempUrl,deferred.resolve(tempUrl)}.bind(this)):(response=this.getBlob(url))&&response.then(function(blob){tempUrl=_URL.createObjectURL(blob),this.urlCache[url]=tempUrl,deferred.resolve(tempUrl)}.bind(this)),response||deferred.reject({message:"File not found in storage: "+url,stack:(new Error).stack}),deferred.promise)}},{key:"revokeUrl",value:function(url){var _URL=window.URL||window.webkitURL||window.mozURL,fromCache=this.urlCache[url];fromCache&&_URL.revokeObjectURL(fromCache)}},{key:"destroy",value:function(){var _URL=window.URL||window.webkitURL||window.mozURL;for(var fromCache in this.urlCache)_URL.revokeObjectURL(fromCache);this.urlCache={},this.removeListeners()}}],protoProps&&store_defineProperties(Constructor.prototype,protoProps),staticProps&&store_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Store}();event_emitter_default()(Store.prototype);var src_store=Store;function displayoptions_typeof(o){return displayoptions_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},displayoptions_typeof(o)}function displayoptions_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,displayoptions_toPropertyKey(descriptor.key),descriptor)}}function displayoptions_toPropertyKey(t){var i=function(t,r){if("object"!=displayoptions_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=displayoptions_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==displayoptions_typeof(i)?i:String(i)}var displayoptions=function(){function DisplayOptions(displayOptionsDocument){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DisplayOptions),this.interactive="",this.fixedLayout="",this.openToSpread="",this.orientationLock="",displayOptionsDocument&&this.parse(displayOptionsDocument)}var Constructor,protoProps,staticProps;return Constructor=DisplayOptions,(protoProps=[{key:"parse",value:function(displayOptionsDocument){var _this=this;if(!displayOptionsDocument)return this;var displayOptionsNode=(0,core.qs)(displayOptionsDocument,"display_options");return displayOptionsNode?((0,core.qsa)(displayOptionsNode,"option").forEach((function(el){var value="";switch(el.childNodes.length&&(value=el.childNodes[0].nodeValue),el.attributes.name.value){case"interactive":_this.interactive=value;break;case"fixed-layout":_this.fixedLayout=value;break;case"open-to-spread":_this.openToSpread=value;break;case"orientation-lock":_this.orientationLock=value}})),this):this}},{key:"destroy",value:function(){this.interactive=void 0,this.fixedLayout=void 0,this.openToSpread=void 0,this.orientationLock=void 0}}])&&displayoptions_defineProperties(Constructor.prototype,protoProps),staticProps&&displayoptions_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),DisplayOptions}();function book_typeof(o){return book_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},book_typeof(o)}function book_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,book_toPropertyKey(descriptor.key),descriptor)}}function book_toPropertyKey(t){var i=function(t,r){if("object"!=book_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=book_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==book_typeof(i)?i:String(i)}var INPUT_TYPE_BINARY="binary",INPUT_TYPE_BASE64="base64",INPUT_TYPE_EPUB="epub",INPUT_TYPE_OPF="opf",INPUT_TYPE_MANIFEST="json",INPUT_TYPE_DIRECTORY="directory",Book=function(){function Book(url,options){var _this=this;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,Book),void 0===options&&"string"!=typeof url&&url instanceof Blob==!1&&(options=url,url=void 0),this.settings=(0,core.extend)(this.settings||{},{requestMethod:void 0,requestCredentials:void 0,requestHeaders:void 0,encoding:void 0,replacements:void 0,canonical:void 0,openAs:void 0,store:void 0}),(0,core.extend)(this.settings,options),this.opening=new core.defer,this.opened=this.opening.promise,this.isOpen=!1,this.loading={manifest:new core.defer,spine:new core.defer,metadata:new core.defer,cover:new core.defer,navigation:new core.defer,pageList:new core.defer,resources:new core.defer,displayOptions:new core.defer},this.loaded={manifest:this.loading.manifest.promise,spine:this.loading.spine.promise,metadata:this.loading.metadata.promise,cover:this.loading.cover.promise,navigation:this.loading.navigation.promise,pageList:this.loading.pageList.promise,resources:this.loading.resources.promise,displayOptions:this.loading.displayOptions.promise},this.ready=Promise.all([this.loaded.manifest,this.loaded.spine,this.loaded.metadata,this.loaded.cover,this.loaded.navigation,this.loaded.resources,this.loaded.displayOptions]),this.isRendered=!1,this.request=this.settings.requestMethod||request.default,this.spine=new spine,this.locations=new locations(this.spine,this.load.bind(this)),this.navigation=void 0,this.pageList=void 0,this.url=void 0,this.path=void 0,this.archived=!1,this.archive=void 0,this.storage=void 0,this.resources=void 0,this.rendition=void 0,this.container=void 0,this.packaging=void 0,this.displayOptions=void 0,this.settings.store&&this.store(this.settings.store),url&&this.open(url,this.settings.openAs).catch((function(error){var err=new Error("Cannot load book at "+url);_this.emit(EVENTS_BOOK.OPEN_FAILED,err)}))}var Constructor,protoProps,staticProps;return Constructor=Book,protoProps=[{key:"open",value:function(input,what){var opening,type=what||this.determineType(input);return type===INPUT_TYPE_BINARY?(this.archived=!0,this.url=new utils_url("/",""),opening=this.openEpub(input)):type===INPUT_TYPE_BASE64?(this.archived=!0,this.url=new utils_url("/",""),opening=this.openEpub(input,type)):type===INPUT_TYPE_EPUB?(this.archived=!0,this.url=new utils_url("/",""),opening=this.request(input,"binary",this.settings.requestCredentials).then(this.openEpub.bind(this))):type==INPUT_TYPE_OPF?(this.url=new utils_url(input),opening=this.openPackaging(this.url.Path.toString())):type==INPUT_TYPE_MANIFEST?(this.url=new utils_url(input),opening=this.openManifest(this.url.Path.toString())):(this.url=new utils_url(input),opening=this.openContainer("META-INF/container.xml").then(this.openPackaging.bind(this))),opening}},{key:"openEpub",value:function(data,encoding){var _this2=this;return this.unarchive(data,encoding||this.settings.encoding).then((function(){return _this2.openContainer("META-INF/container.xml")})).then((function(packagePath){return _this2.openPackaging(packagePath)}))}},{key:"openContainer",value:function(url){var _this3=this;return this.load(url).then((function(xml){return _this3.container=new container(xml),_this3.resolve(_this3.container.packagePath)}))}},{key:"openPackaging",value:function(url){var _this4=this;return this.path=new utils_path.Z(url),this.load(url).then((function(xml){return _this4.packaging=new packaging(xml),_this4.unpack(_this4.packaging)}))}},{key:"openManifest",value:function(url){var _this5=this;return this.path=new utils_path.Z(url),this.load(url).then((function(json){return _this5.packaging=new packaging,_this5.packaging.load(json),_this5.unpack(_this5.packaging)}))}},{key:"load",value:function(path){var resolved=this.resolve(path);return this.archived?this.archive.request(resolved):this.request(resolved,null,this.settings.requestCredentials,this.settings.requestHeaders)}},{key:"resolve",value:function(path,absolute){if(path){var resolved=path;return path.indexOf("://")>-1?path:(this.path&&(resolved=this.path.resolve(path)),0!=absolute&&this.url&&(resolved=this.url.resolve(resolved)),resolved)}}},{key:"canonical",value:function(path){return path?this.settings.canonical?this.settings.canonical(path):this.resolve(path,!0):""}},{key:"determineType",value:function(input){var extension;return"base64"===this.settings.encoding?INPUT_TYPE_BASE64:"string"!=typeof input?INPUT_TYPE_BINARY:(extension=new utils_url(input).path().extension)?"epub"===extension?INPUT_TYPE_EPUB:"opf"===extension?INPUT_TYPE_OPF:"json"===extension?INPUT_TYPE_MANIFEST:void 0:INPUT_TYPE_DIRECTORY}},{key:"unpack",value:function(packaging){var _this6=this;this.package=packaging,""===this.packaging.metadata.layout?this.load(this.url.resolve("META-INF/com.apple.ibooks.display-options.xml")).then((function(xml){_this6.displayOptions=new displayoptions(xml),_this6.loading.displayOptions.resolve(_this6.displayOptions)})).catch((function(err){_this6.displayOptions=new displayoptions,_this6.loading.displayOptions.resolve(_this6.displayOptions)})):(this.displayOptions=new displayoptions,this.loading.displayOptions.resolve(this.displayOptions)),this.spine.unpack(this.packaging,this.resolve.bind(this),this.canonical.bind(this)),this.resources=new resources(this.packaging.manifest,{archive:this.archive,resolver:this.resolve.bind(this),request:this.request.bind(this),replacements:this.settings.replacements||(this.archived?"blobUrl":"base64")}),this.loadNavigation(this.packaging).then((function(){_this6.loading.navigation.resolve(_this6.navigation)})),this.packaging.coverPath&&(this.cover=this.resolve(this.packaging.coverPath)),this.loading.manifest.resolve(this.packaging.manifest),this.loading.metadata.resolve(this.packaging.metadata),this.loading.spine.resolve(this.spine),this.loading.cover.resolve(this.cover),this.loading.resources.resolve(this.resources),this.loading.pageList.resolve(this.pageList),this.isOpen=!0,this.archived||this.settings.replacements&&"none"!=this.settings.replacements?this.replacements().then((function(){_this6.loaded.displayOptions.then((function(){_this6.opening.resolve(_this6)}))})).catch((function(err){console.error(err)})):this.loaded.displayOptions.then((function(){_this6.opening.resolve(_this6)}))}},{key:"loadNavigation",value:function(packaging){var _this7=this,navPath=packaging.navPath||packaging.ncxPath,toc=packaging.toc;return toc?new Promise((function(resolve,reject){_this7.navigation=new navigation(toc),packaging.pageList&&(_this7.pageList=new pagelist(packaging.pageList)),resolve(_this7.navigation)})):navPath?this.load(navPath,"xml").then((function(xml){return _this7.navigation=new navigation(xml),_this7.pageList=new pagelist(xml),_this7.navigation})):new Promise((function(resolve,reject){_this7.navigation=new navigation,_this7.pageList=new pagelist,resolve(_this7.navigation)}))}},{key:"section",value:function(target){return this.spine.get(target)}},{key:"renderTo",value:function(element,options){return this.rendition=new rendition(this,options),this.rendition.attachTo(element),this.rendition}},{key:"setRequestCredentials",value:function(credentials){this.settings.requestCredentials=credentials}},{key:"setRequestHeaders",value:function(headers){this.settings.requestHeaders=headers}},{key:"unarchive",value:function(input,encoding){return this.archive=new archive,this.archive.open(input,encoding)}},{key:"store",value:function(name){var _this8=this,replacementsSetting=this.settings.replacements&&"none"!==this.settings.replacements,originalUrl=this.url,requester=this.settings.requestMethod||request.default.bind(this);return this.storage=new src_store(name,requester,this.resolve.bind(this)),this.request=this.storage.request.bind(this.storage),this.opened.then((function(){_this8.archived&&(_this8.storage.requester=_this8.archive.request.bind(_this8.archive));var substituteResources=function(output,section){section.output=_this8.resources.substitute(output,section.url)};_this8.resources.settings.replacements=replacementsSetting||"blobUrl",_this8.resources.replacements().then((function(){return _this8.resources.replaceCss()})),_this8.storage.on("offline",(function(){_this8.url=new utils_url("/",""),_this8.spine.hooks.serialize.register(substituteResources)})),_this8.storage.on("online",(function(){_this8.url=originalUrl,_this8.spine.hooks.serialize.deregister(substituteResources)}))})),this.storage}},{key:"coverUrl",value:function(){var _this9=this;return this.loaded.cover.then((function(url){return _this9.archived?_this9.resources.get(_this9.cover):_this9.cover}))}},{key:"replacements",value:function(){var _this10=this;return this.spine.hooks.serialize.register((function(output,section){section.output=_this10.resources.substitute(output,section.url)})),this.resources.replacements().then((function(){return _this10.resources.replaceCss()}))}},{key:"getRange",value:function(cfiRange){var cfi=new epubcfi(cfiRange),item=this.spine.get(cfi.spinePos),_request=this.load.bind(this);return item?item.load(_request).then((function(contents){return cfi.toRange(item.document)})):new Promise((function(resolve,reject){reject("CFI could not be found")}))}},{key:"key",value:function(identifier){var ident=identifier||this.packaging.metadata.identifier||this.url.filename;return"epubjs:".concat("0.3",":").concat(ident)}},{key:"destroy",value:function(){this.opened=void 0,this.loading=void 0,this.loaded=void 0,this.ready=void 0,this.isOpen=!1,this.isRendered=!1,this.spine&&this.spine.destroy(),this.locations&&this.locations.destroy(),this.pageList&&this.pageList.destroy(),this.archive&&this.archive.destroy(),this.resources&&this.resources.destroy(),this.container&&this.container.destroy(),this.packaging&&this.packaging.destroy(),this.rendition&&this.rendition.destroy(),this.displayOptions&&this.displayOptions.destroy(),this.spine=void 0,this.locations=void 0,this.pageList=void 0,this.archive=void 0,this.resources=void 0,this.container=void 0,this.packaging=void 0,this.rendition=void 0,this.navigation=void 0,this.url=void 0,this.path=void 0,this.archived=!1}}],protoProps&&book_defineProperties(Constructor.prototype,protoProps),staticProps&&book_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Book}();event_emitter_default()(Book.prototype);var book=Book;__webpack_require__(6908);function epub_ePub(url,options){return new book(url,options)}epub_ePub.VERSION="0.3",void 0!==__webpack_require__.g&&(__webpack_require__.g.EPUBJS_VERSION="0.3"),epub_ePub.Book=book,epub_ePub.Rendition=rendition,epub_ePub.Contents=contents,epub_ePub.CFI=epubcfi,epub_ePub.utils=core;var epub=epub_ePub,mark=__webpack_require__(5029),mark_default=__webpack_require__.n(mark),isEqual=__webpack_require__(9641),isEqual_default=__webpack_require__.n(isEqual),get=__webpack_require__(3117),get_default=__webpack_require__.n(get),clamp=__webpack_require__(913),clamp_default=__webpack_require__.n(clamp),lockr=__webpack_require__(5310),lockr_default=__webpack_require__.n(lockr),dist=__webpack_require__(5599),dist_default=__webpack_require__.n(dist),external_kolibriCoreAppGlobal_coreVue_components_CoreFullscreen_namespaceObject=kolibriCoreAppGlobal.coreVue.components.CoreFullscreen,external_kolibriCoreAppGlobal_coreVue_components_CoreFullscreen_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_CoreFullscreen_namespaceObject),external_kolibriCoreAppGlobal_coreVue_mixins_responsiveElementMixin_namespaceObject=kolibriCoreAppGlobal.coreVue.mixins.responsiveElementMixin,external_kolibriCoreAppGlobal_coreVue_mixins_responsiveElementMixin_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_mixins_responsiveElementMixin_namespaceObject),external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_namespaceObject=kolibriCoreAppGlobal.coreVue.mixins.responsiveWindowMixin,external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_namespaceObject);function SandboxIFrameView_typeof(o){return SandboxIFrameView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},SandboxIFrameView_typeof(o)}function SandboxIFrameView_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,SandboxIFrameView_toPropertyKey(descriptor.key),descriptor)}}function SandboxIFrameView_toPropertyKey(t){var i=function(t,r){if("object"!=SandboxIFrameView_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=SandboxIFrameView_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==SandboxIFrameView_typeof(i)?i:String(i)}function SandboxIFrameView_callSuper(_this,derived,args){return derived=SandboxIFrameView_getPrototypeOf(derived),function(self,call){if(call&&("object"===SandboxIFrameView_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(_this,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(derived,args||[],SandboxIFrameView_getPrototypeOf(_this).constructor):derived.apply(_this,args))}function SandboxIFrameView_get(){return SandboxIFrameView_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=SandboxIFrameView_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},SandboxIFrameView_get.apply(this,arguments)}function SandboxIFrameView_getPrototypeOf(o){return SandboxIFrameView_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},SandboxIFrameView_getPrototypeOf(o)}function SandboxIFrameView_setPrototypeOf(o,p){return SandboxIFrameView_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},SandboxIFrameView_setPrototypeOf(o,p)}var SandboxIFrameView=function(_iFrameView){function SandboxIFrameView(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SandboxIFrameView),SandboxIFrameView_callSuper(this,SandboxIFrameView,arguments)}var Constructor,protoProps,staticProps;return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&SandboxIFrameView_setPrototypeOf(subClass,superClass)}(SandboxIFrameView,_iFrameView),Constructor=SandboxIFrameView,protoProps=[{key:"create",value:function(){var iframe=SandboxIFrameView_get(SandboxIFrameView_getPrototypeOf(SandboxIFrameView.prototype),"create",this).call(this);return iframe.sandbox="allow-scripts allow-same-origin",iframe}},{key:"getContents",value:function(){return this.contents}},{key:"focus",value:function(){this.iframe&&this.iframe.focus()}},{key:"expand",value:function(force){if(this.contents&&"scrolled"===this.layout.props.flow){var textWidth=this.contents.textWidth(),scrollWidth=this.contents.scrollWidth();textWidth!==scrollWidth&&scrollWidth>0&&(this.lockedWidth=textWidth)}return SandboxIFrameView_get(SandboxIFrameView_getPrototypeOf(SandboxIFrameView.prototype),"expand",this).call(this,force)}}],protoProps&&SandboxIFrameView_defineProperties(Constructor.prototype,protoProps),staticProps&&SandboxIFrameView_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),SandboxIFrameView}(iframe),views_SandboxIFrameView=SandboxIFrameView,LoadingScreenvue_type_template_id_d9e5c928_scoped_true_render=function(){var _h=this.$createElement,_c=this._self._c||_h;return _c("div",{staticClass:"loading-screen",style:this.backgroundStyle},[_c("div",{staticClass:"loading-status"},[_c("KCircularLoader",{attrs:{type:"indeterminate",delay:!1}}),_c("p",[this._v(this._s(this.$tr("loadingBook")))])],1)])};LoadingScreenvue_type_template_id_d9e5c928_scoped_true_render._withStripped=!0;function normalizeComponent(scriptExports,render,staticRenderFns,functionalTemplate,injectStyles,scopeId,moduleIdentifier,shadowMode){var hook,options="function"==typeof scriptExports?scriptExports.options:scriptExports;if(render&&(options.render=render,options.staticRenderFns=staticRenderFns,options._compiled=!0),functionalTemplate&&(options.functional=!0),scopeId&&(options._scopeId="data-v-"+scopeId),moduleIdentifier?(hook=function(context){(context=context||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(context=__VUE_SSR_CONTEXT__),injectStyles&&injectStyles.call(this,context),context&&context._registeredComponents&&context._registeredComponents.add(moduleIdentifier)},options._ssrRegister=hook):injectStyles&&(hook=shadowMode?function(){injectStyles.call(this,(options.functional?this.parent:this).$root.$options.shadowRoot)}:injectStyles),hook)if(options.functional){options._injectStyles=hook;var originalRender=options.render;options.render=function(h,context){return hook.call(context),originalRender(h,context)}}else{var existing=options.beforeCreate;options.beforeCreate=existing?[].concat(existing,hook):[hook]}return{exports:scriptExports,options:options}}var LoadingScreen=normalizeComponent({name:"LoadingScreen",computed:{backgroundStyle:function(){return{backgroundColor:this.$themeTokens.surface}}},$trs:{loadingBook:{message:"Loading book",context:"Message that displays when an EPUB file is loading. The learner should wait."}}},LoadingScreenvue_type_template_id_d9e5c928_scoped_true_render,[],!1,null,"d9e5c928",null).exports,LoadingErrorvue_type_template_id_7f2f4873_scoped_true_render=function(){var _h=this.$createElement,_c=this._self._c||_h;return _c("div",{staticClass:"epub-renderer-error",class:{loaded:this.loaded},style:{background:this.$themeTokens.surface}},[_c("UiAlert",{attrs:{type:"error",dismissible:!1}},[this._v("\n    "+this._s(this.$tr("couldNotLoadThisBook"))+"\n  ")])],1)};LoadingErrorvue_type_template_id_7f2f4873_scoped_true_render._withStripped=!0;var external_kolibriCoreAppGlobal_coreVue_components_UiAlert_namespaceObject=kolibriCoreAppGlobal.coreVue.components.UiAlert,LoadingError=normalizeComponent({name:"LoadingError",components:{UiAlert:__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_UiAlert_namespaceObject)()},props:{loaded:{type:Boolean,default:!1}},$trs:{couldNotLoadThisBook:{message:"Could not load this book",context:"Error message that displays when a digital book cannot be loaded."}}},LoadingErrorvue_type_template_id_7f2f4873_scoped_true_render,[],!1,null,"7f2f4873",null).exports,TopBarvue_type_template_id_6bb76a46_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"top-bar",style:{backgroundColor:_vm.$themePalette.grey.v_200}},[_c("KGrid",{style:{marginTop:"2px",marginLeft:"3px",marginRight:"3px"}},[_c("KGridItem",{attrs:{layout4:{span:1},layout8:{span:2},layout12:{span:3}}},[_c("TocButton",{ref:"tocButton",on:{click:function($event){return _vm.$emit("tableOfContentsButtonClicked")}}})],1),_c("KGridItem",{attrs:{layout:{alignment:"center"},layout4:{span:1},layout8:{span:4},layout12:{span:6}}},[_vm.title?_c("h2",{staticClass:"top-bar-title"},[_vm._v("\n        "+_vm._s(_vm.title)+"\n      ")]):_vm._e()]),_c("KGridItem",{attrs:{layout:{alignment:"right"},layout4:{span:2},layout8:{span:2},layout12:{span:3}}},[_c("SettingsButton",{ref:"settingsButton",on:{click:function($event){return _vm.$emit("settingsButtonClicked")}}}),_c("SearchButton",{ref:"searchButton",class:{invisible:_vm.$attrs.hideSearchButton},on:{click:function($event){return _vm.$emit("searchButtonClicked")}}}),_c("KIconButton",{ref:"fullscreenButton",attrs:{icon:_vm.isInFullscreen?"fullscreen_exit":"fullscreen",ariaLabel:_vm.$tr("toggleFullscreen"),size:"small"},on:{click:function($event){return _vm.$emit("fullscreenButtonClicked")}}})],1)],1)],1)};TopBarvue_type_template_id_6bb76a46_scoped_true_render._withStripped=!0;var TocButtonvue_type_template_id_70c915d0_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement;return(_vm._self._c||_h)("KIconButton",{attrs:{icon:"list",ariaLabel:_vm.$tr("toggleTocSideBar"),"data-test":"toc button",size:"small"},on:{click:function($event){return _vm.$emit("click")}}})};TocButtonvue_type_template_id_70c915d0_scoped_true_render._withStripped=!0;var TocButton=normalizeComponent({name:"TocButton",$trs:{toggleTocSideBar:{message:"Toggle table of contents",context:"Learners can use the list button in the upper left corner to view the table of contents with all the book chapters."}}},TocButtonvue_type_template_id_70c915d0_scoped_true_render,[],!1,null,"70c915d0",null).exports,SettingsButtonvue_type_template_id_4c4dfa3a_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement;return(_vm._self._c||_h)("KIconButton",{attrs:{icon:"tune",ariaLabel:_vm.$tr("toggleSettingsSideBar"),"data-test":"settings button",size:"small"},on:{click:function($event){return _vm.$emit("click")}}})};SettingsButtonvue_type_template_id_4c4dfa3a_scoped_true_render._withStripped=!0;var SettingsButton=normalizeComponent({name:"SettingsButton",$trs:{toggleSettingsSideBar:{message:"Toggle settings",context:"Used to open and close the settings button where a learner can adjust things like the text size or the background color."}}},SettingsButtonvue_type_template_id_4c4dfa3a_scoped_true_render,[],!1,null,"4c4dfa3a",null).exports,SearchButtonvue_type_template_id_6bf6c9ce_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement;return(_vm._self._c||_h)("KIconButton",{attrs:{icon:"search",ariaLabel:_vm.$tr("toggleSearchSideBar"),"data-test":"search button",size:"small"},on:{click:function($event){return _vm.$emit("click")}}})};SearchButtonvue_type_template_id_6bf6c9ce_scoped_true_render._withStripped=!0;var SearchButton=normalizeComponent({name:"SearchButton",$trs:{toggleSearchSideBar:{message:"Toggle search",context:"'Toggle search' refers to the button that opens and closes the search bar in the EPUB reader.\n\nSee more about this word here: https://en.wikipedia.org/wiki/Switch#Toggle_switch"}}},SearchButtonvue_type_template_id_6bf6c9ce_scoped_true_render,[],!1,null,"6bf6c9ce",null).exports,TopBar=normalizeComponent({name:"TopBar",components:{TocButton:TocButton,SettingsButton:SettingsButton,SearchButton:SearchButton},props:{title:{type:String,default:null},isInFullscreen:{type:Boolean,required:!0}},methods:{focusOnTocButton:function(){this.$refs.tocButton.$el.focus()},focusOnSettingsButton:function(){this.$refs.settingsButton.$el.focus()},focusOnSearchButton:function(){this.$refs.searchButton.$el.focus()}},$trs:{toggleFullscreen:{message:"Toggle fullscreen",context:"Learners can use the fullscreen button in the upper right corner to open the ebook in fullscreen view."}}},TopBarvue_type_template_id_6bb76a46_scoped_true_render,[],!1,null,"6bb76a46",null).exports,TableOfContentsSideBarvue_type_template_id_157eccc3_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("SideBar",[_c("nav",[_c("ul",{ref:"tocList",staticClass:"toc-list"},[_vm._l(_vm.toc,(function(section,index){return[_c("TableOfContentsSection",{key:"toc-section-"+index,attrs:{section:section,depth:0,currentSection:_vm.currentSection},on:{tocNavigation:_vm.emitTocNavigation}})]}))],2)])])};TableOfContentsSideBarvue_type_template_id_157eccc3_scoped_true_render._withStripped=!0;var SideBarvue_type_template_id_5163f282_scoped_true_render=function(){var _h=this.$createElement;return(this._self._c||_h)("div",{staticClass:"side-bar",style:{backgroundColor:this.$themePalette.grey.v_100}},[this._t("default")],2)};SideBarvue_type_template_id_5163f282_scoped_true_render._withStripped=!0;var SideBar=normalizeComponent({name:"SideBar"},SideBarvue_type_template_id_5163f282_scoped_true_render,[],!1,null,"5163f282",null).exports,TableOfContentsSectionvue_type_template_id_24486785_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("li",{staticClass:"toc-list-item",class:{"toc-list-item-top-level":0===_vm.depth}},[_c("KButton",{staticClass:"toc-list-item-button",class:{"toc-list-item-button-current":_vm.isCurrentSection},attrs:{id:_vm.sectionId,text:_vm.section.label.trim()||_vm.section.href,appearance:"basic-link"},on:{click:function($event){return _vm.$emit("tocNavigation",_vm.section)}}}),_vm.section.subitems&&_vm.section.subitems.length>0?_c("ul",{staticClass:"toc-list"},_vm._l(_vm.section.subitems,(function(subsection,index){return _c("TableOfContentsSection",{key:index,attrs:{section:subsection,currentSection:_vm.currentSection,depth:_vm.depth+1,"data-test":"table-of-contents-section"},on:{tocNavigation:_vm.emitTocNavigation}})})),1):_vm._e()],1)};TableOfContentsSectionvue_type_template_id_24486785_scoped_true_render._withStripped=!0;var TableOfContentsSectionvue_type_script_lang_js={name:"TableOfContentsSection",props:{section:{type:Object,required:!0},depth:{type:Number,required:!0},currentSection:{type:Object,default:null}},computed:{isCurrentSection:function(){return!!this.currentSection&&(this.currentSection.href===this.section.href&&this.currentSection.label===this.section.label)},sectionId:function(){var sanitizedHref=this.section.href.replace(/\W/g,"_");return"section_".concat(sanitizedHref)}},methods:{emitTocNavigation:function(section){this.$emit("tocNavigation",section)}}},TableOfContentsSideBarvue_type_script_lang_js={name:"TableOfContentsSideBar",components:{SideBar:SideBar,TableOfContentsSection:normalizeComponent(TableOfContentsSectionvue_type_script_lang_js,TableOfContentsSectionvue_type_template_id_24486785_scoped_true_render,[],!1,null,"24486785",null).exports},props:{toc:{type:Array,required:!0},currentSection:{type:Object,default:null}},methods:{emitTocNavigation:function(section){this.$emit("tocNavigation",section)}}},TableOfContentsSideBar=normalizeComponent(TableOfContentsSideBarvue_type_script_lang_js,TableOfContentsSideBarvue_type_template_id_157eccc3_scoped_true_render,[],!1,null,"157eccc3",null).exports,SettingsSideBarvue_type_template_id_0b26cee4_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("SideBar",[_c("div",{staticClass:"o-f-h"},[_c("h3",[_vm._v(_vm._s(_vm.$tr("textSize")))]),_c("KFixedGrid",{attrs:{numCols:"2",gutter:"8"}},[_c("KFixedGridItem",{attrs:{span:"1"}},[_c("KButton",{ref:"decreaseFontSizeButton",class:["settings-button",_vm.$computedClass(_vm.settingsButtonFocus)],attrs:{disabled:_vm.decreaseFontSizeDisabled},on:{click:function($event){return _vm.$emit("decreaseFontSize")}},scopedSlots:_vm._u([{key:"icon",fn:function(){return[_c("KIcon",{staticStyle:{top:"0",width:"24px",height:"24px"},attrs:{icon:"minus"}})]},proxy:!0}])},[_c("div",{staticClass:"truncate"},[_vm._v("\n            "+_vm._s(_vm.$tr("decrease"))+"\n          ")])])],1),_c("KFixedGridItem",{attrs:{span:"1"}},[_c("KButton",{ref:"increaseFontSizeButton",class:["settings-button",_vm.$computedClass(_vm.settingsButtonFocus)],attrs:{disabled:_vm.increaseFontSizeDisabled},on:{click:function($event){return _vm.$emit("increaseFontSize")}},scopedSlots:_vm._u([{key:"icon",fn:function(){return[_c("KIcon",{staticStyle:{top:"0",width:"24px",height:"24px"},attrs:{icon:"plus"}})]},proxy:!0}])},[_c("div",{staticClass:"truncate"},[_vm._v("\n            "+_vm._s(_vm.$tr("increase"))+"\n          ")])])],1)],1)],1),_c("div",{staticClass:"o-f-h"},[_c("h3",[_vm._v(_vm._s(_vm.$tr("theme")))]),_c("KFixedGrid",{attrs:{numCols:"4",gutter:"8"}},_vm._l(_vm.themes,(function(value,key){return _c("KFixedGridItem",{key:key,attrs:{span:"1"}},[_c("KButton",{staticClass:"settings-button theme-button",attrs:{"aria-label":_vm.generateThemeAriaLabel(key),appearanceOverrides:_vm.generateStyle(value)},on:{click:function($event){return _vm.$emit("setTheme",value)}}},[_vm.isCurrentlySelectedTheme(value)?_c("KIcon",{staticStyle:{top:"0",width:"24px",height:"24px"},style:{fill:value.textColor},attrs:{icon:"check"}}):_vm._e()],1)],1)})),1)],1)])};SettingsSideBarvue_type_template_id_0b26cee4_scoped_true_render._withStripped=!0;var external_kolibriCoreAppGlobal_lib_vue_namespaceObject=kolibriCoreAppGlobal.lib.vue,styles_globalThemeState=__webpack_require__.n(external_kolibriCoreAppGlobal_lib_vue_namespaceObject)().observable({inputModality:null,mediaType:null,colors:{palette:{black:"#000000",white:"#ffffff",red:{v_50:"#ffebee",v_100:"#ffcdd2",v_200:"#ef9a9a",v_300:"#e57373",v_400:"#ef5350",v_500:"#f44336",v_600:"#e53935",v_700:"#d32f2f",v_800:"#c62828",v_900:"#b71c1c",v_a100:"#ff8a80",v_a200:"#ff5252",v_a400:"#ff1744",v_a700:"#d50000"},pink:{v_50:"#fce4ec",v_100:"#f8bbd0",v_200:"#f48fb1",v_300:"#f06292",v_400:"#ec407a",v_500:"#e91e63",v_600:"#d81b60",v_700:"#c2185b",v_800:"#ad1457",v_900:"#880e4f",v_a100:"#ff80ab",v_a200:"#ff4081",v_a400:"#f50057",v_a700:"#c51162"},purple:{v_50:"#f3e5f5",v_100:"#e1bee7",v_200:"#ce93d8",v_300:"#ba68c8",v_400:"#ab47bc",v_500:"#9c27b0",v_600:"#8e24aa",v_700:"#7b1fa2",v_800:"#6a1b9a",v_900:"#4a148c",v_a100:"#ea80fc",v_a200:"#e040fb",v_a400:"#d500f9",v_a700:"#aa00ff"},deeppurple:{v_50:"#ede7f6",v_100:"#d1c4e9",v_200:"#b39ddb",v_300:"#9575cd",v_400:"#7e57c2",v_500:"#673ab7",v_600:"#5e35b1",v_700:"#512da8",v_800:"#4527a0",v_900:"#311b92",v_a100:"#b388ff",v_a200:"#7c4dff",v_a400:"#651fff",v_a700:"#6200ea"},indigo:{v_50:"#e8eaf6",v_100:"#c5cae9",v_200:"#9fa8da",v_300:"#7986cb",v_400:"#5c6bc0",v_500:"#3f51b5",v_600:"#3949ab",v_700:"#303f9f",v_800:"#283593",v_900:"#1a237e",v_a100:"#8c9eff",v_a200:"#536dfe",v_a400:"#3d5afe",v_a700:"#304ffe"},blue:{v_50:"#e3f2fd",v_100:"#bbdefb",v_200:"#90caf9",v_300:"#64b5f6",v_400:"#42a5f5",v_500:"#2196f3",v_600:"#1e88e5",v_700:"#1976d2",v_800:"#1565c0",v_900:"#0d47a1",v_a100:"#82b1ff",v_a200:"#448aff",v_a400:"#2979ff",v_a700:"#2962ff"},lightblue:{v_50:"#e1f5fe",v_100:"#b3e5fc",v_200:"#81d4fa",v_300:"#4fc3f7",v_400:"#29b6f6",v_500:"#03a9f4",v_600:"#039be5",v_700:"#0288d1",v_800:"#0277bd",v_900:"#01579b",v_a100:"#80d8ff",v_a200:"#40c4ff",v_a400:"#00b0ff",v_a700:"#0091ea"},cyan:{v_50:"#e0f7fa",v_100:"#b2ebf2",v_200:"#80deea",v_300:"#4dd0e1",v_400:"#26c6da",v_500:"#00bcd4",v_600:"#00acc1",v_700:"#0097a7",v_800:"#00838f",v_900:"#006064",v_a100:"#84ffff",v_a200:"#18ffff",v_a400:"#00e5ff",v_a700:"#00b8d4"},teal:{v_50:"#e0f2f1",v_100:"#b2dfdb",v_200:"#80cbc4",v_300:"#4db6ac",v_400:"#26a69a",v_500:"#009688",v_600:"#00897b",v_700:"#00796b",v_800:"#00695c",v_900:"#004d40",v_a100:"#a7ffeb",v_a200:"#64ffda",v_a400:"#1de9b6",v_a700:"#00bfa5"},green:{v_50:"#e8f5e9",v_100:"#c8e6c9",v_200:"#a5d6a7",v_300:"#81c784",v_400:"#66bb6a",v_500:"#4caf50",v_600:"#43a047",v_700:"#388e3c",v_800:"#2e7d32",v_900:"#1b5e20",v_a100:"#b9f6ca",v_a200:"#69f0ae",v_a400:"#00e676",v_a700:"#00c853"},lightgreen:{v_50:"#f1f8e9",v_100:"#dcedc8",v_200:"#c5e1a5",v_300:"#aed581",v_400:"#9ccc65",v_500:"#8bc34a",v_600:"#7cb342",v_700:"#689f38",v_800:"#558b2f",v_900:"#33691e",v_a100:"#ccff90",v_a200:"#b2ff59",v_a400:"#76ff03",v_a700:"#64dd17"},lime:{v_50:"#f9fbe7",v_100:"#f0f4c3",v_200:"#e6ee9c",v_300:"#dce775",v_400:"#d4e157",v_500:"#cddc39",v_600:"#c0ca33",v_700:"#afb42b",v_800:"#9e9d24",v_900:"#827717",v_a100:"#f4ff81",v_a200:"#eeff41",v_a400:"#c6ff00",v_a700:"#aeea00"},yellow:{v_50:"#fffde7",v_100:"#fff9c4",v_200:"#fff59d",v_300:"#fff176",v_400:"#ffee58",v_500:"#ffeb3b",v_600:"#fdd835",v_700:"#fbc02d",v_800:"#f9a825",v_900:"#f57f17",v_a100:"#ffff8d",v_a200:"#ffff00",v_a400:"#ffea00",v_a700:"#ffd600"},amber:{v_50:"#fff8e1",v_100:"#ffecb3",v_200:"#ffe082",v_300:"#ffd54f",v_400:"#ffca28",v_500:"#ffc107",v_600:"#ffb300",v_700:"#ffa000",v_800:"#ff8f00",v_900:"#ff6f00",v_a100:"#ffe57f",v_a200:"#ffd740",v_a400:"#ffc400",v_a700:"#ffab00"},orange:{v_50:"#fff3e0",v_100:"#ffe0b2",v_200:"#ffcc80",v_300:"#ffb74d",v_400:"#ffa726",v_500:"#ff9800",v_600:"#fb8c00",v_700:"#f57c00",v_800:"#ef6c00",v_900:"#e65100",v_a100:"#ffd180",v_a200:"#ffab40",v_a400:"#ff9100",v_a700:"#ff6d00"},deeporange:{v_50:"#fbe9e7",v_100:"#ffccbc",v_200:"#ffab91",v_300:"#ff8a65",v_400:"#ff7043",v_500:"#ff5722",v_600:"#f4511e",v_700:"#e64a19",v_800:"#d84315",v_900:"#bf360c",v_a100:"#ff9e80",v_a200:"#ff6e40",v_a400:"#ff3d00",v_a700:"#dd2c00"},brown:{v_50:"#efebe9",v_100:"#d7ccc8",v_200:"#bcaaa4",v_300:"#a1887f",v_400:"#8d6e63",v_500:"#795548",v_600:"#6d4c41",v_700:"#5d4037",v_800:"#4e342e",v_900:"#3e2723"},grey:{v_50:"#fafafa",v_100:"#f5f5f5",v_200:"#eeeeee",v_300:"#e0e0e0",v_400:"#bdbdbd",v_500:"#9e9e9e",v_600:"#757575",v_700:"#616161",v_800:"#424242",v_900:"#212121"},bluegrey:{v_50:"#eceff1",v_100:"#cfd8dc",v_200:"#b0bec5",v_300:"#90a4ae",v_400:"#78909c",v_500:"#607d8b",v_600:"#546e7a",v_700:"#455a64",v_800:"#37474f",v_900:"#263238"}},brand:{primary:{v_50:"#f0e7ed",v_100:"#dbc3d4",v_200:"#c59db9",v_300:"#ac799d",v_400:"#996189",v_500:"#874e77",v_600:"#7c4870",v_700:"#6e4167",v_800:"#5f3b5c",v_900:"#4b2e4d"},secondary:{v_50:"#e3f0ed",v_100:"#badbd2",v_200:"#8dc5b6",v_300:"#62af9a",v_400:"#479e86",v_500:"#368d74",v_600:"#328168",v_700:"#2c715a",v_800:"#26614d",v_900:"#1b4634"}}},tokenMapping:{primary:"brand.primary.v_400",primaryDark:"brand.primary.v_700",appBar:"brand.primary.v_400",appBarDark:"brand.primary.v_700",appBarFullscreen:"palette.grey.v_900",appBarFullscreenDark:"black",link:"brand.primary.v_400",linkDark:"brand.primary.v_700",loading:"brand.secondary.v_200",focusOutline:"brand.secondary.v_200",text:"palette.grey.v_900",textDisabled:"palette.grey.v_300",annotation:"palette.grey.v_700",textInverted:"palette.white",surface:"palette.white",fineLine:"#dedede",error:"palette.red.v_800",success:"palette.green.v_700",progress:"palette.lightblue.v_500",mastered:"palette.amber.v_500",correct:"palette.green.v_600",incorrect:"palette.red.v_800",coachContent:"palette.lightblue.v_800",superAdmin:"palette.amber.v_600",exercise:"palette.cyan.v_600",video:"palette.indigo.v_700",audio:"palette.pink.v_400",document:"palette.deeporange.v_600",html5:"palette.yellow.v_800",topic:"palette.grey.v_800",slideshow:"palette.green.v_400"}});function throwThemeError(tokenName,mapString){throw"Theme issue: '".concat(tokenName,"' has invalid mapping '").concat(mapString,"'")}var HEX_COLOR_PATTERN=RegExp("#[0-9a-fA-F]{6}"),tokens={};function generateTokenToColorMapping(){var newTokens={};return Object.keys(styles_globalThemeState.tokenMapping).forEach((function(tokenName){var mapString=styles_globalThemeState.tokenMapping[tokenName];if(-1!==mapString.indexOf(".")){for(var refs=mapString.split("."),obj=styles_globalThemeState.colors;refs.length;){var key=refs.shift();obj[key]||throwThemeError(tokenName,mapString),obj=obj[key]}"string"!=typeof obj&&throwThemeError(tokenName,mapString),HEX_COLOR_PATTERN.test(obj)||console.warn("Theme issue: Unexpected value '".concat(obj,"' for token '").concat(tokenName,"'")),newTokens[tokenName]=obj}else newTokens[tokenName]=mapString})),Object.assign(tokens,newTokens),tokens}function themeTokens(){return tokens}function themePalette(){return styles_globalThemeState.colors.palette}generateTokenToColorMapping();var THEMES={WHITE:{name:"WHITE",backgroundColor:themeTokens().surface,hoverColor:themePalette().grey.v_200,textColor:themeTokens().text},BEIGE:{name:"BEIGE",backgroundColor:themePalette().brown.v_50,hoverColor:themePalette().brown.v_100,textColor:themePalette().brown.v_800},GREY:{name:"GREY",backgroundColor:themePalette().grey.v_800,hoverColor:themePalette().grey.v_600,textColor:themePalette().white},BLACK:{name:"BLACK",backgroundColor:themePalette().grey.v_900,hoverColor:themePalette().grey.v_700,textColor:themePalette().grey.v_400},YELLOW:{name:"YELLOW",backgroundColor:themePalette().grey.v_900,hoverColor:themePalette().grey.v_700,textColor:themePalette().yellow.v_300},BLUE:{name:"BLUE",backgroundColor:themeTokens().surface,hoverColor:themePalette().grey.v_200,textColor:themePalette().blue.v_800}},darkThemeNames=["BLACK","GREY","YELLOW"];function SettingsSideBarvue_type_script_lang_js_typeof(o){return SettingsSideBarvue_type_script_lang_js_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},SettingsSideBarvue_type_script_lang_js_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=SettingsSideBarvue_type_script_lang_js_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=SettingsSideBarvue_type_script_lang_js_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==SettingsSideBarvue_type_script_lang_js_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var SettingsSideBar=normalizeComponent({name:"SettingsSideBar",components:{SideBar:SideBar},props:{theme:{type:Object,required:!0},decreaseFontSizeDisabled:{type:Boolean,required:!1,default:!1},increaseFontSizeDisabled:{type:Boolean,required:!1,default:!1}},computed:{themes:function(){return THEMES},settingsButtonFocus:function(){return{":focus":_objectSpread(_objectSpread({},this.$coreOutline),{},{outlineOffset:"0px",outlineWidth:"2px"})}}},methods:{generateThemeAriaLabel:function(themeName){switch(themeName){case"WHITE":return this.$tr("setWhiteTheme");case"BEIGE":return this.$tr("setBeigeTheme");case"GREY":return this.$tr("setGreyTheme");case"BLACK":return this.$tr("setBlackTheme");default:return""}},isCurrentlySelectedTheme:function(theme){return theme.backgroundColor===this.theme.backgroundColor&&theme.textColor===this.theme.textColor},generateStyle:function(theme){return _objectSpread(_objectSpread({},this.settingsButtonFocus),{},{backgroundColor:theme.backgroundColor,":hover":{backgroundColor:theme.hoverColor}})}},$trs:{textSize:{message:"Text size",context:"Indicate the size of the text in the EPUB reader. Learner can either decrease of increase the size of the text."},decrease:{message:"Decrease",context:"Button used to make the EPUB reader text size smaller."},increase:{message:"Increase",context:"Button used to make the EPUB reader text size larger."},theme:{message:"Theme",context:"The EPUB reader allows learners to set the background of the reader to different shades of colors using the 'Theme' option."},setWhiteTheme:{message:"Set white theme",context:"The EPUB reader allows learners to set the background of the reader to different shades of colors using the 'Theme' option. In this case it can be set to white."},setBeigeTheme:{message:"Set beige theme",context:"The EPUB reader allows learners to set the background of the reader to different shades of colors using the 'Theme' option. In this case it can be set to beige."},setGreyTheme:{message:"Set grey theme",context:"The EPUB reader allows learners to set the background of the reader to different shades of colors using the 'Theme' option. In this case it can be set to grey."},setBlackTheme:{message:"Set black theme",context:"The EPUB reader allows learners to set the background of the reader to different shades of colors using the 'Theme' option. In this case it can be set to black."}}},SettingsSideBarvue_type_template_id_0b26cee4_scoped_true_render,[],!1,null,"0b26cee4",null).exports,SearchSideBarvue_type_template_id_3297ee50_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("SideBar",[_c("form",{staticClass:"d-t",on:{submit:function($event){return $event.preventDefault(),_vm.submitSearch.apply(null,arguments)}}},[_c("div",{staticClass:"d-tr"},[_c("input",{directives:[{name:"model",rawName:"v-model.trim",value:_vm.searchQuery,expression:"searchQuery",modifiers:{trim:!0}}],ref:"searchInput",staticClass:"d-tc search-input",attrs:{type:"search","aria-label":_vm.$tr("enterSearchQuery")},domProps:{value:_vm.searchQuery},on:{keyup:function($event){if(!$event.type.indexOf("key")&&_vm._k($event.keyCode,"esc",27,$event.key,["Esc","Escape"]))return null;$event.stopPropagation()},input:function($event){$event.target.composing||(_vm.searchQuery=$event.target.value.trim())},blur:function($event){return _vm.$forceUpdate()}}}),_c("KIconButton",{staticClass:"d-tc",staticStyle:{position:"relative",top:"4px",left:"8px"},attrs:{icon:"search",buttonType:"submit",ariaLabel:_vm.$tr("submitSearchQuery"),size:"small"}})],1)]),_c("transition",{attrs:{mode:"out-in"}},[_vm.searchHasBeenMade?_vm.searchIsLoading?_c("div",{key:"loading-true"},[_c("p",{style:_vm.paragraphStyle},[_vm._v("\n        "+_vm._s(_vm.$tr("loadingResults"))+"\n      ")]),_c("KCircularLoader",{attrs:{delay:!1}})],1):0===_vm.searchResults.length?_c("p",{key:"results-false",style:_vm.paragraphStyle},[_vm._v("\n      "+_vm._s(_vm.$tr("noSearchResults"))+"\n    ")]):_vm.searchResults.length>0?_c("p",{key:"results-true",style:_vm.paragraphStyle},[_vm._v("\n      "+_vm._s(_vm.numberOfSearchResults)+"\n    ")]):_vm._e():_c("p",{key:"no-search",style:_vm.paragraphStyle},[_vm._v("\n      "+_vm._s(_vm.$tr("searchThroughBook"))+"\n    ")])]),_vm.searchHasBeenMade&&!_vm.searchIsLoading&&_vm.searchResults.length>0?_c("ol",{ref:"searchResultsList",staticClass:"search-results-list"},_vm._l(_vm.searchResults,(function(item,index){return _c("li",{key:index,staticClass:"search-results-list-item",style:{borderTop:"solid 1px "+_vm.$themeTokens.fineLine}},[_c("KButton",{staticClass:"search-results-list-item-button",attrs:{appearance:"basic-link"},on:{click:function($event){return _vm.$emit("navigateToSearchResult",item)}}},[_c("span",[_vm._v(_vm._s(item.before))]),_c("span",{staticClass:"mark"},[_vm._v(_vm._s(item.match))]),_c("span",[_vm._v(_vm._s(item.after))])])],1)})),0):_vm._e()],1)};SearchSideBarvue_type_template_id_3297ee50_scoped_true_render._withStripped=!0;function SearchSideBarvue_type_script_lang_js_typeof(o){return SearchSideBarvue_type_script_lang_js_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},SearchSideBarvue_type_script_lang_js_typeof(o)}function SearchSideBarvue_type_script_lang_js_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function SearchSideBarvue_type_script_lang_js_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?SearchSideBarvue_type_script_lang_js_ownKeys(Object(t),!0).forEach((function(r){SearchSideBarvue_type_script_lang_js_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):SearchSideBarvue_type_script_lang_js_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function SearchSideBarvue_type_script_lang_js_defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=SearchSideBarvue_type_script_lang_js_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=SearchSideBarvue_type_script_lang_js_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==SearchSideBarvue_type_script_lang_js_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function searchThroughEntireBook(book,searchQuery,maxSearchResults){return book.spine.spineItems.reduce((function(promiseChain,currentSpineItem){return promiseChain.then((function(totalSearchResults){return function(spineItem,searchQuery,numOfTotalSearchResultsSoFar){return new Promise((function(resolve){if(numOfTotalSearchResultsSoFar>maxSearchResults)resolve([]);else{var final=function(searchResults){return spineItem.unload(),searchResults||[]};spineItem.load(book.load.bind(book)).then((function(){return spineItem.find(searchQuery)})).then(final,final).then((function(searchResults){return resolve(searchResults)}))}}))}(currentSpineItem,searchQuery,totalSearchResults.length).then((function(currentSpineItemSearchResults){return totalSearchResults.concat(currentSpineItemSearchResults)}))}))}),Promise.resolve([]))}var SearchSideBar=normalizeComponent({name:"SearchSideBar",components:{SideBar:SideBar},props:{book:{type:Object,required:!0}},data:function(){return{searchResults:[],searchQuery:"",searchIsLoading:!1,maxSearchResultsExceeded:!1,searchHasBeenMade:!1}},computed:{numberOfSearchResults:function(){return this.maxSearchResultsExceeded?this.$tr("overCertainNumberOfSearchResults",{num:500}):this.$tr("numberOfSearchResults",{num:this.searchResults.length})},paragraphStyle:function(){return{color:this.$themeTokens.annotation}}},methods:{focusOnInput:function(){this.$refs.searchInput.focus()},submitSearch:function(){var _this=this,searchQuery=this.searchQuery.toLowerCase();searchQuery.length>0&&!1===this.searchIsLoading&&(this.searchIsLoading=!0,this.searchHasBeenMade=!0,this.maxSearchResultsExceeded=!1,searchThroughEntireBook(this.book,searchQuery,500).then((function(searchResults){searchResults.length>500&&(_this.maxSearchResultsExceeded=!0),searchResults=searchResults.slice(0,500),_this.searchResults=_this.selectMatchResult(searchResults),_this.$emit("newSearchQuery",searchQuery),_this.searchIsLoading=!1})))},selectMatchResult:function(searchResults){var _this2=this,searchQuery=this.searchQuery.toLowerCase();return searchResults.map((function(result,i){var textSplit=result.excerpt.toLowerCase().split(searchQuery),selectedIndex=_this2.getMatchIndex({textSplit:textSplit,cfi:result.cfi,nextResult:searchResults[i+1]}),slicedExcerpt=_this2.splitExcerpt({textSplit:textSplit,excerpt:result.excerpt,selectedIndex:selectedIndex});return SearchSideBarvue_type_script_lang_js_objectSpread(SearchSideBarvue_type_script_lang_js_objectSpread({},result),slicedExcerpt)}))},getMatchIndex:function(_ref){var textSplit=_ref.textSplit,cfi=_ref.cfi,nextResult=_ref.nextResult;if(textSplit.length<=2)return 0;if(!nextResult)return textSplit.length-2;for(var distanceNext=this.getDistanceInNode(cfi,nextResult.cfi),i=1;i<textSplit.length-1;i++){if(textSplit[i].length===distanceNext)return i-1}return textSplit.length-2},getDistanceInNode:function(cfi1,cfi2){var cfiParser=new epubcfi,cfi1Parsed=cfiParser.parse(cfi1),cfi2Parsed=cfiParser.parse(cfi2);if(!cfi1Parsed.range||!cfi2Parsed.range)return-1;var cfi2StartTerminal=cfi2Parsed.start.terminal,cfi1EndTerminal=cfi1Parsed.end.terminal;return delete cfi1Parsed.start.terminal,delete cfi2Parsed.start.terminal,delete cfi1Parsed.end.terminal,delete cfi2Parsed.end.terminal,isEqual_default()(cfi1Parsed,cfi2Parsed)?cfi2StartTerminal.offset-cfi1EndTerminal.offset:-1},splitExcerpt:function(_ref2){for(var textSplit=_ref2.textSplit,excerpt=_ref2.excerpt,selectedIndex=_ref2.selectedIndex,searchQueryLength=this.searchQuery.length,startIndex=searchQueryLength*selectedIndex,i=0;i<selectedIndex+1;i++)startIndex+=textSplit[i].length;var endIndex=startIndex+searchQueryLength;return{before:excerpt.slice(0,startIndex),match:excerpt.slice(startIndex,endIndex),after:excerpt.slice(endIndex)}}},$trs:{searchThroughBook:{message:"Search through book",context:"Option in the EPUB reader to search for a term throughout the entire book."},noSearchResults:{message:"No results",context:"Displayed when no results are obtained after a learner searches for a term in a digital book."},loadingResults:{message:"Loading results",context:"Message indicating the EPUB reader is loading the results of a search within a book."},overCertainNumberOfSearchResults:{message:"Over {num, number, integer} {num, plural, one {result} other {results}}",context:'Refers to number of search results when there are over a specified amount. Only translate "over", "result" and "results".\n'},numberOfSearchResults:{message:"{num, number, integer} {num, plural, one {result} other {results}}",context:'Refers to number of search results. Only translate "result" and "results".'},enterSearchQuery:{message:"Enter a word to search",context:"Label for the search field in the EPUB reader."},submitSearchQuery:{message:"Start the search",context:"Label for a button to initiate a search in an EPUB book."}}},SearchSideBarvue_type_template_id_3297ee50_scoped_true_render,[],!1,null,"3297ee50",null).exports,BottomBarvue_type_template_id_4238933c_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{staticClass:"bottom-bar",style:{backgroundColor:_vm.$themePalette.grey.v_200}},[_c("div",{staticClass:"bottom-bar-heading"},[_vm.heading?_c("h3",[_vm._v("\n      "+_vm._s(_vm.heading)+"\n    ")]):_vm._e()]),_c("transition",{attrs:{mode:"in-out"}},[_vm.locationsAreReady?_c("div",[_c("div",{staticClass:"d-t"},[_c("div",{staticClass:"d-t-r"},[_c("div",{staticClass:"bottom-bar-progress-container d-t-c"},[_c("div",{staticClass:"bottom-bar-progress"},[_vm._v("\n              "+_vm._s(_vm.$formatNumber(_vm.sliderValue/100,{style:"percent"}))+"\n            ")])]),_c("div",{staticClass:"d-t-c full-width"},[_c("input",{staticClass:"full-width",attrs:{type:"range",min:0,max:100,step:_vm.sliderStep,"aria-label":_vm.$tr("jumpToPositionInBook")},domProps:{value:_vm.sliderValue},on:{change:function($event){return _vm.handleChange($event.target.value)}}})])])])]):_c("div",{staticClass:"loader-container"},[_c("KLinearLoader",{staticClass:"loader",attrs:{type:"indeterminate",delay:!1}}),_c("span",[_vm._v(_vm._s(_vm.$tr("preparingSlider")))])],1)])],1)};BottomBarvue_type_template_id_4238933c_scoped_true_render._withStripped=!0;var BottomBar=normalizeComponent({name:"BottomBar",props:{heading:{type:String,default:null},sliderValue:{type:Number,required:!0},sliderStep:{type:Number,required:!0},locationsAreReady:{type:Boolean,required:!0}},methods:{handleChange:function(newValue){this.$emit("sliderChanged",Number(newValue))}},$trs:{jumpToPositionInBook:{message:"Jump to position in book",context:"To read digital books in Kolibri learners have several available controls inside the reader.\n\nOne of them allows the learner to access a specific page in the book using the slider control bar at the bottom of the screen."},preparingSlider:{message:"Preparing slider",context:"The slider option is a bar that appears at the bottom of the EPUB reader which allows learners to navigate the pages of the book they're reading. This message appears when the slider is loading."}}},BottomBarvue_type_template_id_4238933c_scoped_true_render,[],!1,null,"4238933c",null).exports,PreviousButtonvue_type_template_id_20bc85d0_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement;return(_vm._self._c||_h)("KIconButton",{staticClass:"previous-button",class:{"previous-button-white":"white"===_vm.color},attrs:{icon:_vm.isRtl?"chevronRight":"chevronLeft",color:_vm.color,ariaLabel:_vm.$tr("goToPreviousPage")},on:{click:function($event){return _vm.$emit("goToPreviousPage")}}})};PreviousButtonvue_type_template_id_20bc85d0_scoped_true_render._withStripped=!0;var PreviousButton=normalizeComponent({name:"PreviousButton",props:{color:{type:String,required:!0,validator:function(val){return["black","white"].includes(val)}}},$trs:{goToPreviousPage:{message:"Go to previous page",context:"Digital book navigation option."}}},PreviousButtonvue_type_template_id_20bc85d0_scoped_true_render,[],!1,null,"20bc85d0",null).exports,NextButtonvue_type_template_id_45e676e0_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement;return(_vm._self._c||_h)("KIconButton",{staticClass:"next-button",class:{"next-button-white":"white"===_vm.color},attrs:{icon:_vm.isRtl?"chevronLeft":"chevronRight",ariaLabel:_vm.$tr("goToNextPage"),color:_vm.color},on:{click:function($event){return _vm.$emit("goToNextPage")}}})};NextButtonvue_type_template_id_45e676e0_scoped_true_render._withStripped=!0;var NextButton=normalizeComponent({name:"NextButton",props:{color:{type:String,required:!0,validator:function(val){return["black","white"].includes(val)}}},$trs:{goToNextPage:{message:"Go to next page",context:"Digital book navigation option."}}},NextButtonvue_type_template_id_45e676e0_scoped_true_render,[],!1,null,"45e676e0",null).exports;function EpubRendererIndexvue_type_script_lang_js_typeof(o){return EpubRendererIndexvue_type_script_lang_js_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},EpubRendererIndexvue_type_script_lang_js_typeof(o)}function _toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function EpubRendererIndexvue_type_script_lang_js_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function EpubRendererIndexvue_type_script_lang_js_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?EpubRendererIndexvue_type_script_lang_js_ownKeys(Object(t),!0).forEach((function(r){EpubRendererIndexvue_type_script_lang_js_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):EpubRendererIndexvue_type_script_lang_js_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function EpubRendererIndexvue_type_script_lang_js_defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=EpubRendererIndexvue_type_script_lang_js_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=EpubRendererIndexvue_type_script_lang_js_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==EpubRendererIndexvue_type_script_lang_js_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var SIDE_BARS_TOC="TOC",SIDE_BARS_SEARCH="SEARCH",SIDE_BARS_SETTINGS="SETTINGS",EpubRendererIndexvue_type_script_lang_js={name:"EpubRendererIndex",components:{CoreFullscreen:external_kolibriCoreAppGlobal_coreVue_components_CoreFullscreen_default(),TopBar:TopBar,TableOfContentsSideBar:TableOfContentsSideBar,SettingsSideBar:SettingsSideBar,SearchSideBar:SearchSideBar,LoadingScreen:LoadingScreen,BottomBar:BottomBar,PreviousButton:PreviousButton,NextButton:NextButton,FocusLock:dist_default(),TocButton:TocButton,SettingsButton:SettingsButton,SearchButton:SearchButton,LoadingError:LoadingError},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_default(),external_kolibriCoreAppGlobal_coreVue_mixins_responsiveElementMixin_default()],data:function(){return{book:null,rendition:null,toc:[],locations:[],loaded:!1,errorLoading:!1,sideBarOpen:null,theme:THEMES.WHITE,fontSize:null,isInFullscreen:!1,markInstance:null,currentSection:null,searchQuery:null,sliderValue:0,scrolled:!1,currentLocation:null,visitedPages:{},updateContentStateInterval:null}},computed:{isAtStart:function(){return get_default()(this.rendition,"location.atStart",!1)},isAtEnd:function(){return get_default()(this.rendition,"location.atEnd",!1)},savedLocation:function(){return this.extraFields&&this.extraFields.contentState?this.extraFields.contentState.savedLocation:null},savedVisitedPages:{get:function(){return this.extraFields&&this.extraFields.contentState&&this.extraFields.contentState.savedVisitedPages||{}},set:function(value){this.visitedPages=value}},epubURL:function(){return new URL(this.defaultFile.storage_url,window.location).href},backgroundColor:function(){return this.theme.backgroundColor},textColor:function(){return this.theme.textColor},themeStyle:function(){var colorStyle={"background-color":"".concat(this.backgroundColor,"!important"),color:"".concat(this.textColor,"!important")},alignmentStyle={"text-align":"".concat(this.isRtl?"right":"left")},fontSizeStyle=this.fontSize?{"font-size":"".concat(this.fontSize,"!important")}:{},htmlStyle=this.scrolled?{display:"flex"}:{margin:"0!important"},bodyScrolledStyle=this.scrolled?{width:"auto!important",padding:"20px!important"}:{};return{html:EpubRendererIndexvue_type_script_lang_js_objectSpread(EpubRendererIndexvue_type_script_lang_js_objectSpread(EpubRendererIndexvue_type_script_lang_js_objectSpread(EpubRendererIndexvue_type_script_lang_js_objectSpread({},colorStyle),alignmentStyle),fontSizeStyle),htmlStyle),body:EpubRendererIndexvue_type_script_lang_js_objectSpread(EpubRendererIndexvue_type_script_lang_js_objectSpread(EpubRendererIndexvue_type_script_lang_js_objectSpread(EpubRendererIndexvue_type_script_lang_js_objectSpread({},colorStyle),alignmentStyle),fontSizeStyle),bodyScrolledStyle),p:EpubRendererIndexvue_type_script_lang_js_objectSpread(EpubRendererIndexvue_type_script_lang_js_objectSpread(EpubRendererIndexvue_type_script_lang_js_objectSpread({},colorStyle),alignmentStyle),{"line-height":"1.4em!important"}),h1:EpubRendererIndexvue_type_script_lang_js_objectSpread({},colorStyle),h2:EpubRendererIndexvue_type_script_lang_js_objectSpread({},colorStyle),h3:EpubRendererIndexvue_type_script_lang_js_objectSpread({},colorStyle),h4:EpubRendererIndexvue_type_script_lang_js_objectSpread({},colorStyle),h5:EpubRendererIndexvue_type_script_lang_js_objectSpread({},colorStyle),"p:first-of-type::first-letter":EpubRendererIndexvue_type_script_lang_js_objectSpread({},colorStyle),video:{"max-width":"100%"},img:{"max-width":"100%"}}},tocSideBarIsOpen:function(){return this.sideBarOpen===SIDE_BARS_TOC},settingsSideBarIsOpen:function(){return this.sideBarOpen===SIDE_BARS_SETTINGS},searchSideBarIsOpen:function(){return this.sideBarOpen===SIDE_BARS_SEARCH},epubRendererStyle:function(){return{backgroundColor:this.$themeTokens.surface}},navigationButtonColor:function(){var _this=this;return darkThemeNames.some((function(themeName){return isEqual_default()(_this.theme.name,themeName)}))?"white":"black"},bottomBarHeading:function(){return this.currentSection?this.currentSection.label.trim():""},sliderStep:function(){return this.locations.length>0?Math.floor(Math.min(Math.max(100/this.locations.length,.1),100)):1},decreaseFontSizeDisabled:function(){return this.fontSize==="".concat(8,"px")},increaseFontSizeDisabled:function(){return this.fontSize==="".concat(32,"px")},defaultDuration:function(){return 60*(1e3*this.locations.length/10)/300},locationsAreReady:function(){return this.locations&&this.locations.length>0}},watch:{sideBarOpen:function(newSideBar,oldSideBar){var _this2=this;this.$nextTick().then((function(){if(oldSideBar===SIDE_BARS_SEARCH&&_this2.clearMarks(),!newSideBar)switch(oldSideBar){case SIDE_BARS_TOC:_this2.$refs.topBar.focusOnTocButton();break;case SIDE_BARS_SETTINGS:_this2.$refs.topBar.focusOnSettingsButton();break;case SIDE_BARS_SEARCH:_this2.$refs.topBar.focusOnSearchButton()}newSideBar===SIDE_BARS_SEARCH&&(_this2.$refs.searchSideBar.focusOnInput(),_this2.searchQuery&&_this2.clearMarks().then(_this2.createMarks(_this2.searchQuery)))}))}},created:function(){this.cssPromise=this.$options.contentModule.loadDirectionalCSS(this.contentDirection),this.visitedPages=this.savedVisitedPages||{}},beforeMount:function(){var _this3=this;__webpack_require__.g.ePub=epub,this.book=new epub(this.epubURL),this.book.on(EVENTS_BOOK.OPEN_FAILED,(function(err){_this3.errorLoading=!0,_this3.reportLoadingError(err)}));var _ref=lockr_default().get("kolibriEpubRendererSettings")||{},_ref$theme=_ref.theme,theme=void 0===_ref$theme?this.theme:_ref$theme,_ref$fontSize=_ref.fontSize,fontSize=void 0===_ref$fontSize?this.fontSize:_ref$fontSize;this.theme=theme,this.fontSize=fontSize},mounted:function(){var _this4=this;Promise.all([this.cssPromise,this.book.ready]).then((function(){_this4.book.navigation&&(_this4.toc=_this4.book.navigation.toc),_this4.rendition=_this4.book.renderTo(_this4.$refs.epubjsContainer,{view:views_SandboxIFrameView,resizeOnOrientationChange:!1,spread:"auto",minSpreadWidth:600}),_this4.rendition.display(_this4.savedLocation||void 0).then((function(){var hasTables=_this4.rendition.getContents().reduce((function(hasTable,contents){return hasTable||contents.document.getElementsByTagName("table").length>0}),!1);if(hasTables)return _this4.scrolled=!0,_this4.rendition.flow("scrolled"),_this4.rendition.clear(),_this4.rendition.display(_this4.savedLocation||void 0);var bounds=_this4.$refs.epubjsContainer.getBoundingClientRect();Object.assign(_this4.rendition.manager.stage.settings,{width:bounds.width,height:bounds.height});var resize=new Promise((function(resolve,reject){_this4.rendition.once(EVENTS_RENDITION.DISPLAYED,resolve),_this4.rendition.once(EVENTS_RENDITION.DISPLAY_ERROR,reject)}));return _this4.rendition.q.enqueue((function(){return _this4.rendition.resize()})).then((function(){return resize})).then((function(){}),(function(){return _this4.rendition.display(_this4.savedLocation||void 0)})).then((function(){_this4.errorLoading=!1}))})).then((function(){_this4.handleReadyRendition()}),(function(){_this4.errorLoading=!0})),_this4.rendition.on(EVENTS_RENDITION.DISPLAY_ERROR,(function(err){_this4.errorLoading=!0,_this4.reportLoadingError(err)}))}))},beforeDestroy:function(){this.updateContentState(),this.updateProgress(),this.$emit("stopTracking"),window.removeEventListener("mousedown",this.handleMouseDown,{passive:!0}),clearInterval(this.updateContentStateInterval)},destroyed:function(){delete __webpack_require__.g.ePub},methods:{updateProgress:function(){this.locations.length>0&&(this.forceDurationBasedProgress?this.$emit("updateProgress",this.durationBasedProgress):this.$emit("updateProgress",Object.keys(this.visitedPages||{}).length/this.locations.length))},storeVisitedPage:function(currentLocation){if(currentLocation){var visited=this.savedVisitedPages;visited[currentLocation]=!0,this.savedVisitedPages=visited}},handleReadyRendition:function(){var _this5=this;this.updateRenditionTheme(this.themeStyle),this.rendition.on(EVENTS_RENDITION.RELOCATED,(function(location){return _this5.relocatedHandler(location)})),this.rendition.on("keyup",this.handleKeyUps),this.rendition.on("click",(function(){return _this5.closeSideBar()})),window.addEventListener("mousedown",this.handleMouseDown,{passive:!0}),this.loaded=!0,this.book.locations.generate(1e3).then((function(locations){_this5.locations=locations,_this5.$emit("startTracking"),_this5.updateContentStateInterval=setInterval(_this5.updateProgress,3e4),Promise.resolve().then((function(){return _this5.rendition.currentLocation()})).then((function(currentLocation){currentLocation&&currentLocation.start&&_this5.relocatedHandler(currentLocation)}))}))},updateRenditionTheme:function(newTheme){var themeName=JSON.stringify(newTheme);this.rendition.themes.register(themeName,newTheme),this.rendition.themes.select(themeName)},getIFrameView:function(){return this.rendition.views().displayed().filter((function(view){return view instanceof views_SandboxIFrameView})).shift()},handleKeyUps:function(event){var _this6=this,focus=function(){var view=_this6.getIFrameView();view&&view.focus()};switch(event.which){case 37:this.goToPreviousPage().then(focus);break;case 39:this.goToNextPage().then(focus)}},handleMouseDown:function(event){if(this.$refs.epubRenderer){var closeSideBar=!1;this.tocSideBarIsOpen?closeSideBar=!this.$refs.tocSideBar.$el.contains(event.target):this.settingsSideBarIsOpen?closeSideBar=!this.$refs.settingsSideBar.$el.contains(event.target):this.searchSideBarIsOpen&&(closeSideBar=!this.$refs.searchSideBar.$el.contains(event.target)),closeSideBar&&this.closeSideBar()}},closeSideBar:function(){this.sideBarOpen=null},goToNextPage:function(){return this.rendition.next()},goToPreviousPage:function(){return this.rendition.prev()},jumpToLocation:function(locationToJumpTo){return this.rendition.display(locationToJumpTo)},toggleMenu:function(sideBarName){this.sideBarOpen===sideBarName?this.closeSideBar():this.sideBarOpen=sideBarName},handleTocToggle:function(){this.toggleMenu(SIDE_BARS_TOC)},handleSearchToggle:function(){this.toggleMenu(SIDE_BARS_SEARCH)},handleSettingToggle:function(){this.toggleMenu(SIDE_BARS_SETTINGS)},handleTocNavigation:function(item){var _this7=this;this.jumpToLocation(item.href).then((function(){_this7.closeSideBar()})).catch((function(){_this7.jumpToLocation("xhtml/".concat(item.href)).then((function(){_this7.closeSideBar()}))}))},getCurrentFontSize:function(){var view=this.getIFrameView();return view?view.getContents().css("font-size",null):null},handleChangeFontSize:function(difference){var fontSizeNumericValue=parseFloat(this.getCurrentFontSize()),newFontSizeNumericValue=clamp_default()(fontSizeNumericValue+4*difference,8,32);this.setFontSize("".concat(newFontSizeNumericValue,"px"))},expandIFrameView:function(){this.getIFrameView()},setTheme:function(theme){this.theme=theme,this.persistSettings({theme:theme}),this.updateRenditionTheme(this.themeStyle)},setFontSize:function(fontSize){this.fontSize=fontSize,this.persistSettings({fontSize:fontSize}),this.updateRenditionTheme(this.themeStyle),this.scrolled&&this.expandIFrameView()},persistSettings:function(settings){var saved=lockr_default().get("kolibriEpubRendererSettings");lockr_default().set("kolibriEpubRendererSettings",EpubRendererIndexvue_type_script_lang_js_objectSpread(EpubRendererIndexvue_type_script_lang_js_objectSpread({},saved),settings))},handleNewSearchQuery:function(searchQuery){this.searchQuery=searchQuery,this.clearMarks().then(this.createMarks(searchQuery))},handleNavigateToSearchResult:function(searchResult){var _this8=this;this.clearMarks().then((function(){return _this8.jumpToLocation(searchResult.cfi)})).then((function(){return _this8.createMarks(_this8.searchQuery)}))},clearMarks:function(){var _this9=this;return new Promise((function(resolve){_this9.markInstance?_this9.markInstance.unmark({done:function(){_this9.markInstance=null,resolve()}}):resolve()}))},createMarks:function(searchQuery){var _this10=this,view=this.getIFrameView();return view?new Promise((function(resolve){var root=view.getContents().root();_this10.markInstance=new(mark_default())(root.getElementsByTagName("body").item(0)),_this10.markInstance.mark(searchQuery,{separateWordSearch:!1,done:function(){return resolve()}})})):Promise.resolve()},flattenToc:function(toc){var _ref2,_this11=this;return(_ref2=[]).concat.apply(_ref2,_toConsumableArray(toc.map((function(section){return[section].concat(_toConsumableArray(_this11.flattenToc(section.subitems)))}))))},getCurrentSection:function(currentLocationStart){var currentSection,_this12=this;if(currentLocationStart){var flatToc=this.flattenToc(this.toc),currentLocationHref=this.book.canonical(currentLocationStart.href);currentSection=flatToc.find((function(item){return _this12.book.canonical(item.href)===currentLocationHref}))}return currentSection},updateCurrentSection:function(currentLocationStart){this.currentSection=this.getCurrentSection(currentLocationStart)},relocatedHandler:function(location){location.atEnd?this.sliderValue=100:this.sliderValue=100*location.start.percentage,this.updateCurrentSection(location.start),this.currentLocation=location.start.cfi;for(var locationIndex=location.start.location;locationIndex<=location.end.location;locationIndex++)this.storeVisitedPage(this.locations[locationIndex]);location.end.percentage>=1&&this.finish(),this.updateProgress(),this.updateContentState()},handleSliderChanged:function(newSliderValue){var indexOfLocationToJumpTo=Math.floor((this.locations.length-1)*(newSliderValue/100)),locationToJumpTo=this.locations[indexOfLocationToJumpTo];this.jumpToLocation(locationToJumpTo)},updateContentState:function(){var contentState;contentState=this.extraFields?EpubRendererIndexvue_type_script_lang_js_objectSpread(EpubRendererIndexvue_type_script_lang_js_objectSpread({},this.extraFields.contentState),{},{savedLocation:this.currentLocation||this.savedLocation,savedVisitedPages:this.visitedPages||this.savedVisitedPages}):{savedLocation:this.currentLocation||this.savedLocation,savedVisitedPages:this.visitedPages||this.savedVisitedPages},this.$emit("updateContentState",contentState)},finish:function(){this.$emit("finished")}}},EpubRendererIndex=normalizeComponent(EpubRendererIndexvue_type_script_lang_js,render,[],!1,null,"e3b732ba",null).exports;function module_typeof(o){return module_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},module_typeof(o)}function module_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,module_toPropertyKey(descriptor.key),descriptor)}}function module_toPropertyKey(t){var i=function(t,r){if("object"!=module_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=module_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==module_typeof(i)?i:String(i)}function module_callSuper(_this,derived,args){return derived=module_getPrototypeOf(derived),function(self,call){if(call&&("object"===module_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(_this,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(derived,args||[],module_getPrototypeOf(_this).constructor):derived.apply(_this,args))}function module_getPrototypeOf(o){return module_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},module_getPrototypeOf(o)}function module_setPrototypeOf(o,p){return module_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},module_setPrototypeOf(o,p)}var DocumentEPUBModule=function(_ContentRendererModul){function DocumentEPUBModule(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DocumentEPUBModule),module_callSuper(this,DocumentEPUBModule,arguments)}var Constructor,protoProps,staticProps;return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&module_setPrototypeOf(subClass,superClass)}(DocumentEPUBModule,_ContentRendererModul),Constructor=DocumentEPUBModule,(protoProps=[{key:"rendererComponent",get:function(){return EpubRendererIndex.contentModule=this,EpubRendererIndex}}])&&module_defineProperties(Constructor.prototype,protoProps),staticProps&&module_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),DocumentEPUBModule}(ContentRenderer);new DocumentEPUBModule}()}();
//# sourceMappingURL=kolibri.plugins.epub_viewer.main-0.16.0.js.map