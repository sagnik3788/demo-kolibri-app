/*! For license information please see kolibri.plugins.pdf_viewer.main-0.16.0.js.LICENSE.txt */
(function(){var __webpack_modules__={393:function(){function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}for(var toPolyfill=[Element.prototype,Document.prototype,DocumentFragment.prototype],_i=0,_toPolyfill=toPolyfill;_i<_toPolyfill.length;_i++){var item=_toPolyfill[_i];Object.prototype.hasOwnProperty.call(item,"append")||Object.defineProperty(item,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var _step,argArr=Array.prototype.slice.call(arguments),docFrag=document.createDocumentFragment(),_iterator=_createForOfIteratorHelper(argArr);try{for(_iterator.s();!(_step=_iterator.n()).done;){var argItem=_step.value;docFrag.appendChild(argItem instanceof Node?argItem:document.createTextNode(String(argItem)))}}catch(err){_iterator.e(err)}finally{_iterator.f()}this.appendChild(docFrag)}})}for(var _i2=0,_toPolyfill2=toPolyfill;_i2<_toPolyfill2.length;_i2++){var _item=_toPolyfill2[_i2];Object.prototype.hasOwnProperty.call(_item,"prepend")||Object.defineProperty(_item,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(){var _step2,argArr=Array.prototype.slice.call(arguments),docFrag=document.createDocumentFragment(),_iterator2=_createForOfIteratorHelper(argArr);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var argItem=_step2.value;docFrag.appendChild(argItem instanceof Node?argItem:document.createTextNode(String(argItem)))}}catch(err){_iterator2.e(err)}finally{_iterator2.f()}this.insertBefore(docFrag,this.firstChild)}})}},423:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}factory=function(){"use strict";function fromArray(array){var m=new CSSMatrix,a=Array.from(array);if(!a.every((function(n){return!Number.isNaN(n)})))throw TypeError('CSSMatrix: "'+array+'" must only have numbers.');if(16===a.length){var m11=a[0],m12=a[1],m13=a[2],m14=a[3],m21=a[4],m22=a[5],m23=a[6],m24=a[7],m31=a[8],m32=a[9],m33=a[10],m34=a[11],m41=a[12],m42=a[13],m43=a[14],m44=a[15];m.m11=m11,m.a=m11,m.m21=m21,m.c=m21,m.m31=m31,m.m41=m41,m.e=m41,m.m12=m12,m.b=m12,m.m22=m22,m.d=m22,m.m32=m32,m.m42=m42,m.f=m42,m.m13=m13,m.m23=m23,m.m33=m33,m.m43=m43,m.m14=m14,m.m24=m24,m.m34=m34,m.m44=m44}else{if(6!==a.length)throw new TypeError("CSSMatrix: expecting an Array of 6/16 values.");var M11=a[0],M12=a[1],M21=a[2],M22=a[3],M41=a[4],M42=a[5];m.m11=M11,m.a=M11,m.m12=M12,m.b=M12,m.m21=M21,m.c=M21,m.m22=M22,m.d=M22,m.m41=M41,m.e=M41,m.m42=M42,m.f=M42}return m}function fromMatrix(m){var keys=Object.keys(new CSSMatrix);if("object"===_typeof(m)&&keys.every((function(k){return k in m})))return fromArray([m.m11,m.m12,m.m13,m.m14,m.m21,m.m22,m.m23,m.m24,m.m31,m.m32,m.m33,m.m34,m.m41,m.m42,m.m43,m.m44]);throw TypeError('CSSMatrix: "'+JSON.stringify(m)+'" is not a DOMMatrix / CSSMatrix / JSON compatible object.')}function fromString(source){if("string"!=typeof source)throw TypeError('CSSMatrix: "'+source+'" is not a string.');var str=String(source).replace(/\s/g,""),m=new CSSMatrix,invalidStringError='CSSMatrix: invalid transform string "'+source+'"';return str.split(")").filter((function(f){return f})).forEach((function(tf){var ref=tf.split("("),prop=ref[0],value=ref[1];if(!value)throw TypeError(invalidStringError);var components=value.split(",").map((function(n){return n.includes("rad")?parseFloat(n)*(180/Math.PI):parseFloat(n)})),x=components[0],y=components[1],z=components[2],a=components[3],xyz=[x,y,z],xyza=[x,y,z,a];if("perspective"===prop&&x&&[y,z].every((function(n){return void 0===n})))m.m34=-1/x;else if(prop.includes("matrix")&&[6,16].includes(components.length)&&components.every((function(n){return!Number.isNaN(+n)}))){var values=components.map((function(n){return Math.abs(n)<1e-6?0:n}));m=m.multiply(fromArray(values))}else if("translate3d"===prop&&xyz.every((function(n){return!Number.isNaN(+n)})))m=m.translate(x,y,z);else if("translate"===prop&&x&&void 0===z)m=m.translate(x,y||0,0);else if("rotate3d"===prop&&xyza.every((function(n){return!Number.isNaN(+n)}))&&a)m=m.rotateAxisAngle(x,y,z,a);else if("rotate"===prop&&x&&[y,z].every((function(n){return void 0===n})))m=m.rotate(0,0,x);else if("scale3d"===prop&&xyz.every((function(n){return!Number.isNaN(+n)}))&&xyz.some((function(n){return 1!==n})))m=m.scale(x,y,z);else if("scale"!==prop||Number.isNaN(x)||1===x||void 0!==z)if("skew"===prop&&(x||!Number.isNaN(x)&&y)&&void 0===z)m=m.skew(x,y||0);else{if(!(/[XYZ]/.test(prop)&&x&&[y,z].every((function(n){return void 0===n}))&&["translate","rotate","scale","skew"].some((function(p){return prop.includes(p)}))))throw TypeError(invalidStringError);if(["skewX","skewY"].includes(prop))m=m[prop](x);else{var fn=prop.replace(/[XYZ]/,""),axis=prop.replace(fn,""),idx=["X","Y","Z"].indexOf(axis),def="scale"===fn?1:0,axeValues=[0===idx?x:def,1===idx?x:def,2===idx?x:def];m=m[fn].apply(m,axeValues)}}else{var sy=Number.isNaN(+y)?x:y;m=m.scale(x,sy,1)}})),m}function toArray(m,is2D){return is2D?[m.a,m.b,m.c,m.d,m.e,m.f]:[m.m11,m.m12,m.m13,m.m14,m.m21,m.m22,m.m23,m.m24,m.m31,m.m32,m.m33,m.m34,m.m41,m.m42,m.m43,m.m44]}function Translate(x,y,z){var m=new CSSMatrix;return m.m41=x,m.e=x,m.m42=y,m.f=y,m.m43=z,m}function Rotate(rx,ry,rz){var m=new CSSMatrix,degToRad=Math.PI/180,radX=rx*degToRad,radY=ry*degToRad,radZ=rz*degToRad,cosx=Math.cos(radX),sinx=-Math.sin(radX),cosy=Math.cos(radY),siny=-Math.sin(radY),cosz=Math.cos(radZ),sinz=-Math.sin(radZ),m11=cosy*cosz,m12=-cosy*sinz;m.m11=m11,m.a=m11,m.m12=m12,m.b=m12,m.m13=siny;var m21=sinx*siny*cosz+cosx*sinz;m.m21=m21,m.c=m21;var m22=cosx*cosz-sinx*siny*sinz;return m.m22=m22,m.d=m22,m.m23=-sinx*cosy,m.m31=sinx*sinz-cosx*siny*cosz,m.m32=sinx*cosz+cosx*siny*sinz,m.m33=cosx*cosy,m}function RotateAxisAngle(x,y,z,alpha){var m=new CSSMatrix,length=Math.sqrt(x*x+y*y+z*z);if(0===length)return m;var X=x/length,Y=y/length,Z=z/length,angle=alpha*(Math.PI/360),sinA=Math.sin(angle),cosA=Math.cos(angle),sinA2=sinA*sinA,x2=X*X,y2=Y*Y,z2=Z*Z,m11=1-2*(y2+z2)*sinA2;m.m11=m11,m.a=m11;var m12=2*(X*Y*sinA2+Z*sinA*cosA);m.m12=m12,m.b=m12,m.m13=2*(X*Z*sinA2-Y*sinA*cosA);var m21=2*(Y*X*sinA2-Z*sinA*cosA);m.m21=m21,m.c=m21;var m22=1-2*(z2+x2)*sinA2;return m.m22=m22,m.d=m22,m.m23=2*(Y*Z*sinA2+X*sinA*cosA),m.m31=2*(Z*X*sinA2+Y*sinA*cosA),m.m32=2*(Z*Y*sinA2-X*sinA*cosA),m.m33=1-2*(x2+y2)*sinA2,m}function Scale(x,y,z){var m=new CSSMatrix;return m.m11=x,m.a=x,m.m22=y,m.d=y,m.m33=z,m}function Skew(angleX,angleY){var m=new CSSMatrix;if(angleX){var radX=angleX*Math.PI/180,tX=Math.tan(radX);m.m21=tX,m.c=tX}if(angleY){var radY=angleY*Math.PI/180,tY=Math.tan(radY);m.m12=tY,m.b=tY}return m}function SkewX(angle){return Skew(angle,0)}function SkewY(angle){return Skew(0,angle)}function Multiply(m1,m2){return fromArray([m2.m11*m1.m11+m2.m12*m1.m21+m2.m13*m1.m31+m2.m14*m1.m41,m2.m11*m1.m12+m2.m12*m1.m22+m2.m13*m1.m32+m2.m14*m1.m42,m2.m11*m1.m13+m2.m12*m1.m23+m2.m13*m1.m33+m2.m14*m1.m43,m2.m11*m1.m14+m2.m12*m1.m24+m2.m13*m1.m34+m2.m14*m1.m44,m2.m21*m1.m11+m2.m22*m1.m21+m2.m23*m1.m31+m2.m24*m1.m41,m2.m21*m1.m12+m2.m22*m1.m22+m2.m23*m1.m32+m2.m24*m1.m42,m2.m21*m1.m13+m2.m22*m1.m23+m2.m23*m1.m33+m2.m24*m1.m43,m2.m21*m1.m14+m2.m22*m1.m24+m2.m23*m1.m34+m2.m24*m1.m44,m2.m31*m1.m11+m2.m32*m1.m21+m2.m33*m1.m31+m2.m34*m1.m41,m2.m31*m1.m12+m2.m32*m1.m22+m2.m33*m1.m32+m2.m34*m1.m42,m2.m31*m1.m13+m2.m32*m1.m23+m2.m33*m1.m33+m2.m34*m1.m43,m2.m31*m1.m14+m2.m32*m1.m24+m2.m33*m1.m34+m2.m34*m1.m44,m2.m41*m1.m11+m2.m42*m1.m21+m2.m43*m1.m31+m2.m44*m1.m41,m2.m41*m1.m12+m2.m42*m1.m22+m2.m43*m1.m32+m2.m44*m1.m42,m2.m41*m1.m13+m2.m42*m1.m23+m2.m43*m1.m33+m2.m44*m1.m43,m2.m41*m1.m14+m2.m42*m1.m24+m2.m43*m1.m34+m2.m44*m1.m44])}var CSSMatrix=function(){for(var args=[],len=arguments.length;len--;)args[len]=arguments[len];var m=this;if(m.a=1,m.b=0,m.c=0,m.d=1,m.e=0,m.f=0,m.m11=1,m.m12=0,m.m13=0,m.m14=0,m.m21=0,m.m22=1,m.m23=0,m.m24=0,m.m31=0,m.m32=0,m.m33=1,m.m34=0,m.m41=0,m.m42=0,m.m43=0,m.m44=1,args.length){var ARGS=[16,6].some((function(l){return l===args.length}))?args:args[0];return m.setMatrixValue(ARGS)}return m},prototypeAccessors={isIdentity:{configurable:!0},is2D:{configurable:!0}};return prototypeAccessors.isIdentity.get=function(){var m=this;return 1===m.m11&&0===m.m12&&0===m.m13&&0===m.m14&&0===m.m21&&1===m.m22&&0===m.m23&&0===m.m24&&0===m.m31&&0===m.m32&&1===m.m33&&0===m.m34&&0===m.m41&&0===m.m42&&0===m.m43&&1===m.m44},prototypeAccessors.is2D.get=function(){var m=this;return 0===m.m31&&0===m.m32&&1===m.m33&&0===m.m34&&0===m.m43&&1===m.m44},CSSMatrix.prototype.setMatrixValue=function(source){return"string"==typeof source&&source.length&&"none"!==source?fromString(source):[Array,Float64Array,Float32Array].some((function(a){return source instanceof a}))?fromArray(source):[CSSMatrix,DOMMatrix,Object].some((function(a){return source instanceof a}))?fromMatrix(source):this},CSSMatrix.prototype.toFloat32Array=function(is2D){return Float32Array.from(toArray(this,is2D))},CSSMatrix.prototype.toFloat64Array=function(is2D){return Float64Array.from(toArray(this,is2D))},CSSMatrix.prototype.toString=function(){var is2D=this.is2D;return(is2D?"matrix":"matrix3d")+"("+this.toFloat64Array(is2D).join(", ")+")"},CSSMatrix.prototype.toJSON=function(){var m=this,is2D=m.is2D,isIdentity=m.isIdentity;return Object.assign({},m,{is2D:is2D,isIdentity:isIdentity})},CSSMatrix.prototype.multiply=function(m2){return Multiply(this,m2)},CSSMatrix.prototype.translate=function(x,y,z){var Y=y,Z=z;return void 0===Y&&(Y=0),void 0===Z&&(Z=0),Multiply(this,Translate(x,Y,Z))},CSSMatrix.prototype.scale=function(x,y,z){var Y=y,Z=z;return void 0===Y&&(Y=x),void 0===Z&&(Z=1),Multiply(this,Scale(x,Y,Z))},CSSMatrix.prototype.rotate=function(rx,ry,rz){var RX=rx,RY=ry||0,RZ=rz||0;return"number"==typeof rx&&void 0===ry&&void 0===rz&&(RZ=RX,RX=0,RY=0),Multiply(this,Rotate(RX,RY,RZ))},CSSMatrix.prototype.rotateAxisAngle=function(x,y,z,angle){if([x,y,z,angle].some((function(n){return Number.isNaN(+n)})))throw new TypeError("CSSMatrix: expecting 4 values");return Multiply(this,RotateAxisAngle(x,y,z,angle))},CSSMatrix.prototype.skewX=function(angle){return Multiply(this,SkewX(angle))},CSSMatrix.prototype.skewY=function(angle){return Multiply(this,SkewY(angle))},CSSMatrix.prototype.skew=function(angleX,angleY){return Multiply(this,Skew(angleX,angleY))},CSSMatrix.prototype.transformPoint=function(t){var m=this,x=m.m11*t.x+m.m21*t.y+m.m31*t.z+m.m41*t.w,y=m.m12*t.x+m.m22*t.y+m.m32*t.z+m.m42*t.w,z=m.m13*t.x+m.m23*t.y+m.m33*t.z+m.m43*t.w,w=m.m14*t.x+m.m24*t.y+m.m34*t.z+m.m44*t.w;return t instanceof DOMPoint?new DOMPoint(x,y,z,w):{x:x,y:y,z:z,w:w}},Object.defineProperties(CSSMatrix.prototype,prototypeAccessors),Object.assign(CSSMatrix,{Translate:Translate,Rotate:Rotate,RotateAxisAngle:RotateAxisAngle,Scale:Scale,SkewX:SkewX,SkewY:SkewY,Skew:Skew,Multiply:Multiply,fromArray:fromArray,fromMatrix:fromMatrix,fromString:fromString,toArray:toArray}),Object.assign(CSSMatrix,{Version:"1.0.3"}),CSSMatrix},"object"===_typeof(exports)?module.exports=factory():void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.call(exports,__webpack_require__,exports,module):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)},101:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_RESULT__;function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}!function(window,document,exportName,undefined){"use strict";var assign,VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"],TEST_ELEMENT=document.createElement("div"),TYPE_FUNCTION="function",round=Math.round,abs=Math.abs,now=Date.now;function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){return!!Array.isArray(arg)&&(each(arg,context[fn],context),!0)}function each(obj,iterator,context){var i;if(obj)if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined)for(i=0;i<obj.length;)iterator.call(context,obj[i],i,obj),i++;else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace"),stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",log=window.console&&(window.console.warn||window.console.log);return log&&log.call(window.console,deprecationMessage,stack),method.apply(this,arguments)}}assign="function"!=typeof Object.assign?function(target){if(target===undefined||null===target)throw new TypeError("Cannot convert undefined or null to object");for(var output=Object(target),index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&null!==source)for(var nextKey in source)source.hasOwnProperty(nextKey)&&(output[nextKey]=source[nextKey])}return output}:Object.assign;var extend=deprecate((function(dest,src,merge){for(var keys=Object.keys(src),i=0;i<keys.length;)(!merge||merge&&dest[keys[i]]===undefined)&&(dest[keys[i]]=src[keys[i]]),i++;return dest}),"extend","Use `assign`."),merge=deprecate((function(dest,src){return extend(dest,src,!0)}),"merge","Use `assign`.");function inherit(child,base,properties){var childP,baseP=base.prototype;(childP=child.prototype=Object.create(baseP)).constructor=child,childP._super=baseP,properties&&assign(childP,properties)}function bindFn(fn,context){return function(){return fn.apply(context,arguments)}}function boolOrFn(val,args){return _typeof(val)==TYPE_FUNCTION?val.apply(args&&args[0]||undefined,args):val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,types,handler){each(splitStr(types),(function(type){target.addEventListener(type,handler,!1)}))}function removeEventListeners(target,types,handler){each(splitStr(types),(function(type){target.removeEventListener(type,handler,!1)}))}function hasParent(node,parent){for(;node;){if(node==parent)return!0;node=node.parentNode}return!1}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);for(var i=0;i<src.length;){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++}return-1}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){for(var results=[],values=[],i=0;i<src.length;){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val,i++}return sort&&(results=key?results.sort((function(a,b){return a[key]>b[key]})):results.sort()),results}function prefixed(obj,property){for(var prefix,prop,camelProp=property[0].toUpperCase()+property.slice(1),i=0;i<VENDOR_PREFIXES.length;){if((prop=(prefix=VENDOR_PREFIXES[i])?prefix+camelProp:property)in obj)return prop;i++}return undefined}var _uniqueId=1;function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window}var SUPPORT_TOUCH="ontouchstart"in window,SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined,SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),COMPUTE_INTERVAL=25,INPUT_START=1,INPUT_END=4,INPUT_CANCEL=8,DIRECTION_NONE=1,DIRECTION_LEFT=2,DIRECTION_RIGHT=4,DIRECTION_UP=8,DIRECTION_DOWN=16,DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT,DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN,DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,PROPS_XY=["x","y"],PROPS_CLIENT_XY=["clientX","clientY"];function Input(manager,callback){var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev)},this.init()}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length,changedPointersLen=input.changedPointers.length,isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen==0,isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen==0;input.isFirst=!!isFirst,input.isFinal=!!isFinal,isFirst&&(manager.session={}),input.eventType=eventType,function(manager,input){var session=manager.session,pointers=input.pointers,pointersLength=pointers.length;session.firstInput||(session.firstInput=simpleCloneInputData(input));pointersLength>1&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):1===pointersLength&&(session.firstMultiple=!1);var firstInput=session.firstInput,firstMultiple=session.firstMultiple,offsetCenter=firstMultiple?firstMultiple.center:firstInput.center,center=input.center=getCenter(pointers);input.timeStamp=now(),input.deltaTime=input.timeStamp-firstInput.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),function(session,input){var center=input.center,offset=session.offsetDelta||{},prevDelta=session.prevDelta||{},prevInput=session.prevInput||{};input.eventType!==INPUT_START&&prevInput.eventType!==INPUT_END||(prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y});input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y)}(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x,input.overallVelocityY=overallVelocity.y,input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y,input.scale=firstMultiple?(start=firstMultiple.pointers,end=pointers,getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)):1,input.rotation=firstMultiple?function(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}(firstMultiple.pointers,pointers):0,input.maxPointers=session.prevInput?input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers:input.pointers.length,function(session,input){var velocity,velocityX,velocityY,direction,last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=input.deltaX-last.deltaX,deltaY=input.deltaY-last.deltaY,v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaX,deltaY),session.lastInterval=input}else velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction;input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction}(session,input);var start,end;var target=manager.element;hasParent(input.srcEvent.target,target)&&(target=input.srcEvent.target);input.target=target}(manager,input),manager.emit("hammer.input",input),manager.recognize(input),manager.session.prevInput=input}function simpleCloneInputData(input){for(var pointers=[],i=0;i<input.pointers.length;)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)},i++;return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(1===pointersLength)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};for(var x=0,y=0,i=0;i<pointersLength;)x+=pointers[i].clientX,y+=pointers[i].clientY,i++;return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){return x===y?DIRECTION_NONE:abs(x)>=abs(y)?x<0?DIRECTION_LEFT:DIRECTION_RIGHT:y<0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return 180*Math.atan2(y,x)/Math.PI}Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}};var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:2,mouseup:INPUT_END},MOUSE_ELEMENT_EVENTS="mousedown",MOUSE_WINDOW_EVENTS="mousemove mouseup";function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS,this.evWin=MOUSE_WINDOW_EVENTS,this.pressed=!1,Input.apply(this,arguments)}inherit(MouseInput,Input,{handler:function(ev){var eventType=MOUSE_INPUT_MAP[ev.type];eventType&INPUT_START&&0===ev.button&&(this.pressed=!0),2&eventType&&1!==ev.which&&(eventType=INPUT_END),this.pressed&&(eventType&INPUT_END&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:"mouse",srcEvent:ev}))}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:2,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL},IE10_POINTER_TYPE_ENUM={2:"touch",3:"pen",4:"mouse",5:"kinect"},POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS,this.evWin=POINTER_WINDOW_EVENTS,Input.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}window.MSPointerEvent&&!window.PointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"),inherit(PointerEventInput,Input,{handler:function(ev){var store=this.store,removePointer=!1,eventTypeNormalized=ev.type.toLowerCase().replace("ms",""),eventType=POINTER_INPUT_MAP[eventTypeNormalized],pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType,isTouch="touch"==pointerType,storeIndex=inArray(store,ev.pointerId,"pointerId");eventType&INPUT_START&&(0===ev.button||isTouch)?storeIndex<0&&(store.push(ev),storeIndex=store.length-1):eventType&(INPUT_END|INPUT_CANCEL)&&(removePointer=!0),storeIndex<0||(store[storeIndex]=ev,this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1))}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:2,touchend:INPUT_END,touchcancel:INPUT_CANCEL};function SingleTouchInput(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,Input.apply(this,arguments)}function normalizeSingleTouches(ev,type){var all=toArray(ev.touches),changed=toArray(ev.changedTouches);return type&(INPUT_END|INPUT_CANCEL)&&(all=uniqueArray(all.concat(changed),"identifier",!0)),[all,changed]}inherit(SingleTouchInput,Input,{handler:function(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START&&(this.started=!0),this.started){var touches=normalizeSingleTouches.call(this,ev,type);type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length==0&&(this.started=!1),this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:"touch",srcEvent:ev})}}});var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:2,touchend:INPUT_END,touchcancel:INPUT_CANCEL},TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS,this.targetIds={},Input.apply(this,arguments)}function getTouches(ev,type){var allTouches=toArray(ev.touches),targetIds=this.targetIds;if(type&(2|INPUT_START)&&1===allTouches.length)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;if(targetTouches=allTouches.filter((function(touch){return hasParent(touch.target,target)})),type===INPUT_START)for(i=0;i<targetTouches.length;)targetIds[targetTouches[i].identifier]=!0,i++;for(i=0;i<changedTouches.length;)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),type&(INPUT_END|INPUT_CANCEL)&&delete targetIds[changedTouches[i].identifier],i++;return changedTargetTouches.length?[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",!0),changedTargetTouches]:void 0}inherit(TouchInput,Input,{handler:function(ev){var type=TOUCH_INPUT_MAP[ev.type],touches=getTouches.call(this,ev,type);touches&&this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:"touch",srcEvent:ev})}});var DEDUP_TIMEOUT=2500;function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler),this.mouse=new MouseInput(this.manager,handler),this.primaryTouch=null,this.lastTouches=[]}function recordTouches(eventType,eventData){eventType&INPUT_START?(this.primaryTouch=eventData.changedPointers[0].identifier,setLastTouch.call(this,eventData)):eventType&(INPUT_END|INPUT_CANCEL)&&setLastTouch.call(this,eventData)}function setLastTouch(eventData){var touch=eventData.changedPointers[0];if(touch.identifier===this.primaryTouch){var lastTouch={x:touch.clientX,y:touch.clientY};this.lastTouches.push(lastTouch);var lts=this.lastTouches;setTimeout((function(){var i=lts.indexOf(lastTouch);i>-1&&lts.splice(i,1)}),DEDUP_TIMEOUT)}}function isSyntheticEvent(eventData){for(var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i],dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=25&&dy<=25)return!0}return!1}inherit(TouchMouseInput,Input,{handler:function(manager,inputEvent,inputData){var isTouch="touch"==inputData.pointerType,isMouse="mouse"==inputData.pointerType;if(!(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents)){if(isTouch)recordTouches.call(this,inputEvent,inputData);else if(isMouse&&isSyntheticEvent.call(this,inputData))return;this.callback(manager,inputEvent,inputData)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction"),NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined,TOUCH_ACTION_MAP=function(){if(!NATIVE_TOUCH_ACTION)return!1;var touchMap={},cssSupports=window.CSS&&window.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(val){touchMap[val]=!cssSupports||window.CSS.supports("touch-action",val)})),touchMap}();function TouchAction(manager,value){this.manager=manager,this.set(value)}TouchAction.prototype={set:function(value){"compute"==value&&(value=this.compute()),NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];return each(this.manager.recognizers,(function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()))})),function(actions){if(inStr(actions,"none"))return"none";var hasPanX=inStr(actions,"pan-x"),hasPanY=inStr(actions,"pan-y");if(hasPanX&&hasPanY)return"none";if(hasPanX||hasPanY)return hasPanX?"pan-x":"pan-y";if(inStr(actions,"manipulation"))return"manipulation";return"auto"}(actions.join(" "))},preventDefaults:function(input){var srcEvent=input.srcEvent,direction=input.offsetDirection;if(this.manager.session.prevented)srcEvent.preventDefault();else{var actions=this.actions,hasNone=inStr(actions,"none")&&!TOUCH_ACTION_MAP.none,hasPanY=inStr(actions,"pan-y")&&!TOUCH_ACTION_MAP["pan-y"],hasPanX=inStr(actions,"pan-x")&&!TOUCH_ACTION_MAP["pan-x"];if(hasNone){var isTapPointer=1===input.pointers.length,isTapMovement=input.distance<2,isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime)return}if(!hasPanX||!hasPanY)return hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL?this.preventSrc(srcEvent):void 0}},preventSrc:function(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault()}};var STATE_POSSIBLE=1;function Recognizer(options){this.options=assign({},this.defaults,options||{}),this.id=_uniqueId++,this.manager=null,this.options.enable=ifUndefined(this.options.enable,!0),this.state=STATE_POSSIBLE,this.simultaneous={},this.requireFail=[]}function stateStr(state){return 16&state?"cancel":8&state?"end":4&state?"move":2&state?"start":""}function directionStr(direction){return direction==DIRECTION_DOWN?"down":direction==DIRECTION_UP?"up":direction==DIRECTION_LEFT?"left":direction==DIRECTION_RIGHT?"right":""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;return manager?manager.get(otherRecognizer):otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}function PanRecognizer(){AttrRecognizer.apply(this,arguments),this.pX=null,this.pY=null}function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}function PressRecognizer(){Recognizer.apply(this,arguments),this._timer=null,this._input=null}function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}function TapRecognizer(){Recognizer.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Hammer(element,options){return(options=options||{}).recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset),new Manager(element,options)}Recognizer.prototype={defaults:{},set:function(options){return assign(this.options,options),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this))return this;var simultaneous=this.simultaneous;return simultaneous[(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this)).id]||(simultaneous[otherRecognizer.id]=otherRecognizer,otherRecognizer.recognizeWith(this)),this},dropRecognizeWith:function(otherRecognizer){return invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)||(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id]),this},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;return-1===inArray(requireFail,otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this))&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);return index>-1&&this.requireFail.splice(index,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){var self=this,state=this.state;function emit(event){self.manager.emit(event,input)}state<8&&emit(self.options.event+stateStr(state)),emit(self.options.event),input.additionalEvent&&emit(input.additionalEvent),state>=8&&emit(self.options.event+stateStr(state))},tryEmit:function(input){if(this.canEmit())return this.emit(input);this.state=32},canEmit:function(){for(var i=0;i<this.requireFail.length;){if(!(this.requireFail[i].state&(32|STATE_POSSIBLE)))return!1;i++}return!0},recognize:function(inputData){var inputDataClone=assign({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone]))return this.reset(),void(this.state=32);56&this.state&&(this.state=STATE_POSSIBLE),this.state=this.process(inputDataClone),30&this.state&&this.tryEmit(inputDataClone)},process:function(inputData){},getTouchAction:function(){},reset:function(){}},inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return 0===optionPointers||input.pointers.length===optionPointers},process:function(input){var state=this.state,eventType=input.eventType,isRecognized=6&state,isValid=this.attrTest(input);return isRecognized&&(eventType&INPUT_CANCEL||!isValid)?16|state:isRecognized||isValid?eventType&INPUT_END?8|state:2&state?4|state:2:32}}),inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction,actions=[];return direction&DIRECTION_HORIZONTAL&&actions.push("pan-y"),direction&DIRECTION_VERTICAL&&actions.push("pan-x"),actions},directionTest:function(input){var options=this.options,hasMoved=!0,distance=input.distance,direction=input.direction,x=input.deltaX,y=input.deltaY;return direction&options.direction||(options.direction&DIRECTION_HORIZONTAL?(direction=0===x?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT,hasMoved=x!=this.pX,distance=Math.abs(input.deltaX)):(direction=0===y?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN,hasMoved=y!=this.pY,distance=Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(2&this.state||!(2&this.state)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&(input.additionalEvent=this.options.event+direction),this._super.emit.call(this,input)}}),inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||2&this.state)},emit:function(input){if(1!==input.scale){var inOut=input.scale<1?"in":"out";input.additionalEvent=this.options.event+inOut}this._super.emit.call(this,input)}}),inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTime=input.deltaTime>options.time;if(this._input=input,!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START)this.reset(),this._timer=setTimeoutContext((function(){this.state=8,this.tryEmit()}),options.time,this);else if(input.eventType&INPUT_END)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(input){8===this.state&&(input&&input.eventType&INPUT_END?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input)))}}),inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||2&this.state)}}),inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var velocity,direction=this.options.direction;return direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)?velocity=input.overallVelocity:direction&DIRECTION_HORIZONTAL?velocity=input.overallVelocityX:direction&DIRECTION_VERTICAL&&(velocity=input.overallVelocityY),this._super.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.offsetDirection);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input)}}),inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTouchTime=input.deltaTime<options.time;if(this.reset(),input.eventType&INPUT_START&&0===this.count)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END)return this.failTimeout();var validInterval=!this.pTime||input.timeStamp-this.pTime<options.interval,validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;if(this.pTime=input.timeStamp,this.pCenter=input.center,validMultiTap&&validInterval?this.count+=1:this.count=1,this._input=input,0===this.count%options.taps)return this.hasRequireFailures()?(this._timer=setTimeoutContext((function(){this.state=8,this.tryEmit()}),options.interval,this),2):8}return 32},failTimeout:function(){return this._timer=setTimeoutContext((function(){this.state=32}),this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Hammer.VERSION="2.0.7",Hammer.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:!1}],[PinchRecognizer,{enable:!1},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};function Manager(element,options){var manager;this.options=assign({},Hammer.defaults,options||{}),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=element,this.input=new((manager=this).options.inputClass||(SUPPORT_POINTER_EVENTS?PointerEventInput:SUPPORT_ONLY_TOUCH?TouchInput:SUPPORT_TOUCH?TouchMouseInput:MouseInput))(manager,inputHandler),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(this.options.recognizers,(function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[3])}),this)}function toggleCssProps(manager,add){var prop,element=manager.element;element.style&&(each(manager.options.cssProps,(function(value,name){prop=prefixed(element.style,name),add?(manager.oldCssProps[prop]=element.style[prop],element.style[prop]=value):element.style[prop]=manager.oldCssProps[prop]||""})),add||(manager.oldCssProps={}))}Manager.prototype={set:function(options){return assign(this.options,options),options.touchAction&&this.touchAction.update(),options.inputTarget&&(this.input.destroy(),this.input.target=options.inputTarget,this.input.init()),this},stop:function(force){this.session.stopped=force?2:1},recognize:function(inputData){var session=this.session;if(!session.stopped){var recognizer;this.touchAction.preventDefaults(inputData);var recognizers=this.recognizers,curRecognizer=session.curRecognizer;(!curRecognizer||curRecognizer&&8&curRecognizer.state)&&(curRecognizer=session.curRecognizer=null);for(var i=0;i<recognizers.length;)recognizer=recognizers[i],2===session.stopped||curRecognizer&&recognizer!=curRecognizer&&!recognizer.canRecognizeWith(curRecognizer)?recognizer.reset():recognizer.recognize(inputData),!curRecognizer&&14&recognizer.state&&(curRecognizer=session.curRecognizer=recognizer),i++}},get:function(recognizer){if(recognizer instanceof Recognizer)return recognizer;for(var recognizers=this.recognizers,i=0;i<recognizers.length;i++)if(recognizers[i].options.event==recognizer)return recognizers[i];return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),recognizer.manager=this,this.touchAction.update(),recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",this))return this;if(recognizer=this.get(recognizer)){var recognizers=this.recognizers,index=inArray(recognizers,recognizer);-1!==index&&(recognizers.splice(index,1),this.touchAction.update())}return this},on:function(events,handler){if(events!==undefined&&handler!==undefined){var handlers=this.handlers;return each(splitStr(events),(function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler)})),this}},off:function(events,handler){if(events!==undefined){var handlers=this.handlers;return each(splitStr(events),(function(event){handler?handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event]})),this}},emit:function(event,data){this.options.domEvents&&function(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,!0,!0),gestureEvent.gesture=data,data.target.dispatchEvent(gestureEvent)}(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(handlers&&handlers.length){data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault()};for(var i=0;i<handlers.length;)handlers[i](data),i++}},destroy:function(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},assign(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:2,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,assign:assign,inherit:inherit,bindFn:bindFn,prefixed:prefixed}),(void 0!==window?window:"undefined"!=typeof self?self:{}).Hammer=Hammer,(__WEBPACK_AMD_DEFINE_RESULT__=function(){return Hammer}.call(exports,__webpack_require__,exports,module))===undefined||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__)}(window,document)},965:function(){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}!function(){"use strict";if("object"===("undefined"==typeof window?"undefined":_typeof(window)))if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var document=function(startDoc){for(var doc=window.document,frame=getFrameElement(doc);frame;)frame=getFrameElement(doc=frame.ownerDocument);return doc}(),registry=[],crossOriginUpdater=null,crossOriginRect=null;IntersectionObserver.prototype.THROTTLE_TIMEOUT=100,IntersectionObserver.prototype.POLL_INTERVAL=null,IntersectionObserver.prototype.USE_MUTATION_OBSERVER=!0,IntersectionObserver._setupCrossOriginUpdater=function(){return crossOriginUpdater||(crossOriginUpdater=function(boundingClientRect,intersectionRect){crossOriginRect=boundingClientRect&&intersectionRect?convertFromParentRect(boundingClientRect,intersectionRect):{top:0,bottom:0,left:0,right:0,width:0,height:0},registry.forEach((function(observer){observer._checkForIntersections()}))}),crossOriginUpdater},IntersectionObserver._resetCrossOriginUpdater=function(){crossOriginUpdater=null,crossOriginRect=null},IntersectionObserver.prototype.observe=function(target){if(!this._observationTargets.some((function(item){return item.element==target}))){if(!target||1!=target.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:target,entry:null}),this._monitorIntersections(target.ownerDocument),this._checkForIntersections()}},IntersectionObserver.prototype.unobserve=function(target){this._observationTargets=this._observationTargets.filter((function(item){return item.element!=target})),this._unmonitorIntersections(target.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},IntersectionObserver.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},IntersectionObserver.prototype.takeRecords=function(){var records=this._queuedEntries.slice();return this._queuedEntries=[],records},IntersectionObserver.prototype._initThresholds=function(opt_threshold){var threshold=opt_threshold||[0];return Array.isArray(threshold)||(threshold=[threshold]),threshold.sort().filter((function(t,i,a){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==a[i-1]}))},IntersectionObserver.prototype._parseRootMargin=function(opt_rootMargin){var margins=(opt_rootMargin||"0px").split(/\s+/).map((function(margin){var parts=/^(-?\d*\.?\d+)(px|%)$/.exec(margin);if(!parts)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(parts[1]),unit:parts[2]}}));return margins[1]=margins[1]||margins[0],margins[2]=margins[2]||margins[0],margins[3]=margins[3]||margins[1],margins},IntersectionObserver.prototype._monitorIntersections=function(doc){var win=doc.defaultView;if(win&&-1==this._monitoringDocuments.indexOf(doc)){var callback=this._checkForIntersections,monitoringInterval=null,domObserver=null;this.POLL_INTERVAL?monitoringInterval=win.setInterval(callback,this.POLL_INTERVAL):(addEvent(win,"resize",callback,!0),addEvent(doc,"scroll",callback,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in win&&(domObserver=new win.MutationObserver(callback)).observe(doc,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(doc),this._monitoringUnsubscribes.push((function(){var win=doc.defaultView;win&&(monitoringInterval&&win.clearInterval(monitoringInterval),removeEvent(win,"resize",callback,!0)),removeEvent(doc,"scroll",callback,!0),domObserver&&domObserver.disconnect()}));var rootDoc=this.root&&(this.root.ownerDocument||this.root)||document;if(doc!=rootDoc){var frame=getFrameElement(doc);frame&&this._monitorIntersections(frame.ownerDocument)}}},IntersectionObserver.prototype._unmonitorIntersections=function(doc){var index=this._monitoringDocuments.indexOf(doc);if(-1!=index){var rootDoc=this.root&&(this.root.ownerDocument||this.root)||document,hasDependentTargets=this._observationTargets.some((function(item){var itemDoc=item.element.ownerDocument;if(itemDoc==doc)return!0;for(;itemDoc&&itemDoc!=rootDoc;){var frame=getFrameElement(itemDoc);if((itemDoc=frame&&frame.ownerDocument)==doc)return!0}return!1}));if(!hasDependentTargets){var unsubscribe=this._monitoringUnsubscribes[index];if(this._monitoringDocuments.splice(index,1),this._monitoringUnsubscribes.splice(index,1),unsubscribe(),doc!=rootDoc){var frame=getFrameElement(doc);frame&&this._unmonitorIntersections(frame.ownerDocument)}}}},IntersectionObserver.prototype._unmonitorAllIntersections=function(){var unsubscribes=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var i=0;i<unsubscribes.length;i++)unsubscribes[i]()},IntersectionObserver.prototype._checkForIntersections=function(){if(this.root||!crossOriginUpdater||crossOriginRect){var rootIsInDom=this._rootIsInDom(),rootRect=rootIsInDom?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach((function(item){var target=item.element,targetRect=getBoundingClientRect(target),rootContainsTarget=this._rootContainsTarget(target),oldEntry=item.entry,intersectionRect=rootIsInDom&&rootContainsTarget&&this._computeTargetAndRootIntersection(target,targetRect,rootRect),rootBounds=null;this._rootContainsTarget(target)?crossOriginUpdater&&!this.root||(rootBounds=rootRect):rootBounds={top:0,bottom:0,left:0,right:0,width:0,height:0};var newEntry=item.entry=new IntersectionObserverEntry({time:window.performance&&performance.now&&performance.now(),target:target,boundingClientRect:targetRect,rootBounds:rootBounds,intersectionRect:intersectionRect});oldEntry?rootIsInDom&&rootContainsTarget?this._hasCrossedThreshold(oldEntry,newEntry)&&this._queuedEntries.push(newEntry):oldEntry&&oldEntry.isIntersecting&&this._queuedEntries.push(newEntry):this._queuedEntries.push(newEntry)}),this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},IntersectionObserver.prototype._computeTargetAndRootIntersection=function(target,targetRect,rootRect){if("none"!=window.getComputedStyle(target).display){for(var rect1,rect2,top,bottom,left,right,width,height,intersectionRect=targetRect,parent=getParentNode(target),atRoot=!1;!atRoot&&parent;){var parentRect=null,parentComputedStyle=1==parent.nodeType?window.getComputedStyle(parent):{};if("none"==parentComputedStyle.display)return null;if(parent==this.root||9==parent.nodeType)if(atRoot=!0,parent==this.root||parent==document)crossOriginUpdater&&!this.root?!crossOriginRect||0==crossOriginRect.width&&0==crossOriginRect.height?(parent=null,parentRect=null,intersectionRect=null):parentRect=crossOriginRect:parentRect=rootRect;else{var frame=getParentNode(parent),frameRect=frame&&getBoundingClientRect(frame),frameIntersect=frame&&this._computeTargetAndRootIntersection(frame,frameRect,rootRect);frameRect&&frameIntersect?(parent=frame,parentRect=convertFromParentRect(frameRect,frameIntersect)):(parent=null,intersectionRect=null)}else{var doc=parent.ownerDocument;parent!=doc.body&&parent!=doc.documentElement&&"visible"!=parentComputedStyle.overflow&&(parentRect=getBoundingClientRect(parent))}if(parentRect&&(rect1=parentRect,rect2=intersectionRect,top=void 0,bottom=void 0,left=void 0,right=void 0,width=void 0,height=void 0,top=Math.max(rect1.top,rect2.top),bottom=Math.min(rect1.bottom,rect2.bottom),left=Math.max(rect1.left,rect2.left),right=Math.min(rect1.right,rect2.right),height=bottom-top,intersectionRect=(width=right-left)>=0&&height>=0&&{top:top,bottom:bottom,left:left,right:right,width:width,height:height}||null),!intersectionRect)break;parent=parent&&getParentNode(parent)}return intersectionRect}},IntersectionObserver.prototype._getRootRect=function(){var rootRect;if(this.root&&!isDoc(this.root))rootRect=getBoundingClientRect(this.root);else{var doc=isDoc(this.root)?this.root:document,html=doc.documentElement,body=doc.body;rootRect={top:0,left:0,right:html.clientWidth||body.clientWidth,width:html.clientWidth||body.clientWidth,bottom:html.clientHeight||body.clientHeight,height:html.clientHeight||body.clientHeight}}return this._expandRectByRootMargin(rootRect)},IntersectionObserver.prototype._expandRectByRootMargin=function(rect){var margins=this._rootMarginValues.map((function(margin,i){return"px"==margin.unit?margin.value:margin.value*(i%2?rect.width:rect.height)/100})),newRect={top:rect.top-margins[0],right:rect.right+margins[1],bottom:rect.bottom+margins[2],left:rect.left-margins[3]};return newRect.width=newRect.right-newRect.left,newRect.height=newRect.bottom-newRect.top,newRect},IntersectionObserver.prototype._hasCrossedThreshold=function(oldEntry,newEntry){var oldRatio=oldEntry&&oldEntry.isIntersecting?oldEntry.intersectionRatio||0:-1,newRatio=newEntry.isIntersecting?newEntry.intersectionRatio||0:-1;if(oldRatio!==newRatio)for(var i=0;i<this.thresholds.length;i++){var threshold=this.thresholds[i];if(threshold==oldRatio||threshold==newRatio||threshold<oldRatio!=threshold<newRatio)return!0}},IntersectionObserver.prototype._rootIsInDom=function(){return!this.root||containsDeep(document,this.root)},IntersectionObserver.prototype._rootContainsTarget=function(target){var rootDoc=this.root&&(this.root.ownerDocument||this.root)||document;return containsDeep(rootDoc,target)&&(!this.root||rootDoc==target.ownerDocument)},IntersectionObserver.prototype._registerInstance=function(){registry.indexOf(this)<0&&registry.push(this)},IntersectionObserver.prototype._unregisterInstance=function(){var index=registry.indexOf(this);-1!=index&&registry.splice(index,1)},window.IntersectionObserver=IntersectionObserver,window.IntersectionObserverEntry=IntersectionObserverEntry}function getFrameElement(doc){try{return doc.defaultView&&doc.defaultView.frameElement||null}catch(e){return null}}function IntersectionObserverEntry(entry){this.time=entry.time,this.target=entry.target,this.rootBounds=ensureDOMRect(entry.rootBounds),this.boundingClientRect=ensureDOMRect(entry.boundingClientRect),this.intersectionRect=ensureDOMRect(entry.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!entry.intersectionRect;var targetRect=this.boundingClientRect,targetArea=targetRect.width*targetRect.height,intersectionRect=this.intersectionRect,intersectionArea=intersectionRect.width*intersectionRect.height;this.intersectionRatio=targetArea?Number((intersectionArea/targetArea).toFixed(4)):this.isIntersecting?1:0}function IntersectionObserver(callback,opt_options){var fn,timeout,timer,options=opt_options||{};if("function"!=typeof callback)throw new Error("callback must be a function");if(options.root&&1!=options.root.nodeType&&9!=options.root.nodeType)throw new Error("root must be a Document or Element");this._checkForIntersections=(fn=this._checkForIntersections.bind(this),timeout=this.THROTTLE_TIMEOUT,timer=null,function(){timer||(timer=setTimeout((function(){fn(),timer=null}),timeout))}),this._callback=callback,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(options.rootMargin),this.thresholds=this._initThresholds(options.threshold),this.root=options.root||null,this.rootMargin=this._rootMarginValues.map((function(margin){return margin.value+margin.unit})).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function addEvent(node,event,fn,opt_useCapture){"function"==typeof node.addEventListener?node.addEventListener(event,fn,opt_useCapture||!1):"function"==typeof node.attachEvent&&node.attachEvent("on"+event,fn)}function removeEvent(node,event,fn,opt_useCapture){"function"==typeof node.removeEventListener?node.removeEventListener(event,fn,opt_useCapture||!1):"function"==typeof node.detachEvent&&node.detachEvent("on"+event,fn)}function getBoundingClientRect(el){var rect;try{rect=el.getBoundingClientRect()}catch(err){}return rect?(rect.width&&rect.height||(rect={top:rect.top,right:rect.right,bottom:rect.bottom,left:rect.left,width:rect.right-rect.left,height:rect.bottom-rect.top}),rect):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function ensureDOMRect(rect){return!rect||"x"in rect?rect:{top:rect.top,y:rect.top,bottom:rect.bottom,left:rect.left,x:rect.left,right:rect.right,width:rect.width,height:rect.height}}function convertFromParentRect(parentBoundingRect,parentIntersectionRect){var top=parentIntersectionRect.top-parentBoundingRect.top,left=parentIntersectionRect.left-parentBoundingRect.left;return{top:top,left:left,height:parentIntersectionRect.height,width:parentIntersectionRect.width,bottom:top+parentIntersectionRect.height,right:left+parentIntersectionRect.width}}function containsDeep(parent,child){for(var node=child;node;){if(node==parent)return!0;node=getParentNode(node)}return!1}function getParentNode(node){var parent=node.parentNode;return 9==node.nodeType&&node!=document?getFrameElement(node):(parent&&parent.assignedSlot&&(parent=parent.assignedSlot.parentNode),parent&&11==parent.nodeType&&parent.host?parent.host:parent)}function isDoc(node){return node&&9===node.nodeType}}()},914:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(373).Symbol;module.exports=_Symbol},569:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(914),getRawTag=__webpack_require__(316),objectToString=__webpack_require__(619),symToStringTag=_Symbol?_Symbol.toStringTag:void 0;module.exports=function(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}},94:function(module,__unused_webpack_exports,__webpack_require__){var trimmedEndIndex=__webpack_require__(510),reTrimStart=/^\s+/;module.exports=function(string){return string?string.slice(0,trimmedEndIndex(string)+1).replace(reTrimStart,""):string}},978:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var freeGlobal="object"==(void 0===__webpack_require__.g?"undefined":_typeof(__webpack_require__.g))&&__webpack_require__.g&&__webpack_require__.g.Object===Object&&__webpack_require__.g;module.exports=freeGlobal},316:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(914),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;module.exports=function(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result}},619:function(module){var nativeObjectToString=Object.prototype.toString;module.exports=function(value){return nativeObjectToString.call(value)}},373:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var freeGlobal=__webpack_require__(978),freeSelf="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")();module.exports=root},510:function(module){var reWhitespace=/\s/;module.exports=function(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index}},310:function(module,__unused_webpack_exports,__webpack_require__){var isObject=__webpack_require__(576),now=__webpack_require__(472),toNumber=__webpack_require__(183),nativeMax=Math.max,nativeMin=Math.min;module.exports=function(func,wait,options){var lastArgs,lastThis,maxWait,result,timerId,lastCallTime,lastInvokeTime=0,leading=!1,maxing=!1,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");function invokeFunc(time){var args=lastArgs,thisArg=lastThis;return lastArgs=lastThis=void 0,lastInvokeTime=time,result=func.apply(thisArg,args)}function shouldInvoke(time){var timeSinceLastCall=time-lastCallTime;return void 0===lastCallTime||timeSinceLastCall>=wait||timeSinceLastCall<0||maxing&&time-lastInvokeTime>=maxWait}function timerExpired(){var time=now();if(shouldInvoke(time))return trailingEdge(time);timerId=setTimeout(timerExpired,function(time){var timeWaiting=wait-(time-lastCallTime);return maxing?nativeMin(timeWaiting,maxWait-(time-lastInvokeTime)):timeWaiting}(time))}function trailingEdge(time){return timerId=void 0,trailing&&lastArgs?invokeFunc(time):(lastArgs=lastThis=void 0,result)}function debounced(){var time=now(),isInvoking=shouldInvoke(time);if(lastArgs=arguments,lastThis=this,lastCallTime=time,isInvoking){if(void 0===timerId)return function(time){return lastInvokeTime=time,timerId=setTimeout(timerExpired,wait),leading?invokeFunc(time):result}(lastCallTime);if(maxing)return clearTimeout(timerId),timerId=setTimeout(timerExpired,wait),invokeFunc(lastCallTime)}return void 0===timerId&&(timerId=setTimeout(timerExpired,wait)),result}return wait=toNumber(wait)||0,isObject(options)&&(leading=!!options.leading,maxWait=(maxing="maxWait"in options)?nativeMax(toNumber(options.maxWait)||0,wait):maxWait,trailing="trailing"in options?!!options.trailing:trailing),debounced.cancel=function(){void 0!==timerId&&clearTimeout(timerId),lastInvokeTime=0,lastArgs=lastCallTime=lastThis=timerId=void 0},debounced.flush=function(){return void 0===timerId?result:trailingEdge(now())},debounced}},576:function(module){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module.exports=function(value){var type=_typeof(value);return null!=value&&("object"==type||"function"==type)}},385:function(module){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module.exports=function(value){return null!=value&&"object"==_typeof(value)}},430:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var baseGetTag=__webpack_require__(569),isObjectLike=__webpack_require__(385);module.exports=function(value){return"symbol"==_typeof(value)||isObjectLike(value)&&"[object Symbol]"==baseGetTag(value)}},472:function(module,__unused_webpack_exports,__webpack_require__){var root=__webpack_require__(373);module.exports=function(){return root.Date.now()}},876:function(module,__unused_webpack_exports,__webpack_require__){var debounce=__webpack_require__(310),isObject=__webpack_require__(576);module.exports=function(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError("Expected a function");return isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:wait,trailing:trailing})}},183:function(module,__unused_webpack_exports,__webpack_require__){var baseTrim=__webpack_require__(94),isObject=__webpack_require__(576),isSymbol=__webpack_require__(430),reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;module.exports=function(value){if("number"==typeof value)return value;if(isSymbol(value))return NaN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}},784:function(module,exports,__webpack_require__){module=__webpack_require__.nmd(module);var process=__webpack_require__(76),__WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty2(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty2(obj,key,value){return(key=_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(target,property,receiver){var base=_superPropBase(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},_get.apply(this,arguments)}function _superPropBase(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=_getPrototypeOf(object)););return object}function _regeneratorRuntime(){"use strict";_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw new Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function _asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}function _toConsumableArray(arr){return _arrayWithoutHoles(arr)||_iterableToArray(arr)||_unsupportedIterableToArray(arr)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}function _arrayWithoutHoles(arr){if(Array.isArray(arr))return _arrayLikeToArray(arr)}function _slicedToArray(arr,i){return _arrayWithHoles(arr)||_iterableToArrayLimit(arr,i)||_unsupportedIterableToArray(arr,i)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}function _arrayWithHoles(arr){if(Array.isArray(arr))return arr}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _createClass(Constructor,protoProps,staticProps){return protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),Constructor}function _toPropertyKey(t){var i=_toPrimitive(t,"string");return"symbol"==_typeof(i)?i:String(i)}function _toPrimitive(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function _callSuper(_this,derived,args){return derived=_getPrototypeOf(derived),_possibleConstructorReturn(_this,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(derived,args||[],_getPrototypeOf(_this).constructor):derived.apply(_this,args))}function _possibleConstructorReturn(self,call){if(call&&("object"===_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(self)}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _inherits(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}globalThis,factory=function(){return function(){var __webpack_modules__=[,function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.VerbosityLevel=exports.Util=exports.UnknownErrorException=exports.UnexpectedResponseException=exports.UNSUPPORTED_FEATURES=exports.TextRenderingMode=exports.StreamType=exports.RenderingIntentFlag=exports.PermissionFlag=exports.PasswordResponses=exports.PasswordException=exports.PageActionEventType=exports.OPS=exports.MissingPDFException=exports.LINE_FACTOR=exports.LINE_DESCENT_FACTOR=exports.InvalidPDFException=exports.ImageKind=exports.IDENTITY_MATRIX=exports.FormatError=exports.FontType=exports.FeatureTest=exports.FONT_IDENTITY_MATRIX=exports.DocumentActionEventType=exports.CMapCompressionType=exports.BaseException=exports.AnnotationType=exports.AnnotationStateModelType=exports.AnnotationReviewState=exports.AnnotationReplyType=exports.AnnotationMode=exports.AnnotationMarkedState=exports.AnnotationFlag=exports.AnnotationFieldFlag=exports.AnnotationEditorType=exports.AnnotationEditorPrefix=exports.AnnotationEditorParamsType=exports.AnnotationBorderStyleType=exports.AnnotationActionEventType=exports.AbortException=void 0,exports.arrayByteLength=arrayByteLength,exports.arraysToBytes=function(arr){var length=arr.length;if(1===length&&arr[0]instanceof Uint8Array)return arr[0];for(var resultLength=0,i=0;i<length;i++)resultLength+=arrayByteLength(arr[i]);for(var pos=0,data=new Uint8Array(resultLength),_i=0;_i<length;_i++){var item=arr[_i];item instanceof Uint8Array||(item="string"==typeof item?stringToBytes(item):new Uint8Array(item));var itemLength=item.byteLength;data.set(item,pos),pos+=itemLength}return data},exports.assert=function(cond,msg){cond||unreachable(msg)},exports.bytesToString=function(bytes){"object"===_typeof(bytes)&&null!==bytes&&void 0!==bytes.length||unreachable("Invalid argument for bytesToString");var length=bytes.length;if(length<8192)return String.fromCharCode.apply(null,bytes);for(var strBuf=[],i=0;i<length;i+=8192){var chunkEnd=Math.min(i+8192,length),chunk=bytes.subarray(i,chunkEnd);strBuf.push(String.fromCharCode.apply(null,chunk))}return strBuf.join("")},exports.createPromiseCapability=function(){var capability=Object.create(null),isSettled=!1;return Object.defineProperty(capability,"settled",{get:function(){return isSettled}}),capability.promise=new Promise((function(resolve,reject){capability.resolve=function(data){isSettled=!0,resolve(data)},capability.reject=function(reason){isSettled=!0,reject(reason)}})),capability},exports.createValidAbsoluteUrl=function(url){var baseUrl=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!url)return null;try{if(options&&"string"==typeof url){if(options.addDefaultProtocol&&url.startsWith("www.")){var dots=url.match(/\./g);dots&&dots.length>=2&&(url="http://".concat(url))}if(options.tryConvertEncoding)try{url=stringToUTF8String(url)}catch(ex){}}var absoluteUrl=baseUrl?new URL(url,baseUrl):new URL(url);if(function(url){if(!url)return!1;switch(url.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(absoluteUrl))return absoluteUrl}catch(ex){}return null},exports.escapeString=function(str){return str.replace(/([()\\\n\r])/g,(function(match){return"\n"===match?"\\n":"\r"===match?"\\r":"\\".concat(match)}))},exports.getModificationDate=function(){var date=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return[date.getUTCFullYear().toString(),(date.getUTCMonth()+1).toString().padStart(2,"0"),date.getUTCDate().toString().padStart(2,"0"),date.getUTCHours().toString().padStart(2,"0"),date.getUTCMinutes().toString().padStart(2,"0"),date.getUTCSeconds().toString().padStart(2,"0")].join("")},exports.getVerbosityLevel=function(){return verbosity},exports.info=function(msg){verbosity>=VerbosityLevel.INFOS&&console.log("Info: ".concat(msg))},exports.isArrayBuffer=function(v){return"object"===_typeof(v)&&null!==v&&void 0!==v.byteLength},exports.isArrayEqual=function(arr1,arr2){if(arr1.length!==arr2.length)return!1;for(var i=0,ii=arr1.length;i<ii;i++)if(arr1[i]!==arr2[i])return!1;return!0},exports.isAscii=function(str){return/^[\x00-\x7F]*$/.test(str)},exports.objectFromMap=function(map){var _step,obj=Object.create(null),_iterator=_createForOfIteratorHelper(map);try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),key=_step$value[0],value=_step$value[1];obj[key]=value}}catch(err){_iterator.e(err)}finally{_iterator.f()}return obj},exports.objectSize=function(obj){return Object.keys(obj).length},exports.setVerbosityLevel=function(level){Number.isInteger(level)&&(verbosity=level)},exports.shadow=shadow,exports.string32=function(value){return String.fromCharCode(value>>24&255,value>>16&255,value>>8&255,255&value)},exports.stringToBytes=stringToBytes,exports.stringToPDFString=function(str){var encoding;if(str[0]>=""&&(""===str[0]&&""===str[1]?encoding="utf-16be":""===str[0]&&""===str[1]?encoding="utf-16le":""===str[0]&&""===str[1]&&""===str[2]&&(encoding="utf-8"),encoding))try{var decoder=new TextDecoder(encoding,{fatal:!0}),buffer=stringToBytes(str);return decoder.decode(buffer)}catch(ex){warn('stringToPDFString: "'.concat(ex,'".'))}for(var strBuf=[],i=0,ii=str.length;i<ii;i++){var code=PDFStringTranslateTable[str.charCodeAt(i)];strBuf.push(code?String.fromCharCode(code):str.charAt(i))}return strBuf.join("")},exports.stringToUTF16BEString=function(str){for(var buf=[""],i=0,ii=str.length;i<ii;i++){var char=str.charCodeAt(i);buf.push(String.fromCharCode(char>>8&255),String.fromCharCode(255&char))}return buf.join("")},exports.stringToUTF8String=stringToUTF8String,exports.unreachable=unreachable,exports.utf8StringToString=function(str){return unescape(encodeURIComponent(str))},exports.warn=warn,__w_pdfjs_require__(2),exports.IDENTITY_MATRIX=[1,0,0,1,0,0],exports.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],exports.LINE_FACTOR=1.35,exports.LINE_DESCENT_FACTOR=.35,exports.RenderingIntentFlag={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256},exports.AnnotationMode={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},exports.AnnotationEditorPrefix="pdfjs_internal_editor_",exports.AnnotationEditorType={DISABLE:-1,NONE:0,FREETEXT:3,INK:15},exports.AnnotationEditorParamsType={FREETEXT_SIZE:1,FREETEXT_COLOR:2,FREETEXT_OPACITY:3,INK_COLOR:11,INK_THICKNESS:12,INK_OPACITY:13},exports.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},exports.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},exports.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},exports.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},exports.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},exports.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},exports.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},exports.AnnotationReplyType={GROUP:"Group",REPLY:"R"},exports.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},exports.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},exports.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},exports.AnnotationActionEventType={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"},exports.DocumentActionEventType={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"},exports.PageActionEventType={O:"PageOpen",C:"PageClose"},exports.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},exports.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};var VerbosityLevel={ERRORS:0,WARNINGS:1,INFOS:5};exports.VerbosityLevel=VerbosityLevel,exports.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},exports.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},exports.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"},exports.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};var verbosity=VerbosityLevel.WARNINGS;function warn(msg){verbosity>=VerbosityLevel.WARNINGS&&console.log("Warning: ".concat(msg))}function unreachable(msg){throw new Error(msg)}function shadow(obj,prop,value){return Object.defineProperty(obj,prop,{value:value,enumerable:!0,configurable:!0,writable:!1}),value}var BaseException=function(){function BaseException(message,name){this.constructor===BaseException&&unreachable("Cannot initialize BaseException."),this.message=message,this.name=name}return BaseException.prototype=new Error,BaseException.constructor=BaseException,BaseException}();exports.BaseException=BaseException;var PasswordException=function(_BaseException){function PasswordException(msg,code){var _this;return _classCallCheck(this,PasswordException),(_this=_callSuper(this,PasswordException,[msg,"PasswordException"])).code=code,_this}return _inherits(PasswordException,_BaseException),_createClass(PasswordException)}(BaseException);exports.PasswordException=PasswordException;var UnknownErrorException=function(_BaseException2){function UnknownErrorException(msg,details){var _this2;return _classCallCheck(this,UnknownErrorException),(_this2=_callSuper(this,UnknownErrorException,[msg,"UnknownErrorException"])).details=details,_this2}return _inherits(UnknownErrorException,_BaseException2),_createClass(UnknownErrorException)}(BaseException);exports.UnknownErrorException=UnknownErrorException;var InvalidPDFException=function(_BaseException3){function InvalidPDFException(msg){return _classCallCheck(this,InvalidPDFException),_callSuper(this,InvalidPDFException,[msg,"InvalidPDFException"])}return _inherits(InvalidPDFException,_BaseException3),_createClass(InvalidPDFException)}(BaseException);exports.InvalidPDFException=InvalidPDFException;var MissingPDFException=function(_BaseException4){function MissingPDFException(msg){return _classCallCheck(this,MissingPDFException),_callSuper(this,MissingPDFException,[msg,"MissingPDFException"])}return _inherits(MissingPDFException,_BaseException4),_createClass(MissingPDFException)}(BaseException);exports.MissingPDFException=MissingPDFException;var UnexpectedResponseException=function(_BaseException5){function UnexpectedResponseException(msg,status){var _this3;return _classCallCheck(this,UnexpectedResponseException),(_this3=_callSuper(this,UnexpectedResponseException,[msg,"UnexpectedResponseException"])).status=status,_this3}return _inherits(UnexpectedResponseException,_BaseException5),_createClass(UnexpectedResponseException)}(BaseException);exports.UnexpectedResponseException=UnexpectedResponseException;var FormatError=function(_BaseException6){function FormatError(msg){return _classCallCheck(this,FormatError),_callSuper(this,FormatError,[msg,"FormatError"])}return _inherits(FormatError,_BaseException6),_createClass(FormatError)}(BaseException);exports.FormatError=FormatError;var AbortException=function(_BaseException7){function AbortException(msg){return _classCallCheck(this,AbortException),_callSuper(this,AbortException,[msg,"AbortException"])}return _inherits(AbortException,_BaseException7),_createClass(AbortException)}(BaseException);function stringToBytes(str){"string"!=typeof str&&unreachable("Invalid argument for stringToBytes");for(var length=str.length,bytes=new Uint8Array(length),i=0;i<length;++i)bytes[i]=255&str.charCodeAt(i);return bytes}function arrayByteLength(arr){return void 0!==arr.length?arr.length:void 0!==arr.byteLength?arr.byteLength:void unreachable("Invalid argument for arrayByteLength")}exports.AbortException=AbortException;var FeatureTest=function(){function FeatureTest(){_classCallCheck(this,FeatureTest)}return _createClass(FeatureTest,null,[{key:"isLittleEndian",get:function(){return shadow(this,"isLittleEndian",((buffer8=new Uint8Array(4))[0]=1,1===new Uint32Array(buffer8.buffer,0,1)[0]));var buffer8}},{key:"isEvalSupported",get:function(){return shadow(this,"isEvalSupported",function(){try{return new Function(""),!0}catch(e){return!1}}())}},{key:"isOffscreenCanvasSupported",get:function(){return shadow(this,"isOffscreenCanvasSupported","undefined"!=typeof OffscreenCanvas)}}]),FeatureTest}();exports.FeatureTest=FeatureTest;var hexNumbers=_toConsumableArray(Array(256).keys()).map((function(n){return n.toString(16).padStart(2,"0")})),Util=function(){function Util(){_classCallCheck(this,Util)}return _createClass(Util,null,[{key:"makeHexColor",value:function(r,g,b){return"#".concat(hexNumbers[r]).concat(hexNumbers[g]).concat(hexNumbers[b])}},{key:"scaleMinMax",value:function(transform,minMax){var temp;transform[0]?(transform[0]<0&&(temp=minMax[0],minMax[0]=minMax[1],minMax[1]=temp),minMax[0]*=transform[0],minMax[1]*=transform[0],transform[3]<0&&(temp=minMax[2],minMax[2]=minMax[3],minMax[3]=temp),minMax[2]*=transform[3],minMax[3]*=transform[3]):(temp=minMax[0],minMax[0]=minMax[2],minMax[2]=temp,temp=minMax[1],minMax[1]=minMax[3],minMax[3]=temp,transform[1]<0&&(temp=minMax[2],minMax[2]=minMax[3],minMax[3]=temp),minMax[2]*=transform[1],minMax[3]*=transform[1],transform[2]<0&&(temp=minMax[0],minMax[0]=minMax[1],minMax[1]=temp),minMax[0]*=transform[2],minMax[1]*=transform[2]),minMax[0]+=transform[4],minMax[1]+=transform[4],minMax[2]+=transform[5],minMax[3]+=transform[5]}},{key:"transform",value:function(m1,m2){return[m1[0]*m2[0]+m1[2]*m2[1],m1[1]*m2[0]+m1[3]*m2[1],m1[0]*m2[2]+m1[2]*m2[3],m1[1]*m2[2]+m1[3]*m2[3],m1[0]*m2[4]+m1[2]*m2[5]+m1[4],m1[1]*m2[4]+m1[3]*m2[5]+m1[5]]}},{key:"applyTransform",value:function(p,m){return[p[0]*m[0]+p[1]*m[2]+m[4],p[0]*m[1]+p[1]*m[3]+m[5]]}},{key:"applyInverseTransform",value:function(p,m){var d=m[0]*m[3]-m[1]*m[2];return[(p[0]*m[3]-p[1]*m[2]+m[2]*m[5]-m[4]*m[3])/d,(-p[0]*m[1]+p[1]*m[0]+m[4]*m[1]-m[5]*m[0])/d]}},{key:"getAxialAlignedBoundingBox",value:function(r,m){var p1=Util.applyTransform(r,m),p2=Util.applyTransform(r.slice(2,4),m),p3=Util.applyTransform([r[0],r[3]],m),p4=Util.applyTransform([r[2],r[1]],m);return[Math.min(p1[0],p2[0],p3[0],p4[0]),Math.min(p1[1],p2[1],p3[1],p4[1]),Math.max(p1[0],p2[0],p3[0],p4[0]),Math.max(p1[1],p2[1],p3[1],p4[1])]}},{key:"inverseTransform",value:function(m){var d=m[0]*m[3]-m[1]*m[2];return[m[3]/d,-m[1]/d,-m[2]/d,m[0]/d,(m[2]*m[5]-m[4]*m[3])/d,(m[4]*m[1]-m[5]*m[0])/d]}},{key:"apply3dTransform",value:function(m,v){return[m[0]*v[0]+m[1]*v[1]+m[2]*v[2],m[3]*v[0]+m[4]*v[1]+m[5]*v[2],m[6]*v[0]+m[7]*v[1]+m[8]*v[2]]}},{key:"singularValueDecompose2dScale",value:function(m){var transpose=[m[0],m[2],m[1],m[3]],a=m[0]*transpose[0]+m[1]*transpose[2],b=m[0]*transpose[1]+m[1]*transpose[3],c=m[2]*transpose[0]+m[3]*transpose[2],d=m[2]*transpose[1]+m[3]*transpose[3],first=(a+d)/2,second=Math.sqrt(Math.pow(a+d,2)-4*(a*d-c*b))/2,sx=first+second||1,sy=first-second||1;return[Math.sqrt(sx),Math.sqrt(sy)]}},{key:"normalizeRect",value:function(rect){var r=rect.slice(0);return rect[0]>rect[2]&&(r[0]=rect[2],r[2]=rect[0]),rect[1]>rect[3]&&(r[1]=rect[3],r[3]=rect[1]),r}},{key:"intersect",value:function(rect1,rect2){var xLow=Math.max(Math.min(rect1[0],rect1[2]),Math.min(rect2[0],rect2[2])),xHigh=Math.min(Math.max(rect1[0],rect1[2]),Math.max(rect2[0],rect2[2]));if(xLow>xHigh)return null;var yLow=Math.max(Math.min(rect1[1],rect1[3]),Math.min(rect2[1],rect2[3])),yHigh=Math.min(Math.max(rect1[1],rect1[3]),Math.max(rect2[1],rect2[3]));return yLow>yHigh?null:[xLow,yLow,xHigh,yHigh]}},{key:"bezierBoundingBox",value:function(x0,y0,x1,y1,x2,y2,x3,y3){for(var a,b,c,t,t1,t2,b2ac,sqrtb2ac,tvalues=[],bounds=[[],[]],i=0;i<2;++i)if(0===i?(b=6*x0-12*x1+6*x2,a=-3*x0+9*x1-9*x2+3*x3,c=3*x1-3*x0):(b=6*y0-12*y1+6*y2,a=-3*y0+9*y1-9*y2+3*y3,c=3*y1-3*y0),Math.abs(a)<1e-12){if(Math.abs(b)<1e-12)continue;0<(t=-c/b)&&t<1&&tvalues.push(t)}else b2ac=b*b-4*c*a,sqrtb2ac=Math.sqrt(b2ac),b2ac<0||(0<(t1=(-b+sqrtb2ac)/(2*a))&&t1<1&&tvalues.push(t1),0<(t2=(-b-sqrtb2ac)/(2*a))&&t2<1&&tvalues.push(t2));for(var mt,j=tvalues.length,jlen=j;j--;)mt=1-(t=tvalues[j]),bounds[0][j]=mt*mt*mt*x0+3*mt*mt*t*x1+3*mt*t*t*x2+t*t*t*x3,bounds[1][j]=mt*mt*mt*y0+3*mt*mt*t*y1+3*mt*t*t*y2+t*t*t*y3;return bounds[0][jlen]=x0,bounds[1][jlen]=y0,bounds[0][jlen+1]=x3,bounds[1][jlen+1]=y3,bounds[0].length=bounds[1].length=jlen+2,[Math.min.apply(Math,_toConsumableArray(bounds[0])),Math.min.apply(Math,_toConsumableArray(bounds[1])),Math.max.apply(Math,_toConsumableArray(bounds[0])),Math.max.apply(Math,_toConsumableArray(bounds[1]))]}}]),Util}();exports.Util=Util;var PDFStringTranslateTable=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function stringToUTF8String(str){return decodeURIComponent(escape(str))}},function(__unused_webpack_module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var _is_node=__w_pdfjs_require__(3);globalThis._pdfjsCompatibilityChecked||(globalThis._pdfjsCompatibilityChecked=!0,!globalThis.btoa&&_is_node.isNodeJS&&(globalThis.btoa=function(chars){return Buffer.from(chars,"binary").toString("base64")}),!globalThis.atob&&_is_node.isNodeJS&&(globalThis.atob=function(input){return Buffer.from(input,"base64").toString("binary")}),!globalThis.DOMMatrix&&_is_node.isNodeJS&&(globalThis.DOMMatrix=__webpack_require__(423)),!globalThis.ReadableStream&&_is_node.isNodeJS&&(globalThis.ReadableStream=__webpack_require__(339).ReadableStream),Array.prototype.at||__w_pdfjs_require__(4),Uint8Array.prototype.at||__w_pdfjs_require__(76),globalThis.structuredClone||__w_pdfjs_require__(86))},function(__unused_webpack_module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isNodeJS=void 0;var isNodeJS=!("object"!==(void 0===process?"undefined":_typeof(process))||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);exports.isNodeJS=isNodeJS},function(module,__unused_webpack_exports,__w_pdfjs_require__){__w_pdfjs_require__(5);var entryUnbind=__w_pdfjs_require__(75);module.exports=entryUnbind("Array","at")},function(__unused_webpack_module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var $=__w_pdfjs_require__(6),toObject=__w_pdfjs_require__(41),lengthOfArrayLike=__w_pdfjs_require__(65),toIntegerOrInfinity=__w_pdfjs_require__(63),addToUnscopables=__w_pdfjs_require__(70);$({target:"Array",proto:!0},{at:function(index){var O=toObject(this),len=lengthOfArrayLike(O),relativeIndex=toIntegerOrInfinity(index),k=relativeIndex>=0?relativeIndex:len+relativeIndex;return k<0||k>=len?void 0:O[k]}}),addToUnscopables("at")},function(module,__unused_webpack_exports,__w_pdfjs_require__){var global=__w_pdfjs_require__(7),getOwnPropertyDescriptor=__w_pdfjs_require__(8).f,createNonEnumerableProperty=__w_pdfjs_require__(45),defineBuiltIn=__w_pdfjs_require__(49),defineGlobalProperty=__w_pdfjs_require__(39),copyConstructorProperties=__w_pdfjs_require__(57),isForced=__w_pdfjs_require__(69);module.exports=function(options,source){var target,key,targetProperty,sourceProperty,descriptor,TARGET=options.target,GLOBAL=options.global,STATIC=options.stat;if(target=GLOBAL?global:STATIC?global[TARGET]||defineGlobalProperty(TARGET,{}):(global[TARGET]||{}).prototype)for(key in source){if(sourceProperty=source[key],targetProperty=options.dontCallGetSet?(descriptor=getOwnPropertyDescriptor(target,key))&&descriptor.value:target[key],!isForced(GLOBAL?key:TARGET+(STATIC?".":"#")+key,options.forced)&&void 0!==targetProperty){if(_typeof(sourceProperty)==_typeof(targetProperty))continue;copyConstructorProperties(sourceProperty,targetProperty)}(options.sham||targetProperty&&targetProperty.sham)&&createNonEnumerableProperty(sourceProperty,"sham",!0),defineBuiltIn(target,key,sourceProperty,options)}}},function(module){var check=function(it){return it&&it.Math==Math&&it};module.exports=check("object"==("undefined"==typeof globalThis?"undefined":_typeof(globalThis))&&globalThis)||check("object"==("undefined"==typeof window?"undefined":_typeof(window))&&window)||check("object"==("undefined"==typeof self?"undefined":_typeof(self))&&self)||check("object"==(void 0===__webpack_require__.g?"undefined":_typeof(__webpack_require__.g))&&__webpack_require__.g)||function(){return this}()||Function("return this")()},function(__unused_webpack_module,exports,__w_pdfjs_require__){var DESCRIPTORS=__w_pdfjs_require__(9),call=__w_pdfjs_require__(11),propertyIsEnumerableModule=__w_pdfjs_require__(13),createPropertyDescriptor=__w_pdfjs_require__(14),toIndexedObject=__w_pdfjs_require__(15),toPropertyKey=__w_pdfjs_require__(20),hasOwn=__w_pdfjs_require__(40),IE8_DOM_DEFINE=__w_pdfjs_require__(43),$getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;exports.f=DESCRIPTORS?$getOwnPropertyDescriptor:function(O,P){if(O=toIndexedObject(O),P=toPropertyKey(P),IE8_DOM_DEFINE)try{return $getOwnPropertyDescriptor(O,P)}catch(error){}if(hasOwn(O,P))return createPropertyDescriptor(!call(propertyIsEnumerableModule.f,O,P),O[P])}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var fails=__w_pdfjs_require__(10);module.exports=!fails((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(module){module.exports=function(exec){try{return!!exec()}catch(error){return!0}}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var NATIVE_BIND=__w_pdfjs_require__(12),call=Function.prototype.call;module.exports=NATIVE_BIND?call.bind(call):function(){return call.apply(call,arguments)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var fails=__w_pdfjs_require__(10);module.exports=!fails((function(){var test=function(){}.bind();return"function"!=typeof test||test.hasOwnProperty("prototype")}))},function(__unused_webpack_module,exports){"use strict";var $propertyIsEnumerable={}.propertyIsEnumerable,getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor,NASHORN_BUG=getOwnPropertyDescriptor&&!$propertyIsEnumerable.call({1:2},1);exports.f=NASHORN_BUG?function(V){var descriptor=getOwnPropertyDescriptor(this,V);return!!descriptor&&descriptor.enumerable}:$propertyIsEnumerable},function(module){module.exports=function(bitmap,value){return{enumerable:!(1&bitmap),configurable:!(2&bitmap),writable:!(4&bitmap),value:value}}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var IndexedObject=__w_pdfjs_require__(16),requireObjectCoercible=__w_pdfjs_require__(19);module.exports=function(it){return IndexedObject(requireObjectCoercible(it))}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var uncurryThis=__w_pdfjs_require__(17),fails=__w_pdfjs_require__(10),classof=__w_pdfjs_require__(18),$Object=Object,split=uncurryThis("".split);module.exports=fails((function(){return!$Object("z").propertyIsEnumerable(0)}))?function(it){return"String"==classof(it)?split(it,""):$Object(it)}:$Object},function(module,__unused_webpack_exports,__w_pdfjs_require__){var NATIVE_BIND=__w_pdfjs_require__(12),FunctionPrototype=Function.prototype,bind=FunctionPrototype.bind,call=FunctionPrototype.call,uncurryThis=NATIVE_BIND&&bind.bind(call,call);module.exports=NATIVE_BIND?function(fn){return fn&&uncurryThis(fn)}:function(fn){return fn&&function(){return call.apply(fn,arguments)}}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var uncurryThis=__w_pdfjs_require__(17),toString=uncurryThis({}.toString),stringSlice=uncurryThis("".slice);module.exports=function(it){return stringSlice(toString(it),8,-1)}},function(module){var $TypeError=TypeError;module.exports=function(it){if(null==it)throw $TypeError("Can't call method on "+it);return it}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var toPrimitive=__w_pdfjs_require__(21),isSymbol=__w_pdfjs_require__(24);module.exports=function(argument){var key=toPrimitive(argument,"string");return isSymbol(key)?key:key+""}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var call=__w_pdfjs_require__(11),isObject=__w_pdfjs_require__(22),isSymbol=__w_pdfjs_require__(24),getMethod=__w_pdfjs_require__(31),ordinaryToPrimitive=__w_pdfjs_require__(34),wellKnownSymbol=__w_pdfjs_require__(35),$TypeError=TypeError,TO_PRIMITIVE=wellKnownSymbol("toPrimitive");module.exports=function(input,pref){if(!isObject(input)||isSymbol(input))return input;var result,exoticToPrim=getMethod(input,TO_PRIMITIVE);if(exoticToPrim){if(void 0===pref&&(pref="default"),result=call(exoticToPrim,input,pref),!isObject(result)||isSymbol(result))return result;throw $TypeError("Can't convert object to primitive value")}return void 0===pref&&(pref="number"),ordinaryToPrimitive(input,pref)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var isCallable=__w_pdfjs_require__(23);module.exports=function(it){return"object"==_typeof(it)?null!==it:isCallable(it)}},function(module){module.exports=function(argument){return"function"==typeof argument}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var getBuiltIn=__w_pdfjs_require__(25),isCallable=__w_pdfjs_require__(23),isPrototypeOf=__w_pdfjs_require__(26),USE_SYMBOL_AS_UID=__w_pdfjs_require__(27),$Object=Object;module.exports=USE_SYMBOL_AS_UID?function(it){return"symbol"==_typeof(it)}:function(it){var $Symbol=getBuiltIn("Symbol");return isCallable($Symbol)&&isPrototypeOf($Symbol.prototype,$Object(it))}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var global=__w_pdfjs_require__(7),isCallable=__w_pdfjs_require__(23);module.exports=function(namespace,method){return arguments.length<2?(argument=global[namespace],isCallable(argument)?argument:void 0):global[namespace]&&global[namespace][method];var argument}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var uncurryThis=__w_pdfjs_require__(17);module.exports=uncurryThis({}.isPrototypeOf)},function(module,__unused_webpack_exports,__w_pdfjs_require__){var NATIVE_SYMBOL=__w_pdfjs_require__(28);module.exports=NATIVE_SYMBOL&&!Symbol.sham&&"symbol"==_typeof(Symbol.iterator)},function(module,__unused_webpack_exports,__w_pdfjs_require__){var V8_VERSION=__w_pdfjs_require__(29),fails=__w_pdfjs_require__(10);module.exports=!!Object.getOwnPropertySymbols&&!fails((function(){var symbol=Symbol();return!String(symbol)||!(Object(symbol)instanceof Symbol)||!Symbol.sham&&V8_VERSION&&V8_VERSION<41}))},function(module,__unused_webpack_exports,__w_pdfjs_require__){var match,version,global=__w_pdfjs_require__(7),userAgent=__w_pdfjs_require__(30),process=global.process,Deno=global.Deno,versions=process&&process.versions||Deno&&Deno.version,v8=versions&&versions.v8;v8&&(version=(match=v8.split("."))[0]>0&&match[0]<4?1:+(match[0]+match[1])),!version&&userAgent&&(!(match=userAgent.match(/Edge\/(\d+)/))||match[1]>=74)&&(match=userAgent.match(/Chrome\/(\d+)/))&&(version=+match[1]),module.exports=version},function(module,__unused_webpack_exports,__w_pdfjs_require__){var getBuiltIn=__w_pdfjs_require__(25);module.exports=getBuiltIn("navigator","userAgent")||""},function(module,__unused_webpack_exports,__w_pdfjs_require__){var aCallable=__w_pdfjs_require__(32);module.exports=function(V,P){var func=V[P];return null==func?void 0:aCallable(func)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var isCallable=__w_pdfjs_require__(23),tryToString=__w_pdfjs_require__(33),$TypeError=TypeError;module.exports=function(argument){if(isCallable(argument))return argument;throw $TypeError(tryToString(argument)+" is not a function")}},function(module){var $String=String;module.exports=function(argument){try{return $String(argument)}catch(error){return"Object"}}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var call=__w_pdfjs_require__(11),isCallable=__w_pdfjs_require__(23),isObject=__w_pdfjs_require__(22),$TypeError=TypeError;module.exports=function(input,pref){var fn,val;if("string"===pref&&isCallable(fn=input.toString)&&!isObject(val=call(fn,input)))return val;if(isCallable(fn=input.valueOf)&&!isObject(val=call(fn,input)))return val;if("string"!==pref&&isCallable(fn=input.toString)&&!isObject(val=call(fn,input)))return val;throw $TypeError("Can't convert object to primitive value")}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var global=__w_pdfjs_require__(7),shared=__w_pdfjs_require__(36),hasOwn=__w_pdfjs_require__(40),uid=__w_pdfjs_require__(42),NATIVE_SYMBOL=__w_pdfjs_require__(28),USE_SYMBOL_AS_UID=__w_pdfjs_require__(27),WellKnownSymbolsStore=shared("wks"),_Symbol=global.Symbol,symbolFor=_Symbol&&_Symbol.for,createWellKnownSymbol=USE_SYMBOL_AS_UID?_Symbol:_Symbol&&_Symbol.withoutSetter||uid;module.exports=function(name){if(!hasOwn(WellKnownSymbolsStore,name)||!NATIVE_SYMBOL&&"string"!=typeof WellKnownSymbolsStore[name]){var description="Symbol."+name;NATIVE_SYMBOL&&hasOwn(_Symbol,name)?WellKnownSymbolsStore[name]=_Symbol[name]:WellKnownSymbolsStore[name]=USE_SYMBOL_AS_UID&&symbolFor?symbolFor(description):createWellKnownSymbol(description)}return WellKnownSymbolsStore[name]}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var IS_PURE=__w_pdfjs_require__(37),store=__w_pdfjs_require__(38);(module.exports=function(key,value){return store[key]||(store[key]=void 0!==value?value:{})})("versions",[]).push({version:"3.24.1",mode:IS_PURE?"pure":"global",copyright:" 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.1/LICENSE",source:"https://github.com/zloirock/core-js"})},function(module){module.exports=!1},function(module,__unused_webpack_exports,__w_pdfjs_require__){var global=__w_pdfjs_require__(7),defineGlobalProperty=__w_pdfjs_require__(39),store=global["__core-js_shared__"]||defineGlobalProperty("__core-js_shared__",{});module.exports=store},function(module,__unused_webpack_exports,__w_pdfjs_require__){var global=__w_pdfjs_require__(7),defineProperty=Object.defineProperty;module.exports=function(key,value){try{defineProperty(global,key,{value:value,configurable:!0,writable:!0})}catch(error){global[key]=value}return value}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var uncurryThis=__w_pdfjs_require__(17),toObject=__w_pdfjs_require__(41),hasOwnProperty=uncurryThis({}.hasOwnProperty);module.exports=Object.hasOwn||function(it,key){return hasOwnProperty(toObject(it),key)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var requireObjectCoercible=__w_pdfjs_require__(19),$Object=Object;module.exports=function(argument){return $Object(requireObjectCoercible(argument))}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var uncurryThis=__w_pdfjs_require__(17),id=0,postfix=Math.random(),toString=uncurryThis(1..toString);module.exports=function(key){return"Symbol("+(void 0===key?"":key)+")_"+toString(++id+postfix,36)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var DESCRIPTORS=__w_pdfjs_require__(9),fails=__w_pdfjs_require__(10),createElement=__w_pdfjs_require__(44);module.exports=!DESCRIPTORS&&!fails((function(){return 7!=Object.defineProperty(createElement("div"),"a",{get:function(){return 7}}).a}))},function(module,__unused_webpack_exports,__w_pdfjs_require__){var global=__w_pdfjs_require__(7),isObject=__w_pdfjs_require__(22),document=global.document,EXISTS=isObject(document)&&isObject(document.createElement);module.exports=function(it){return EXISTS?document.createElement(it):{}}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var DESCRIPTORS=__w_pdfjs_require__(9),definePropertyModule=__w_pdfjs_require__(46),createPropertyDescriptor=__w_pdfjs_require__(14);module.exports=DESCRIPTORS?function(object,key,value){return definePropertyModule.f(object,key,createPropertyDescriptor(1,value))}:function(object,key,value){return object[key]=value,object}},function(__unused_webpack_module,exports,__w_pdfjs_require__){var DESCRIPTORS=__w_pdfjs_require__(9),IE8_DOM_DEFINE=__w_pdfjs_require__(43),V8_PROTOTYPE_DEFINE_BUG=__w_pdfjs_require__(47),anObject=__w_pdfjs_require__(48),toPropertyKey=__w_pdfjs_require__(20),$TypeError=TypeError,$defineProperty=Object.defineProperty,$getOwnPropertyDescriptor=Object.getOwnPropertyDescriptor;exports.f=DESCRIPTORS?V8_PROTOTYPE_DEFINE_BUG?function(O,P,Attributes){if(anObject(O),P=toPropertyKey(P),anObject(Attributes),"function"==typeof O&&"prototype"===P&&"value"in Attributes&&"writable"in Attributes&&!Attributes.writable){var current=$getOwnPropertyDescriptor(O,P);current&&current.writable&&(O[P]=Attributes.value,Attributes={configurable:"configurable"in Attributes?Attributes.configurable:current.configurable,enumerable:"enumerable"in Attributes?Attributes.enumerable:current.enumerable,writable:!1})}return $defineProperty(O,P,Attributes)}:$defineProperty:function(O,P,Attributes){if(anObject(O),P=toPropertyKey(P),anObject(Attributes),IE8_DOM_DEFINE)try{return $defineProperty(O,P,Attributes)}catch(error){}if("get"in Attributes||"set"in Attributes)throw $TypeError("Accessors not supported");return"value"in Attributes&&(O[P]=Attributes.value),O}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var DESCRIPTORS=__w_pdfjs_require__(9),fails=__w_pdfjs_require__(10);module.exports=DESCRIPTORS&&fails((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype}))},function(module,__unused_webpack_exports,__w_pdfjs_require__){var isObject=__w_pdfjs_require__(22),$String=String,$TypeError=TypeError;module.exports=function(argument){if(isObject(argument))return argument;throw $TypeError($String(argument)+" is not an object")}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var isCallable=__w_pdfjs_require__(23),definePropertyModule=__w_pdfjs_require__(46),makeBuiltIn=__w_pdfjs_require__(50),defineGlobalProperty=__w_pdfjs_require__(39);module.exports=function(O,key,value,options){options||(options={});var simple=options.enumerable,name=void 0!==options.name?options.name:key;if(isCallable(value)&&makeBuiltIn(value,name,options),options.global)simple?O[key]=value:defineGlobalProperty(key,value);else{try{options.unsafe?O[key]&&(simple=!0):delete O[key]}catch(error){}simple?O[key]=value:definePropertyModule.f(O,key,{value:value,enumerable:!1,configurable:!options.nonConfigurable,writable:!options.nonWritable})}return O}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var fails=__w_pdfjs_require__(10),isCallable=__w_pdfjs_require__(23),hasOwn=__w_pdfjs_require__(40),DESCRIPTORS=__w_pdfjs_require__(9),CONFIGURABLE_FUNCTION_NAME=__w_pdfjs_require__(51).CONFIGURABLE,inspectSource=__w_pdfjs_require__(52),InternalStateModule=__w_pdfjs_require__(53),enforceInternalState=InternalStateModule.enforce,getInternalState=InternalStateModule.get,defineProperty=Object.defineProperty,CONFIGURABLE_LENGTH=DESCRIPTORS&&!fails((function(){return 8!==defineProperty((function(){}),"length",{value:8}).length})),TEMPLATE=String(String).split("String"),makeBuiltIn=module.exports=function(value,name,options){"Symbol("===String(name).slice(0,7)&&(name="["+String(name).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),options&&options.getter&&(name="get "+name),options&&options.setter&&(name="set "+name),(!hasOwn(value,"name")||CONFIGURABLE_FUNCTION_NAME&&value.name!==name)&&(DESCRIPTORS?defineProperty(value,"name",{value:name,configurable:!0}):value.name=name),CONFIGURABLE_LENGTH&&options&&hasOwn(options,"arity")&&value.length!==options.arity&&defineProperty(value,"length",{value:options.arity});try{options&&hasOwn(options,"constructor")&&options.constructor?DESCRIPTORS&&defineProperty(value,"prototype",{writable:!1}):value.prototype&&(value.prototype=void 0)}catch(error){}var state=enforceInternalState(value);return hasOwn(state,"source")||(state.source=TEMPLATE.join("string"==typeof name?name:"")),value};Function.prototype.toString=makeBuiltIn((function(){return isCallable(this)&&getInternalState(this).source||inspectSource(this)}),"toString")},function(module,__unused_webpack_exports,__w_pdfjs_require__){var DESCRIPTORS=__w_pdfjs_require__(9),hasOwn=__w_pdfjs_require__(40),FunctionPrototype=Function.prototype,getDescriptor=DESCRIPTORS&&Object.getOwnPropertyDescriptor,EXISTS=hasOwn(FunctionPrototype,"name"),PROPER=EXISTS&&"something"===function(){}.name,CONFIGURABLE=EXISTS&&(!DESCRIPTORS||DESCRIPTORS&&getDescriptor(FunctionPrototype,"name").configurable);module.exports={EXISTS:EXISTS,PROPER:PROPER,CONFIGURABLE:CONFIGURABLE}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var uncurryThis=__w_pdfjs_require__(17),isCallable=__w_pdfjs_require__(23),store=__w_pdfjs_require__(38),functionToString=uncurryThis(Function.toString);isCallable(store.inspectSource)||(store.inspectSource=function(it){return functionToString(it)}),module.exports=store.inspectSource},function(module,__unused_webpack_exports,__w_pdfjs_require__){var set,get,has,NATIVE_WEAK_MAP=__w_pdfjs_require__(54),global=__w_pdfjs_require__(7),uncurryThis=__w_pdfjs_require__(17),isObject=__w_pdfjs_require__(22),createNonEnumerableProperty=__w_pdfjs_require__(45),hasOwn=__w_pdfjs_require__(40),shared=__w_pdfjs_require__(38),sharedKey=__w_pdfjs_require__(55),hiddenKeys=__w_pdfjs_require__(56),TypeError=global.TypeError,WeakMap=global.WeakMap;if(NATIVE_WEAK_MAP||shared.state){var store=shared.state||(shared.state=new WeakMap),wmget=uncurryThis(store.get),wmhas=uncurryThis(store.has),wmset=uncurryThis(store.set);set=function(it,metadata){if(wmhas(store,it))throw new TypeError("Object already initialized");return metadata.facade=it,wmset(store,it,metadata),metadata},get=function(it){return wmget(store,it)||{}},has=function(it){return wmhas(store,it)}}else{var STATE=sharedKey("state");hiddenKeys[STATE]=!0,set=function(it,metadata){if(hasOwn(it,STATE))throw new TypeError("Object already initialized");return metadata.facade=it,createNonEnumerableProperty(it,STATE,metadata),metadata},get=function(it){return hasOwn(it,STATE)?it[STATE]:{}},has=function(it){return hasOwn(it,STATE)}}module.exports={set:set,get:get,has:has,enforce:function(it){return has(it)?get(it):set(it,{})},getterFor:function(TYPE){return function(it){var state;if(!isObject(it)||(state=get(it)).type!==TYPE)throw TypeError("Incompatible receiver, "+TYPE+" required");return state}}}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var global=__w_pdfjs_require__(7),isCallable=__w_pdfjs_require__(23),inspectSource=__w_pdfjs_require__(52),WeakMap=global.WeakMap;module.exports=isCallable(WeakMap)&&/native code/.test(inspectSource(WeakMap))},function(module,__unused_webpack_exports,__w_pdfjs_require__){var shared=__w_pdfjs_require__(36),uid=__w_pdfjs_require__(42),keys=shared("keys");module.exports=function(key){return keys[key]||(keys[key]=uid(key))}},function(module){module.exports={}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var hasOwn=__w_pdfjs_require__(40),ownKeys=__w_pdfjs_require__(58),getOwnPropertyDescriptorModule=__w_pdfjs_require__(8),definePropertyModule=__w_pdfjs_require__(46);module.exports=function(target,source,exceptions){for(var keys=ownKeys(source),defineProperty=definePropertyModule.f,getOwnPropertyDescriptor=getOwnPropertyDescriptorModule.f,i=0;i<keys.length;i++){var key=keys[i];hasOwn(target,key)||exceptions&&hasOwn(exceptions,key)||defineProperty(target,key,getOwnPropertyDescriptor(source,key))}}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var getBuiltIn=__w_pdfjs_require__(25),uncurryThis=__w_pdfjs_require__(17),getOwnPropertyNamesModule=__w_pdfjs_require__(59),getOwnPropertySymbolsModule=__w_pdfjs_require__(68),anObject=__w_pdfjs_require__(48),concat=uncurryThis([].concat);module.exports=getBuiltIn("Reflect","ownKeys")||function(it){var keys=getOwnPropertyNamesModule.f(anObject(it)),getOwnPropertySymbols=getOwnPropertySymbolsModule.f;return getOwnPropertySymbols?concat(keys,getOwnPropertySymbols(it)):keys}},function(__unused_webpack_module,exports,__w_pdfjs_require__){var internalObjectKeys=__w_pdfjs_require__(60),hiddenKeys=__w_pdfjs_require__(67).concat("length","prototype");exports.f=Object.getOwnPropertyNames||function(O){return internalObjectKeys(O,hiddenKeys)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var uncurryThis=__w_pdfjs_require__(17),hasOwn=__w_pdfjs_require__(40),toIndexedObject=__w_pdfjs_require__(15),indexOf=__w_pdfjs_require__(61).indexOf,hiddenKeys=__w_pdfjs_require__(56),push=uncurryThis([].push);module.exports=function(object,names){var key,O=toIndexedObject(object),i=0,result=[];for(key in O)!hasOwn(hiddenKeys,key)&&hasOwn(O,key)&&push(result,key);for(;names.length>i;)hasOwn(O,key=names[i++])&&(~indexOf(result,key)||push(result,key));return result}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var toIndexedObject=__w_pdfjs_require__(15),toAbsoluteIndex=__w_pdfjs_require__(62),lengthOfArrayLike=__w_pdfjs_require__(65),createMethod=function(IS_INCLUDES){return function($this,el,fromIndex){var value,O=toIndexedObject($this),length=lengthOfArrayLike(O),index=toAbsoluteIndex(fromIndex,length);if(IS_INCLUDES&&el!=el){for(;length>index;)if((value=O[index++])!=value)return!0}else for(;length>index;index++)if((IS_INCLUDES||index in O)&&O[index]===el)return IS_INCLUDES||index||0;return!IS_INCLUDES&&-1}};module.exports={includes:createMethod(!0),indexOf:createMethod(!1)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var toIntegerOrInfinity=__w_pdfjs_require__(63),max=Math.max,min=Math.min;module.exports=function(index,length){var integer=toIntegerOrInfinity(index);return integer<0?max(integer+length,0):min(integer,length)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var trunc=__w_pdfjs_require__(64);module.exports=function(argument){var number=+argument;return number!=number||0===number?0:trunc(number)}},function(module){var ceil=Math.ceil,floor=Math.floor;module.exports=Math.trunc||function(x){var n=+x;return(n>0?floor:ceil)(n)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var toLength=__w_pdfjs_require__(66);module.exports=function(obj){return toLength(obj.length)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var toIntegerOrInfinity=__w_pdfjs_require__(63),min=Math.min;module.exports=function(argument){return argument>0?min(toIntegerOrInfinity(argument),9007199254740991):0}},function(module){module.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(__unused_webpack_module,exports){exports.f=Object.getOwnPropertySymbols},function(module,__unused_webpack_exports,__w_pdfjs_require__){var fails=__w_pdfjs_require__(10),isCallable=__w_pdfjs_require__(23),replacement=/#|\.prototype\./,isForced=function(feature,detection){var value=data[normalize(feature)];return value==POLYFILL||value!=NATIVE&&(isCallable(detection)?fails(detection):!!detection)},normalize=isForced.normalize=function(string){return String(string).replace(replacement,".").toLowerCase()},data=isForced.data={},NATIVE=isForced.NATIVE="N",POLYFILL=isForced.POLYFILL="P";module.exports=isForced},function(module,__unused_webpack_exports,__w_pdfjs_require__){var wellKnownSymbol=__w_pdfjs_require__(35),create=__w_pdfjs_require__(71),defineProperty=__w_pdfjs_require__(46).f,UNSCOPABLES=wellKnownSymbol("unscopables"),ArrayPrototype=Array.prototype;null==ArrayPrototype[UNSCOPABLES]&&defineProperty(ArrayPrototype,UNSCOPABLES,{configurable:!0,value:create(null)}),module.exports=function(key){ArrayPrototype[UNSCOPABLES][key]=!0}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var activeXDocument,anObject=__w_pdfjs_require__(48),definePropertiesModule=__w_pdfjs_require__(72),enumBugKeys=__w_pdfjs_require__(67),hiddenKeys=__w_pdfjs_require__(56),html=__w_pdfjs_require__(74),documentCreateElement=__w_pdfjs_require__(44),sharedKey=__w_pdfjs_require__(55),IE_PROTO=sharedKey("IE_PROTO"),EmptyConstructor=function(){},scriptTag=function(content){return"<script>"+content+"<\/script>"},NullProtoObjectViaActiveX=function(activeXDocument){activeXDocument.write(scriptTag("")),activeXDocument.close();var temp=activeXDocument.parentWindow.Object;return activeXDocument=null,temp},_NullProtoObject=function(){try{activeXDocument=new ActiveXObject("htmlfile")}catch(error){}var iframeDocument,iframe;_NullProtoObject="undefined"!=typeof document?document.domain&&activeXDocument?NullProtoObjectViaActiveX(activeXDocument):((iframe=documentCreateElement("iframe")).style.display="none",html.appendChild(iframe),iframe.src=String("javascript:"),(iframeDocument=iframe.contentWindow.document).open(),iframeDocument.write(scriptTag("document.F=Object")),iframeDocument.close(),iframeDocument.F):NullProtoObjectViaActiveX(activeXDocument);for(var length=enumBugKeys.length;length--;)delete _NullProtoObject.prototype[enumBugKeys[length]];return _NullProtoObject()};hiddenKeys[IE_PROTO]=!0,module.exports=Object.create||function(O,Properties){var result;return null!==O?(EmptyConstructor.prototype=anObject(O),result=new EmptyConstructor,EmptyConstructor.prototype=null,result[IE_PROTO]=O):result=_NullProtoObject(),void 0===Properties?result:definePropertiesModule.f(result,Properties)}},function(__unused_webpack_module,exports,__w_pdfjs_require__){var DESCRIPTORS=__w_pdfjs_require__(9),V8_PROTOTYPE_DEFINE_BUG=__w_pdfjs_require__(47),definePropertyModule=__w_pdfjs_require__(46),anObject=__w_pdfjs_require__(48),toIndexedObject=__w_pdfjs_require__(15),objectKeys=__w_pdfjs_require__(73);exports.f=DESCRIPTORS&&!V8_PROTOTYPE_DEFINE_BUG?Object.defineProperties:function(O,Properties){anObject(O);for(var key,props=toIndexedObject(Properties),keys=objectKeys(Properties),length=keys.length,index=0;length>index;)definePropertyModule.f(O,key=keys[index++],props[key]);return O}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var internalObjectKeys=__w_pdfjs_require__(60),enumBugKeys=__w_pdfjs_require__(67);module.exports=Object.keys||function(O){return internalObjectKeys(O,enumBugKeys)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var getBuiltIn=__w_pdfjs_require__(25);module.exports=getBuiltIn("document","documentElement")},function(module,__unused_webpack_exports,__w_pdfjs_require__){var global=__w_pdfjs_require__(7),uncurryThis=__w_pdfjs_require__(17);module.exports=function(CONSTRUCTOR,METHOD){return uncurryThis(global[CONSTRUCTOR].prototype[METHOD])}},function(__unused_webpack_module,__unused_webpack_exports,__w_pdfjs_require__){__w_pdfjs_require__(77)},function(__unused_webpack_module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var ArrayBufferViewCore=__w_pdfjs_require__(78),lengthOfArrayLike=__w_pdfjs_require__(65),toIntegerOrInfinity=__w_pdfjs_require__(63),aTypedArray=ArrayBufferViewCore.aTypedArray;(0,ArrayBufferViewCore.exportTypedArrayMethod)("at",(function(index){var O=aTypedArray(this),len=lengthOfArrayLike(O),relativeIndex=toIntegerOrInfinity(index),k=relativeIndex>=0?relativeIndex:len+relativeIndex;return k<0||k>=len?void 0:O[k]}))},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var NAME,Constructor,Prototype,NATIVE_ARRAY_BUFFER=__w_pdfjs_require__(79),DESCRIPTORS=__w_pdfjs_require__(9),global=__w_pdfjs_require__(7),isCallable=__w_pdfjs_require__(23),isObject=__w_pdfjs_require__(22),hasOwn=__w_pdfjs_require__(40),classof=__w_pdfjs_require__(80),tryToString=__w_pdfjs_require__(33),createNonEnumerableProperty=__w_pdfjs_require__(45),defineBuiltIn=__w_pdfjs_require__(49),defineProperty=__w_pdfjs_require__(46).f,isPrototypeOf=__w_pdfjs_require__(26),getPrototypeOf=__w_pdfjs_require__(82),setPrototypeOf=__w_pdfjs_require__(84),wellKnownSymbol=__w_pdfjs_require__(35),uid=__w_pdfjs_require__(42),InternalStateModule=__w_pdfjs_require__(53),enforceInternalState=InternalStateModule.enforce,getInternalState=InternalStateModule.get,Int8Array=global.Int8Array,Int8ArrayPrototype=Int8Array&&Int8Array.prototype,Uint8ClampedArray=global.Uint8ClampedArray,Uint8ClampedArrayPrototype=Uint8ClampedArray&&Uint8ClampedArray.prototype,TypedArray=Int8Array&&getPrototypeOf(Int8Array),TypedArrayPrototype=Int8ArrayPrototype&&getPrototypeOf(Int8ArrayPrototype),ObjectPrototype=Object.prototype,TypeError=global.TypeError,TO_STRING_TAG=wellKnownSymbol("toStringTag"),TYPED_ARRAY_TAG=uid("TYPED_ARRAY_TAG"),NATIVE_ARRAY_BUFFER_VIEWS=NATIVE_ARRAY_BUFFER&&!!setPrototypeOf&&"Opera"!==classof(global.opera),TYPED_ARRAY_TAG_REQUIRED=!1,TypedArrayConstructorsList={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},BigIntArrayConstructorsList={BigInt64Array:8,BigUint64Array:8},isTypedArray=function(it){if(!isObject(it))return!1;var klass=classof(it);return hasOwn(TypedArrayConstructorsList,klass)||hasOwn(BigIntArrayConstructorsList,klass)};for(NAME in TypedArrayConstructorsList)(Prototype=(Constructor=global[NAME])&&Constructor.prototype)?enforceInternalState(Prototype).TypedArrayConstructor=Constructor:NATIVE_ARRAY_BUFFER_VIEWS=!1;for(NAME in BigIntArrayConstructorsList)(Prototype=(Constructor=global[NAME])&&Constructor.prototype)&&(enforceInternalState(Prototype).TypedArrayConstructor=Constructor);if((!NATIVE_ARRAY_BUFFER_VIEWS||!isCallable(TypedArray)||TypedArray===Function.prototype)&&(TypedArray=function(){throw TypeError("Incorrect invocation")},NATIVE_ARRAY_BUFFER_VIEWS))for(NAME in TypedArrayConstructorsList)global[NAME]&&setPrototypeOf(global[NAME],TypedArray);if((!NATIVE_ARRAY_BUFFER_VIEWS||!TypedArrayPrototype||TypedArrayPrototype===ObjectPrototype)&&(TypedArrayPrototype=TypedArray.prototype,NATIVE_ARRAY_BUFFER_VIEWS))for(NAME in TypedArrayConstructorsList)global[NAME]&&setPrototypeOf(global[NAME].prototype,TypedArrayPrototype);if(NATIVE_ARRAY_BUFFER_VIEWS&&getPrototypeOf(Uint8ClampedArrayPrototype)!==TypedArrayPrototype&&setPrototypeOf(Uint8ClampedArrayPrototype,TypedArrayPrototype),DESCRIPTORS&&!hasOwn(TypedArrayPrototype,TO_STRING_TAG))for(NAME in TYPED_ARRAY_TAG_REQUIRED=!0,defineProperty(TypedArrayPrototype,TO_STRING_TAG,{get:function(){return isObject(this)?this[TYPED_ARRAY_TAG]:void 0}}),TypedArrayConstructorsList)global[NAME]&&createNonEnumerableProperty(global[NAME],TYPED_ARRAY_TAG,NAME);module.exports={NATIVE_ARRAY_BUFFER_VIEWS:NATIVE_ARRAY_BUFFER_VIEWS,TYPED_ARRAY_TAG:TYPED_ARRAY_TAG_REQUIRED&&TYPED_ARRAY_TAG,aTypedArray:function(it){if(isTypedArray(it))return it;throw TypeError("Target is not a typed array")},aTypedArrayConstructor:function(C){if(isCallable(C)&&(!setPrototypeOf||isPrototypeOf(TypedArray,C)))return C;throw TypeError(tryToString(C)+" is not a typed array constructor")},exportTypedArrayMethod:function(KEY,property,forced,options){if(DESCRIPTORS){if(forced)for(var ARRAY in TypedArrayConstructorsList){var TypedArrayConstructor=global[ARRAY];if(TypedArrayConstructor&&hasOwn(TypedArrayConstructor.prototype,KEY))try{delete TypedArrayConstructor.prototype[KEY]}catch(error){try{TypedArrayConstructor.prototype[KEY]=property}catch(error2){}}}TypedArrayPrototype[KEY]&&!forced||defineBuiltIn(TypedArrayPrototype,KEY,forced?property:NATIVE_ARRAY_BUFFER_VIEWS&&Int8ArrayPrototype[KEY]||property,options)}},exportTypedArrayStaticMethod:function(KEY,property,forced){var ARRAY,TypedArrayConstructor;if(DESCRIPTORS){if(setPrototypeOf){if(forced)for(ARRAY in TypedArrayConstructorsList)if((TypedArrayConstructor=global[ARRAY])&&hasOwn(TypedArrayConstructor,KEY))try{delete TypedArrayConstructor[KEY]}catch(error){}if(TypedArray[KEY]&&!forced)return;try{return defineBuiltIn(TypedArray,KEY,forced?property:NATIVE_ARRAY_BUFFER_VIEWS&&TypedArray[KEY]||property)}catch(error){}}for(ARRAY in TypedArrayConstructorsList)!(TypedArrayConstructor=global[ARRAY])||TypedArrayConstructor[KEY]&&!forced||defineBuiltIn(TypedArrayConstructor,KEY,property)}},getTypedArrayConstructor:function getTypedArrayConstructor(it){var proto=getPrototypeOf(it);if(isObject(proto)){var state=getInternalState(proto);return state&&hasOwn(state,"TypedArrayConstructor")?state.TypedArrayConstructor:getTypedArrayConstructor(proto)}},isView:function(it){if(!isObject(it))return!1;var klass=classof(it);return"DataView"===klass||hasOwn(TypedArrayConstructorsList,klass)||hasOwn(BigIntArrayConstructorsList,klass)},isTypedArray:isTypedArray,TypedArray:TypedArray,TypedArrayPrototype:TypedArrayPrototype}},function(module){module.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},function(module,__unused_webpack_exports,__w_pdfjs_require__){var TO_STRING_TAG_SUPPORT=__w_pdfjs_require__(81),isCallable=__w_pdfjs_require__(23),classofRaw=__w_pdfjs_require__(18),TO_STRING_TAG=__w_pdfjs_require__(35)("toStringTag"),$Object=Object,CORRECT_ARGUMENTS="Arguments"==classofRaw(function(){return arguments}());module.exports=TO_STRING_TAG_SUPPORT?classofRaw:function(it){var O,tag,result;return void 0===it?"Undefined":null===it?"Null":"string"==typeof(tag=function(it,key){try{return it[key]}catch(error){}}(O=$Object(it),TO_STRING_TAG))?tag:CORRECT_ARGUMENTS?classofRaw(O):"Object"==(result=classofRaw(O))&&isCallable(O.callee)?"Arguments":result}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var test={};test[__w_pdfjs_require__(35)("toStringTag")]="z",module.exports="[object z]"===String(test)},function(module,__unused_webpack_exports,__w_pdfjs_require__){var hasOwn=__w_pdfjs_require__(40),isCallable=__w_pdfjs_require__(23),toObject=__w_pdfjs_require__(41),sharedKey=__w_pdfjs_require__(55),CORRECT_PROTOTYPE_GETTER=__w_pdfjs_require__(83),IE_PROTO=sharedKey("IE_PROTO"),$Object=Object,ObjectPrototype=$Object.prototype;module.exports=CORRECT_PROTOTYPE_GETTER?$Object.getPrototypeOf:function(O){var object=toObject(O);if(hasOwn(object,IE_PROTO))return object[IE_PROTO];var constructor=object.constructor;return isCallable(constructor)&&object instanceof constructor?constructor.prototype:object instanceof $Object?ObjectPrototype:null}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var fails=__w_pdfjs_require__(10);module.exports=!fails((function(){function F(){}return F.prototype.constructor=null,Object.getPrototypeOf(new F)!==F.prototype}))},function(module,__unused_webpack_exports,__w_pdfjs_require__){var uncurryThis=__w_pdfjs_require__(17),anObject=__w_pdfjs_require__(48),aPossiblePrototype=__w_pdfjs_require__(85);module.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var setter,CORRECT_SETTER=!1,test={};try{(setter=uncurryThis(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(test,[]),CORRECT_SETTER=test instanceof Array}catch(error){}return function(O,proto){return anObject(O),aPossiblePrototype(proto),CORRECT_SETTER?setter(O,proto):O.__proto__=proto,O}}():void 0)},function(module,__unused_webpack_exports,__w_pdfjs_require__){var isCallable=__w_pdfjs_require__(23),$String=String,$TypeError=TypeError;module.exports=function(argument){if("object"==_typeof(argument)||isCallable(argument))return argument;throw $TypeError("Can't set "+$String(argument)+" as a prototype")}},function(module,__unused_webpack_exports,__w_pdfjs_require__){__w_pdfjs_require__(87),__w_pdfjs_require__(93),__w_pdfjs_require__(95),__w_pdfjs_require__(117),__w_pdfjs_require__(119);var path=__w_pdfjs_require__(128);module.exports=path.structuredClone},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var toIndexedObject=__w_pdfjs_require__(15),addToUnscopables=__w_pdfjs_require__(70),Iterators=__w_pdfjs_require__(88),InternalStateModule=__w_pdfjs_require__(53),defineProperty=__w_pdfjs_require__(46).f,defineIterator=__w_pdfjs_require__(89),IS_PURE=__w_pdfjs_require__(37),DESCRIPTORS=__w_pdfjs_require__(9),setInternalState=InternalStateModule.set,getInternalState=InternalStateModule.getterFor("Array Iterator");module.exports=defineIterator(Array,"Array",(function(iterated,kind){setInternalState(this,{type:"Array Iterator",target:toIndexedObject(iterated),index:0,kind:kind})}),(function(){var state=getInternalState(this),target=state.target,kind=state.kind,index=state.index++;return!target||index>=target.length?(state.target=void 0,{value:void 0,done:!0}):"keys"==kind?{value:index,done:!1}:"values"==kind?{value:target[index],done:!1}:{value:[index,target[index]],done:!1}}),"values");var values=Iterators.Arguments=Iterators.Array;if(addToUnscopables("keys"),addToUnscopables("values"),addToUnscopables("entries"),!IS_PURE&&DESCRIPTORS&&"values"!==values.name)try{defineProperty(values,"name",{value:"values"})}catch(error){}},function(module){module.exports={}},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var $=__w_pdfjs_require__(6),call=__w_pdfjs_require__(11),IS_PURE=__w_pdfjs_require__(37),FunctionName=__w_pdfjs_require__(51),isCallable=__w_pdfjs_require__(23),createIteratorConstructor=__w_pdfjs_require__(90),getPrototypeOf=__w_pdfjs_require__(82),setPrototypeOf=__w_pdfjs_require__(84),setToStringTag=__w_pdfjs_require__(92),createNonEnumerableProperty=__w_pdfjs_require__(45),defineBuiltIn=__w_pdfjs_require__(49),wellKnownSymbol=__w_pdfjs_require__(35),Iterators=__w_pdfjs_require__(88),IteratorsCore=__w_pdfjs_require__(91),PROPER_FUNCTION_NAME=FunctionName.PROPER,CONFIGURABLE_FUNCTION_NAME=FunctionName.CONFIGURABLE,IteratorPrototype=IteratorsCore.IteratorPrototype,BUGGY_SAFARI_ITERATORS=IteratorsCore.BUGGY_SAFARI_ITERATORS,ITERATOR=wellKnownSymbol("iterator"),returnThis=function(){return this};module.exports=function(Iterable,NAME,IteratorConstructor,next,DEFAULT,IS_SET,FORCED){createIteratorConstructor(IteratorConstructor,NAME,next);var CurrentIteratorPrototype,methods,KEY,getIterationMethod=function(KIND){if(KIND===DEFAULT&&defaultIterator)return defaultIterator;if(!BUGGY_SAFARI_ITERATORS&&KIND in IterablePrototype)return IterablePrototype[KIND];switch(KIND){case"keys":case"values":case"entries":return function(){return new IteratorConstructor(this,KIND)}}return function(){return new IteratorConstructor(this)}},TO_STRING_TAG=NAME+" Iterator",INCORRECT_VALUES_NAME=!1,IterablePrototype=Iterable.prototype,nativeIterator=IterablePrototype[ITERATOR]||IterablePrototype["@@iterator"]||DEFAULT&&IterablePrototype[DEFAULT],defaultIterator=!BUGGY_SAFARI_ITERATORS&&nativeIterator||getIterationMethod(DEFAULT),anyNativeIterator="Array"==NAME&&IterablePrototype.entries||nativeIterator;if(anyNativeIterator&&(CurrentIteratorPrototype=getPrototypeOf(anyNativeIterator.call(new Iterable)))!==Object.prototype&&CurrentIteratorPrototype.next&&(IS_PURE||getPrototypeOf(CurrentIteratorPrototype)===IteratorPrototype||(setPrototypeOf?setPrototypeOf(CurrentIteratorPrototype,IteratorPrototype):isCallable(CurrentIteratorPrototype[ITERATOR])||defineBuiltIn(CurrentIteratorPrototype,ITERATOR,returnThis)),setToStringTag(CurrentIteratorPrototype,TO_STRING_TAG,!0,!0),IS_PURE&&(Iterators[TO_STRING_TAG]=returnThis)),PROPER_FUNCTION_NAME&&"values"==DEFAULT&&nativeIterator&&"values"!==nativeIterator.name&&(!IS_PURE&&CONFIGURABLE_FUNCTION_NAME?createNonEnumerableProperty(IterablePrototype,"name","values"):(INCORRECT_VALUES_NAME=!0,defaultIterator=function(){return call(nativeIterator,this)})),DEFAULT)if(methods={values:getIterationMethod("values"),keys:IS_SET?defaultIterator:getIterationMethod("keys"),entries:getIterationMethod("entries")},FORCED)for(KEY in methods)(BUGGY_SAFARI_ITERATORS||INCORRECT_VALUES_NAME||!(KEY in IterablePrototype))&&defineBuiltIn(IterablePrototype,KEY,methods[KEY]);else $({target:NAME,proto:!0,forced:BUGGY_SAFARI_ITERATORS||INCORRECT_VALUES_NAME},methods);return IS_PURE&&!FORCED||IterablePrototype[ITERATOR]===defaultIterator||defineBuiltIn(IterablePrototype,ITERATOR,defaultIterator,{name:DEFAULT}),Iterators[NAME]=defaultIterator,methods}},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var IteratorPrototype=__w_pdfjs_require__(91).IteratorPrototype,create=__w_pdfjs_require__(71),createPropertyDescriptor=__w_pdfjs_require__(14),setToStringTag=__w_pdfjs_require__(92),Iterators=__w_pdfjs_require__(88),returnThis=function(){return this};module.exports=function(IteratorConstructor,NAME,next,ENUMERABLE_NEXT){var TO_STRING_TAG=NAME+" Iterator";return IteratorConstructor.prototype=create(IteratorPrototype,{next:createPropertyDescriptor(+!ENUMERABLE_NEXT,next)}),setToStringTag(IteratorConstructor,TO_STRING_TAG,!1,!0),Iterators[TO_STRING_TAG]=returnThis,IteratorConstructor}},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var IteratorPrototype,PrototypeOfArrayIteratorPrototype,arrayIterator,fails=__w_pdfjs_require__(10),isCallable=__w_pdfjs_require__(23),create=__w_pdfjs_require__(71),getPrototypeOf=__w_pdfjs_require__(82),defineBuiltIn=__w_pdfjs_require__(49),wellKnownSymbol=__w_pdfjs_require__(35),IS_PURE=__w_pdfjs_require__(37),ITERATOR=wellKnownSymbol("iterator"),BUGGY_SAFARI_ITERATORS=!1;[].keys&&("next"in(arrayIterator=[].keys())?(PrototypeOfArrayIteratorPrototype=getPrototypeOf(getPrototypeOf(arrayIterator)))!==Object.prototype&&(IteratorPrototype=PrototypeOfArrayIteratorPrototype):BUGGY_SAFARI_ITERATORS=!0),null==IteratorPrototype||fails((function(){var test={};return IteratorPrototype[ITERATOR].call(test)!==test}))?IteratorPrototype={}:IS_PURE&&(IteratorPrototype=create(IteratorPrototype)),isCallable(IteratorPrototype[ITERATOR])||defineBuiltIn(IteratorPrototype,ITERATOR,(function(){return this})),module.exports={IteratorPrototype:IteratorPrototype,BUGGY_SAFARI_ITERATORS:BUGGY_SAFARI_ITERATORS}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var defineProperty=__w_pdfjs_require__(46).f,hasOwn=__w_pdfjs_require__(40),TO_STRING_TAG=__w_pdfjs_require__(35)("toStringTag");module.exports=function(target,TAG,STATIC){target&&!STATIC&&(target=target.prototype),target&&!hasOwn(target,TO_STRING_TAG)&&defineProperty(target,TO_STRING_TAG,{configurable:!0,value:TAG})}},function(__unused_webpack_module,__unused_webpack_exports,__w_pdfjs_require__){var TO_STRING_TAG_SUPPORT=__w_pdfjs_require__(81),defineBuiltIn=__w_pdfjs_require__(49),toString=__w_pdfjs_require__(94);TO_STRING_TAG_SUPPORT||defineBuiltIn(Object.prototype,"toString",toString,{unsafe:!0})},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var TO_STRING_TAG_SUPPORT=__w_pdfjs_require__(81),classof=__w_pdfjs_require__(80);module.exports=TO_STRING_TAG_SUPPORT?{}.toString:function(){return"[object "+classof(this)+"]"}},function(__unused_webpack_module,__unused_webpack_exports,__w_pdfjs_require__){__w_pdfjs_require__(96)},function(__unused_webpack_module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";__w_pdfjs_require__(97)("Map",(function(init){return function(){return init(this,arguments.length?arguments[0]:void 0)}}),__w_pdfjs_require__(114))},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var $=__w_pdfjs_require__(6),global=__w_pdfjs_require__(7),uncurryThis=__w_pdfjs_require__(17),isForced=__w_pdfjs_require__(69),defineBuiltIn=__w_pdfjs_require__(49),InternalMetadataModule=__w_pdfjs_require__(98),iterate=__w_pdfjs_require__(105),anInstance=__w_pdfjs_require__(111),isCallable=__w_pdfjs_require__(23),isObject=__w_pdfjs_require__(22),fails=__w_pdfjs_require__(10),checkCorrectnessOfIteration=__w_pdfjs_require__(112),setToStringTag=__w_pdfjs_require__(92),inheritIfRequired=__w_pdfjs_require__(113);module.exports=function(CONSTRUCTOR_NAME,wrapper,common){var IS_MAP=-1!==CONSTRUCTOR_NAME.indexOf("Map"),IS_WEAK=-1!==CONSTRUCTOR_NAME.indexOf("Weak"),ADDER=IS_MAP?"set":"add",NativeConstructor=global[CONSTRUCTOR_NAME],NativePrototype=NativeConstructor&&NativeConstructor.prototype,Constructor=NativeConstructor,exported={},fixMethod=function(KEY){var uncurriedNativeMethod=uncurryThis(NativePrototype[KEY]);defineBuiltIn(NativePrototype,KEY,"add"==KEY?function(value){return uncurriedNativeMethod(this,0===value?0:value),this}:"delete"==KEY?function(key){return!(IS_WEAK&&!isObject(key))&&uncurriedNativeMethod(this,0===key?0:key)}:"get"==KEY?function(key){return IS_WEAK&&!isObject(key)?void 0:uncurriedNativeMethod(this,0===key?0:key)}:"has"==KEY?function(key){return!(IS_WEAK&&!isObject(key))&&uncurriedNativeMethod(this,0===key?0:key)}:function(key,value){return uncurriedNativeMethod(this,0===key?0:key,value),this})};if(isForced(CONSTRUCTOR_NAME,!isCallable(NativeConstructor)||!(IS_WEAK||NativePrototype.forEach&&!fails((function(){(new NativeConstructor).entries().next()})))))Constructor=common.getConstructor(wrapper,CONSTRUCTOR_NAME,IS_MAP,ADDER),InternalMetadataModule.enable();else if(isForced(CONSTRUCTOR_NAME,!0)){var instance=new Constructor,HASNT_CHAINING=instance[ADDER](IS_WEAK?{}:-0,1)!=instance,THROWS_ON_PRIMITIVES=fails((function(){instance.has(1)})),ACCEPT_ITERABLES=checkCorrectnessOfIteration((function(iterable){new NativeConstructor(iterable)})),BUGGY_ZERO=!IS_WEAK&&fails((function(){for(var $instance=new NativeConstructor,index=5;index--;)$instance[ADDER](index,index);return!$instance.has(-0)}));ACCEPT_ITERABLES||((Constructor=wrapper((function(dummy,iterable){anInstance(dummy,NativePrototype);var that=inheritIfRequired(new NativeConstructor,dummy,Constructor);return null!=iterable&&iterate(iterable,that[ADDER],{that:that,AS_ENTRIES:IS_MAP}),that}))).prototype=NativePrototype,NativePrototype.constructor=Constructor),(THROWS_ON_PRIMITIVES||BUGGY_ZERO)&&(fixMethod("delete"),fixMethod("has"),IS_MAP&&fixMethod("get")),(BUGGY_ZERO||HASNT_CHAINING)&&fixMethod(ADDER),IS_WEAK&&NativePrototype.clear&&delete NativePrototype.clear}return exported[CONSTRUCTOR_NAME]=Constructor,$({global:!0,constructor:!0,forced:Constructor!=NativeConstructor},exported),setToStringTag(Constructor,CONSTRUCTOR_NAME),IS_WEAK||common.setStrong(Constructor,CONSTRUCTOR_NAME,IS_MAP),Constructor}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var $=__w_pdfjs_require__(6),uncurryThis=__w_pdfjs_require__(17),hiddenKeys=__w_pdfjs_require__(56),isObject=__w_pdfjs_require__(22),hasOwn=__w_pdfjs_require__(40),defineProperty=__w_pdfjs_require__(46).f,getOwnPropertyNamesModule=__w_pdfjs_require__(59),getOwnPropertyNamesExternalModule=__w_pdfjs_require__(99),isExtensible=__w_pdfjs_require__(102),uid=__w_pdfjs_require__(42),FREEZING=__w_pdfjs_require__(104),REQUIRED=!1,METADATA=uid("meta"),id=0,setMetadata=function(it){defineProperty(it,METADATA,{value:{objectID:"O"+id++,weakData:{}}})},meta=module.exports={enable:function(){meta.enable=function(){},REQUIRED=!0;var getOwnPropertyNames=getOwnPropertyNamesModule.f,splice=uncurryThis([].splice),test={};test[METADATA]=1,getOwnPropertyNames(test).length&&(getOwnPropertyNamesModule.f=function(it){for(var result=getOwnPropertyNames(it),i=0,length=result.length;i<length;i++)if(result[i]===METADATA){splice(result,i,1);break}return result},$({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:getOwnPropertyNamesExternalModule.f}))},fastKey:function(it,create){if(!isObject(it))return"symbol"==_typeof(it)?it:("string"==typeof it?"S":"P")+it;if(!hasOwn(it,METADATA)){if(!isExtensible(it))return"F";if(!create)return"E";setMetadata(it)}return it[METADATA].objectID},getWeakData:function(it,create){if(!hasOwn(it,METADATA)){if(!isExtensible(it))return!0;if(!create)return!1;setMetadata(it)}return it[METADATA].weakData},onFreeze:function(it){return FREEZING&&REQUIRED&&isExtensible(it)&&!hasOwn(it,METADATA)&&setMetadata(it),it}};hiddenKeys[METADATA]=!0},function(module,__unused_webpack_exports,__w_pdfjs_require__){var classof=__w_pdfjs_require__(18),toIndexedObject=__w_pdfjs_require__(15),$getOwnPropertyNames=__w_pdfjs_require__(59).f,arraySlice=__w_pdfjs_require__(100),windowNames="object"==("undefined"==typeof window?"undefined":_typeof(window))&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];module.exports.f=function(it){return windowNames&&"Window"==classof(it)?function(it){try{return $getOwnPropertyNames(it)}catch(error){return arraySlice(windowNames)}}(it):$getOwnPropertyNames(toIndexedObject(it))}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var toAbsoluteIndex=__w_pdfjs_require__(62),lengthOfArrayLike=__w_pdfjs_require__(65),createProperty=__w_pdfjs_require__(101),$Array=Array,max=Math.max;module.exports=function(O,start,end){for(var length=lengthOfArrayLike(O),k=toAbsoluteIndex(start,length),fin=toAbsoluteIndex(void 0===end?length:end,length),result=$Array(max(fin-k,0)),n=0;k<fin;k++,n++)createProperty(result,n,O[k]);return result.length=n,result}},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var toPropertyKey=__w_pdfjs_require__(20),definePropertyModule=__w_pdfjs_require__(46),createPropertyDescriptor=__w_pdfjs_require__(14);module.exports=function(object,key,value){var propertyKey=toPropertyKey(key);propertyKey in object?definePropertyModule.f(object,propertyKey,createPropertyDescriptor(0,value)):object[propertyKey]=value}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var fails=__w_pdfjs_require__(10),isObject=__w_pdfjs_require__(22),classof=__w_pdfjs_require__(18),ARRAY_BUFFER_NON_EXTENSIBLE=__w_pdfjs_require__(103),$isExtensible=Object.isExtensible,FAILS_ON_PRIMITIVES=fails((function(){$isExtensible(1)}));module.exports=FAILS_ON_PRIMITIVES||ARRAY_BUFFER_NON_EXTENSIBLE?function(it){return!!isObject(it)&&(!ARRAY_BUFFER_NON_EXTENSIBLE||"ArrayBuffer"!=classof(it))&&(!$isExtensible||$isExtensible(it))}:$isExtensible},function(module,__unused_webpack_exports,__w_pdfjs_require__){var fails=__w_pdfjs_require__(10);module.exports=fails((function(){if("function"==typeof ArrayBuffer){var buffer=new ArrayBuffer(8);Object.isExtensible(buffer)&&Object.defineProperty(buffer,"a",{value:8})}}))},function(module,__unused_webpack_exports,__w_pdfjs_require__){var fails=__w_pdfjs_require__(10);module.exports=!fails((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(module,__unused_webpack_exports,__w_pdfjs_require__){var bind=__w_pdfjs_require__(106),call=__w_pdfjs_require__(11),anObject=__w_pdfjs_require__(48),tryToString=__w_pdfjs_require__(33),isArrayIteratorMethod=__w_pdfjs_require__(107),lengthOfArrayLike=__w_pdfjs_require__(65),isPrototypeOf=__w_pdfjs_require__(26),getIterator=__w_pdfjs_require__(108),getIteratorMethod=__w_pdfjs_require__(109),iteratorClose=__w_pdfjs_require__(110),$TypeError=TypeError,Result=function(stopped,result){this.stopped=stopped,this.result=result},ResultPrototype=Result.prototype;module.exports=function(iterable,unboundFunction,options){var iterator,iterFn,index,length,result,next,step,that=options&&options.that,AS_ENTRIES=!(!options||!options.AS_ENTRIES),IS_RECORD=!(!options||!options.IS_RECORD),IS_ITERATOR=!(!options||!options.IS_ITERATOR),INTERRUPTED=!(!options||!options.INTERRUPTED),fn=bind(unboundFunction,that),stop=function(condition){return iterator&&iteratorClose(iterator,"normal",condition),new Result(!0,condition)},callFn=function(value){return AS_ENTRIES?(anObject(value),INTERRUPTED?fn(value[0],value[1],stop):fn(value[0],value[1])):INTERRUPTED?fn(value,stop):fn(value)};if(IS_RECORD)iterator=iterable.iterator;else if(IS_ITERATOR)iterator=iterable;else{if(!(iterFn=getIteratorMethod(iterable)))throw $TypeError(tryToString(iterable)+" is not iterable");if(isArrayIteratorMethod(iterFn)){for(index=0,length=lengthOfArrayLike(iterable);length>index;index++)if((result=callFn(iterable[index]))&&isPrototypeOf(ResultPrototype,result))return result;return new Result(!1)}iterator=getIterator(iterable,iterFn)}for(next=IS_RECORD?iterable.next:iterator.next;!(step=call(next,iterator)).done;){try{result=callFn(step.value)}catch(error){iteratorClose(iterator,"throw",error)}if("object"==_typeof(result)&&result&&isPrototypeOf(ResultPrototype,result))return result}return new Result(!1)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var uncurryThis=__w_pdfjs_require__(17),aCallable=__w_pdfjs_require__(32),NATIVE_BIND=__w_pdfjs_require__(12),bind=uncurryThis(uncurryThis.bind);module.exports=function(fn,that){return aCallable(fn),void 0===that?fn:NATIVE_BIND?bind(fn,that):function(){return fn.apply(that,arguments)}}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var wellKnownSymbol=__w_pdfjs_require__(35),Iterators=__w_pdfjs_require__(88),ITERATOR=wellKnownSymbol("iterator"),ArrayPrototype=Array.prototype;module.exports=function(it){return void 0!==it&&(Iterators.Array===it||ArrayPrototype[ITERATOR]===it)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var call=__w_pdfjs_require__(11),aCallable=__w_pdfjs_require__(32),anObject=__w_pdfjs_require__(48),tryToString=__w_pdfjs_require__(33),getIteratorMethod=__w_pdfjs_require__(109),$TypeError=TypeError;module.exports=function(argument,usingIterator){var iteratorMethod=arguments.length<2?getIteratorMethod(argument):usingIterator;if(aCallable(iteratorMethod))return anObject(call(iteratorMethod,argument));throw $TypeError(tryToString(argument)+" is not iterable")}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var classof=__w_pdfjs_require__(80),getMethod=__w_pdfjs_require__(31),Iterators=__w_pdfjs_require__(88),ITERATOR=__w_pdfjs_require__(35)("iterator");module.exports=function(it){if(null!=it)return getMethod(it,ITERATOR)||getMethod(it,"@@iterator")||Iterators[classof(it)]}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var call=__w_pdfjs_require__(11),anObject=__w_pdfjs_require__(48),getMethod=__w_pdfjs_require__(31);module.exports=function(iterator,kind,value){var innerResult,innerError;anObject(iterator);try{if(!(innerResult=getMethod(iterator,"return"))){if("throw"===kind)throw value;return value}innerResult=call(innerResult,iterator)}catch(error){innerError=!0,innerResult=error}if("throw"===kind)throw value;if(innerError)throw innerResult;return anObject(innerResult),value}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var isPrototypeOf=__w_pdfjs_require__(26),$TypeError=TypeError;module.exports=function(it,Prototype){if(isPrototypeOf(Prototype,it))return it;throw $TypeError("Incorrect invocation")}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var ITERATOR=__w_pdfjs_require__(35)("iterator"),SAFE_CLOSING=!1;try{var called=0,iteratorWithReturn={next:function(){return{done:!!called++}},return:function(){SAFE_CLOSING=!0}};iteratorWithReturn[ITERATOR]=function(){return this},Array.from(iteratorWithReturn,(function(){throw 2}))}catch(error){}module.exports=function(exec,SKIP_CLOSING){if(!SKIP_CLOSING&&!SAFE_CLOSING)return!1;var ITERATION_SUPPORT=!1;try{var object={};object[ITERATOR]=function(){return{next:function(){return{done:ITERATION_SUPPORT=!0}}}},exec(object)}catch(error){}return ITERATION_SUPPORT}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var isCallable=__w_pdfjs_require__(23),isObject=__w_pdfjs_require__(22),setPrototypeOf=__w_pdfjs_require__(84);module.exports=function($this,dummy,Wrapper){var NewTarget,NewTargetPrototype;return setPrototypeOf&&isCallable(NewTarget=dummy.constructor)&&NewTarget!==Wrapper&&isObject(NewTargetPrototype=NewTarget.prototype)&&NewTargetPrototype!==Wrapper.prototype&&setPrototypeOf($this,NewTargetPrototype),$this}},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var defineProperty=__w_pdfjs_require__(46).f,create=__w_pdfjs_require__(71),defineBuiltIns=__w_pdfjs_require__(115),bind=__w_pdfjs_require__(106),anInstance=__w_pdfjs_require__(111),iterate=__w_pdfjs_require__(105),defineIterator=__w_pdfjs_require__(89),setSpecies=__w_pdfjs_require__(116),DESCRIPTORS=__w_pdfjs_require__(9),fastKey=__w_pdfjs_require__(98).fastKey,InternalStateModule=__w_pdfjs_require__(53),setInternalState=InternalStateModule.set,internalStateGetterFor=InternalStateModule.getterFor;module.exports={getConstructor:function(wrapper,CONSTRUCTOR_NAME,IS_MAP,ADDER){var Constructor=wrapper((function(that,iterable){anInstance(that,Prototype),setInternalState(that,{type:CONSTRUCTOR_NAME,index:create(null),first:void 0,last:void 0,size:0}),DESCRIPTORS||(that.size=0),null!=iterable&&iterate(iterable,that[ADDER],{that:that,AS_ENTRIES:IS_MAP})})),Prototype=Constructor.prototype,getInternalState=internalStateGetterFor(CONSTRUCTOR_NAME),define=function(that,key,value){var previous,index,state=getInternalState(that),entry=getEntry(that,key);return entry?entry.value=value:(state.last=entry={index:index=fastKey(key,!0),key:key,value:value,previous:previous=state.last,next:void 0,removed:!1},state.first||(state.first=entry),previous&&(previous.next=entry),DESCRIPTORS?state.size++:that.size++,"F"!==index&&(state.index[index]=entry)),that},getEntry=function(that,key){var entry,state=getInternalState(that),index=fastKey(key);if("F"!==index)return state.index[index];for(entry=state.first;entry;entry=entry.next)if(entry.key==key)return entry};return defineBuiltIns(Prototype,{clear:function(){for(var state=getInternalState(this),data=state.index,entry=state.first;entry;)entry.removed=!0,entry.previous&&(entry.previous=entry.previous.next=void 0),delete data[entry.index],entry=entry.next;state.first=state.last=void 0,DESCRIPTORS?state.size=0:this.size=0},delete:function(key){var state=getInternalState(this),entry=getEntry(this,key);if(entry){var next=entry.next,prev=entry.previous;delete state.index[entry.index],entry.removed=!0,prev&&(prev.next=next),next&&(next.previous=prev),state.first==entry&&(state.first=next),state.last==entry&&(state.last=prev),DESCRIPTORS?state.size--:this.size--}return!!entry},forEach:function(callbackfn){for(var entry,state=getInternalState(this),boundFunction=bind(callbackfn,arguments.length>1?arguments[1]:void 0);entry=entry?entry.next:state.first;)for(boundFunction(entry.value,entry.key,this);entry&&entry.removed;)entry=entry.previous},has:function(key){return!!getEntry(this,key)}}),defineBuiltIns(Prototype,IS_MAP?{get:function(key){var entry=getEntry(this,key);return entry&&entry.value},set:function(key,value){return define(this,0===key?0:key,value)}}:{add:function(value){return define(this,value=0===value?0:value,value)}}),DESCRIPTORS&&defineProperty(Prototype,"size",{get:function(){return getInternalState(this).size}}),Constructor},setStrong:function(Constructor,CONSTRUCTOR_NAME,IS_MAP){var ITERATOR_NAME=CONSTRUCTOR_NAME+" Iterator",getInternalCollectionState=internalStateGetterFor(CONSTRUCTOR_NAME),getInternalIteratorState=internalStateGetterFor(ITERATOR_NAME);defineIterator(Constructor,CONSTRUCTOR_NAME,(function(iterated,kind){setInternalState(this,{type:ITERATOR_NAME,target:iterated,state:getInternalCollectionState(iterated),kind:kind,last:void 0})}),(function(){for(var state=getInternalIteratorState(this),kind=state.kind,entry=state.last;entry&&entry.removed;)entry=entry.previous;return state.target&&(state.last=entry=entry?entry.next:state.state.first)?"keys"==kind?{value:entry.key,done:!1}:"values"==kind?{value:entry.value,done:!1}:{value:[entry.key,entry.value],done:!1}:(state.target=void 0,{value:void 0,done:!0})}),IS_MAP?"entries":"values",!IS_MAP,!0),setSpecies(CONSTRUCTOR_NAME)}}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var defineBuiltIn=__w_pdfjs_require__(49);module.exports=function(target,src,options){for(var key in src)defineBuiltIn(target,key,src[key],options);return target}},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var getBuiltIn=__w_pdfjs_require__(25),definePropertyModule=__w_pdfjs_require__(46),wellKnownSymbol=__w_pdfjs_require__(35),DESCRIPTORS=__w_pdfjs_require__(9),SPECIES=wellKnownSymbol("species");module.exports=function(CONSTRUCTOR_NAME){var Constructor=getBuiltIn(CONSTRUCTOR_NAME),defineProperty=definePropertyModule.f;DESCRIPTORS&&Constructor&&!Constructor[SPECIES]&&defineProperty(Constructor,SPECIES,{configurable:!0,get:function(){return this}})}},function(__unused_webpack_module,__unused_webpack_exports,__w_pdfjs_require__){__w_pdfjs_require__(118)},function(__unused_webpack_module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";__w_pdfjs_require__(97)("Set",(function(init){return function(){return init(this,arguments.length?arguments[0]:void 0)}}),__w_pdfjs_require__(114))},function(__unused_webpack_module,__unused_webpack_exports,__w_pdfjs_require__){var structuredCloneImplementation,IS_PURE=__w_pdfjs_require__(37),$=__w_pdfjs_require__(6),global=__w_pdfjs_require__(7),getBuiltin=__w_pdfjs_require__(25),uncurryThis=__w_pdfjs_require__(17),fails=__w_pdfjs_require__(10),uid=__w_pdfjs_require__(42),isCallable=__w_pdfjs_require__(23),isConstructor=__w_pdfjs_require__(120),isObject=__w_pdfjs_require__(22),isSymbol=__w_pdfjs_require__(24),iterate=__w_pdfjs_require__(105),anObject=__w_pdfjs_require__(48),classof=__w_pdfjs_require__(80),hasOwn=__w_pdfjs_require__(40),createProperty=__w_pdfjs_require__(101),createNonEnumerableProperty=__w_pdfjs_require__(45),lengthOfArrayLike=__w_pdfjs_require__(65),validateArgumentsLength=__w_pdfjs_require__(121),getRegExpFlags=__w_pdfjs_require__(122),ERROR_STACK_INSTALLABLE=__w_pdfjs_require__(124),V8=__w_pdfjs_require__(29),IS_BROWSER=__w_pdfjs_require__(125),IS_DENO=__w_pdfjs_require__(126),IS_NODE=__w_pdfjs_require__(127),Object=global.Object,Date=global.Date,Error=global.Error,EvalError=global.EvalError,RangeError=global.RangeError,ReferenceError=global.ReferenceError,SyntaxError=global.SyntaxError,TypeError=global.TypeError,URIError=global.URIError,PerformanceMark=global.PerformanceMark,WebAssembly=global.WebAssembly,CompileError=WebAssembly&&WebAssembly.CompileError||Error,LinkError=WebAssembly&&WebAssembly.LinkError||Error,RuntimeError=WebAssembly&&WebAssembly.RuntimeError||Error,DOMException=getBuiltin("DOMException"),Set=getBuiltin("Set"),Map=getBuiltin("Map"),MapPrototype=Map.prototype,mapHas=uncurryThis(MapPrototype.has),mapGet=uncurryThis(MapPrototype.get),mapSet=uncurryThis(MapPrototype.set),setAdd=uncurryThis(Set.prototype.add),objectKeys=getBuiltin("Object","keys"),push=uncurryThis([].push),booleanValueOf=uncurryThis((!0).valueOf),numberValueOf=uncurryThis(1..valueOf),stringValueOf=uncurryThis("".valueOf),getTime=uncurryThis(Date.prototype.getTime),PERFORMANCE_MARK=uid("structuredClone"),checkBasicSemantic=function(structuredCloneImplementation){return!fails((function(){var set1=new global.Set([7]),set2=structuredCloneImplementation(set1),number=structuredCloneImplementation(Object(7));return set2==set1||!set2.has(7)||"object"!=_typeof(number)||7!=number}))&&structuredCloneImplementation},checkErrorsCloning=function(structuredCloneImplementation,$Error){return!fails((function(){var error=new $Error,test=structuredCloneImplementation({a:error,b:error});return!(test&&test.a===test.b&&test.a instanceof $Error&&test.a.stack===error.stack)}))},nativeStructuredClone=global.structuredClone,FORCED_REPLACEMENT=IS_PURE||!checkErrorsCloning(nativeStructuredClone,Error)||!checkErrorsCloning(nativeStructuredClone,DOMException)||(structuredCloneImplementation=nativeStructuredClone,!!fails((function(){var test=structuredCloneImplementation(new global.AggregateError([1],PERFORMANCE_MARK,{cause:3}));return"AggregateError"!=test.name||1!=test.errors[0]||test.message!=PERFORMANCE_MARK||3!=test.cause}))),structuredCloneFromMark=!nativeStructuredClone&&checkBasicSemantic((function(value){return new PerformanceMark(PERFORMANCE_MARK,{detail:value}).detail})),nativeRestrictedStructuredClone=checkBasicSemantic(nativeStructuredClone)||structuredCloneFromMark,throwUncloneable=function(type){throw new DOMException("Uncloneable type: "+type,"DataCloneError")},throwUnpolyfillable=function(type,kind){throw new DOMException((kind||"Cloning")+" of "+type+" cannot be properly polyfilled in this engine","DataCloneError")},structuredCloneInternal=function structuredCloneInternal(value,map){if(isSymbol(value)&&throwUncloneable("Symbol"),!isObject(value))return value;if(map){if(mapHas(map,value))return mapGet(map,value)}else map=new Map;var C,name,cloned,dataTransfer,i,length,keys,key,source,target,type=classof(value),deep=!1;switch(type){case"Array":cloned=[],deep=!0;break;case"Object":cloned={},deep=!0;break;case"Map":cloned=new Map,deep=!0;break;case"Set":cloned=new Set,deep=!0;break;case"RegExp":cloned=new RegExp(value.source,getRegExpFlags(value));break;case"Error":switch(name=value.name){case"AggregateError":cloned=getBuiltin("AggregateError")([]);break;case"EvalError":cloned=EvalError();break;case"RangeError":cloned=RangeError();break;case"ReferenceError":cloned=ReferenceError();break;case"SyntaxError":cloned=SyntaxError();break;case"TypeError":cloned=TypeError();break;case"URIError":cloned=URIError();break;case"CompileError":cloned=CompileError();break;case"LinkError":cloned=LinkError();break;case"RuntimeError":cloned=RuntimeError();break;default:cloned=Error()}deep=!0;break;case"DOMException":cloned=new DOMException(value.message,value.name),deep=!0;break;case"DataView":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"BigInt64Array":case"BigUint64Array":C=global[type],isObject(C)||throwUnpolyfillable(type),cloned=new C(structuredCloneInternal(value.buffer,map),value.byteOffset,"DataView"===type?value.byteLength:value.length);break;case"DOMQuad":try{cloned=new DOMQuad(structuredCloneInternal(value.p1,map),structuredCloneInternal(value.p2,map),structuredCloneInternal(value.p3,map),structuredCloneInternal(value.p4,map))}catch(error){nativeRestrictedStructuredClone?cloned=nativeRestrictedStructuredClone(value):throwUnpolyfillable(type)}break;case"FileList":if(C=global.DataTransfer,isConstructor(C)){for(dataTransfer=new C,i=0,length=lengthOfArrayLike(value);i<length;i++)dataTransfer.items.add(structuredCloneInternal(value[i],map));cloned=dataTransfer.files}else nativeRestrictedStructuredClone?cloned=nativeRestrictedStructuredClone(value):throwUnpolyfillable(type);break;case"ImageData":try{cloned=new ImageData(structuredCloneInternal(value.data,map),value.width,value.height,{colorSpace:value.colorSpace})}catch(error){nativeRestrictedStructuredClone?cloned=nativeRestrictedStructuredClone(value):throwUnpolyfillable(type)}break;default:if(nativeRestrictedStructuredClone)cloned=nativeRestrictedStructuredClone(value);else switch(type){case"BigInt":cloned=Object(value.valueOf());break;case"Boolean":cloned=Object(booleanValueOf(value));break;case"Number":cloned=Object(numberValueOf(value));break;case"String":cloned=Object(stringValueOf(value));break;case"Date":cloned=new Date(getTime(value));break;case"ArrayBuffer":(C=global.DataView)||"function"==typeof value.slice||throwUnpolyfillable(type);try{if("function"==typeof value.slice)cloned=value.slice(0);else for(length=value.byteLength,cloned=new ArrayBuffer(length),source=new C(value),target=new C(cloned),i=0;i<length;i++)target.setUint8(i,source.getUint8(i))}catch(error){throw new DOMException("ArrayBuffer is detached","DataCloneError")}break;case"SharedArrayBuffer":cloned=value;break;case"Blob":try{cloned=value.slice(0,value.size,value.type)}catch(error){throwUnpolyfillable(type)}break;case"DOMPoint":case"DOMPointReadOnly":C=global[type];try{cloned=C.fromPoint?C.fromPoint(value):new C(value.x,value.y,value.z,value.w)}catch(error){throwUnpolyfillable(type)}break;case"DOMRect":case"DOMRectReadOnly":C=global[type];try{cloned=C.fromRect?C.fromRect(value):new C(value.x,value.y,value.width,value.height)}catch(error){throwUnpolyfillable(type)}break;case"DOMMatrix":case"DOMMatrixReadOnly":C=global[type];try{cloned=C.fromMatrix?C.fromMatrix(value):new C(value)}catch(error){throwUnpolyfillable(type)}break;case"AudioData":case"VideoFrame":isCallable(value.clone)||throwUnpolyfillable(type);try{cloned=value.clone()}catch(error){throwUncloneable(type)}break;case"File":try{cloned=new File([value],value.name,value)}catch(error){throwUnpolyfillable(type)}break;case"CryptoKey":case"GPUCompilationMessage":case"GPUCompilationInfo":case"ImageBitmap":case"RTCCertificate":case"WebAssembly.Module":throwUnpolyfillable(type);default:throwUncloneable(type)}}if(mapSet(map,value,cloned),deep)switch(type){case"Array":case"Object":for(keys=objectKeys(value),i=0,length=lengthOfArrayLike(keys);i<length;i++)key=keys[i],createProperty(cloned,key,structuredCloneInternal(value[key],map));break;case"Map":value.forEach((function(v,k){mapSet(cloned,structuredCloneInternal(k,map),structuredCloneInternal(v,map))}));break;case"Set":value.forEach((function(v){setAdd(cloned,structuredCloneInternal(v,map))}));break;case"Error":createNonEnumerableProperty(cloned,"message",structuredCloneInternal(value.message,map)),hasOwn(value,"cause")&&createNonEnumerableProperty(cloned,"cause",structuredCloneInternal(value.cause,map)),"AggregateError"==name&&(cloned.errors=structuredCloneInternal(value.errors,map));case"DOMException":ERROR_STACK_INSTALLABLE&&createNonEnumerableProperty(cloned,"stack",structuredCloneInternal(value.stack,map))}return cloned},PROPER_TRANSFER=nativeStructuredClone&&!fails((function(){if(IS_DENO&&V8>92||IS_NODE&&V8>94||IS_BROWSER&&V8>97)return!1;var buffer=new ArrayBuffer(8),clone=nativeStructuredClone(buffer,{transfer:[buffer]});return 0!=buffer.byteLength||8!=clone.byteLength}));$({global:!0,enumerable:!0,sham:!PROPER_TRANSFER,forced:FORCED_REPLACEMENT},{structuredClone:function(value){var map,options=validateArgumentsLength(arguments.length,1)>1&&null!=arguments[1]?anObject(arguments[1]):void 0,transfer=options?options.transfer:void 0;return void 0!==transfer&&function(rawTransfer,map){if(!isObject(rawTransfer))throw TypeError("Transfer option cannot be converted to a sequence");var transfer=[];iterate(rawTransfer,(function(value){push(transfer,anObject(value))}));var value,type,C,transferredArray,transferred,canvas,i=0,length=lengthOfArrayLike(transfer);if(PROPER_TRANSFER)for(transferredArray=nativeStructuredClone(transfer,{transfer:transfer});i<length;)mapSet(map,transfer[i],transferredArray[i++]);else for(;i<length;){if(value=transfer[i++],mapHas(map,value))throw new DOMException("Duplicate transferable","DataCloneError");switch(type=classof(value)){case"ImageBitmap":C=global.OffscreenCanvas,isConstructor(C)||throwUnpolyfillable(type,"Transferring");try{(canvas=new C(value.width,value.height)).getContext("bitmaprenderer").transferFromImageBitmap(value),transferred=canvas.transferToImageBitmap()}catch(error){}break;case"AudioData":case"VideoFrame":isCallable(value.clone)&&isCallable(value.close)||throwUnpolyfillable(type,"Transferring");try{transferred=value.clone(),value.close()}catch(error){}break;case"ArrayBuffer":case"MessagePort":case"OffscreenCanvas":case"ReadableStream":case"TransformStream":case"WritableStream":throwUnpolyfillable(type,"Transferring")}if(void 0===transferred)throw new DOMException("This object cannot be transferred: "+type,"DataCloneError");mapSet(map,value,transferred)}}(transfer,map=new Map),structuredCloneInternal(value,map)}})},function(module,__unused_webpack_exports,__w_pdfjs_require__){var uncurryThis=__w_pdfjs_require__(17),fails=__w_pdfjs_require__(10),isCallable=__w_pdfjs_require__(23),classof=__w_pdfjs_require__(80),getBuiltIn=__w_pdfjs_require__(25),inspectSource=__w_pdfjs_require__(52),noop=function(){},empty=[],construct=getBuiltIn("Reflect","construct"),constructorRegExp=/^\s*(?:class|function)\b/,exec=uncurryThis(constructorRegExp.exec),INCORRECT_TO_STRING=!constructorRegExp.exec(noop),isConstructorModern=function(argument){if(!isCallable(argument))return!1;try{return construct(noop,empty,argument),!0}catch(error){return!1}},isConstructorLegacy=function(argument){if(!isCallable(argument))return!1;switch(classof(argument)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return INCORRECT_TO_STRING||!!exec(constructorRegExp,inspectSource(argument))}catch(error){return!0}};isConstructorLegacy.sham=!0,module.exports=!construct||fails((function(){var called;return isConstructorModern(isConstructorModern.call)||!isConstructorModern(Object)||!isConstructorModern((function(){called=!0}))||called}))?isConstructorLegacy:isConstructorModern},function(module){var $TypeError=TypeError;module.exports=function(passed,required){if(passed<required)throw $TypeError("Not enough arguments");return passed}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var call=__w_pdfjs_require__(11),hasOwn=__w_pdfjs_require__(40),isPrototypeOf=__w_pdfjs_require__(26),regExpFlags=__w_pdfjs_require__(123),RegExpPrototype=RegExp.prototype;module.exports=function(R){var flags=R.flags;return void 0!==flags||"flags"in RegExpPrototype||hasOwn(R,"flags")||!isPrototypeOf(RegExpPrototype,R)?flags:call(regExpFlags,R)}},function(module,__unused_webpack_exports,__w_pdfjs_require__){"use strict";var anObject=__w_pdfjs_require__(48);module.exports=function(){var that=anObject(this),result="";return that.hasIndices&&(result+="d"),that.global&&(result+="g"),that.ignoreCase&&(result+="i"),that.multiline&&(result+="m"),that.dotAll&&(result+="s"),that.unicode&&(result+="u"),that.unicodeSets&&(result+="v"),that.sticky&&(result+="y"),result}},function(module,__unused_webpack_exports,__w_pdfjs_require__){var fails=__w_pdfjs_require__(10),createPropertyDescriptor=__w_pdfjs_require__(14);module.exports=!fails((function(){var error=Error("a");return!("stack"in error)||(Object.defineProperty(error,"stack",createPropertyDescriptor(1,7)),7!==error.stack)}))},function(module,__unused_webpack_exports,__w_pdfjs_require__){var IS_DENO=__w_pdfjs_require__(126),IS_NODE=__w_pdfjs_require__(127);module.exports=!IS_DENO&&!IS_NODE&&"object"==("undefined"==typeof window?"undefined":_typeof(window))&&"object"==("undefined"==typeof document?"undefined":_typeof(document))},function(module){module.exports="object"==("undefined"==typeof Deno?"undefined":_typeof(Deno))&&Deno&&"object"==_typeof(Deno.version)},function(module,__unused_webpack_exports,__w_pdfjs_require__){var classof=__w_pdfjs_require__(18),global=__w_pdfjs_require__(7);module.exports="process"==classof(global.process)},function(module,__unused_webpack_exports,__w_pdfjs_require__){var global=__w_pdfjs_require__(7);module.exports=global},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.build=exports.RenderTask=exports.PDFWorkerUtil=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCanvasFactory=exports.DefaultCMapReaderFactory=void 0,exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(130),_display_utils=__w_pdfjs_require__(133),_font_loader=__w_pdfjs_require__(136),_canvas=__w_pdfjs_require__(137),_worker_options=__w_pdfjs_require__(140),_is_node=__w_pdfjs_require__(3),_message_handler=__w_pdfjs_require__(141),_metadata=__w_pdfjs_require__(142),_optional_content_config=__w_pdfjs_require__(143),_transport_stream=__w_pdfjs_require__(144),_xfa_text=__w_pdfjs_require__(145);function _classPrivateMethodInitSpec(obj,privateSet){_checkPrivateRedeclaration(obj,privateSet),privateSet.add(obj)}function _classPrivateMethodGet(receiver,privateSet,fn){if(!privateSet.has(receiver))throw new TypeError("attempted to get private field on non-instance");return fn}function _classPrivateFieldInitSpec(obj,privateMap,value){_checkPrivateRedeclaration(obj,privateMap),privateMap.set(obj,value)}function _checkPrivateRedeclaration(obj,privateCollection){if(privateCollection.has(obj))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet(receiver,privateMap,value){return _classApplyDescriptorSet(receiver,_classExtractFieldDescriptor(receiver,privateMap,"set"),value),value}function _classPrivateFieldGet(receiver,privateMap){return _classApplyDescriptorGet(receiver,_classExtractFieldDescriptor(receiver,privateMap,"get"))}function _classExtractFieldDescriptor(receiver,privateMap,action){if(!privateMap.has(receiver))throw new TypeError("attempted to "+action+" private field on non-instance");return privateMap.get(receiver)}function _classStaticPrivateFieldSpecSet(receiver,classConstructor,descriptor,value){return _classCheckPrivateStaticAccess(receiver,classConstructor),_classCheckPrivateStaticFieldDescriptor(descriptor,"set"),_classApplyDescriptorSet(receiver,descriptor,value),value}function _classApplyDescriptorSet(receiver,descriptor,value){if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}function _classStaticPrivateFieldSpecGet(receiver,classConstructor,descriptor){return _classCheckPrivateStaticAccess(receiver,classConstructor),_classCheckPrivateStaticFieldDescriptor(descriptor,"get"),_classApplyDescriptorGet(receiver,descriptor)}function _classCheckPrivateStaticFieldDescriptor(descriptor,action){if(void 0===descriptor)throw new TypeError("attempted to "+action+" private static field before its declaration")}function _classCheckPrivateStaticAccess(receiver,classConstructor){if(receiver!==classConstructor)throw new TypeError("Private static access of wrong provenance")}function _classApplyDescriptorGet(receiver,descriptor){return descriptor.get?descriptor.get.call(receiver):descriptor.value}var DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DefaultCanvasFactory=_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;var DefaultCMapReaderFactory=_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;var DefaultStandardFontDataFactory=_display_utils.DOMStandardFontDataFactory,createPDFNetworkStream;if(exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory,_is_node.isNodeJS){var _w_pdfjs_require__=__w_pdfjs_require__(146),NodeCanvasFactory=_w_pdfjs_require__.NodeCanvasFactory,NodeCMapReaderFactory=_w_pdfjs_require__.NodeCMapReaderFactory,NodeStandardFontDataFactory=_w_pdfjs_require__.NodeStandardFontDataFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory=NodeCanvasFactory,exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory=NodeCMapReaderFactory,exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory=NodeStandardFontDataFactory}function setPDFNetworkStreamFactory(pdfNetworkStreamFactory){createPDFNetworkStream=pdfNetworkStreamFactory}function getDocument(src){var source,task=new PDFDocumentLoadingTask;if("string"==typeof src||src instanceof URL)source={url:src};else if((0,_util.isArrayBuffer)(src))source={data:src};else if(src instanceof PDFDataRangeTransport)source={range:src};else{if("object"!==_typeof(src))throw new Error("Invalid parameter in getDocument, need either string, URL, TypedArray, or parameter object.");if(!src.url&&!src.data&&!src.range)throw new Error("Invalid parameter object: need either .data, .range or .url");source=src}var params=Object.create(null),rangeTransport=null,worker=null;for(var key in source){var value=source[key];switch(key){case"url":if("undefined"!=typeof window)try{params[key]=new URL(value,window.location).href;continue}catch(ex){(0,_util.warn)('Cannot create valid URL: "'.concat(ex,'".'))}else if("string"==typeof value||value instanceof URL){params[key]=value.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":rangeTransport=value;continue;case"worker":worker=value;continue;case"data":if(_is_node.isNodeJS&&"undefined"!=typeof Buffer&&value instanceof Buffer)params[key]=new Uint8Array(value);else{if(value instanceof Uint8Array)break;if("string"==typeof value)params[key]=(0,_util.stringToBytes)(value);else if("object"!==_typeof(value)||null===value||isNaN(value.length)){if(!(0,_util.isArrayBuffer)(value))throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.");params[key]=new Uint8Array(value)}else params[key]=new Uint8Array(value)}continue}params[key]=value}if(params.CMapReaderFactory=params.CMapReaderFactory||DefaultCMapReaderFactory,params.StandardFontDataFactory=params.StandardFontDataFactory||DefaultStandardFontDataFactory,params.ignoreErrors=!0!==params.stopAtErrors,params.fontExtraProperties=!0===params.fontExtraProperties,params.pdfBug=!0===params.pdfBug,params.enableXfa=!0===params.enableXfa,(!Number.isInteger(params.rangeChunkSize)||params.rangeChunkSize<1)&&(params.rangeChunkSize=DEFAULT_RANGE_CHUNK_SIZE),("string"!=typeof params.docBaseUrl||(0,_display_utils.isDataScheme)(params.docBaseUrl))&&(params.docBaseUrl=null),(!Number.isInteger(params.maxImageSize)||params.maxImageSize<-1)&&(params.maxImageSize=-1),"string"!=typeof params.cMapUrl&&(params.cMapUrl=null),"string"!=typeof params.standardFontDataUrl&&(params.standardFontDataUrl=null),"boolean"!=typeof params.useWorkerFetch&&(params.useWorkerFetch=params.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&params.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),"boolean"!=typeof params.isEvalSupported&&(params.isEvalSupported=!0),"boolean"!=typeof params.disableFontFace&&(params.disableFontFace=_is_node.isNodeJS),"boolean"!=typeof params.useSystemFonts&&(params.useSystemFonts=!_is_node.isNodeJS&&!params.disableFontFace),"object"===_typeof(params.ownerDocument)&&null!==params.ownerDocument||(params.ownerDocument=globalThis.document),"boolean"!=typeof params.disableRange&&(params.disableRange=!1),"boolean"!=typeof params.disableStream&&(params.disableStream=!1),"boolean"!=typeof params.disableAutoFetch&&(params.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(params.verbosity),!worker){var workerParams={verbosity:params.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};worker=workerParams.port?PDFWorker.fromPort(workerParams):new PDFWorker(workerParams),task._worker=worker}var docId=task.docId;return worker.promise.then((function(){if(task.destroyed)throw new Error("Loading aborted");var workerIdPromise=_fetchDocument(worker,params,rangeTransport,docId),networkStreamPromise=new Promise((function(resolve){var networkStream;rangeTransport?networkStream=new _transport_stream.PDFDataTransportStream({length:params.length,initialData:params.initialData,progressiveDone:params.progressiveDone,contentDispositionFilename:params.contentDispositionFilename,disableRange:params.disableRange,disableStream:params.disableStream},rangeTransport):params.data||(networkStream=createPDFNetworkStream({url:params.url,length:params.length,httpHeaders:params.httpHeaders,withCredentials:params.withCredentials,rangeChunkSize:params.rangeChunkSize,disableRange:params.disableRange,disableStream:params.disableStream})),resolve(networkStream)}));return Promise.all([workerIdPromise,networkStreamPromise]).then((function(_ref){var _ref16=_slicedToArray(_ref,2),workerId=_ref16[0],networkStream=_ref16[1];if(task.destroyed)throw new Error("Loading aborted");var messageHandler=new _message_handler.MessageHandler(docId,workerId,worker.port),transport=new WorkerTransport(messageHandler,task,networkStream,params);task._transport=transport,messageHandler.send("Ready",null)}))})).catch(task._capability.reject),task}function _fetchDocument(_x,_x2,_x3,_x4){return _fetchDocument2.apply(this,arguments)}function _fetchDocument2(){return(_fetchDocument2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee7(worker,source,pdfDataRangeTransport,docId){var workerId;return _regeneratorRuntime().wrap((function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(!worker.destroyed){_context7.next=2;break}throw new Error("Worker was destroyed");case 2:return pdfDataRangeTransport&&(source.length=pdfDataRangeTransport.length,source.initialData=pdfDataRangeTransport.initialData,source.progressiveDone=pdfDataRangeTransport.progressiveDone,source.contentDispositionFilename=pdfDataRangeTransport.contentDispositionFilename),_context7.next=5,worker.messageHandler.sendWithPromise("GetDocRequest",{docId:docId,apiVersion:"2.16.105",source:{data:source.data,url:source.url,password:source.password,disableAutoFetch:source.disableAutoFetch,rangeChunkSize:source.rangeChunkSize,length:source.length},maxImageSize:source.maxImageSize,disableFontFace:source.disableFontFace,docBaseUrl:source.docBaseUrl,ignoreErrors:source.ignoreErrors,isEvalSupported:source.isEvalSupported,fontExtraProperties:source.fontExtraProperties,enableXfa:source.enableXfa,useSystemFonts:source.useSystemFonts,cMapUrl:source.useWorkerFetch?source.cMapUrl:null,standardFontDataUrl:source.useWorkerFetch?source.standardFontDataUrl:null});case 5:if(workerId=_context7.sent,source.data&&(source.data=null),!worker.destroyed){_context7.next=9;break}throw new Error("Worker was destroyed");case 9:return _context7.abrupt("return",workerId);case 10:case"end":return _context7.stop()}}),_callee7)})))).apply(this,arguments)}var PDFDocumentLoadingTask=function(){function PDFDocumentLoadingTask(){var _PDFDocumentLoadingTa,_PDFDocumentLoadingTa2;_classCallCheck(this,PDFDocumentLoadingTask),this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d".concat((_classStaticPrivateFieldSpecSet(PDFDocumentLoadingTask,PDFDocumentLoadingTask,_docId,(_PDFDocumentLoadingTa=_classStaticPrivateFieldSpecGet(PDFDocumentLoadingTask,PDFDocumentLoadingTask,_docId),_PDFDocumentLoadingTa2=_PDFDocumentLoadingTa++,_PDFDocumentLoadingTa)),_PDFDocumentLoadingTa2)),this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}var _destroy;return _createClass(PDFDocumentLoadingTask,[{key:"promise",get:function(){return this._capability.promise}},{key:"destroy",value:(_destroy=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(){var _this$_transport;return _regeneratorRuntime().wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return this.destroyed=!0,_context.next=3,null===(_this$_transport=this._transport)||void 0===_this$_transport?void 0:_this$_transport.destroy();case 3:this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null);case 5:case"end":return _context.stop()}}),_callee,this)}))),function(){return _destroy.apply(this,arguments)})}]),PDFDocumentLoadingTask}();exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;var _docId={writable:!0,value:0},PDFDataRangeTransport=function(){function PDFDataRangeTransport(length,initialData){_classCallCheck(this,PDFDataRangeTransport);var progressiveDone=arguments.length>2&&void 0!==arguments[2]&&arguments[2],contentDispositionFilename=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.length=length,this.initialData=initialData,this.progressiveDone=progressiveDone,this.contentDispositionFilename=contentDispositionFilename,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}return _createClass(PDFDataRangeTransport,[{key:"addRangeListener",value:function(listener){this._rangeListeners.push(listener)}},{key:"addProgressListener",value:function(listener){this._progressListeners.push(listener)}},{key:"addProgressiveReadListener",value:function(listener){this._progressiveReadListeners.push(listener)}},{key:"addProgressiveDoneListener",value:function(listener){this._progressiveDoneListeners.push(listener)}},{key:"onDataRange",value:function(begin,chunk){var _step2,_iterator2=_createForOfIteratorHelper(this._rangeListeners);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)(0,_step2.value)(begin,chunk)}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}},{key:"onDataProgress",value:function(loaded,total){var _this4=this;this._readyCapability.promise.then((function(){var _step3,_iterator3=_createForOfIteratorHelper(_this4._progressListeners);try{for(_iterator3.s();!(_step3=_iterator3.n()).done;)(0,_step3.value)(loaded,total)}catch(err){_iterator3.e(err)}finally{_iterator3.f()}}))}},{key:"onDataProgressiveRead",value:function(chunk){var _this5=this;this._readyCapability.promise.then((function(){var _step4,_iterator4=_createForOfIteratorHelper(_this5._progressiveReadListeners);try{for(_iterator4.s();!(_step4=_iterator4.n()).done;)(0,_step4.value)(chunk)}catch(err){_iterator4.e(err)}finally{_iterator4.f()}}))}},{key:"onDataProgressiveDone",value:function(){var _this6=this;this._readyCapability.promise.then((function(){var _step5,_iterator5=_createForOfIteratorHelper(_this6._progressiveDoneListeners);try{for(_iterator5.s();!(_step5=_iterator5.n()).done;)(0,_step5.value)()}catch(err){_iterator5.e(err)}finally{_iterator5.f()}}))}},{key:"transportReady",value:function(){this._readyCapability.resolve()}},{key:"requestDataRange",value:function(begin,end){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}},{key:"abort",value:function(){}}]),PDFDataRangeTransport}();exports.PDFDataRangeTransport=PDFDataRangeTransport;var PDFDocumentProxy=function(){function PDFDocumentProxy(pdfInfo,transport){var _value,_this7=this;_classCallCheck(this,PDFDocumentProxy),this._pdfInfo=pdfInfo,this._transport=transport,Object.defineProperty(this,"fingerprint",{get:function(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}}),Object.defineProperty(this,"getStats",{value:(_value=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(){return _regeneratorRuntime().wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return(0,_display_utils.deprecated)("`PDFDocumentProxy.getStats`, please use the `PDFDocumentProxy.stats`-getter instead."),_context2.abrupt("return",_this7.stats||{streamTypes:{},fontTypes:{}});case 2:case"end":return _context2.stop()}}),_callee2)}))),function(){return _value.apply(this,arguments)})})}return _createClass(PDFDocumentProxy,[{key:"annotationStorage",get:function(){return this._transport.annotationStorage}},{key:"numPages",get:function(){return this._pdfInfo.numPages}},{key:"fingerprints",get:function(){return this._pdfInfo.fingerprints}},{key:"stats",get:function(){return this._transport.stats}},{key:"isPureXfa",get:function(){return!!this._transport._htmlForXfa}},{key:"allXfaHtml",get:function(){return this._transport._htmlForXfa}},{key:"getPage",value:function(pageNumber){return this._transport.getPage(pageNumber)}},{key:"getPageIndex",value:function(ref){return this._transport.getPageIndex(ref)}},{key:"getDestinations",value:function(){return this._transport.getDestinations()}},{key:"getDestination",value:function(id){return this._transport.getDestination(id)}},{key:"getPageLabels",value:function(){return this._transport.getPageLabels()}},{key:"getPageLayout",value:function(){return this._transport.getPageLayout()}},{key:"getPageMode",value:function(){return this._transport.getPageMode()}},{key:"getViewerPreferences",value:function(){return this._transport.getViewerPreferences()}},{key:"getOpenAction",value:function(){return this._transport.getOpenAction()}},{key:"getAttachments",value:function(){return this._transport.getAttachments()}},{key:"getJavaScript",value:function(){return this._transport.getJavaScript()}},{key:"getJSActions",value:function(){return this._transport.getDocJSActions()}},{key:"getOutline",value:function(){return this._transport.getOutline()}},{key:"getOptionalContentConfig",value:function(){return this._transport.getOptionalContentConfig()}},{key:"getPermissions",value:function(){return this._transport.getPermissions()}},{key:"getMetadata",value:function(){return this._transport.getMetadata()}},{key:"getMarkInfo",value:function(){return this._transport.getMarkInfo()}},{key:"getData",value:function(){return this._transport.getData()}},{key:"getDownloadInfo",value:function(){return this._transport.downloadInfoCapability.promise}},{key:"cleanup",value:function(){var keepLoadedFonts=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._transport.startCleanup(keepLoadedFonts||this.isPureXfa)}},{key:"destroy",value:function(){return this.loadingTask.destroy()}},{key:"loadingParams",get:function(){return this._transport.loadingParams}},{key:"loadingTask",get:function(){return this._transport.loadingTask}},{key:"saveDocument",value:function(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}},{key:"getFieldObjects",value:function(){return this._transport.getFieldObjects()}},{key:"hasJSActions",value:function(){return this._transport.hasJSActions()}},{key:"getCalculationOrderIds",value:function(){return this._transport.getCalculationOrderIds()}}]),PDFDocumentProxy}();exports.PDFDocumentProxy=PDFDocumentProxy;var PDFPageProxy=function(){function PDFPageProxy(pageIndex,pageInfo,transport,ownerDocument){_classCallCheck(this,PDFPageProxy);var pdfBug=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this._pageIndex=pageIndex,this._pageInfo=pageInfo,this._ownerDocument=ownerDocument,this._transport=transport,this._stats=pdfBug?new _display_utils.StatTimer:null,this._pdfBug=pdfBug,this.commonObjs=transport.commonObjs,this.objs=new PDFObjects,this._bitmaps=new Set,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}var _getXfa;return _createClass(PDFPageProxy,[{key:"pageNumber",get:function(){return this._pageIndex+1}},{key:"rotate",get:function(){return this._pageInfo.rotate}},{key:"ref",get:function(){return this._pageInfo.ref}},{key:"userUnit",get:function(){return this._pageInfo.userUnit}},{key:"view",get:function(){return this._pageInfo.view}},{key:"getViewport",value:function(){var _ref17=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},scale=_ref17.scale,_ref17$rotation=_ref17.rotation,rotation=void 0===_ref17$rotation?this.rotate:_ref17$rotation,_ref17$offsetX=_ref17.offsetX,offsetX=void 0===_ref17$offsetX?0:_ref17$offsetX,_ref17$offsetY=_ref17.offsetY,offsetY=void 0===_ref17$offsetY?0:_ref17$offsetY,_ref17$dontFlip=_ref17.dontFlip,dontFlip=void 0!==_ref17$dontFlip&&_ref17$dontFlip;return new _display_utils.PageViewport({viewBox:this.view,scale:scale,rotation:rotation,offsetX:offsetX,offsetY:offsetY,dontFlip:dontFlip})}},{key:"getAnnotations",value:function(){var _ref18$intent=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).intent,intent=void 0===_ref18$intent?"display":_ref18$intent,intentArgs=this._transport.getRenderingIntent(intent),promise=this._annotationPromises.get(intentArgs.cacheKey);return promise||(promise=this._transport.getAnnotations(this._pageIndex,intentArgs.renderingIntent),this._annotationPromises.set(intentArgs.cacheKey,promise),promise=promise.then((function(annotations){var _step6,_iterator6=_createForOfIteratorHelper(annotations);try{var _loop=function(){var annotation=_step6.value;void 0!==annotation.titleObj&&Object.defineProperty(annotation,"title",{get:function(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),annotation.titleObj.str}}),void 0!==annotation.contentsObj&&Object.defineProperty(annotation,"contents",{get:function(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),annotation.contentsObj.str}})};for(_iterator6.s();!(_step6=_iterator6.n()).done;)_loop()}catch(err){_iterator6.e(err)}finally{_iterator6.f()}return annotations}))),promise}},{key:"getJSActions",value:function(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}},{key:"getXfa",value:(_getXfa=_asyncToGenerator(_regeneratorRuntime().mark((function _callee3(){var _this$_transport$_htm;return _regeneratorRuntime().wrap((function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",(null===(_this$_transport$_htm=this._transport._htmlForXfa)||void 0===_this$_transport$_htm?void 0:_this$_transport$_htm.children[this._pageIndex])||null);case 1:case"end":return _context3.stop()}}),_callee3,this)}))),function(){return _getXfa.apply(this,arguments)})},{key:"render",value:function(_ref2){var _arguments$,_arguments$2,_intentState,_this8=this,canvasContext=_ref2.canvasContext,viewport=_ref2.viewport,_ref2$intent=_ref2.intent,intent=void 0===_ref2$intent?"display":_ref2$intent,_ref2$annotationMode=_ref2.annotationMode,annotationMode=void 0===_ref2$annotationMode?_util.AnnotationMode.ENABLE:_ref2$annotationMode,_ref2$transform=_ref2.transform,transform=void 0===_ref2$transform?null:_ref2$transform,_ref2$imageLayer=_ref2.imageLayer,imageLayer=void 0===_ref2$imageLayer?null:_ref2$imageLayer,_ref2$canvasFactory=_ref2.canvasFactory,canvasFactory=void 0===_ref2$canvasFactory?null:_ref2$canvasFactory,_ref2$background=_ref2.background,background=void 0===_ref2$background?null:_ref2$background,_ref2$optionalContent=_ref2.optionalContentConfigPromise,optionalContentConfigPromise=void 0===_ref2$optionalContent?null:_ref2$optionalContent,_ref2$annotationCanva=_ref2.annotationCanvasMap,annotationCanvasMap=void 0===_ref2$annotationCanva?null:_ref2$annotationCanva,_ref2$pageColors=_ref2.pageColors,pageColors=void 0===_ref2$pageColors?null:_ref2$pageColors,_ref2$printAnnotation=_ref2.printAnnotationStorage,printAnnotationStorage=void 0===_ref2$printAnnotation?null:_ref2$printAnnotation;void 0!==(null===(_arguments$=arguments[0])||void 0===_arguments$?void 0:_arguments$.renderInteractiveForms)&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),!0===arguments[0].renderInteractiveForms&&annotationMode===_util.AnnotationMode.ENABLE&&(annotationMode=_util.AnnotationMode.ENABLE_FORMS)),void 0!==(null===(_arguments$2=arguments[0])||void 0===_arguments$2?void 0:_arguments$2.includeAnnotationStorage)&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),!0===arguments[0].includeAnnotationStorage&&annotationMode===_util.AnnotationMode.ENABLE&&(annotationMode=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");var intentArgs=this._transport.getRenderingIntent(intent,annotationMode,printAnnotationStorage);this.pendingCleanup=!1,optionalContentConfigPromise||(optionalContentConfigPromise=this._transport.getOptionalContentConfig());var intentState=this._intentStates.get(intentArgs.cacheKey);intentState||(intentState=Object.create(null),this._intentStates.set(intentArgs.cacheKey,intentState)),intentState.streamReaderCancelTimeout&&(clearTimeout(intentState.streamReaderCancelTimeout),intentState.streamReaderCancelTimeout=null);var canvasFactoryInstance=canvasFactory||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),intentPrint=!!(intentArgs.renderingIntent&_util.RenderingIntentFlag.PRINT);intentState.displayReadyCapability||(intentState.displayReadyCapability=(0,_util.createPromiseCapability)(),intentState.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(intentArgs));var complete=function(error){intentState.renderTasks.delete(internalRenderTask),(_this8.cleanupAfterRender||intentPrint)&&(_this8.pendingCleanup=!0),_this8._tryCleanup(),error?(internalRenderTask.capability.reject(error),_this8._abortOperatorList({intentState:intentState,reason:error instanceof Error?error:new Error(error)})):internalRenderTask.capability.resolve(),_this8._stats&&(_this8._stats.timeEnd("Rendering"),_this8._stats.timeEnd("Overall"))},internalRenderTask=new InternalRenderTask({callback:complete,params:{canvasContext:canvasContext,viewport:viewport,transform:transform,imageLayer:imageLayer,background:background},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:annotationCanvasMap,operatorList:intentState.operatorList,pageIndex:this._pageIndex,canvasFactory:canvasFactoryInstance,useRequestAnimationFrame:!intentPrint,pdfBug:this._pdfBug,pageColors:pageColors});((_intentState=intentState).renderTasks||(_intentState.renderTasks=new Set)).add(internalRenderTask);var renderTask=internalRenderTask.task;return Promise.all([intentState.displayReadyCapability.promise,optionalContentConfigPromise]).then((function(_ref3){var _ref19=_slicedToArray(_ref3,2),transparency=_ref19[0],optionalContentConfig=_ref19[1];_this8.pendingCleanup?complete():(_this8._stats&&_this8._stats.time("Rendering"),internalRenderTask.initializeGraphics({transparency:transparency,optionalContentConfig:optionalContentConfig}),internalRenderTask.operatorListChanged())})).catch(complete),renderTask}},{key:"getOperatorList",value:function(){var opListTask,_intentState2,_ref20=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref20$intent=_ref20.intent,intent=void 0===_ref20$intent?"display":_ref20$intent,_ref20$annotationMode=_ref20.annotationMode,annotationMode=void 0===_ref20$annotationMode?_util.AnnotationMode.ENABLE:_ref20$annotationMode,_ref20$printAnnotatio=_ref20.printAnnotationStorage,printAnnotationStorage=void 0===_ref20$printAnnotatio?null:_ref20$printAnnotatio,intentArgs=this._transport.getRenderingIntent(intent,annotationMode,printAnnotationStorage,!0),intentState=this._intentStates.get(intentArgs.cacheKey);return intentState||(intentState=Object.create(null),this._intentStates.set(intentArgs.cacheKey,intentState)),intentState.opListReadCapability||((opListTask=Object.create(null)).operatorListChanged=function(){intentState.operatorList.lastChunk&&(intentState.opListReadCapability.resolve(intentState.operatorList),intentState.renderTasks.delete(opListTask))},intentState.opListReadCapability=(0,_util.createPromiseCapability)(),((_intentState2=intentState).renderTasks||(_intentState2.renderTasks=new Set)).add(opListTask),intentState.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(intentArgs)),intentState.opListReadCapability.promise}},{key:"streamTextContent",value:function(){var _ref21=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref21$disableCombine=_ref21.disableCombineTextItems,disableCombineTextItems=void 0!==_ref21$disableCombine&&_ref21$disableCombine,_ref21$includeMarkedC=_ref21.includeMarkedContent,includeMarkedContent=void 0!==_ref21$includeMarkedC&&_ref21$includeMarkedC;return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,combineTextItems:!0!==disableCombineTextItems,includeMarkedContent:!0===includeMarkedContent},{highWaterMark:100,size:function(textContent){return textContent.items.length}})}},{key:"getTextContent",value:function(){var params=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._transport._htmlForXfa)return this.getXfa().then((function(xfa){return _xfa_text.XfaText.textContent(xfa)}));var readableStream=this.streamTextContent(params);return new Promise((function(resolve,reject){var reader=readableStream.getReader(),textContent={items:[],styles:Object.create(null)};!function pump(){reader.read().then((function(_ref4){var _textContent$items,value=_ref4.value;_ref4.done?resolve(textContent):(Object.assign(textContent.styles,value.styles),(_textContent$items=textContent.items).push.apply(_textContent$items,_toConsumableArray(value.items)),pump())}),reject)}()}))}},{key:"getStructTree",value:function(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}},{key:"_destroy",value:function(){this.destroyed=!0;var _step7,waitOn=[],_iterator7=_createForOfIteratorHelper(this._intentStates.values());try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){var intentState=_step7.value;if(this._abortOperatorList({intentState:intentState,reason:new Error("Page was destroyed."),force:!0}),!intentState.opListReadCapability){var _step9,_iterator9=_createForOfIteratorHelper(intentState.renderTasks);try{for(_iterator9.s();!(_step9=_iterator9.n()).done;){var internalRenderTask=_step9.value;waitOn.push(internalRenderTask.completed),internalRenderTask.cancel()}}catch(err){_iterator9.e(err)}finally{_iterator9.f()}}}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}this.objs.clear();var _step8,_iterator8=_createForOfIteratorHelper(this._bitmaps);try{for(_iterator8.s();!(_step8=_iterator8.n()).done;)_step8.value.close()}catch(err){_iterator8.e(err)}finally{_iterator8.f()}return this._bitmaps.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(waitOn)}},{key:"cleanup",value:function(){var resetStats=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.pendingCleanup=!0,this._tryCleanup(resetStats)}},{key:"_tryCleanup",value:function(){var resetStats=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.pendingCleanup)return!1;var _step10,_iterator10=_createForOfIteratorHelper(this._intentStates.values());try{for(_iterator10.s();!(_step10=_iterator10.n()).done;){var _step10$value=_step10.value,renderTasks=_step10$value.renderTasks,operatorList=_step10$value.operatorList;if(renderTasks.size>0||!operatorList.lastChunk)return!1}}catch(err){_iterator10.e(err)}finally{_iterator10.f()}this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,resetStats&&this._stats&&(this._stats=new _display_utils.StatTimer);var _step11,_iterator11=_createForOfIteratorHelper(this._bitmaps);try{for(_iterator11.s();!(_step11=_iterator11.n()).done;)_step11.value.close()}catch(err){_iterator11.e(err)}finally{_iterator11.f()}return this._bitmaps.clear(),this.pendingCleanup=!1,!0}},{key:"_startRenderPage",value:function(transparency,cacheKey){var intentState=this._intentStates.get(cacheKey);intentState&&(this._stats&&this._stats.timeEnd("Page Request"),intentState.displayReadyCapability&&intentState.displayReadyCapability.resolve(transparency))}},{key:"_renderPageChunk",value:function(operatorListChunk,intentState){for(var i=0,ii=operatorListChunk.length;i<ii;i++)intentState.operatorList.fnArray.push(operatorListChunk.fnArray[i]),intentState.operatorList.argsArray.push(operatorListChunk.argsArray[i]);intentState.operatorList.lastChunk=operatorListChunk.lastChunk,intentState.operatorList.separateAnnots=operatorListChunk.separateAnnots;var _step12,_iterator12=_createForOfIteratorHelper(intentState.renderTasks);try{for(_iterator12.s();!(_step12=_iterator12.n()).done;)_step12.value.operatorListChanged()}catch(err){_iterator12.e(err)}finally{_iterator12.f()}operatorListChunk.lastChunk&&this._tryCleanup()}},{key:"_pumpOperatorList",value:function(_ref5){var _this9=this,renderingIntent=_ref5.renderingIntent,cacheKey=_ref5.cacheKey,annotationStorageMap=_ref5.annotationStorageMap,reader=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:renderingIntent,cacheKey:cacheKey,annotationStorage:annotationStorageMap}).getReader(),intentState=this._intentStates.get(cacheKey);intentState.streamReader=reader,function pump(){reader.read().then((function(_ref6){var value=_ref6.value;_ref6.done?intentState.streamReader=null:_this9._transport.destroyed||(_this9._renderPageChunk(value,intentState),pump())}),(function(reason){if(intentState.streamReader=null,!_this9._transport.destroyed){if(intentState.operatorList){intentState.operatorList.lastChunk=!0;var _step13,_iterator13=_createForOfIteratorHelper(intentState.renderTasks);try{for(_iterator13.s();!(_step13=_iterator13.n()).done;)_step13.value.operatorListChanged()}catch(err){_iterator13.e(err)}finally{_iterator13.f()}_this9._tryCleanup()}if(intentState.displayReadyCapability)intentState.displayReadyCapability.reject(reason);else{if(!intentState.opListReadCapability)throw reason;intentState.opListReadCapability.reject(reason)}}}))}()}},{key:"_abortOperatorList",value:function(_ref7){var _this10=this,intentState=_ref7.intentState,reason=_ref7.reason,_ref7$force=_ref7.force,force=void 0!==_ref7$force&&_ref7$force;if(intentState.streamReader){if(!force){if(intentState.renderTasks.size>0)return;if(reason instanceof _display_utils.RenderingCancelledException)return void(intentState.streamReaderCancelTimeout=setTimeout((function(){_this10._abortOperatorList({intentState:intentState,reason:reason,force:!0}),intentState.streamReaderCancelTimeout=null}),RENDERING_CANCELLED_TIMEOUT))}if(intentState.streamReader.cancel(new _util.AbortException(reason.message)).catch((function(){})),intentState.streamReader=null,!this._transport.destroyed){var _step14,_iterator14=_createForOfIteratorHelper(this._intentStates);try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){var _step14$value=_slicedToArray(_step14.value,2),curCacheKey=_step14$value[0];if(_step14$value[1]===intentState){this._intentStates.delete(curCacheKey);break}}}catch(err){_iterator14.e(err)}finally{_iterator14.f()}this.cleanup()}}}},{key:"stats",get:function(){return this._stats}}]),PDFPageProxy}();exports.PDFPageProxy=PDFPageProxy;var LoopbackPort=function(){function LoopbackPort(){_classCallCheck(this,LoopbackPort),this._listeners=[],this._deferred=Promise.resolve()}return _createClass(LoopbackPort,[{key:"postMessage",value:function(obj,transfers){var _this11=this,event={data:structuredClone(obj,transfers)};this._deferred.then((function(){var _step15,_iterator15=_createForOfIteratorHelper(_this11._listeners);try{for(_iterator15.s();!(_step15=_iterator15.n()).done;)_step15.value.call(_this11,event)}catch(err){_iterator15.e(err)}finally{_iterator15.f()}}))}},{key:"addEventListener",value:function(name,listener){this._listeners.push(listener)}},{key:"removeEventListener",value:function(name,listener){var i=this._listeners.indexOf(listener);this._listeners.splice(i,1)}},{key:"terminate",value:function(){this._listeners.length=0}}]),LoopbackPort}();exports.LoopbackPort=LoopbackPort;var PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};if(exports.PDFWorkerUtil=PDFWorkerUtil,_is_node.isNodeJS)PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if("object"===("undefined"==typeof document?"undefined":_typeof(document))){var _document,_document$currentScri,pdfjsFilePath=null===(_document=document)||void 0===_document||null===(_document$currentScri=_document.currentScript)||void 0===_document$currentScri?void 0:_document$currentScri.src;pdfjsFilePath&&(PDFWorkerUtil.fallbackWorkerSrc=pdfjsFilePath.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(baseUrl,otherUrl){var base;try{if(!(base=new URL(baseUrl)).origin||"null"===base.origin)return!1}catch(e){return!1}var other=new URL(otherUrl,base);return base.origin===other.origin},PDFWorkerUtil.createCDNWrapper=function(url){var wrapper='importScripts("'.concat(url,'");');return URL.createObjectURL(new Blob([wrapper]))};var PDFWorker=function(){function PDFWorker(){_classCallCheck(this,PDFWorker);var _ref22=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref22$name=_ref22.name,name=void 0===_ref22$name?null:_ref22$name,_ref22$port=_ref22.port,port=void 0===_ref22$port?null:_ref22$port,_ref22$verbosity=_ref22.verbosity,verbosity=void 0===_ref22$verbosity?(0,_util.getVerbosityLevel)():_ref22$verbosity;if(port&&_classStaticPrivateFieldSpecGet(PDFWorker,PDFWorker,_workerPorts).has(port))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=name,this.destroyed=!1,this.verbosity=verbosity,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,port)return _classStaticPrivateFieldSpecGet(PDFWorker,PDFWorker,_workerPorts).set(port,this),void this._initializeFromPort(port);this._initialize()}return _createClass(PDFWorker,[{key:"promise",get:function(){return this._readyCapability.promise}},{key:"port",get:function(){return this._port}},{key:"messageHandler",get:function(){return this._messageHandler}},{key:"_initializeFromPort",value:function(port){this._port=port,this._messageHandler=new _message_handler.MessageHandler("main","worker",port),this._messageHandler.on("ready",(function(){})),this._readyCapability.resolve()}},{key:"_initialize",value:function(){var _this12=this;if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){var workerSrc=PDFWorker.workerSrc;try{PDFWorkerUtil.isSameOrigin(window.location.href,workerSrc)||(workerSrc=PDFWorkerUtil.createCDNWrapper(new URL(workerSrc,window.location).href));var worker=new Worker(workerSrc),messageHandler=new _message_handler.MessageHandler("main","worker",worker),terminateEarly=function(){worker.removeEventListener("error",onWorkerError),messageHandler.destroy(),worker.terminate(),_this12.destroyed?_this12._readyCapability.reject(new Error("Worker was destroyed")):_this12._setupFakeWorker()},onWorkerError=function(){_this12._webWorker||terminateEarly()};worker.addEventListener("error",onWorkerError),messageHandler.on("test",(function(data){worker.removeEventListener("error",onWorkerError),_this12.destroyed?terminateEarly():data?(_this12._messageHandler=messageHandler,_this12._port=worker,_this12._webWorker=worker,_this12._readyCapability.resolve(),messageHandler.send("configure",{verbosity:_this12.verbosity})):(_this12._setupFakeWorker(),messageHandler.destroy(),worker.terminate())})),messageHandler.on("ready",(function(data){if(worker.removeEventListener("error",onWorkerError),_this12.destroyed)terminateEarly();else try{sendTest()}catch(e){_this12._setupFakeWorker()}}));var sendTest=function(){var testObj=new Uint8Array;messageHandler.send("test",testObj,[testObj.buffer])};return void sendTest()}catch(e){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}},{key:"_setupFakeWorker",value:function(){var _this13=this;PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then((function(WorkerMessageHandler){if(_this13.destroyed)_this13._readyCapability.reject(new Error("Worker was destroyed"));else{var port=new LoopbackPort;_this13._port=port;var id="fake".concat(PDFWorkerUtil.fakeWorkerId++),workerHandler=new _message_handler.MessageHandler(id+"_worker",id,port);WorkerMessageHandler.setup(workerHandler,port);var messageHandler=new _message_handler.MessageHandler(id,id+"_worker",port);_this13._messageHandler=messageHandler,_this13._readyCapability.resolve(),messageHandler.send("configure",{verbosity:_this13.verbosity})}})).catch((function(reason){_this13._readyCapability.reject(new Error('Setting up fake worker failed: "'.concat(reason.message,'".')))}))}},{key:"destroy",value:function(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),_classStaticPrivateFieldSpecGet(PDFWorker,PDFWorker,_workerPorts).delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}}],[{key:"fromPort",value:function(params){if(null==params||!params.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return _classStaticPrivateFieldSpecGet(this,PDFWorker,_workerPorts).has(params.port)?_classStaticPrivateFieldSpecGet(this,PDFWorker,_workerPorts).get(params.port):new PDFWorker(params)}},{key:"workerSrc",get:function(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(null!==PDFWorkerUtil.fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}},{key:"_mainThreadWorkerMessageHandler",get:function(){try{var _globalThis$pdfjsWork;return(null===(_globalThis$pdfjsWork=globalThis.pdfjsWorker)||void 0===_globalThis$pdfjsWork?void 0:_globalThis$pdfjsWork.WorkerMessageHandler)||null}catch(ex){return null}}},{key:"_setupFakeWorkerGlobal",get:function get(){var _this14=this,loader=function(){var _ref23=_asyncToGenerator(_regeneratorRuntime().mark((function _callee4(){var mainWorkerMessageHandler,worker;return _regeneratorRuntime().wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(mainWorkerMessageHandler=_this14._mainThreadWorkerMessageHandler,!mainWorkerMessageHandler){_context4.next=3;break}return _context4.abrupt("return",mainWorkerMessageHandler);case 3:if(!_is_node.isNodeJS){_context4.next=6;break}return worker=eval("require")(_this14.workerSrc),_context4.abrupt("return",worker.WorkerMessageHandler);case 6:return _context4.next=8,(0,_display_utils.loadScript)(_this14.workerSrc);case 8:return _context4.abrupt("return",window.pdfjsWorker.WorkerMessageHandler);case 9:case"end":return _context4.stop()}}),_callee4)})));return function(){return _ref23.apply(this,arguments)}}();return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}]),PDFWorker}();exports.PDFWorker=PDFWorker;var _workerPorts={writable:!0,value:new WeakMap};PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};var _docStats=new WeakMap,_pageCache=new WeakMap,_pagePromises=new WeakMap,_metadataPromise=new WeakMap,WorkerTransport=function(){function WorkerTransport(messageHandler,loadingTask,networkStream,params){_classCallCheck(this,WorkerTransport),_classPrivateFieldInitSpec(this,_docStats,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,_pageCache,{writable:!0,value:new Map}),_classPrivateFieldInitSpec(this,_pagePromises,{writable:!0,value:new Map}),_classPrivateFieldInitSpec(this,_metadataPromise,{writable:!0,value:null}),this.messageHandler=messageHandler,this.loadingTask=loadingTask,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:loadingTask.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:params.ownerDocument,styleElement:params.styleElement}),this._params=params,params.useWorkerFetch||(this.CMapReaderFactory=new params.CMapReaderFactory({baseUrl:params.cMapUrl,isCompressed:params.cMapPacked}),this.StandardFontDataFactory=new params.StandardFontDataFactory({baseUrl:params.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=networkStream,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}var _startCleanup;return _createClass(WorkerTransport,[{key:"annotationStorage",get:function(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}},{key:"stats",get:function(){return _classPrivateFieldGet(this,_docStats)}},{key:"getRenderingIntent",value:function(intent){var annotationMode=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_util.AnnotationMode.ENABLE,printAnnotationStorage=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,isOpList=arguments.length>3&&void 0!==arguments[3]&&arguments[3],renderingIntent=_util.RenderingIntentFlag.DISPLAY,annotationMap=null;switch(intent){case"any":renderingIntent=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":renderingIntent=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)("getRenderingIntent - invalid intent: ".concat(intent))}switch(annotationMode){case _util.AnnotationMode.DISABLE:renderingIntent+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:renderingIntent+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:annotationMap=((renderingIntent+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE)&_util.RenderingIntentFlag.PRINT&&printAnnotationStorage instanceof _annotation_storage.PrintAnnotationStorage?printAnnotationStorage:this.annotationStorage).serializable;break;default:(0,_util.warn)("getRenderingIntent - invalid annotationMode: ".concat(annotationMode))}return isOpList&&(renderingIntent+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:renderingIntent,cacheKey:"".concat(renderingIntent,"_").concat(_annotation_storage.AnnotationStorage.getHash(annotationMap)),annotationStorageMap:annotationMap}}},{key:"destroy",value:function(){var _this15=this;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));var _step16,waitOn=[],_iterator16=_createForOfIteratorHelper(_classPrivateFieldGet(this,_pageCache).values());try{for(_iterator16.s();!(_step16=_iterator16.n()).done;){var page=_step16.value;waitOn.push(page._destroy())}}catch(err){_iterator16.e(err)}finally{_iterator16.f()}_classPrivateFieldGet(this,_pageCache).clear(),_classPrivateFieldGet(this,_pagePromises).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();var terminated=this.messageHandler.sendWithPromise("Terminate",null);return waitOn.push(terminated),Promise.all(waitOn).then((function(){_this15.commonObjs.clear(),_this15.fontLoader.clear(),_classPrivateFieldSet(_this15,_metadataPromise,null),_this15._getFieldObjectsPromise=null,_this15._hasJSActionsPromise=null,_this15._networkStream&&_this15._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),_this15.messageHandler&&(_this15.messageHandler.destroy(),_this15.messageHandler=null),_this15.destroyCapability.resolve()}),this.destroyCapability.reject),this.destroyCapability.promise}},{key:"setupMessageHandler",value:function(){var _this16=this,messageHandler=this.messageHandler,loadingTask=this.loadingTask;messageHandler.on("GetReader",(function(data,sink){(0,_util.assert)(_this16._networkStream,"GetReader - no `IPDFStream` instance available."),_this16._fullReader=_this16._networkStream.getFullReader(),_this16._fullReader.onProgress=function(evt){_this16._lastProgress={loaded:evt.loaded,total:evt.total}},sink.onPull=function(){_this16._fullReader.read().then((function(_ref8){var value=_ref8.value;_ref8.done?sink.close():((0,_util.assert)((0,_util.isArrayBuffer)(value),"GetReader - expected an ArrayBuffer."),sink.enqueue(new Uint8Array(value),1,[value]))})).catch((function(reason){sink.error(reason)}))},sink.onCancel=function(reason){_this16._fullReader.cancel(reason),sink.ready.catch((function(readyReason){if(!_this16.destroyed)throw readyReason}))}})),messageHandler.on("ReaderHeadersReady",(function(data){var headersCapability=(0,_util.createPromiseCapability)(),fullReader=_this16._fullReader;return fullReader.headersReady.then((function(){var _loadingTask$onProgre;fullReader.isStreamingSupported&&fullReader.isRangeSupported||(_this16._lastProgress&&(null===(_loadingTask$onProgre=loadingTask.onProgress)||void 0===_loadingTask$onProgre||_loadingTask$onProgre.call(loadingTask,_this16._lastProgress)),fullReader.onProgress=function(evt){var _loadingTask$onProgre2;null===(_loadingTask$onProgre2=loadingTask.onProgress)||void 0===_loadingTask$onProgre2||_loadingTask$onProgre2.call(loadingTask,{loaded:evt.loaded,total:evt.total})});headersCapability.resolve({isStreamingSupported:fullReader.isStreamingSupported,isRangeSupported:fullReader.isRangeSupported,contentLength:fullReader.contentLength})}),headersCapability.reject),headersCapability.promise})),messageHandler.on("GetRangeReader",(function(data,sink){(0,_util.assert)(_this16._networkStream,"GetRangeReader - no `IPDFStream` instance available.");var rangeReader=_this16._networkStream.getRangeReader(data.begin,data.end);rangeReader?(sink.onPull=function(){rangeReader.read().then((function(_ref9){var value=_ref9.value;_ref9.done?sink.close():((0,_util.assert)((0,_util.isArrayBuffer)(value),"GetRangeReader - expected an ArrayBuffer."),sink.enqueue(new Uint8Array(value),1,[value]))})).catch((function(reason){sink.error(reason)}))},sink.onCancel=function(reason){rangeReader.cancel(reason),sink.ready.catch((function(readyReason){if(!_this16.destroyed)throw readyReason}))}):sink.close()})),messageHandler.on("GetDoc",(function(_ref10){var pdfInfo=_ref10.pdfInfo;_this16._numPages=pdfInfo.numPages,_this16._htmlForXfa=pdfInfo.htmlForXfa,delete pdfInfo.htmlForXfa,loadingTask._capability.resolve(new PDFDocumentProxy(pdfInfo,_this16))})),messageHandler.on("DocException",(function(ex){var reason;switch(ex.name){case"PasswordException":reason=new _util.PasswordException(ex.message,ex.code);break;case"InvalidPDFException":reason=new _util.InvalidPDFException(ex.message);break;case"MissingPDFException":reason=new _util.MissingPDFException(ex.message);break;case"UnexpectedResponseException":reason=new _util.UnexpectedResponseException(ex.message,ex.status);break;case"UnknownErrorException":reason=new _util.UnknownErrorException(ex.message,ex.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}loadingTask._capability.reject(reason)})),messageHandler.on("PasswordRequest",(function(exception){if(_this16._passwordCapability=(0,_util.createPromiseCapability)(),loadingTask.onPassword)try{loadingTask.onPassword((function(password){password instanceof Error?_this16._passwordCapability.reject(password):_this16._passwordCapability.resolve({password:password})}),exception.code)}catch(ex){_this16._passwordCapability.reject(ex)}else _this16._passwordCapability.reject(new _util.PasswordException(exception.message,exception.code));return _this16._passwordCapability.promise})),messageHandler.on("DataLoaded",(function(data){var _loadingTask$onProgre3;null===(_loadingTask$onProgre3=loadingTask.onProgress)||void 0===_loadingTask$onProgre3||_loadingTask$onProgre3.call(loadingTask,{loaded:data.length,total:data.length}),_this16.downloadInfoCapability.resolve(data)})),messageHandler.on("StartRenderPage",(function(data){_this16.destroyed||_classPrivateFieldGet(_this16,_pageCache).get(data.pageIndex)._startRenderPage(data.transparency,data.cacheKey)})),messageHandler.on("commonobj",(function(_ref11){var _globalThis$FontInspe,_ref24=_slicedToArray(_ref11,3),id=_ref24[0],type=_ref24[1],exportedData=_ref24[2];if(!_this16.destroyed&&!_this16.commonObjs.has(id))switch(type){case"Font":var params=_this16._params;if("error"in exportedData){var exportedError=exportedData.error;(0,_util.warn)("Error during font loading: ".concat(exportedError)),_this16.commonObjs.resolve(id,exportedError);break}var fontRegistry=null;params.pdfBug&&null!==(_globalThis$FontInspe=globalThis.FontInspector)&&void 0!==_globalThis$FontInspe&&_globalThis$FontInspe.enabled&&(fontRegistry={registerFont:function(font,url){globalThis.FontInspector.fontAdded(font,url)}});var font=new _font_loader.FontFaceObject(exportedData,{isEvalSupported:params.isEvalSupported,disableFontFace:params.disableFontFace,ignoreErrors:params.ignoreErrors,onUnsupportedFeature:_this16._onUnsupportedFeature.bind(_this16),fontRegistry:fontRegistry});_this16.fontLoader.bind(font).catch((function(reason){return messageHandler.sendWithPromise("FontFallback",{id:id})})).finally((function(){!params.fontExtraProperties&&font.data&&(font.data=null),_this16.commonObjs.resolve(id,font)}));break;case"FontPath":case"Image":_this16.commonObjs.resolve(id,exportedData);break;default:throw new Error("Got unknown common object type ".concat(type))}})),messageHandler.on("obj",(function(_ref12){var _ref25=_slicedToArray(_ref12,4),id=_ref25[0],pageIndex=_ref25[1],type=_ref25[2],imageData=_ref25[3];if(!_this16.destroyed){var pageProxy=_classPrivateFieldGet(_this16,_pageCache).get(pageIndex);if(!pageProxy.objs.has(id))switch(type){case"Image":if(pageProxy.objs.resolve(id,imageData),imageData){var length;if(imageData.bitmap){var bitmap=imageData.bitmap;length=imageData.width*imageData.height*4,pageProxy._bitmaps.add(bitmap)}else{var _imageData$data;length=(null===(_imageData$data=imageData.data)||void 0===_imageData$data?void 0:_imageData$data.length)||0}length>8e6&&(pageProxy.cleanupAfterRender=!0)}break;case"Pattern":pageProxy.objs.resolve(id,imageData);break;default:throw new Error("Got unknown object type ".concat(type))}}})),messageHandler.on("DocProgress",(function(data){var _loadingTask$onProgre4;_this16.destroyed||null===(_loadingTask$onProgre4=loadingTask.onProgress)||void 0===_loadingTask$onProgre4||_loadingTask$onProgre4.call(loadingTask,{loaded:data.loaded,total:data.total})})),messageHandler.on("DocStats",(function(data){_this16.destroyed||_classPrivateFieldSet(_this16,_docStats,Object.freeze({streamTypes:Object.freeze(data.streamTypes),fontTypes:Object.freeze(data.fontTypes)}))})),messageHandler.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),messageHandler.on("FetchBuiltInCMap",(function(data){return _this16.destroyed?Promise.reject(new Error("Worker was destroyed.")):_this16.CMapReaderFactory?_this16.CMapReaderFactory.fetch(data):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))})),messageHandler.on("FetchStandardFontData",(function(data){return _this16.destroyed?Promise.reject(new Error("Worker was destroyed.")):_this16.StandardFontDataFactory?_this16.StandardFontDataFactory.fetch(data):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter."))}))}},{key:"_onUnsupportedFeature",value:function(_ref13){var _this$loadingTask$onU,_this$loadingTask,featureId=_ref13.featureId;this.destroyed||null===(_this$loadingTask$onU=(_this$loadingTask=this.loadingTask).onUnsupportedFeature)||void 0===_this$loadingTask$onU||_this$loadingTask$onU.call(_this$loadingTask,featureId)}},{key:"getData",value:function(){return this.messageHandler.sendWithPromise("GetData",null)}},{key:"getPage",value:function(pageNumber){var _this17=this;if(!Number.isInteger(pageNumber)||pageNumber<=0||pageNumber>this._numPages)return Promise.reject(new Error("Invalid page request."));var pageIndex=pageNumber-1,cachedPromise=_classPrivateFieldGet(this,_pagePromises).get(pageIndex);if(cachedPromise)return cachedPromise;var promise=this.messageHandler.sendWithPromise("GetPage",{pageIndex:pageIndex}).then((function(pageInfo){if(_this17.destroyed)throw new Error("Transport destroyed");var page=new PDFPageProxy(pageIndex,pageInfo,_this17,_this17._params.ownerDocument,_this17._params.pdfBug);return _classPrivateFieldGet(_this17,_pageCache).set(pageIndex,page),page}));return _classPrivateFieldGet(this,_pagePromises).set(pageIndex,promise),promise}},{key:"getPageIndex",value:function(ref){return"object"!==_typeof(ref)||null===ref||!Number.isInteger(ref.num)||ref.num<0||!Number.isInteger(ref.gen)||ref.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:ref.num,gen:ref.gen})}},{key:"getAnnotations",value:function(pageIndex,intent){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:pageIndex,intent:intent})}},{key:"saveDocument",value:function(){var _this$_fullReader$fil,_this$_fullReader,_this18=this;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:null!==(_this$_fullReader$fil=null===(_this$_fullReader=this._fullReader)||void 0===_this$_fullReader?void 0:_this$_fullReader.filename)&&void 0!==_this$_fullReader$fil?_this$_fullReader$fil:null}).finally((function(){_this18.annotationStorage.resetModified()}))}},{key:"getFieldObjects",value:function(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}},{key:"hasJSActions",value:function(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}},{key:"getCalculationOrderIds",value:function(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}},{key:"getDestinations",value:function(){return this.messageHandler.sendWithPromise("GetDestinations",null)}},{key:"getDestination",value:function(id){return"string"!=typeof id?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:id})}},{key:"getPageLabels",value:function(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}},{key:"getPageLayout",value:function(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}},{key:"getPageMode",value:function(){return this.messageHandler.sendWithPromise("GetPageMode",null)}},{key:"getViewerPreferences",value:function(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}},{key:"getOpenAction",value:function(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}},{key:"getAttachments",value:function(){return this.messageHandler.sendWithPromise("GetAttachments",null)}},{key:"getJavaScript",value:function(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}},{key:"getDocJSActions",value:function(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}},{key:"getPageJSActions",value:function(pageIndex){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:pageIndex})}},{key:"getStructTree",value:function(pageIndex){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:pageIndex})}},{key:"getOutline",value:function(){return this.messageHandler.sendWithPromise("GetOutline",null)}},{key:"getOptionalContentConfig",value:function(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then((function(results){return new _optional_content_config.OptionalContentConfig(results)}))}},{key:"getPermissions",value:function(){return this.messageHandler.sendWithPromise("GetPermissions",null)}},{key:"getMetadata",value:function(){var _this19=this;return _classPrivateFieldGet(this,_metadataPromise)||_classPrivateFieldSet(this,_metadataPromise,this.messageHandler.sendWithPromise("GetMetadata",null).then((function(results){var _this$_fullReader$fil2,_this$_fullReader2,_this$_fullReader$con,_this$_fullReader3;return{info:results[0],metadata:results[1]?new _metadata.Metadata(results[1]):null,contentDispositionFilename:null!==(_this$_fullReader$fil2=null===(_this$_fullReader2=_this19._fullReader)||void 0===_this$_fullReader2?void 0:_this$_fullReader2.filename)&&void 0!==_this$_fullReader$fil2?_this$_fullReader$fil2:null,contentLength:null!==(_this$_fullReader$con=null===(_this$_fullReader3=_this19._fullReader)||void 0===_this$_fullReader3?void 0:_this$_fullReader3.contentLength)&&void 0!==_this$_fullReader$con?_this$_fullReader$con:null}})))}},{key:"getMarkInfo",value:function(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}},{key:"startCleanup",value:(_startCleanup=_asyncToGenerator(_regeneratorRuntime().mark((function _callee5(){var keepLoadedFonts,_iterator17,_step17,page,_args5=arguments;return _regeneratorRuntime().wrap((function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return keepLoadedFonts=_args5.length>0&&void 0!==_args5[0]&&_args5[0],_context5.next=3,this.messageHandler.sendWithPromise("Cleanup",null);case 3:if(!this.destroyed){_context5.next=5;break}return _context5.abrupt("return");case 5:_iterator17=_createForOfIteratorHelper(_classPrivateFieldGet(this,_pageCache).values()),_context5.prev=6,_iterator17.s();case 8:if((_step17=_iterator17.n()).done){_context5.next=15;break}if((page=_step17.value).cleanup()){_context5.next=13;break}throw new Error("startCleanup: Page ".concat(page.pageNumber," is currently rendering."));case 13:_context5.next=8;break;case 15:_context5.next=20;break;case 17:_context5.prev=17,_context5.t0=_context5.catch(6),_iterator17.e(_context5.t0);case 20:return _context5.prev=20,_iterator17.f(),_context5.finish(20);case 23:this.commonObjs.clear(),keepLoadedFonts||this.fontLoader.clear(),_classPrivateFieldSet(this,_metadataPromise,null),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null;case 28:case"end":return _context5.stop()}}),_callee5,this,[[6,17,20,23]])}))),function(){return _startCleanup.apply(this,arguments)})},{key:"loadingParams",get:function(){var params=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:params.disableAutoFetch,enableXfa:params.enableXfa})}}]),WorkerTransport}(),_objs=new WeakMap,_ensureObj=new WeakSet,PDFObjects=function(){function PDFObjects(){_classCallCheck(this,PDFObjects),_classPrivateMethodInitSpec(this,_ensureObj),_classPrivateFieldInitSpec(this,_objs,{writable:!0,value:Object.create(null)})}return _createClass(PDFObjects,[{key:"get",value:function(objId){var callback=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(callback){var _obj=_classPrivateMethodGet(this,_ensureObj,_ensureObj2).call(this,objId);return _obj.capability.promise.then((function(){return callback(_obj.data)})),null}var obj=_classPrivateFieldGet(this,_objs)[objId];if(null==obj||!obj.capability.settled)throw new Error("Requesting object that isn't resolved yet ".concat(objId,"."));return obj.data}},{key:"has",value:function(objId){var obj=_classPrivateFieldGet(this,_objs)[objId];return(null==obj?void 0:obj.capability.settled)||!1}},{key:"resolve",value:function(objId){var data=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,obj=_classPrivateMethodGet(this,_ensureObj,_ensureObj2).call(this,objId);obj.data=data,obj.capability.resolve()}},{key:"clear",value:function(){_classPrivateFieldSet(this,_objs,Object.create(null))}}]),PDFObjects}();function _ensureObj2(objId){var obj=_classPrivateFieldGet(this,_objs)[objId];return obj||(_classPrivateFieldGet(this,_objs)[objId]={capability:(0,_util.createPromiseCapability)(),data:null})}var _internalRenderTask=new WeakMap,RenderTask=function(){function RenderTask(internalRenderTask){_classCallCheck(this,RenderTask),_classPrivateFieldInitSpec(this,_internalRenderTask,{writable:!0,value:null}),_classPrivateFieldSet(this,_internalRenderTask,internalRenderTask),this.onContinue=null}return _createClass(RenderTask,[{key:"promise",get:function(){return _classPrivateFieldGet(this,_internalRenderTask).capability.promise}},{key:"cancel",value:function(){_classPrivateFieldGet(this,_internalRenderTask).cancel()}},{key:"separateAnnots",get:function(){var separateAnnots=_classPrivateFieldGet(this,_internalRenderTask).operatorList.separateAnnots;if(!separateAnnots)return!1;var annotationCanvasMap=_classPrivateFieldGet(this,_internalRenderTask).annotationCanvasMap;return separateAnnots.form||separateAnnots.canvas&&(null==annotationCanvasMap?void 0:annotationCanvasMap.size)>0}}]),RenderTask}();exports.RenderTask=RenderTask;var InternalRenderTask=function(){function InternalRenderTask(_ref14){_classCallCheck(this,InternalRenderTask);var callback=_ref14.callback,params=_ref14.params,objs=_ref14.objs,commonObjs=_ref14.commonObjs,annotationCanvasMap=_ref14.annotationCanvasMap,operatorList=_ref14.operatorList,pageIndex=_ref14.pageIndex,canvasFactory=_ref14.canvasFactory,_ref14$useRequestAnim=_ref14.useRequestAnimationFrame,useRequestAnimationFrame=void 0!==_ref14$useRequestAnim&&_ref14$useRequestAnim,_ref14$pdfBug=_ref14.pdfBug,pdfBug=void 0!==_ref14$pdfBug&&_ref14$pdfBug,_ref14$pageColors=_ref14.pageColors,pageColors=void 0===_ref14$pageColors?null:_ref14$pageColors;this.callback=callback,this.params=params,this.objs=objs,this.commonObjs=commonObjs,this.annotationCanvasMap=annotationCanvasMap,this.operatorListIdx=null,this.operatorList=operatorList,this._pageIndex=pageIndex,this.canvasFactory=canvasFactory,this._pdfBug=pdfBug,this.pageColors=pageColors,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===useRequestAnimationFrame&&"undefined"!=typeof window,this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=params.canvasContext.canvas}var _next2;return _createClass(InternalRenderTask,[{key:"completed",get:function(){return this.capability.promise.catch((function(){}))}},{key:"initializeGraphics",value:function(_ref15){var _globalThis$StepperMa,_ref15$transparency=_ref15.transparency,transparency=void 0!==_ref15$transparency&&_ref15$transparency,optionalContentConfig=_ref15.optionalContentConfig;if(!this.cancelled){if(this._canvas){if(_classStaticPrivateFieldSpecGet(InternalRenderTask,InternalRenderTask,_canvasInUse).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");_classStaticPrivateFieldSpecGet(InternalRenderTask,InternalRenderTask,_canvasInUse).add(this._canvas)}this._pdfBug&&null!==(_globalThis$StepperMa=globalThis.StepperManager)&&void 0!==_globalThis$StepperMa&&_globalThis$StepperMa.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());var _this$params=this.params,canvasContext=_this$params.canvasContext,viewport=_this$params.viewport,transform=_this$params.transform,imageLayer=_this$params.imageLayer,background=_this$params.background;this.gfx=new _canvas.CanvasGraphics(canvasContext,this.commonObjs,this.objs,this.canvasFactory,imageLayer,optionalContentConfig,this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:transform,viewport:viewport,transparency:transparency,background:background}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}}},{key:"cancel",value:function(){var error=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&_classStaticPrivateFieldSpecGet(InternalRenderTask,InternalRenderTask,_canvasInUse).delete(this._canvas),this.callback(error||new _display_utils.RenderingCancelledException("Rendering cancelled, page ".concat(this._pageIndex+1),"canvas"))}},{key:"operatorListChanged",value:function(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}},{key:"_continue",value:function(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}},{key:"_scheduleNext",value:function(){var _this20=this;this._useRequestAnimationFrame?window.requestAnimationFrame((function(){_this20._nextBound().catch(_this20._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}},{key:"_next",value:(_next2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee6(){return _regeneratorRuntime().wrap((function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(!this.cancelled){_context6.next=2;break}return _context6.abrupt("return");case 2:this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&_classStaticPrivateFieldSpecGet(InternalRenderTask,InternalRenderTask,_canvasInUse).delete(this._canvas),this.callback()));case 4:case"end":return _context6.stop()}}),_callee6,this)}))),function(){return _next2.apply(this,arguments)})}]),InternalRenderTask}(),_canvasInUse={writable:!0,value:new WeakSet},version="2.16.105";exports.version=version;var build="172ccdbe5";exports.build=build},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PrintAnnotationStorage=exports.AnnotationStorage=void 0;var _util=__w_pdfjs_require__(1),_editor=__w_pdfjs_require__(131),_murmurhash=__w_pdfjs_require__(135);function _classPrivateFieldSet(receiver,privateMap,value){return function(receiver,descriptor,value){if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"set"),value),value}function _classExtractFieldDescriptor(receiver,privateMap,action){if(!privateMap.has(receiver))throw new TypeError("attempted to "+action+" private field on non-instance");return privateMap.get(receiver)}function _checkPrivateRedeclaration(obj,privateCollection){if(privateCollection.has(obj))throw new TypeError("Cannot initialize the same private elements twice on an object")}var _setModified=new WeakSet,AnnotationStorage=function(){function AnnotationStorage(){var obj,privateSet;_classCallCheck(this,AnnotationStorage),_checkPrivateRedeclaration(obj=this,privateSet=_setModified),privateSet.add(obj),this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}return _createClass(AnnotationStorage,[{key:"getValue",value:function(key,defaultValue){var value=this._storage.get(key);return void 0===value?defaultValue:Object.assign(defaultValue,value)}},{key:"getRawValue",value:function(key){return this._storage.get(key)}},{key:"remove",value:function(key){if(this._storage.delete(key),0===this._storage.size&&this.resetModified(),"function"==typeof this.onAnnotationEditor){var _step18,_iterator18=_createForOfIteratorHelper(this._storage.values());try{for(_iterator18.s();!(_step18=_iterator18.n()).done;)if(_step18.value instanceof _editor.AnnotationEditor)return}catch(err){_iterator18.e(err)}finally{_iterator18.f()}this.onAnnotationEditor(null)}}},{key:"setValue",value:function(key,value){var obj=this._storage.get(key),modified=!1;if(void 0!==obj)for(var _i2=0,_Object$entries=Object.entries(value);_i2<_Object$entries.length;_i2++){var _Object$entries$_i=_slicedToArray(_Object$entries[_i2],2),entry=_Object$entries$_i[0],val=_Object$entries$_i[1];obj[entry]!==val&&(modified=!0,obj[entry]=val)}else modified=!0,this._storage.set(key,value);modified&&function(receiver,privateSet,fn){if(!privateSet.has(receiver))throw new TypeError("attempted to get private field on non-instance");return fn}(this,_setModified,_setModified2).call(this),value instanceof _editor.AnnotationEditor&&"function"==typeof this.onAnnotationEditor&&this.onAnnotationEditor(value.constructor._type)}},{key:"has",value:function(key){return this._storage.has(key)}},{key:"getAll",value:function(){return this._storage.size>0?(0,_util.objectFromMap)(this._storage):null}},{key:"size",get:function(){return this._storage.size}},{key:"resetModified",value:function(){this._modified&&(this._modified=!1,"function"==typeof this.onResetModified&&this.onResetModified())}},{key:"print",get:function(){return new PrintAnnotationStorage(this)}},{key:"serializable",get:function(){if(0===this._storage.size)return null;var _step19,clone=new Map,_iterator19=_createForOfIteratorHelper(this._storage);try{for(_iterator19.s();!(_step19=_iterator19.n()).done;){var _step19$value=_slicedToArray(_step19.value,2),key=_step19$value[0],val=_step19$value[1],serialized=val instanceof _editor.AnnotationEditor?val.serialize():val;serialized&&clone.set(key,serialized)}}catch(err){_iterator19.e(err)}finally{_iterator19.f()}return clone}}],[{key:"getHash",value:function(map){if(!map)return"";var _step20,hash=new _murmurhash.MurmurHash3_64,_iterator20=_createForOfIteratorHelper(map);try{for(_iterator20.s();!(_step20=_iterator20.n()).done;){var _step20$value=_slicedToArray(_step20.value,2),key=_step20$value[0],val=_step20$value[1];hash.update("".concat(key,":").concat(JSON.stringify(val)))}}catch(err){_iterator20.e(err)}finally{_iterator20.f()}return hash.hexdigest()}}]),AnnotationStorage}();function _setModified2(){this._modified||(this._modified=!0,"function"==typeof this.onSetModified&&this.onSetModified())}exports.AnnotationStorage=AnnotationStorage;var _serializable=new WeakMap,PrintAnnotationStorage=function(_AnnotationStorage){function PrintAnnotationStorage(parent){var _this21,obj,privateMap,value;return _classCallCheck(this,PrintAnnotationStorage),_this21=_callSuper(this,PrintAnnotationStorage),obj=_assertThisInitialized(_this21),value={writable:!0,value:null},_checkPrivateRedeclaration(obj,privateMap=_serializable),privateMap.set(obj,value),_classPrivateFieldSet(_assertThisInitialized(_this21),_serializable,structuredClone(parent.serializable)),_this21}return _inherits(PrintAnnotationStorage,_AnnotationStorage),_createClass(PrintAnnotationStorage,[{key:"print",get:function(){(0,_util.unreachable)("Should not call PrintAnnotationStorage.print")}},{key:"serializable",get:function(){return function(receiver,descriptor){return descriptor.get?descriptor.get.call(receiver):descriptor.value}(receiver=this,_classExtractFieldDescriptor(receiver,_serializable,"get"));var receiver}}]),PrintAnnotationStorage}(AnnotationStorage);exports.PrintAnnotationStorage=PrintAnnotationStorage},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnnotationEditor=void 0;var _tools=__w_pdfjs_require__(132),_util=__w_pdfjs_require__(1);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldInitSpec(obj,privateMap,value){!function(obj,privateCollection){if(privateCollection.has(obj))throw new TypeError("Cannot initialize the same private elements twice on an object")}(obj,privateMap),privateMap.set(obj,value)}function _classPrivateFieldSet(receiver,privateMap,value){return function(receiver,descriptor,value){if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"set"),value),value}function _classPrivateFieldGet(receiver,privateMap){return function(receiver,descriptor){return descriptor.get?descriptor.get.call(receiver):descriptor.value}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"get"))}function _classExtractFieldDescriptor(receiver,privateMap,action){if(!privateMap.has(receiver))throw new TypeError("attempted to "+action+" private field on non-instance");return privateMap.get(receiver)}var _boundFocusin=new WeakMap,_boundFocusout=new WeakMap,_hasBeenSelected=new WeakMap,_isEditing=new WeakMap,_isInEditMode=new WeakMap,_zIndex=new WeakMap,AnnotationEditor=function(){function AnnotationEditor(parameters){_classCallCheck(this,AnnotationEditor),_classPrivateFieldInitSpec(this,_boundFocusin,{writable:!0,value:this.focusin.bind(this)}),_classPrivateFieldInitSpec(this,_boundFocusout,{writable:!0,value:this.focusout.bind(this)}),_classPrivateFieldInitSpec(this,_hasBeenSelected,{writable:!0,value:!1}),_classPrivateFieldInitSpec(this,_isEditing,{writable:!0,value:!1}),_classPrivateFieldInitSpec(this,_isInEditMode,{writable:!0,value:!1}),_classPrivateFieldInitSpec(this,_zIndex,{writable:!0,value:AnnotationEditor._zIndex++}),this.constructor===AnnotationEditor&&(0,_util.unreachable)("Cannot initialize AnnotationEditor."),this.parent=parameters.parent,this.id=parameters.id,this.width=this.height=null,this.pageIndex=parameters.parent.pageIndex,this.name=parameters.name,this.div=null;var _this$parent$viewport=_slicedToArray(this.parent.viewportBaseDimensions,2),width=_this$parent$viewport[0],height=_this$parent$viewport[1];this.x=parameters.x/width,this.y=parameters.y/height,this.rotation=this.parent.viewport.rotation,this.isAttachedToDOM=!1}return _createClass(AnnotationEditor,[{key:"setInBackground",value:function(){this.div.style.zIndex=0}},{key:"setInForeground",value:function(){this.div.style.zIndex=_classPrivateFieldGet(this,_zIndex)}},{key:"focusin",value:function(event){_classPrivateFieldGet(this,_hasBeenSelected)?_classPrivateFieldSet(this,_hasBeenSelected,!1):this.parent.setSelected(this)}},{key:"focusout",value:function(event){if(this.isAttachedToDOM){var target=event.relatedTarget;null!=target&&target.closest("#".concat(this.id))||(event.preventDefault(),this.parent.isMultipleSelection||this.commitOrRemove())}}},{key:"commitOrRemove",value:function(){this.isEmpty()?this.remove():this.commit()}},{key:"commit",value:function(){this.parent.addToAnnotationStorage(this)}},{key:"dragstart",value:function(event){var rect=this.parent.div.getBoundingClientRect();this.startX=event.clientX-rect.x,this.startY=event.clientY-rect.y,event.dataTransfer.setData("text/plain",this.id),event.dataTransfer.effectAllowed="move"}},{key:"setAt",value:function(x,y,tx,ty){var _this$parent$viewport2=_slicedToArray(this.parent.viewportBaseDimensions,2),width=_this$parent$viewport2[0],height=_this$parent$viewport2[1],_this$screenToPageTra2=_slicedToArray(this.screenToPageTranslation(tx,ty),2);tx=_this$screenToPageTra2[0],ty=_this$screenToPageTra2[1],this.x=(x+tx)/width,this.y=(y+ty)/height,this.div.style.left="".concat(100*this.x,"%"),this.div.style.top="".concat(100*this.y,"%")}},{key:"translate",value:function(x,y){var _this$parent$viewport3=_slicedToArray(this.parent.viewportBaseDimensions,2),width=_this$parent$viewport3[0],height=_this$parent$viewport3[1],_this$screenToPageTra4=_slicedToArray(this.screenToPageTranslation(x,y),2);x=_this$screenToPageTra4[0],y=_this$screenToPageTra4[1],this.x+=x/width,this.y+=y/height,this.div.style.left="".concat(100*this.x,"%"),this.div.style.top="".concat(100*this.y,"%")}},{key:"screenToPageTranslation",value:function(x,y){switch(this.parent.viewport.rotation){case 90:return[y,-x];case 180:return[-x,-y];case 270:return[-y,x];default:return[x,y]}}},{key:"setDims",value:function(width,height){var _this$parent$viewport4=_slicedToArray(this.parent.viewportBaseDimensions,2),parentWidth=_this$parent$viewport4[0],parentHeight=_this$parent$viewport4[1];this.div.style.width="".concat(100*width/parentWidth,"%"),this.div.style.height="".concat(100*height/parentHeight,"%")}},{key:"getInitialTranslation",value:function(){return[0,0]}},{key:"render",value:function(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",_classPrivateFieldGet(this,_boundFocusin)),this.div.addEventListener("focusout",_classPrivateFieldGet(this,_boundFocusout));var _this$getInitialTrans2=_slicedToArray(this.getInitialTranslation(),2),tx=_this$getInitialTrans2[0],ty=_this$getInitialTrans2[1];return this.translate(tx,ty),(0,_tools.bindEvents)(this,this.div,["dragstart","pointerdown"]),this.div}},{key:"pointerdown",value:function(event){var isMac=_tools.KeyboardManager.platform.isMac;0!==event.button||event.ctrlKey&&isMac?event.preventDefault():(event.ctrlKey&&!isMac||event.shiftKey||event.metaKey&&isMac?this.parent.toggleSelected(this):this.parent.setSelected(this),_classPrivateFieldSet(this,_hasBeenSelected,!0))}},{key:"getRect",value:function(tx,ty){var _this$parent$viewport5=_slicedToArray(this.parent.viewportBaseDimensions,2),parentWidth=_this$parent$viewport5[0],parentHeight=_this$parent$viewport5[1],_this$parent$pageDime=_slicedToArray(this.parent.pageDimensions,2),pageWidth=_this$parent$pageDime[0],pageHeight=_this$parent$pageDime[1],shiftX=pageWidth*tx/parentWidth,shiftY=pageHeight*ty/parentHeight,x=this.x*pageWidth,y=this.y*pageHeight,width=this.width*pageWidth,height=this.height*pageHeight;switch(this.rotation){case 0:return[x+shiftX,pageHeight-y-shiftY-height,x+shiftX+width,pageHeight-y-shiftY];case 90:return[x+shiftY,pageHeight-y+shiftX,x+shiftY+height,pageHeight-y+shiftX+width];case 180:return[x-shiftX-width,pageHeight-y+shiftY,x-shiftX,pageHeight-y+shiftY+height];case 270:return[x-shiftY-height,pageHeight-y-shiftX-width,x-shiftY,pageHeight-y-shiftX];default:throw new Error("Invalid rotation")}}},{key:"getRectInCurrentCoords",value:function(rect,pageHeight){var _rect=_slicedToArray(rect,4),x1=_rect[0],y1=_rect[1],x2=_rect[2],y2=_rect[3],width=x2-x1,height=y2-y1;switch(this.rotation){case 0:return[x1,pageHeight-y2,width,height];case 90:return[x1,pageHeight-y1,height,width];case 180:return[x2,pageHeight-y1,width,height];case 270:return[x2,pageHeight-y2,height,width];default:throw new Error("Invalid rotation")}}},{key:"onceAdded",value:function(){}},{key:"isEmpty",value:function(){return!1}},{key:"enableEditMode",value:function(){_classPrivateFieldSet(this,_isInEditMode,!0)}},{key:"disableEditMode",value:function(){_classPrivateFieldSet(this,_isInEditMode,!1)}},{key:"isInEditMode",value:function(){return _classPrivateFieldGet(this,_isInEditMode)}},{key:"shouldGetKeyboardEvents",value:function(){return!1}},{key:"needsToBeRebuilt",value:function(){return this.div&&!this.isAttachedToDOM}},{key:"rebuild",value:function(){var _this$div;null===(_this$div=this.div)||void 0===_this$div||_this$div.addEventListener("focusin",_classPrivateFieldGet(this,_boundFocusin))}},{key:"serialize",value:function(){(0,_util.unreachable)("An editor must be serializable")}},{key:"remove",value:function(){this.div.removeEventListener("focusin",_classPrivateFieldGet(this,_boundFocusin)),this.div.removeEventListener("focusout",_classPrivateFieldGet(this,_boundFocusout)),this.isEmpty()||this.commit(),this.parent.remove(this)}},{key:"select",value:function(){var _this$div2;null===(_this$div2=this.div)||void 0===_this$div2||_this$div2.classList.add("selectedEditor")}},{key:"unselect",value:function(){var _this$div3;null===(_this$div3=this.div)||void 0===_this$div3||_this$div3.classList.remove("selectedEditor")}},{key:"updateParams",value:function(type,value){}},{key:"disableEditing",value:function(){}},{key:"enableEditing",value:function(){}},{key:"propertiesToUpdate",get:function(){return{}}},{key:"contentDiv",get:function(){return this.div}},{key:"isEditing",get:function(){return _classPrivateFieldGet(this,_isEditing)},set:function(value){_classPrivateFieldSet(this,_isEditing,value),value?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null)}}],[{key:"_defaultLineColor",get:function(){return(0,_util.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}},{key:"deserialize",value:function(data,parent){var editor=new this.prototype.constructor({parent:parent,id:parent.getNextId()});editor.rotation=data.rotation;var _parent$pageDimension=_slicedToArray(parent.pageDimensions,2),pageWidth=_parent$pageDimension[0],pageHeight=_parent$pageDimension[1],_editor$getRectInCurr2=_slicedToArray(editor.getRectInCurrentCoords(data.rect,pageHeight),4),x=_editor$getRectInCurr2[0],y=_editor$getRectInCurr2[1],width=_editor$getRectInCurr2[2],height=_editor$getRectInCurr2[3];return editor.x=x/pageWidth,editor.y=y/pageHeight,editor.width=width/pageWidth,editor.height=height/pageHeight,editor}}]),AnnotationEditor}();exports.AnnotationEditor=AnnotationEditor,_defineProperty(AnnotationEditor,"_colorManager",new _tools.ColorManager),_defineProperty(AnnotationEditor,"_zIndex",1)},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KeyboardManager=exports.CommandManager=exports.ColorManager=exports.AnnotationEditorUIManager=void 0,exports.bindEvents=function(obj,element,names){var _step21,_iterator21=_createForOfIteratorHelper(names);try{for(_iterator21.s();!(_step21=_iterator21.n()).done;){var name=_step21.value;element.addEventListener(name,obj[name].bind(obj))}}catch(err){_iterator21.e(err)}finally{_iterator21.f()}},exports.opacityToHex=function(opacity){return Math.round(Math.min(255,Math.max(1,255*opacity))).toString(16).padStart(2,"0")};var _util=__w_pdfjs_require__(1),_display_utils=__w_pdfjs_require__(133);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateMethodInitSpec(obj,privateSet){_checkPrivateRedeclaration(obj,privateSet),privateSet.add(obj)}function _classPrivateMethodGet(receiver,privateSet,fn){if(!privateSet.has(receiver))throw new TypeError("attempted to get private field on non-instance");return fn}function _classPrivateFieldInitSpec(obj,privateMap,value){_checkPrivateRedeclaration(obj,privateMap),privateMap.set(obj,value)}function _checkPrivateRedeclaration(obj,privateCollection){if(privateCollection.has(obj))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet(receiver,privateMap,value){return function(receiver,descriptor,value){if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"set"),value),value}function _classPrivateFieldGet(receiver,privateMap){return function(receiver,descriptor){return descriptor.get?descriptor.get.call(receiver):descriptor.value}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"get"))}function _classExtractFieldDescriptor(receiver,privateMap,action){if(!privateMap.has(receiver))throw new TypeError("attempted to "+action+" private field on non-instance");return privateMap.get(receiver)}var _id=new WeakMap,IdManager=function(){function IdManager(){_classCallCheck(this,IdManager),_classPrivateFieldInitSpec(this,_id,{writable:!0,value:0})}return _createClass(IdManager,[{key:"getId",value:function(){var _this$id,_this$id2;return"".concat(_util.AnnotationEditorPrefix).concat((_classPrivateFieldSet(this,_id,(_this$id=_classPrivateFieldGet(this,_id),_this$id2=_this$id++,_this$id)),_this$id2))}}]),IdManager}(),_commands=new WeakMap,_locked=new WeakMap,_maxSize=new WeakMap,_position=new WeakMap,CommandManager=function(){function CommandManager(){_classCallCheck(this,CommandManager);var maxSize=arguments.length>0&&void 0!==arguments[0]?arguments[0]:128;_classPrivateFieldInitSpec(this,_commands,{writable:!0,value:[]}),_classPrivateFieldInitSpec(this,_locked,{writable:!0,value:!1}),_classPrivateFieldInitSpec(this,_maxSize,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_position,{writable:!0,value:-1}),_classPrivateFieldSet(this,_maxSize,maxSize)}return _createClass(CommandManager,[{key:"add",value:function(_ref){var cmd=_ref.cmd,undo=_ref.undo,mustExec=_ref.mustExec,_ref$type=_ref.type,type=void 0===_ref$type?NaN:_ref$type,_ref$overwriteIfSameT=_ref.overwriteIfSameType,overwriteIfSameType=void 0!==_ref$overwriteIfSameT&&_ref$overwriteIfSameT,_ref$keepUndo=_ref.keepUndo,keepUndo=void 0!==_ref$keepUndo&&_ref$keepUndo;if(mustExec&&cmd(),!_classPrivateFieldGet(this,_locked)){var save={cmd:cmd,undo:undo,type:type};if(-1===_classPrivateFieldGet(this,_position))return _classPrivateFieldGet(this,_commands).length>0&&(_classPrivateFieldGet(this,_commands).length=0),_classPrivateFieldSet(this,_position,0),void _classPrivateFieldGet(this,_commands).push(save);if(overwriteIfSameType&&_classPrivateFieldGet(this,_commands)[_classPrivateFieldGet(this,_position)].type===type)return keepUndo&&(save.undo=_classPrivateFieldGet(this,_commands)[_classPrivateFieldGet(this,_position)].undo),void(_classPrivateFieldGet(this,_commands)[_classPrivateFieldGet(this,_position)]=save);var next=_classPrivateFieldGet(this,_position)+1;next===_classPrivateFieldGet(this,_maxSize)?_classPrivateFieldGet(this,_commands).splice(0,1):(_classPrivateFieldSet(this,_position,next),next<_classPrivateFieldGet(this,_commands).length&&_classPrivateFieldGet(this,_commands).splice(next)),_classPrivateFieldGet(this,_commands).push(save)}}},{key:"undo",value:function(){-1!==_classPrivateFieldGet(this,_position)&&(_classPrivateFieldSet(this,_locked,!0),_classPrivateFieldGet(this,_commands)[_classPrivateFieldGet(this,_position)].undo(),_classPrivateFieldSet(this,_locked,!1),_classPrivateFieldSet(this,_position,_classPrivateFieldGet(this,_position)-1))}},{key:"redo",value:function(){_classPrivateFieldGet(this,_position)<_classPrivateFieldGet(this,_commands).length-1&&(_classPrivateFieldSet(this,_position,_classPrivateFieldGet(this,_position)+1),_classPrivateFieldSet(this,_locked,!0),_classPrivateFieldGet(this,_commands)[_classPrivateFieldGet(this,_position)].cmd(),_classPrivateFieldSet(this,_locked,!1))}},{key:"hasSomethingToUndo",value:function(){return-1!==_classPrivateFieldGet(this,_position)}},{key:"hasSomethingToRedo",value:function(){return _classPrivateFieldGet(this,_position)<_classPrivateFieldGet(this,_commands).length-1}},{key:"destroy",value:function(){_classPrivateFieldSet(this,_commands,null)}}]),CommandManager}();exports.CommandManager=CommandManager;var _serialize=new WeakSet,KeyboardManager=function(){function KeyboardManager(callbacks){_classCallCheck(this,KeyboardManager),_classPrivateMethodInitSpec(this,_serialize),this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;var _step22,isMac=KeyboardManager.platform.isMac,_iterator22=_createForOfIteratorHelper(callbacks);try{for(_iterator22.s();!(_step22=_iterator22.n()).done;){var _step23,_step22$value=_slicedToArray(_step22.value,2),keys=_step22$value[0],callback=_step22$value[1],_iterator23=_createForOfIteratorHelper(keys);try{for(_iterator23.s();!(_step23=_iterator23.n()).done;){var key=_step23.value,isMacKey=key.startsWith("mac+");isMac&&isMacKey?(this.callbacks.set(key.slice(4),callback),this.allKeys.add(key.split("+").at(-1))):isMac||isMacKey||(this.callbacks.set(key,callback),this.allKeys.add(key.split("+").at(-1)))}}catch(err){_iterator23.e(err)}finally{_iterator23.f()}}}catch(err){_iterator22.e(err)}finally{_iterator22.f()}}return _createClass(KeyboardManager,[{key:"exec",value:function(self,event){if(this.allKeys.has(event.key)){var callback=this.callbacks.get(_classPrivateMethodGet(this,_serialize,_serialize2).call(this,event));callback&&(callback.bind(self)(),event.stopPropagation(),event.preventDefault())}}}],[{key:"platform",get:function(){var platform="undefined"!=typeof navigator?navigator.platform:"";return(0,_util.shadow)(this,"platform",{isWin:platform.includes("Win"),isMac:platform.includes("Mac")})}}]),KeyboardManager}();function _serialize2(event){event.altKey&&this.buffer.push("alt"),event.ctrlKey&&this.buffer.push("ctrl"),event.metaKey&&this.buffer.push("meta"),event.shiftKey&&this.buffer.push("shift"),this.buffer.push(event.key);var str=this.buffer.join("+");return this.buffer.length=0,str}exports.KeyboardManager=KeyboardManager;var _elements=new WeakMap,ClipboardManager=function(){function ClipboardManager(){_classCallCheck(this,ClipboardManager),_classPrivateFieldInitSpec(this,_elements,{writable:!0,value:null})}return _createClass(ClipboardManager,[{key:"copy",value:function(element){element&&(Array.isArray(element)?_classPrivateFieldSet(this,_elements,element.map((function(el){return el.serialize()}))):_classPrivateFieldSet(this,_elements,[element.serialize()]),_classPrivateFieldSet(this,_elements,_classPrivateFieldGet(this,_elements).filter((function(el){return!!el}))),0===_classPrivateFieldGet(this,_elements).length&&_classPrivateFieldSet(this,_elements,null))}},{key:"paste",value:function(){return _classPrivateFieldGet(this,_elements)}},{key:"isEmpty",value:function(){return null===_classPrivateFieldGet(this,_elements)}},{key:"destroy",value:function(){_classPrivateFieldSet(this,_elements,null)}}]),ClipboardManager}(),ColorManager=function(){function ColorManager(){_classCallCheck(this,ColorManager)}return _createClass(ColorManager,[{key:"_colors",get:function(){var colors=new Map([["CanvasText",null],["Canvas",null]]);return(0,_display_utils.getColorValues)(colors),(0,_util.shadow)(this,"_colors",colors)}},{key:"convert",value:function(color){var rgb=(0,_display_utils.getRGB)(color);if(!window.matchMedia("(forced-colors: active)").matches)return rgb;var _step24,_iterator24=_createForOfIteratorHelper(this._colors);try{for(_iterator24.s();!(_step24=_iterator24.n()).done;){var _step24$value=_slicedToArray(_step24.value,2),name=_step24$value[0];if(_step24$value[1].every((function(x,i){return x===rgb[i]})))return ColorManager._colorsMapping.get(name)}}catch(err){_iterator24.e(err)}finally{_iterator24.f()}return rgb}},{key:"getHexCode",value:function(name){var _util$Util,rgb=this._colors.get(name);return rgb?(_util$Util=_util.Util).makeHexColor.apply(_util$Util,_toConsumableArray(rgb)):name}}]),ColorManager}();exports.ColorManager=ColorManager,_defineProperty(ColorManager,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));var _activeEditor=new WeakMap,_allEditors=new WeakMap,_allLayers=new WeakMap,_clipboardManager=new WeakMap,_commandManager=new WeakMap,_currentPageIndex=new WeakMap,_editorTypes=new WeakMap,_eventBus=new WeakMap,_idManager=new WeakMap,_isEnabled=new WeakMap,_mode=new WeakMap,_selectedEditors=new WeakMap,_boundKeydown=new WeakMap,_boundOnEditingAction=new WeakMap,_boundOnPageChanging=new WeakMap,_previousStates=new WeakMap,_container=new WeakMap,_addKeyboardManager=new WeakSet,_removeKeyboardManager=new WeakSet,_dispatchUpdateStates=new WeakSet,_dispatchUpdateUI=new WeakSet,_enableAll=new WeakSet,_disableAll=new WeakSet,_addEditorToLayer=new WeakSet,_isEmpty=new WeakSet,_selectEditors=new WeakSet,AnnotationEditorUIManager=function(){function AnnotationEditorUIManager(container,eventBus){_classCallCheck(this,AnnotationEditorUIManager),_classPrivateMethodInitSpec(this,_selectEditors),_classPrivateMethodInitSpec(this,_isEmpty),_classPrivateMethodInitSpec(this,_addEditorToLayer),_classPrivateMethodInitSpec(this,_disableAll),_classPrivateMethodInitSpec(this,_enableAll),_classPrivateMethodInitSpec(this,_dispatchUpdateUI),_classPrivateMethodInitSpec(this,_dispatchUpdateStates),_classPrivateMethodInitSpec(this,_removeKeyboardManager),_classPrivateMethodInitSpec(this,_addKeyboardManager),_classPrivateFieldInitSpec(this,_activeEditor,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,_allEditors,{writable:!0,value:new Map}),_classPrivateFieldInitSpec(this,_allLayers,{writable:!0,value:new Map}),_classPrivateFieldInitSpec(this,_clipboardManager,{writable:!0,value:new ClipboardManager}),_classPrivateFieldInitSpec(this,_commandManager,{writable:!0,value:new CommandManager}),_classPrivateFieldInitSpec(this,_currentPageIndex,{writable:!0,value:0}),_classPrivateFieldInitSpec(this,_editorTypes,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,_eventBus,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,_idManager,{writable:!0,value:new IdManager}),_classPrivateFieldInitSpec(this,_isEnabled,{writable:!0,value:!1}),_classPrivateFieldInitSpec(this,_mode,{writable:!0,value:_util.AnnotationEditorType.NONE}),_classPrivateFieldInitSpec(this,_selectedEditors,{writable:!0,value:new Set}),_classPrivateFieldInitSpec(this,_boundKeydown,{writable:!0,value:this.keydown.bind(this)}),_classPrivateFieldInitSpec(this,_boundOnEditingAction,{writable:!0,value:this.onEditingAction.bind(this)}),_classPrivateFieldInitSpec(this,_boundOnPageChanging,{writable:!0,value:this.onPageChanging.bind(this)}),_classPrivateFieldInitSpec(this,_previousStates,{writable:!0,value:{isEditing:!1,isEmpty:!0,hasEmptyClipboard:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1}}),_classPrivateFieldInitSpec(this,_container,{writable:!0,value:null}),_classPrivateFieldSet(this,_container,container),_classPrivateFieldSet(this,_eventBus,eventBus),_classPrivateFieldGet(this,_eventBus)._on("editingaction",_classPrivateFieldGet(this,_boundOnEditingAction)),_classPrivateFieldGet(this,_eventBus)._on("pagechanging",_classPrivateFieldGet(this,_boundOnPageChanging))}return _createClass(AnnotationEditorUIManager,[{key:"destroy",value:function(){_classPrivateMethodGet(this,_removeKeyboardManager,_removeKeyboardManager2).call(this),_classPrivateFieldGet(this,_eventBus)._off("editingaction",_classPrivateFieldGet(this,_boundOnEditingAction)),_classPrivateFieldGet(this,_eventBus)._off("pagechanging",_classPrivateFieldGet(this,_boundOnPageChanging));var _step25,_iterator25=_createForOfIteratorHelper(_classPrivateFieldGet(this,_allLayers).values());try{for(_iterator25.s();!(_step25=_iterator25.n()).done;)_step25.value.destroy()}catch(err){_iterator25.e(err)}finally{_iterator25.f()}_classPrivateFieldGet(this,_allLayers).clear(),_classPrivateFieldGet(this,_allEditors).clear(),_classPrivateFieldSet(this,_activeEditor,null),_classPrivateFieldGet(this,_selectedEditors).clear(),_classPrivateFieldGet(this,_clipboardManager).destroy(),_classPrivateFieldGet(this,_commandManager).destroy()}},{key:"onPageChanging",value:function(_ref2){var pageNumber=_ref2.pageNumber;_classPrivateFieldSet(this,_currentPageIndex,pageNumber-1)}},{key:"focusMainContainer",value:function(){_classPrivateFieldGet(this,_container).focus()}},{key:"keydown",value:function(event){var _this$getActive;null!==(_this$getActive=this.getActive())&&void 0!==_this$getActive&&_this$getActive.shouldGetKeyboardEvents()||AnnotationEditorUIManager._keyboardManager.exec(this,event)}},{key:"onEditingAction",value:function(details){["undo","redo","cut","copy","paste","delete","selectAll"].includes(details.name)&&this[details.name]()}},{key:"setEditingState",value:function(isEditing){isEditing?(_classPrivateMethodGet(this,_addKeyboardManager,_addKeyboardManager2).call(this),_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{isEditing:_classPrivateFieldGet(this,_mode)!==_util.AnnotationEditorType.NONE,isEmpty:_classPrivateMethodGet(this,_isEmpty,_isEmpty2).call(this),hasSomethingToUndo:_classPrivateFieldGet(this,_commandManager).hasSomethingToUndo(),hasSomethingToRedo:_classPrivateFieldGet(this,_commandManager).hasSomethingToRedo(),hasSelectedEditor:!1,hasEmptyClipboard:_classPrivateFieldGet(this,_clipboardManager).isEmpty()})):(_classPrivateMethodGet(this,_removeKeyboardManager,_removeKeyboardManager2).call(this),_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{isEditing:!1}))}},{key:"registerEditorTypes",value:function(types){_classPrivateFieldSet(this,_editorTypes,types);var _step26,_iterator26=_createForOfIteratorHelper(_classPrivateFieldGet(this,_editorTypes));try{for(_iterator26.s();!(_step26=_iterator26.n()).done;){var editorType=_step26.value;_classPrivateMethodGet(this,_dispatchUpdateUI,_dispatchUpdateUI2).call(this,editorType.defaultPropertiesToUpdate)}}catch(err){_iterator26.e(err)}finally{_iterator26.f()}}},{key:"getId",value:function(){return _classPrivateFieldGet(this,_idManager).getId()}},{key:"addLayer",value:function(layer){_classPrivateFieldGet(this,_allLayers).set(layer.pageIndex,layer),_classPrivateFieldGet(this,_isEnabled)?layer.enable():layer.disable()}},{key:"removeLayer",value:function(layer){_classPrivateFieldGet(this,_allLayers).delete(layer.pageIndex)}},{key:"updateMode",value:function(mode){if(_classPrivateFieldSet(this,_mode,mode),mode===_util.AnnotationEditorType.NONE)this.setEditingState(!1),_classPrivateMethodGet(this,_disableAll,_disableAll2).call(this);else{this.setEditingState(!0),_classPrivateMethodGet(this,_enableAll,_enableAll2).call(this);var _step27,_iterator27=_createForOfIteratorHelper(_classPrivateFieldGet(this,_allLayers).values());try{for(_iterator27.s();!(_step27=_iterator27.n()).done;)_step27.value.updateMode(mode)}catch(err){_iterator27.e(err)}finally{_iterator27.f()}}}},{key:"updateToolbar",value:function(mode){mode!==_classPrivateFieldGet(this,_mode)&&_classPrivateFieldGet(this,_eventBus).dispatch("switchannotationeditormode",{source:this,mode:mode})}},{key:"updateParams",value:function(type,value){var _step28,_iterator28=_createForOfIteratorHelper(_classPrivateFieldGet(this,_selectedEditors));try{for(_iterator28.s();!(_step28=_iterator28.n()).done;)_step28.value.updateParams(type,value)}catch(err){_iterator28.e(err)}finally{_iterator28.f()}var _step29,_iterator29=_createForOfIteratorHelper(_classPrivateFieldGet(this,_editorTypes));try{for(_iterator29.s();!(_step29=_iterator29.n()).done;)_step29.value.updateDefaultParams(type,value)}catch(err){_iterator29.e(err)}finally{_iterator29.f()}}},{key:"getEditors",value:function(pageIndex){var _step30,editors=[],_iterator30=_createForOfIteratorHelper(_classPrivateFieldGet(this,_allEditors).values());try{for(_iterator30.s();!(_step30=_iterator30.n()).done;){var editor=_step30.value;editor.pageIndex===pageIndex&&editors.push(editor)}}catch(err){_iterator30.e(err)}finally{_iterator30.f()}return editors}},{key:"getEditor",value:function(id){return _classPrivateFieldGet(this,_allEditors).get(id)}},{key:"addEditor",value:function(editor){_classPrivateFieldGet(this,_allEditors).set(editor.id,editor)}},{key:"removeEditor",value:function(editor){_classPrivateFieldGet(this,_allEditors).delete(editor.id),this.unselect(editor)}},{key:"setActiveEditor",value:function(editor){_classPrivateFieldGet(this,_activeEditor)!==editor&&(_classPrivateFieldSet(this,_activeEditor,editor),editor&&_classPrivateMethodGet(this,_dispatchUpdateUI,_dispatchUpdateUI2).call(this,editor.propertiesToUpdate))}},{key:"toggleSelected",value:function(editor){if(_classPrivateFieldGet(this,_selectedEditors).has(editor))return _classPrivateFieldGet(this,_selectedEditors).delete(editor),editor.unselect(),void _classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{hasSelectedEditor:this.hasSelection});_classPrivateFieldGet(this,_selectedEditors).add(editor),editor.select(),_classPrivateMethodGet(this,_dispatchUpdateUI,_dispatchUpdateUI2).call(this,editor.propertiesToUpdate),_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{hasSelectedEditor:!0})}},{key:"setSelected",value:function(editor){var _step31,_iterator31=_createForOfIteratorHelper(_classPrivateFieldGet(this,_selectedEditors));try{for(_iterator31.s();!(_step31=_iterator31.n()).done;){var ed=_step31.value;ed!==editor&&ed.unselect()}}catch(err){_iterator31.e(err)}finally{_iterator31.f()}_classPrivateFieldGet(this,_selectedEditors).clear(),_classPrivateFieldGet(this,_selectedEditors).add(editor),editor.select(),_classPrivateMethodGet(this,_dispatchUpdateUI,_dispatchUpdateUI2).call(this,editor.propertiesToUpdate),_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{hasSelectedEditor:!0})}},{key:"isSelected",value:function(editor){return _classPrivateFieldGet(this,_selectedEditors).has(editor)}},{key:"unselect",value:function(editor){editor.unselect(),_classPrivateFieldGet(this,_selectedEditors).delete(editor),_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{hasSelectedEditor:this.hasSelection})}},{key:"hasSelection",get:function(){return 0!==_classPrivateFieldGet(this,_selectedEditors).size}},{key:"undo",value:function(){_classPrivateFieldGet(this,_commandManager).undo(),_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{hasSomethingToUndo:_classPrivateFieldGet(this,_commandManager).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:_classPrivateMethodGet(this,_isEmpty,_isEmpty2).call(this)})}},{key:"redo",value:function(){_classPrivateFieldGet(this,_commandManager).redo(),_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:_classPrivateFieldGet(this,_commandManager).hasSomethingToRedo(),isEmpty:_classPrivateMethodGet(this,_isEmpty,_isEmpty2).call(this)})}},{key:"addCommands",value:function(params){_classPrivateFieldGet(this,_commandManager).add(params),_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:_classPrivateMethodGet(this,_isEmpty,_isEmpty2).call(this)})}},{key:"delete",value:function(){var _this22=this;if(_classPrivateFieldGet(this,_activeEditor)&&_classPrivateFieldGet(this,_activeEditor).commitOrRemove(),this.hasSelection){var editors=_toConsumableArray(_classPrivateFieldGet(this,_selectedEditors));this.addCommands({cmd:function(){var _step32,_iterator32=_createForOfIteratorHelper(editors);try{for(_iterator32.s();!(_step32=_iterator32.n()).done;)_step32.value.remove()}catch(err){_iterator32.e(err)}finally{_iterator32.f()}},undo:function(){var _step33,_iterator33=_createForOfIteratorHelper(editors);try{for(_iterator33.s();!(_step33=_iterator33.n()).done;){var editor=_step33.value;_classPrivateMethodGet(_this22,_addEditorToLayer,_addEditorToLayer2).call(_this22,editor)}}catch(err){_iterator33.e(err)}finally{_iterator33.f()}},mustExec:!0})}}},{key:"copy",value:function(){if(_classPrivateFieldGet(this,_activeEditor)&&_classPrivateFieldGet(this,_activeEditor).commitOrRemove(),this.hasSelection){var _step34,editors=[],_iterator34=_createForOfIteratorHelper(_classPrivateFieldGet(this,_selectedEditors));try{for(_iterator34.s();!(_step34=_iterator34.n()).done;){var editor=_step34.value;editor.isEmpty()||editors.push(editor)}}catch(err){_iterator34.e(err)}finally{_iterator34.f()}if(0===editors.length)return;_classPrivateFieldGet(this,_clipboardManager).copy(editors),_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{hasEmptyClipboard:!1})}}},{key:"cut",value:function(){this.copy(),this.delete()}},{key:"paste",value:function(){var _this23=this;if(!_classPrivateFieldGet(this,_clipboardManager).isEmpty()){this.unselectAll();var layer=_classPrivateFieldGet(this,_allLayers).get(_classPrivateFieldGet(this,_currentPageIndex)),newEditors=_classPrivateFieldGet(this,_clipboardManager).paste().map((function(data){return layer.deserialize(data)}));this.addCommands({cmd:function(){var _step35,_iterator35=_createForOfIteratorHelper(newEditors);try{for(_iterator35.s();!(_step35=_iterator35.n()).done;){var editor=_step35.value;_classPrivateMethodGet(_this23,_addEditorToLayer,_addEditorToLayer2).call(_this23,editor)}}catch(err){_iterator35.e(err)}finally{_iterator35.f()}_classPrivateMethodGet(_this23,_selectEditors,_selectEditors2).call(_this23,newEditors)},undo:function(){var _step36,_iterator36=_createForOfIteratorHelper(newEditors);try{for(_iterator36.s();!(_step36=_iterator36.n()).done;)_step36.value.remove()}catch(err){_iterator36.e(err)}finally{_iterator36.f()}},mustExec:!0})}}},{key:"selectAll",value:function(){var _step37,_iterator37=_createForOfIteratorHelper(_classPrivateFieldGet(this,_selectedEditors));try{for(_iterator37.s();!(_step37=_iterator37.n()).done;)_step37.value.commit()}catch(err){_iterator37.e(err)}finally{_iterator37.f()}_classPrivateMethodGet(this,_selectEditors,_selectEditors2).call(this,_classPrivateFieldGet(this,_allEditors).values())}},{key:"unselectAll",value:function(){if(_classPrivateFieldGet(this,_activeEditor))_classPrivateFieldGet(this,_activeEditor).commitOrRemove();else if(0!==_classPrivateMethodGet(this,_selectEditors,_selectEditors2).size){var _step38,_iterator38=_createForOfIteratorHelper(_classPrivateFieldGet(this,_selectedEditors));try{for(_iterator38.s();!(_step38=_iterator38.n()).done;)_step38.value.unselect()}catch(err){_iterator38.e(err)}finally{_iterator38.f()}_classPrivateFieldGet(this,_selectedEditors).clear(),_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{hasSelectedEditor:!1})}}},{key:"isActive",value:function(editor){return _classPrivateFieldGet(this,_activeEditor)===editor}},{key:"getActive",value:function(){return _classPrivateFieldGet(this,_activeEditor)}},{key:"getMode",value:function(){return _classPrivateFieldGet(this,_mode)}}]),AnnotationEditorUIManager}();function _addKeyboardManager2(){_classPrivateFieldGet(this,_container).addEventListener("keydown",_classPrivateFieldGet(this,_boundKeydown))}function _removeKeyboardManager2(){_classPrivateFieldGet(this,_container).removeEventListener("keydown",_classPrivateFieldGet(this,_boundKeydown))}function _dispatchUpdateStates2(details){var _this24=this;Object.entries(details).some((function(_ref3){var _ref26=_slicedToArray(_ref3,2),key=_ref26[0],value=_ref26[1];return _classPrivateFieldGet(_this24,_previousStates)[key]!==value}))&&_classPrivateFieldGet(this,_eventBus).dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(_classPrivateFieldGet(this,_previousStates),details)})}function _dispatchUpdateUI2(details){_classPrivateFieldGet(this,_eventBus).dispatch("annotationeditorparamschanged",{source:this,details:details})}function _enableAll2(){if(!_classPrivateFieldGet(this,_isEnabled)){_classPrivateFieldSet(this,_isEnabled,!0);var _step39,_iterator39=_createForOfIteratorHelper(_classPrivateFieldGet(this,_allLayers).values());try{for(_iterator39.s();!(_step39=_iterator39.n()).done;)_step39.value.enable()}catch(err){_iterator39.e(err)}finally{_iterator39.f()}}}function _disableAll2(){if(this.unselectAll(),_classPrivateFieldGet(this,_isEnabled)){_classPrivateFieldSet(this,_isEnabled,!1);var _step40,_iterator40=_createForOfIteratorHelper(_classPrivateFieldGet(this,_allLayers).values());try{for(_iterator40.s();!(_step40=_iterator40.n()).done;)_step40.value.disable()}catch(err){_iterator40.e(err)}finally{_iterator40.f()}}}function _addEditorToLayer2(editor){var layer=_classPrivateFieldGet(this,_allLayers).get(editor.pageIndex);layer?layer.addOrRebuild(editor):this.addEditor(editor)}function _isEmpty2(){if(0===_classPrivateFieldGet(this,_allEditors).size)return!0;if(1===_classPrivateFieldGet(this,_allEditors).size){var _step41,_iterator41=_createForOfIteratorHelper(_classPrivateFieldGet(this,_allEditors).values());try{for(_iterator41.s();!(_step41=_iterator41.n()).done;)return _step41.value.isEmpty()}catch(err){_iterator41.e(err)}finally{_iterator41.f()}}return!1}function _selectEditors2(editors){_classPrivateFieldGet(this,_selectedEditors).clear();var _step42,_iterator42=_createForOfIteratorHelper(editors);try{for(_iterator42.s();!(_step42=_iterator42.n()).done;){var editor=_step42.value;editor.isEmpty()||(_classPrivateFieldGet(this,_selectedEditors).add(editor),editor.select())}}catch(err){_iterator42.e(err)}finally{_iterator42.f()}_classPrivateMethodGet(this,_dispatchUpdateStates,_dispatchUpdateStates2).call(this,{hasSelectedEditor:!0})}exports.AnnotationEditorUIManager=AnnotationEditorUIManager,_defineProperty(AnnotationEditorUIManager,"_keyboardManager",new KeyboardManager([[["ctrl+a","mac+meta+a"],AnnotationEditorUIManager.prototype.selectAll],[["ctrl+c","mac+meta+c"],AnnotationEditorUIManager.prototype.copy],[["ctrl+v","mac+meta+v"],AnnotationEditorUIManager.prototype.paste],[["ctrl+x","mac+meta+x"],AnnotationEditorUIManager.prototype.cut],[["ctrl+z","mac+meta+z"],AnnotationEditorUIManager.prototype.undo],[["ctrl+y","ctrl+shift+Z","mac+meta+shift+Z"],AnnotationEditorUIManager.prototype.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete"],AnnotationEditorUIManager.prototype.delete],[["Escape","mac+Escape"],AnnotationEditorUIManager.prototype.unselectAll]]))},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.StatTimer=exports.RenderingCancelledException=exports.PixelsPerInch=exports.PageViewport=exports.PDFDateString=exports.DOMStandardFontDataFactory=exports.DOMSVGFactory=exports.DOMCanvasFactory=exports.DOMCMapReaderFactory=exports.AnnotationPrefix=void 0,exports.deprecated=function(details){console.log("Deprecated API usage: "+details)},exports.getColorValues=function(colors){var span=document.createElement("span");span.style.visibility="hidden",document.body.append(span);var _step45,_iterator45=_createForOfIteratorHelper(colors.keys());try{for(_iterator45.s();!(_step45=_iterator45.n()).done;){var name=_step45.value;span.style.color=name;var computedColor=window.getComputedStyle(span).color;colors.set(name,getRGB(computedColor))}}catch(err){_iterator45.e(err)}finally{_iterator45.f()}span.remove()},exports.getCurrentTransform=function(ctx){var _ctx$getTransform=ctx.getTransform(),a=_ctx$getTransform.a,b=_ctx$getTransform.b,c=_ctx$getTransform.c,d=_ctx$getTransform.d,e=_ctx$getTransform.e,f=_ctx$getTransform.f;return[a,b,c,d,e,f]},exports.getCurrentTransformInverse=function(ctx){var _ctx$getTransform$inv=ctx.getTransform().invertSelf(),a=_ctx$getTransform$inv.a,b=_ctx$getTransform$inv.b,c=_ctx$getTransform$inv.c,d=_ctx$getTransform$inv.d,e=_ctx$getTransform$inv.e,f=_ctx$getTransform$inv.f;return[a,b,c,d,e,f]},exports.getFilenameFromUrl=function(url){var anchor=url.indexOf("#"),query=url.indexOf("?"),end=Math.min(anchor>0?anchor:url.length,query>0?query:url.length);return url.substring(url.lastIndexOf("/",end)+1,end)},exports.getPdfFilenameFromUrl=function(url){var defaultFilename=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"document.pdf";if("string"!=typeof url)return defaultFilename;if(isDataScheme(url))return(0,_util.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),defaultFilename;var reFilename=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,splitURI=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/.exec(url),suggestedFilename=reFilename.exec(splitURI[1])||reFilename.exec(splitURI[2])||reFilename.exec(splitURI[3]);if(suggestedFilename&&(suggestedFilename=suggestedFilename[0]).includes("%"))try{suggestedFilename=reFilename.exec(decodeURIComponent(suggestedFilename))[0]}catch(ex){}return suggestedFilename||defaultFilename},exports.getRGB=getRGB,exports.getXfaPageViewport=function(xfaPage,_ref2){var _ref2$scale=_ref2.scale,scale=void 0===_ref2$scale?1:_ref2$scale,_ref2$rotation=_ref2.rotation,rotation=void 0===_ref2$rotation?0:_ref2$rotation,_xfaPage$attributes$s=xfaPage.attributes.style,width=_xfaPage$attributes$s.width,height=_xfaPage$attributes$s.height,viewBox=[0,0,parseInt(width),parseInt(height)];return new PageViewport({viewBox:viewBox,scale:scale,rotation:rotation})},exports.isDataScheme=isDataScheme,exports.isPdfFile=function(filename){return"string"==typeof filename&&/\.pdf$/i.test(filename)},exports.isValidFetchUrl=isValidFetchUrl,exports.loadScript=function(src){var removeScriptElement=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new Promise((function(resolve,reject){var script=document.createElement("script");script.src=src,script.onload=function(evt){removeScriptElement&&script.remove(),resolve(evt)},script.onerror=function(){reject(new Error("Cannot load script at: ".concat(script.src)))},(document.head||document.documentElement).append(script)}))};var _base_factory=__w_pdfjs_require__(134),_util=__w_pdfjs_require__(1);function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}exports.AnnotationPrefix="pdfjs_internal_id_";var PixelsPerInch=_createClass((function PixelsPerInch(){_classCallCheck(this,PixelsPerInch)}));exports.PixelsPerInch=PixelsPerInch,_defineProperty(PixelsPerInch,"CSS",96),_defineProperty(PixelsPerInch,"PDF",72),_defineProperty(PixelsPerInch,"PDF_TO_CSS_UNITS",PixelsPerInch.CSS/PixelsPerInch.PDF);var DOMCanvasFactory=function(_base_factory$BaseCan){function DOMCanvasFactory(){var _this25;_classCallCheck(this,DOMCanvasFactory);var _ref27$ownerDocument=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).ownerDocument,ownerDocument=void 0===_ref27$ownerDocument?globalThis.document:_ref27$ownerDocument;return(_this25=_callSuper(this,DOMCanvasFactory))._document=ownerDocument,_this25}return _inherits(DOMCanvasFactory,_base_factory$BaseCan),_createClass(DOMCanvasFactory,[{key:"_createCanvas",value:function(width,height){var canvas=this._document.createElement("canvas");return canvas.width=width,canvas.height=height,canvas}}]),DOMCanvasFactory}(_base_factory.BaseCanvasFactory);function fetchData(_x5){return _fetchData.apply(this,arguments)}function _fetchData(){return _fetchData=_asyncToGenerator(_regeneratorRuntime().mark((function _callee8(url){var asTypedArray,response,_args8=arguments;return _regeneratorRuntime().wrap((function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(asTypedArray=_args8.length>1&&void 0!==_args8[1]&&_args8[1],!isValidFetchUrl(url,document.baseURI)){_context8.next=21;break}return _context8.next=4,fetch(url);case 4:if((response=_context8.sent).ok){_context8.next=7;break}throw new Error(response.statusText);case 7:if(!asTypedArray){_context8.next=15;break}return _context8.t1=Uint8Array,_context8.next=11,response.arrayBuffer();case 11:_context8.t2=_context8.sent,_context8.t0=new _context8.t1(_context8.t2),_context8.next=20;break;case 15:return _context8.t3=_util.stringToBytes,_context8.next=18,response.text();case 18:_context8.t4=_context8.sent,_context8.t0=(0,_context8.t3)(_context8.t4);case 20:return _context8.abrupt("return",_context8.t0);case 21:return _context8.abrupt("return",new Promise((function(resolve,reject){var request=new XMLHttpRequest;request.open("GET",url,!0),asTypedArray&&(request.responseType="arraybuffer"),request.onreadystatechange=function(){if(request.readyState===XMLHttpRequest.DONE){var data;if((200===request.status||0===request.status)&&(asTypedArray&&request.response?data=new Uint8Array(request.response):!asTypedArray&&request.responseText&&(data=(0,_util.stringToBytes)(request.responseText)),data))return void resolve(data);reject(new Error(request.statusText))}},request.send(null)})));case 22:case"end":return _context8.stop()}}),_callee8)}))),_fetchData.apply(this,arguments)}exports.DOMCanvasFactory=DOMCanvasFactory;var DOMCMapReaderFactory=function(_base_factory$BaseCMa){function DOMCMapReaderFactory(){return _classCallCheck(this,DOMCMapReaderFactory),_callSuper(this,DOMCMapReaderFactory,arguments)}return _inherits(DOMCMapReaderFactory,_base_factory$BaseCMa),_createClass(DOMCMapReaderFactory,[{key:"_fetchData",value:function(url,compressionType){return fetchData(url,this.isCompressed).then((function(data){return{cMapData:data,compressionType:compressionType}}))}}]),DOMCMapReaderFactory}(_base_factory.BaseCMapReaderFactory);exports.DOMCMapReaderFactory=DOMCMapReaderFactory;var DOMStandardFontDataFactory=function(_base_factory$BaseSta){function DOMStandardFontDataFactory(){return _classCallCheck(this,DOMStandardFontDataFactory),_callSuper(this,DOMStandardFontDataFactory,arguments)}return _inherits(DOMStandardFontDataFactory,_base_factory$BaseSta),_createClass(DOMStandardFontDataFactory,[{key:"_fetchData",value:function(url){return fetchData(url,!0)}}]),DOMStandardFontDataFactory}(_base_factory.BaseStandardFontDataFactory);exports.DOMStandardFontDataFactory=DOMStandardFontDataFactory;var DOMSVGFactory=function(_base_factory$BaseSVG){function DOMSVGFactory(){return _classCallCheck(this,DOMSVGFactory),_callSuper(this,DOMSVGFactory,arguments)}return _inherits(DOMSVGFactory,_base_factory$BaseSVG),_createClass(DOMSVGFactory,[{key:"_createSVG",value:function(type){return document.createElementNS("http://www.w3.org/2000/svg",type)}}]),DOMSVGFactory}(_base_factory.BaseSVGFactory);exports.DOMSVGFactory=DOMSVGFactory;var PageViewport=function(){function PageViewport(_ref){_classCallCheck(this,PageViewport);var viewBox=_ref.viewBox,scale=_ref.scale,rotation=_ref.rotation,_ref$offsetX=_ref.offsetX,offsetX=void 0===_ref$offsetX?0:_ref$offsetX,_ref$offsetY=_ref.offsetY,offsetY=void 0===_ref$offsetY?0:_ref$offsetY,_ref$dontFlip=_ref.dontFlip,dontFlip=void 0!==_ref$dontFlip&&_ref$dontFlip;this.viewBox=viewBox,this.scale=scale,this.rotation=rotation,this.offsetX=offsetX,this.offsetY=offsetY;var rotateA,rotateB,rotateC,rotateD,offsetCanvasX,offsetCanvasY,width,height,centerX=(viewBox[2]+viewBox[0])/2,centerY=(viewBox[3]+viewBox[1])/2;switch((rotation%=360)<0&&(rotation+=360),rotation){case 180:rotateA=-1,rotateB=0,rotateC=0,rotateD=1;break;case 90:rotateA=0,rotateB=1,rotateC=1,rotateD=0;break;case 270:rotateA=0,rotateB=-1,rotateC=-1,rotateD=0;break;case 0:rotateA=1,rotateB=0,rotateC=0,rotateD=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}dontFlip&&(rotateC=-rotateC,rotateD=-rotateD),0===rotateA?(offsetCanvasX=Math.abs(centerY-viewBox[1])*scale+offsetX,offsetCanvasY=Math.abs(centerX-viewBox[0])*scale+offsetY,width=Math.abs(viewBox[3]-viewBox[1])*scale,height=Math.abs(viewBox[2]-viewBox[0])*scale):(offsetCanvasX=Math.abs(centerX-viewBox[0])*scale+offsetX,offsetCanvasY=Math.abs(centerY-viewBox[1])*scale+offsetY,width=Math.abs(viewBox[2]-viewBox[0])*scale,height=Math.abs(viewBox[3]-viewBox[1])*scale),this.transform=[rotateA*scale,rotateB*scale,rotateC*scale,rotateD*scale,offsetCanvasX-rotateA*scale*centerX-rotateC*scale*centerY,offsetCanvasY-rotateB*scale*centerX-rotateD*scale*centerY],this.width=width,this.height=height}return _createClass(PageViewport,[{key:"clone",value:function(){var _ref28=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},_ref28$scale=_ref28.scale,scale=void 0===_ref28$scale?this.scale:_ref28$scale,_ref28$rotation=_ref28.rotation,rotation=void 0===_ref28$rotation?this.rotation:_ref28$rotation,_ref28$offsetX=_ref28.offsetX,offsetX=void 0===_ref28$offsetX?this.offsetX:_ref28$offsetX,_ref28$offsetY=_ref28.offsetY,offsetY=void 0===_ref28$offsetY?this.offsetY:_ref28$offsetY,_ref28$dontFlip=_ref28.dontFlip,dontFlip=void 0!==_ref28$dontFlip&&_ref28$dontFlip;return new PageViewport({viewBox:this.viewBox.slice(),scale:scale,rotation:rotation,offsetX:offsetX,offsetY:offsetY,dontFlip:dontFlip})}},{key:"convertToViewportPoint",value:function(x,y){return _util.Util.applyTransform([x,y],this.transform)}},{key:"convertToViewportRectangle",value:function(rect){var topLeft=_util.Util.applyTransform([rect[0],rect[1]],this.transform),bottomRight=_util.Util.applyTransform([rect[2],rect[3]],this.transform);return[topLeft[0],topLeft[1],bottomRight[0],bottomRight[1]]}},{key:"convertToPdfPoint",value:function(x,y){return _util.Util.applyInverseTransform([x,y],this.transform)}}]),PageViewport}();exports.PageViewport=PageViewport;var RenderingCancelledException=function(_util$BaseException){function RenderingCancelledException(msg,type){var _this26;return _classCallCheck(this,RenderingCancelledException),(_this26=_callSuper(this,RenderingCancelledException,[msg,"RenderingCancelledException"])).type=type,_this26}return _inherits(RenderingCancelledException,_util$BaseException),_createClass(RenderingCancelledException)}(_util.BaseException);function isDataScheme(url){for(var ii=url.length,i=0;i<ii&&""===url[i].trim();)i++;return"data:"===url.substring(i,i+5).toLowerCase()}exports.RenderingCancelledException=RenderingCancelledException;var pdfDateStringRegex,StatTimer=function(){function StatTimer(){_classCallCheck(this,StatTimer),this.started=Object.create(null),this.times=[]}return _createClass(StatTimer,[{key:"time",value:function(name){name in this.started&&(0,_util.warn)("Timer is already running for ".concat(name)),this.started[name]=Date.now()}},{key:"timeEnd",value:function(name){name in this.started||(0,_util.warn)("Timer has not been started for ".concat(name)),this.times.push({name:name,start:this.started[name],end:Date.now()}),delete this.started[name]}},{key:"toString",value:function(){var _step43,outBuf=[],longest=0,_iterator43=_createForOfIteratorHelper(this.times);try{for(_iterator43.s();!(_step43=_iterator43.n()).done;){var name=_step43.value.name;name.length>longest&&(longest=name.length)}}catch(err){_iterator43.e(err)}finally{_iterator43.f()}var _step44,_iterator44=_createForOfIteratorHelper(this.times);try{for(_iterator44.s();!(_step44=_iterator44.n()).done;){var _time=_step44.value,duration=_time.end-_time.start;outBuf.push("".concat(_time.name.padEnd(longest)," ").concat(duration,"ms\n"))}}catch(err){_iterator44.e(err)}finally{_iterator44.f()}return outBuf.join("")}}]),StatTimer}();function isValidFetchUrl(url,baseUrl){try{var protocol=(baseUrl?new URL(url,baseUrl):new URL(url)).protocol;return"http:"===protocol||"https:"===protocol}catch(ex){return!1}}exports.StatTimer=StatTimer;var PDFDateString=function(){function PDFDateString(){_classCallCheck(this,PDFDateString)}return _createClass(PDFDateString,null,[{key:"toDateObject",value:function(input){if(!input||"string"!=typeof input)return null;pdfDateStringRegex||(pdfDateStringRegex=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));var matches=pdfDateStringRegex.exec(input);if(!matches)return null;var year=parseInt(matches[1],10),month=parseInt(matches[2],10);month=month>=1&&month<=12?month-1:0;var day=parseInt(matches[3],10);day=day>=1&&day<=31?day:1;var hour=parseInt(matches[4],10);hour=hour>=0&&hour<=23?hour:0;var minute=parseInt(matches[5],10);minute=minute>=0&&minute<=59?minute:0;var second=parseInt(matches[6],10);second=second>=0&&second<=59?second:0;var universalTimeRelation=matches[7]||"Z",offsetHour=parseInt(matches[8],10);offsetHour=offsetHour>=0&&offsetHour<=23?offsetHour:0;var offsetMinute=parseInt(matches[9],10)||0;return offsetMinute=offsetMinute>=0&&offsetMinute<=59?offsetMinute:0,"-"===universalTimeRelation?(hour+=offsetHour,minute+=offsetMinute):"+"===universalTimeRelation&&(hour-=offsetHour,minute-=offsetMinute),new Date(Date.UTC(year,month,day,hour,minute,second))}}]),PDFDateString}();function getRGB(color){if(color.startsWith("#")){var colorRGB=parseInt(color.slice(1),16);return[(16711680&colorRGB)>>16,(65280&colorRGB)>>8,255&colorRGB]}return color.startsWith("rgb(")?color.slice(4,-1).split(",").map((function(x){return parseInt(x)})):color.startsWith("rgba(")?color.slice(5,-1).split(",").map((function(x){return parseInt(x)})).slice(0,3):((0,_util.warn)('Not a valid color format: "'.concat(color,'"')),[0,0,0])}exports.PDFDateString=PDFDateString},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.BaseStandardFontDataFactory=exports.BaseSVGFactory=exports.BaseCanvasFactory=exports.BaseCMapReaderFactory=void 0;var _util=__w_pdfjs_require__(1),BaseCanvasFactory=function(){function BaseCanvasFactory(){_classCallCheck(this,BaseCanvasFactory),this.constructor===BaseCanvasFactory&&(0,_util.unreachable)("Cannot initialize BaseCanvasFactory.")}return _createClass(BaseCanvasFactory,[{key:"create",value:function(width,height){if(width<=0||height<=0)throw new Error("Invalid canvas size");var canvas=this._createCanvas(width,height);return{canvas:canvas,context:canvas.getContext("2d")}}},{key:"reset",value:function(canvasAndContext,width,height){if(!canvasAndContext.canvas)throw new Error("Canvas is not specified");if(width<=0||height<=0)throw new Error("Invalid canvas size");canvasAndContext.canvas.width=width,canvasAndContext.canvas.height=height}},{key:"destroy",value:function(canvasAndContext){if(!canvasAndContext.canvas)throw new Error("Canvas is not specified");canvasAndContext.canvas.width=0,canvasAndContext.canvas.height=0,canvasAndContext.canvas=null,canvasAndContext.context=null}},{key:"_createCanvas",value:function(width,height){(0,_util.unreachable)("Abstract method `_createCanvas` called.")}}]),BaseCanvasFactory}();exports.BaseCanvasFactory=BaseCanvasFactory;var BaseCMapReaderFactory=function(){function BaseCMapReaderFactory(_ref){_classCallCheck(this,BaseCMapReaderFactory);var _ref$baseUrl=_ref.baseUrl,baseUrl=void 0===_ref$baseUrl?null:_ref$baseUrl,_ref$isCompressed=_ref.isCompressed,isCompressed=void 0!==_ref$isCompressed&&_ref$isCompressed;this.constructor===BaseCMapReaderFactory&&(0,_util.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=baseUrl,this.isCompressed=isCompressed}var _fetch;return _createClass(BaseCMapReaderFactory,[{key:"fetch",value:(_fetch=_asyncToGenerator(_regeneratorRuntime().mark((function _callee9(_ref2){var name,url,compressionType,_this27=this;return _regeneratorRuntime().wrap((function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:if(name=_ref2.name,this.baseUrl){_context9.next=3;break}throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');case 3:if(name){_context9.next=5;break}throw new Error("CMap name must be specified.");case 5:return url=this.baseUrl+name+(this.isCompressed?".bcmap":""),compressionType=this.isCompressed?_util.CMapCompressionType.BINARY:_util.CMapCompressionType.NONE,_context9.abrupt("return",this._fetchData(url,compressionType).catch((function(reason){throw new Error("Unable to load ".concat(_this27.isCompressed?"binary ":"","CMap at: ").concat(url))})));case 8:case"end":return _context9.stop()}}),_callee9,this)}))),function(_x6){return _fetch.apply(this,arguments)})},{key:"_fetchData",value:function(url,compressionType){(0,_util.unreachable)("Abstract method `_fetchData` called.")}}]),BaseCMapReaderFactory}();exports.BaseCMapReaderFactory=BaseCMapReaderFactory;var BaseStandardFontDataFactory=function(){function BaseStandardFontDataFactory(_ref3){_classCallCheck(this,BaseStandardFontDataFactory);var _ref3$baseUrl=_ref3.baseUrl,baseUrl=void 0===_ref3$baseUrl?null:_ref3$baseUrl;this.constructor===BaseStandardFontDataFactory&&(0,_util.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=baseUrl}var _fetch2;return _createClass(BaseStandardFontDataFactory,[{key:"fetch",value:(_fetch2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee10(_ref4){var filename,url;return _regeneratorRuntime().wrap((function(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(filename=_ref4.filename,this.baseUrl){_context10.next=3;break}throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');case 3:if(filename){_context10.next=5;break}throw new Error("Font filename must be specified.");case 5:return url="".concat(this.baseUrl).concat(filename),_context10.abrupt("return",this._fetchData(url).catch((function(reason){throw new Error("Unable to load font data at: ".concat(url))})));case 7:case"end":return _context10.stop()}}),_callee10,this)}))),function(_x7){return _fetch2.apply(this,arguments)})},{key:"_fetchData",value:function(url){(0,_util.unreachable)("Abstract method `_fetchData` called.")}}]),BaseStandardFontDataFactory}();exports.BaseStandardFontDataFactory=BaseStandardFontDataFactory;var BaseSVGFactory=function(){function BaseSVGFactory(){_classCallCheck(this,BaseSVGFactory),this.constructor===BaseSVGFactory&&(0,_util.unreachable)("Cannot initialize BaseSVGFactory.")}return _createClass(BaseSVGFactory,[{key:"create",value:function(width,height){var skipDimensions=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(width<=0||height<=0)throw new Error("Invalid SVG dimensions");var svg=this._createSVG("svg:svg");return svg.setAttribute("version","1.1"),skipDimensions||(svg.setAttribute("width","".concat(width,"px")),svg.setAttribute("height","".concat(height,"px"))),svg.setAttribute("preserveAspectRatio","none"),svg.setAttribute("viewBox","0 0 ".concat(width," ").concat(height)),svg}},{key:"createElement",value:function(type){if("string"!=typeof type)throw new Error("Invalid SVG element type");return this._createSVG(type)}},{key:"_createSVG",value:function(type){(0,_util.unreachable)("Abstract method `_createSVG` called.")}}]),BaseSVGFactory}();exports.BaseSVGFactory=BaseSVGFactory},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MurmurHash3_64=void 0;var _util=__w_pdfjs_require__(1),MurmurHash3_64=function(){function MurmurHash3_64(seed){_classCallCheck(this,MurmurHash3_64),this.h1=seed?4294967295&seed:3285377520,this.h2=seed?4294967295&seed:3285377520}return _createClass(MurmurHash3_64,[{key:"update",value:function(input){var data,length;if("string"==typeof input){data=new Uint8Array(2*input.length),length=0;for(var i=0,ii=input.length;i<ii;i++){var code=input.charCodeAt(i);code<=255?data[length++]=code:(data[length++]=code>>>8,data[length++]=255&code)}}else{if(!(0,_util.isArrayBuffer)(input))throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");length=(data=input.slice()).byteLength}for(var blockCounts=length>>2,tailLength=length-4*blockCounts,dataUint32=new Uint32Array(data.buffer,0,blockCounts),k1=0,k2=0,h1=this.h1,h2=this.h2,C1=3432918353,C2=461845907,_i3=0;_i3<blockCounts;_i3++)1&_i3?h1=5*(h1=(h1^=k1=(k1=(k1=(k1=dataUint32[_i3])*C1&4294901760|11601*k1&65535)<<15|k1>>>17)*C2&4294901760|13715*k1&65535)<<13|h1>>>19)+3864292196:h2=5*(h2=(h2^=k2=(k2=(k2=(k2=dataUint32[_i3])*C1&4294901760|11601*k2&65535)<<15|k2>>>17)*C2&4294901760|13715*k2&65535)<<13|h2>>>19)+3864292196;switch(k1=0,tailLength){case 3:k1^=data[4*blockCounts+2]<<16;case 2:k1^=data[4*blockCounts+1]<<8;case 1:k1=(k1=(k1=(k1^=data[4*blockCounts])*C1&4294901760|11601*k1&65535)<<15|k1>>>17)*C2&4294901760|13715*k1&65535,1&blockCounts?h1^=k1:h2^=k1}this.h1=h1,this.h2=h2}},{key:"hexdigest",value:function(){var h1=this.h1,h2=this.h2;h1=3981806797*(h1^=h2>>>1)&4294901760|36045*h1&65535,h1=444984403*(h1^=(h2=4283543511*h2&4294901760|(2950163797*(h2<<16|h1>>>16)&4294901760)>>>16)>>>1)&4294901760|60499*h1&65535;var hex1=((h1^=(h2=3301882366*h2&4294901760|(3120437893*(h2<<16|h1>>>16)&4294901760)>>>16)>>>1)>>>0).toString(16),hex2=(h2>>>0).toString(16);return hex1.padStart(8,"0")+hex2.padStart(8,"0")}}]),MurmurHash3_64}();exports.MurmurHash3_64=MurmurHash3_64},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FontLoader=exports.FontFaceObject=void 0;var FontLoader,_util=__w_pdfjs_require__(1),BaseFontLoader=function(){function BaseFontLoader(_ref){_classCallCheck(this,BaseFontLoader);var docId=_ref.docId,onUnsupportedFeature=_ref.onUnsupportedFeature,_ref$ownerDocument=_ref.ownerDocument,ownerDocument=void 0===_ref$ownerDocument?globalThis.document:_ref$ownerDocument;_ref.styleElement,this.constructor===BaseFontLoader&&(0,_util.unreachable)("Cannot initialize BaseFontLoader."),this.docId=docId,this._onUnsupportedFeature=onUnsupportedFeature,this._document=ownerDocument,this.nativeFontFaces=[],this.styleElement=null}var _bind;return _createClass(BaseFontLoader,[{key:"addNativeFontFace",value:function(nativeFontFace){this.nativeFontFaces.push(nativeFontFace),this._document.fonts.add(nativeFontFace)}},{key:"insertRule",value:function(rule){var styleElement=this.styleElement;styleElement||((styleElement=this.styleElement=this._document.createElement("style")).id="PDFJS_FONT_STYLE_TAG_".concat(this.docId),this._document.documentElement.getElementsByTagName("head")[0].append(styleElement));var styleSheet=styleElement.sheet;styleSheet.insertRule(rule,styleSheet.cssRules.length)}},{key:"clear",value:function(){var _step46,_iterator46=_createForOfIteratorHelper(this.nativeFontFaces);try{for(_iterator46.s();!(_step46=_iterator46.n()).done;){var nativeFontFace=_step46.value;this._document.fonts.delete(nativeFontFace)}}catch(err){_iterator46.e(err)}finally{_iterator46.f()}this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}},{key:"bind",value:(_bind=_asyncToGenerator(_regeneratorRuntime().mark((function _callee11(font){var nativeFontFace,rule,_this28=this;return _regeneratorRuntime().wrap((function(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(!font.attached&&!font.missingFile){_context11.next=2;break}return _context11.abrupt("return");case 2:if(font.attached=!0,!this.isFontLoadingAPISupported){_context11.next=19;break}if(!(nativeFontFace=font.createNativeFontFace())){_context11.next=18;break}return this.addNativeFontFace(nativeFontFace),_context11.prev=7,_context11.next=10,nativeFontFace.loaded;case 10:_context11.next=18;break;case 12:throw _context11.prev=12,_context11.t0=_context11.catch(7),this._onUnsupportedFeature({featureId:_util.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,_util.warn)("Failed to load font '".concat(nativeFontFace.family,"': '").concat(_context11.t0,"'.")),font.disableFontFace=!0,_context11.t0;case 18:return _context11.abrupt("return");case 19:if(!(rule=font.createFontFaceRule())){_context11.next=26;break}if(this.insertRule(rule),!this.isSyncFontLoadingSupported){_context11.next=24;break}return _context11.abrupt("return");case 24:return _context11.next=26,new Promise((function(resolve){var request=_this28._queueLoadingCallback(resolve);_this28._prepareFontLoadEvent([rule],[font],request)}));case 26:case"end":return _context11.stop()}}),_callee11,this,[[7,12]])}))),function(_x8){return _bind.apply(this,arguments)})},{key:"_queueLoadingCallback",value:function(callback){(0,_util.unreachable)("Abstract method `_queueLoadingCallback`.")}},{key:"isFontLoadingAPISupported",get:function(){var _this$_document,hasFonts=!(null===(_this$_document=this._document)||void 0===_this$_document||!_this$_document.fonts);return(0,_util.shadow)(this,"isFontLoadingAPISupported",hasFonts)}},{key:"isSyncFontLoadingSupported",get:function(){(0,_util.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}},{key:"_loadTestFont",get:function(){(0,_util.unreachable)("Abstract method `_loadTestFont`.")}},{key:"_prepareFontLoadEvent",value:function(rules,fontsToLoad,request){(0,_util.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}]),BaseFontLoader}();exports.FontLoader=FontLoader,exports.FontLoader=FontLoader=function(_BaseFontLoader){function GenericFontLoader(params){var _this29;return _classCallCheck(this,GenericFontLoader),(_this29=_callSuper(this,GenericFontLoader,[params])).loadingContext={requests:[],nextRequestId:0},_this29.loadTestFontId=0,_this29}return _inherits(GenericFontLoader,_BaseFontLoader),_createClass(GenericFontLoader,[{key:"isSyncFontLoadingSupported",get:function(){var supported=!1;if("undefined"==typeof navigator)supported=!0;else{var m=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(null==m?void 0:m[1])>=14&&(supported=!0)}return(0,_util.shadow)(this,"isSyncFontLoadingSupported",supported)}},{key:"_queueLoadingCallback",value:function(callback){var context=this.loadingContext,request={id:"pdfjs-font-loading-".concat(context.nextRequestId++),done:!1,complete:function(){for((0,_util.assert)(!request.done,"completeRequest() cannot be called twice."),request.done=!0;context.requests.length>0&&context.requests[0].done;){var otherRequest=context.requests.shift();setTimeout(otherRequest.callback,0)}},callback:callback};return context.requests.push(request),request}},{key:"_loadTestFont",get:function(){return(0,_util.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}},{key:"_prepareFontLoadEvent",value:function(rules,fonts,request){function int32(data,offset){return data.charCodeAt(offset)<<24|data.charCodeAt(offset+1)<<16|data.charCodeAt(offset+2)<<8|255&data.charCodeAt(offset+3)}function spliceString(s,offset,remove,insert){return s.substring(0,offset)+insert+s.substring(offset+remove)}var i,ii,canvas=this._document.createElement("canvas");canvas.width=1,canvas.height=1;var ctx=canvas.getContext("2d"),called=0,loadTestFontId="lt".concat(Date.now()).concat(this.loadTestFontId++),data=this._loadTestFont,checksum=int32(data=spliceString(data,976,loadTestFontId.length,loadTestFontId),16);for(i=0,ii=loadTestFontId.length-3;i<ii;i+=4)checksum=checksum-1482184792+int32(loadTestFontId,i)|0;i<loadTestFontId.length&&(checksum=checksum-1482184792+int32(loadTestFontId+"XXX",i)|0),data=spliceString(data,16,4,(0,_util.string32)(checksum));var url="url(data:font/opentype;base64,".concat(btoa(data),");"),rule='@font-face {font-family:"'.concat(loadTestFontId,'";src:').concat(url,"}");this.insertRule(rule);var _step47,names=[],_iterator47=_createForOfIteratorHelper(fonts);try{for(_iterator47.s();!(_step47=_iterator47.n()).done;){var font=_step47.value;names.push(font.loadedName)}}catch(err){_iterator47.e(err)}finally{_iterator47.f()}names.push(loadTestFontId);var div=this._document.createElement("div");div.style.visibility="hidden",div.style.width=div.style.height="10px",div.style.position="absolute",div.style.top=div.style.left="0px";for(var _i4=0,_names=names;_i4<_names.length;_i4++){var name=_names[_i4],span=this._document.createElement("span");span.textContent="Hi",span.style.fontFamily=name,div.append(span)}this._document.body.append(div),function isFontReady(name,callback){if(++called>30)return(0,_util.warn)("Load test font never loaded."),void callback();ctx.font="30px "+name,ctx.fillText(".",0,20),ctx.getImageData(0,0,1,1).data[3]>0?callback():setTimeout(isFontReady.bind(null,name,callback))}(loadTestFontId,(function(){div.remove(),request.complete()}))}}]),GenericFontLoader}(BaseFontLoader);var FontFaceObject=function(){function FontFaceObject(translatedData,_ref2){_classCallCheck(this,FontFaceObject);var _ref2$isEvalSupported=_ref2.isEvalSupported,isEvalSupported=void 0===_ref2$isEvalSupported||_ref2$isEvalSupported,_ref2$disableFontFace=_ref2.disableFontFace,disableFontFace=void 0!==_ref2$disableFontFace&&_ref2$disableFontFace,_ref2$ignoreErrors=_ref2.ignoreErrors,ignoreErrors=void 0!==_ref2$ignoreErrors&&_ref2$ignoreErrors,onUnsupportedFeature=_ref2.onUnsupportedFeature,_ref2$fontRegistry=_ref2.fontRegistry,fontRegistry=void 0===_ref2$fontRegistry?null:_ref2$fontRegistry;for(var i in this.compiledGlyphs=Object.create(null),translatedData)this[i]=translatedData[i];this.isEvalSupported=!1!==isEvalSupported,this.disableFontFace=!0===disableFontFace,this.ignoreErrors=!0===ignoreErrors,this._onUnsupportedFeature=onUnsupportedFeature,this.fontRegistry=fontRegistry}return _createClass(FontFaceObject,[{key:"createNativeFontFace",value:function(){if(!this.data||this.disableFontFace)return null;var nativeFontFace;if(this.cssFontInfo){var css={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(css.style="oblique ".concat(this.cssFontInfo.italicAngle,"deg")),nativeFontFace=new FontFace(this.cssFontInfo.fontFamily,this.data,css)}else nativeFontFace=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),nativeFontFace}},{key:"createFontFaceRule",value:function(){if(!this.data||this.disableFontFace)return null;var rule,data=(0,_util.bytesToString)(this.data),url="url(data:".concat(this.mimetype,";base64,").concat(btoa(data),");");if(this.cssFontInfo){var css="font-weight: ".concat(this.cssFontInfo.fontWeight,";");this.cssFontInfo.italicAngle&&(css+="font-style: oblique ".concat(this.cssFontInfo.italicAngle,"deg;")),rule='@font-face {font-family:"'.concat(this.cssFontInfo.fontFamily,'";').concat(css,"src:").concat(url,"}")}else rule='@font-face {font-family:"'.concat(this.loadedName,'";src:').concat(url,"}");return this.fontRegistry&&this.fontRegistry.registerFont(this,url),rule}},{key:"getPathGenerator",value:function(objs,character){if(void 0!==this.compiledGlyphs[character])return this.compiledGlyphs[character];var cmds;try{cmds=objs.get(this.loadedName+"_path_"+character)}catch(ex){if(!this.ignoreErrors)throw ex;return this._onUnsupportedFeature({featureId:_util.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,_util.warn)('getPathGenerator - ignoring character: "'.concat(ex,'".')),this.compiledGlyphs[character]=function(c,size){}}if(this.isEvalSupported&&_util.FeatureTest.isEvalSupported){var _step48,jsBuf=[],_iterator48=_createForOfIteratorHelper(cmds);try{for(_iterator48.s();!(_step48=_iterator48.n()).done;){var current=_step48.value,args=void 0!==current.args?current.args.join(","):"";jsBuf.push("c.",current.cmd,"(",args,");\n")}}catch(err){_iterator48.e(err)}finally{_iterator48.f()}return this.compiledGlyphs[character]=new Function("c","size",jsBuf.join(""))}return this.compiledGlyphs[character]=function(c,size){var _step49,_iterator49=_createForOfIteratorHelper(cmds);try{for(_iterator49.s();!(_step49=_iterator49.n()).done;){var _current=_step49.value;"scale"===_current.cmd&&(_current.args=[size,-size]),c[_current.cmd].apply(c,_current.args)}}catch(err){_iterator49.e(err)}finally{_iterator49.f()}}}}]),FontFaceObject}();exports.FontFaceObject=FontFaceObject},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.CanvasGraphics=void 0;var _display_utils=__w_pdfjs_require__(133),_util=__w_pdfjs_require__(1),_pattern_helper=__w_pdfjs_require__(138),_image_utils=__w_pdfjs_require__(139),_is_node=__w_pdfjs_require__(3);function _classPrivateMethodInitSpec(obj,privateSet){!function(obj,privateCollection){if(privateCollection.has(obj))throw new TypeError("Cannot initialize the same private elements twice on an object")}(obj,privateSet),privateSet.add(obj)}function _classPrivateMethodGet(receiver,privateSet,fn){if(!privateSet.has(receiver))throw new TypeError("attempted to get private field on non-instance");return fn}var MAX_SIZE_TO_COMPILE=_is_node.isNodeJS&&"undefined"==typeof Path2D?-1:1e3,CachedCanvases=function(){function CachedCanvases(canvasFactory){_classCallCheck(this,CachedCanvases),this.canvasFactory=canvasFactory,this.cache=Object.create(null)}return _createClass(CachedCanvases,[{key:"getCanvas",value:function(id,width,height){var canvasEntry;return void 0!==this.cache[id]?(canvasEntry=this.cache[id],this.canvasFactory.reset(canvasEntry,width,height)):(canvasEntry=this.canvasFactory.create(width,height),this.cache[id]=canvasEntry),canvasEntry}},{key:"delete",value:function(id){delete this.cache[id]}},{key:"clear",value:function(){for(var id in this.cache){var canvasEntry=this.cache[id];this.canvasFactory.destroy(canvasEntry),delete this.cache[id]}}}]),CachedCanvases}();function drawImageAtIntegerCoords(ctx,srcImg,srcX,srcY,srcW,srcH,destX,destY,destW,destH){var _ref31=_slicedToArray((0,_display_utils.getCurrentTransform)(ctx),6),a=_ref31[0],b=_ref31[1],c=_ref31[2],d=_ref31[3],tx=_ref31[4],ty=_ref31[5];if(0===b&&0===c){var tlX=destX*a+tx,rTlX=Math.round(tlX),tlY=destY*d+ty,rTlY=Math.round(tlY),brX=(destX+destW)*a+tx,rWidth=Math.abs(Math.round(brX)-rTlX)||1,brY=(destY+destH)*d+ty,rHeight=Math.abs(Math.round(brY)-rTlY)||1;return ctx.setTransform(Math.sign(a),0,0,Math.sign(d),rTlX,rTlY),ctx.drawImage(srcImg,srcX,srcY,srcW,srcH,0,0,rWidth,rHeight),ctx.setTransform(a,b,c,d,tx,ty),[rWidth,rHeight]}if(0===a&&0===d){var _tlX=destY*c+tx,_rTlX=Math.round(_tlX),_tlY=destX*b+ty,_rTlY=Math.round(_tlY),_brX=(destY+destH)*c+tx,_rWidth=Math.abs(Math.round(_brX)-_rTlX)||1,_brY=(destX+destW)*b+ty,_rHeight=Math.abs(Math.round(_brY)-_rTlY)||1;return ctx.setTransform(0,Math.sign(b),Math.sign(c),0,_rTlX,_rTlY),ctx.drawImage(srcImg,srcX,srcY,srcW,srcH,0,0,_rHeight,_rWidth),ctx.setTransform(a,b,c,d,tx,ty),[_rHeight,_rWidth]}return ctx.drawImage(srcImg,srcX,srcY,srcW,srcH,destX,destY,destW,destH),[Math.hypot(a,b)*destW,Math.hypot(c,d)*destH]}var CanvasExtraState=function(){function CanvasExtraState(width,height){_classCallCheck(this,CanvasExtraState),this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=_util.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=_util.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=_util.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps=null,this.startNewPathAndClipBox([0,0,width,height])}return _createClass(CanvasExtraState,[{key:"clone",value:function(){var clone=Object.create(this);return clone.clipBox=this.clipBox.slice(),clone}},{key:"setCurrentPoint",value:function(x,y){this.x=x,this.y=y}},{key:"updatePathMinMax",value:function(transform,x,y){var _util$Util$applyTrans2=_slicedToArray(_util.Util.applyTransform([x,y],transform),2);x=_util$Util$applyTrans2[0],y=_util$Util$applyTrans2[1],this.minX=Math.min(this.minX,x),this.minY=Math.min(this.minY,y),this.maxX=Math.max(this.maxX,x),this.maxY=Math.max(this.maxY,y)}},{key:"updateRectMinMax",value:function(transform,rect){var p1=_util.Util.applyTransform(rect,transform),p2=_util.Util.applyTransform(rect.slice(2),transform);this.minX=Math.min(this.minX,p1[0],p2[0]),this.minY=Math.min(this.minY,p1[1],p2[1]),this.maxX=Math.max(this.maxX,p1[0],p2[0]),this.maxY=Math.max(this.maxY,p1[1],p2[1])}},{key:"updateScalingPathMinMax",value:function(transform,minMax){_util.Util.scaleMinMax(transform,minMax),this.minX=Math.min(this.minX,minMax[0]),this.maxX=Math.max(this.maxX,minMax[1]),this.minY=Math.min(this.minY,minMax[2]),this.maxY=Math.max(this.maxY,minMax[3])}},{key:"updateCurvePathMinMax",value:function(transform,x0,y0,x1,y1,x2,y2,x3,y3,minMax){var box=_util.Util.bezierBoundingBox(x0,y0,x1,y1,x2,y2,x3,y3);if(minMax)return minMax[0]=Math.min(minMax[0],box[0],box[2]),minMax[1]=Math.max(minMax[1],box[0],box[2]),minMax[2]=Math.min(minMax[2],box[1],box[3]),void(minMax[3]=Math.max(minMax[3],box[1],box[3]));this.updateRectMinMax(transform,box)}},{key:"getPathBoundingBox",value:function(){var pathType=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_pattern_helper.PathType.FILL,transform=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,box=[this.minX,this.minY,this.maxX,this.maxY];if(pathType===_pattern_helper.PathType.STROKE){transform||(0,_util.unreachable)("Stroke bounding box must include transform.");var scale=_util.Util.singularValueDecompose2dScale(transform),xStrokePad=scale[0]*this.lineWidth/2,yStrokePad=scale[1]*this.lineWidth/2;box[0]-=xStrokePad,box[1]-=yStrokePad,box[2]+=xStrokePad,box[3]+=yStrokePad}return box}},{key:"updateClipFromPath",value:function(){var intersect=_util.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(intersect||[0,0,0,0])}},{key:"isEmptyClip",value:function(){return this.minX===1/0}},{key:"startNewPathAndClipBox",value:function(box){this.clipBox=box,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}},{key:"getClippedPathBoundingBox",value:function(){var pathType=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_pattern_helper.PathType.FILL,transform=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return _util.Util.intersect(this.clipBox,this.getPathBoundingBox(pathType,transform))}}]),CanvasExtraState}();function putBinaryImageData(ctx,imgData){var transferMaps=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if("undefined"!=typeof ImageData&&imgData instanceof ImageData)ctx.putImageData(imgData,0,0);else{var destPos,i,j,thisChunkHeight,elemsInThisChunk,transferMapRed,transferMapGreen,transferMapBlue,transferMapGray,height=imgData.height,width=imgData.width,partialChunkHeight=height%16,fullChunks=(height-partialChunkHeight)/16,totalChunks=0===partialChunkHeight?fullChunks:fullChunks+1,chunkImgData=ctx.createImageData(width,16),srcPos=0,src=imgData.data,dest=chunkImgData.data;if(transferMaps)switch(transferMaps.length){case 1:transferMapRed=transferMaps[0],transferMapGreen=transferMaps[0],transferMapBlue=transferMaps[0],transferMapGray=transferMaps[0];break;case 4:transferMapRed=transferMaps[0],transferMapGreen=transferMaps[1],transferMapBlue=transferMaps[2],transferMapGray=transferMaps[3]}if(imgData.kind===_util.ImageKind.GRAYSCALE_1BPP){var srcLength=src.byteLength,dest32=new Uint32Array(dest.buffer,0,dest.byteLength>>2),dest32DataLength=dest32.length,fullSrcDiff=width+7>>3,white=4294967295,black=_util.FeatureTest.isLittleEndian?4278190080:255;if(transferMapGray&&255===transferMapGray[0]&&0===transferMapGray[255]){var _ref32=[black,white];white=_ref32[0],black=_ref32[1]}for(i=0;i<totalChunks;i++){for(thisChunkHeight=i<fullChunks?16:partialChunkHeight,destPos=0,j=0;j<thisChunkHeight;j++){for(var srcDiff=srcLength-srcPos,k=0,kEnd=srcDiff>fullSrcDiff?width:8*srcDiff-7,kEndUnrolled=-8&kEnd,mask=0,srcByte=0;k<kEndUnrolled;k+=8)srcByte=src[srcPos++],dest32[destPos++]=128&srcByte?white:black,dest32[destPos++]=64&srcByte?white:black,dest32[destPos++]=32&srcByte?white:black,dest32[destPos++]=16&srcByte?white:black,dest32[destPos++]=8&srcByte?white:black,dest32[destPos++]=4&srcByte?white:black,dest32[destPos++]=2&srcByte?white:black,dest32[destPos++]=1&srcByte?white:black;for(;k<kEnd;k++)0===mask&&(srcByte=src[srcPos++],mask=128),dest32[destPos++]=srcByte&mask?white:black,mask>>=1}for(;destPos<dest32DataLength;)dest32[destPos++]=0;ctx.putImageData(chunkImgData,0,16*i)}}else if(imgData.kind===_util.ImageKind.RGBA_32BPP){var hasTransferMaps=!!(transferMapRed||transferMapGreen||transferMapBlue);for(j=0,elemsInThisChunk=16*width*4,i=0;i<fullChunks;i++){if(dest.set(src.subarray(srcPos,srcPos+elemsInThisChunk)),srcPos+=elemsInThisChunk,hasTransferMaps)for(var _k=0;_k<elemsInThisChunk;_k+=4)transferMapRed&&(dest[_k+0]=transferMapRed[dest[_k+0]]),transferMapGreen&&(dest[_k+1]=transferMapGreen[dest[_k+1]]),transferMapBlue&&(dest[_k+2]=transferMapBlue[dest[_k+2]]);ctx.putImageData(chunkImgData,0,j),j+=16}if(i<totalChunks){if(elemsInThisChunk=width*partialChunkHeight*4,dest.set(src.subarray(srcPos,srcPos+elemsInThisChunk)),hasTransferMaps)for(var _k2=0;_k2<elemsInThisChunk;_k2+=4)transferMapRed&&(dest[_k2+0]=transferMapRed[dest[_k2+0]]),transferMapGreen&&(dest[_k2+1]=transferMapGreen[dest[_k2+1]]),transferMapBlue&&(dest[_k2+2]=transferMapBlue[dest[_k2+2]]);ctx.putImageData(chunkImgData,0,j)}}else{if(imgData.kind!==_util.ImageKind.RGB_24BPP)throw new Error("bad image kind: ".concat(imgData.kind));var _hasTransferMaps=!!(transferMapRed||transferMapGreen||transferMapBlue);for(elemsInThisChunk=width*(thisChunkHeight=16),i=0;i<totalChunks;i++){for(i>=fullChunks&&(elemsInThisChunk=width*(thisChunkHeight=partialChunkHeight)),destPos=0,j=elemsInThisChunk;j--;)dest[destPos++]=src[srcPos++],dest[destPos++]=src[srcPos++],dest[destPos++]=src[srcPos++],dest[destPos++]=255;if(_hasTransferMaps)for(var _k3=0;_k3<destPos;_k3+=4)transferMapRed&&(dest[_k3+0]=transferMapRed[dest[_k3+0]]),transferMapGreen&&(dest[_k3+1]=transferMapGreen[dest[_k3+1]]),transferMapBlue&&(dest[_k3+2]=transferMapBlue[dest[_k3+2]]);ctx.putImageData(chunkImgData,0,16*i)}}}}function putBinaryImageMask(ctx,imgData){if(imgData.bitmap)ctx.drawImage(imgData.bitmap,0,0);else for(var height=imgData.height,width=imgData.width,partialChunkHeight=height%16,fullChunks=(height-partialChunkHeight)/16,totalChunks=0===partialChunkHeight?fullChunks:fullChunks+1,chunkImgData=ctx.createImageData(width,16),srcPos=0,src=imgData.data,dest=chunkImgData.data,i=0;i<totalChunks;i++){var thisChunkHeight=i<fullChunks?16:partialChunkHeight;srcPos=(0,_image_utils.applyMaskImageData)({src:src,srcPos:srcPos,dest:dest,width:width,height:thisChunkHeight}).srcPos,ctx.putImageData(chunkImgData,0,16*i)}}function copyCtxState(sourceCtx,destCtx){for(var properties=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"],i=0,ii=properties.length;i<ii;i++){var property=properties[i];void 0!==sourceCtx[property]&&(destCtx[property]=sourceCtx[property])}void 0!==sourceCtx.setLineDash&&(destCtx.setLineDash(sourceCtx.getLineDash()),destCtx.lineDashOffset=sourceCtx.lineDashOffset)}function resetCtxToDefault(ctx,foregroundColor){ctx.strokeStyle=ctx.fillStyle=foregroundColor||"#000000",ctx.fillRule="nonzero",ctx.globalAlpha=1,ctx.lineWidth=1,ctx.lineCap="butt",ctx.lineJoin="miter",ctx.miterLimit=10,ctx.globalCompositeOperation="source-over",ctx.font="10px sans-serif",void 0!==ctx.setLineDash&&(ctx.setLineDash([]),ctx.lineDashOffset=0)}function composeSMaskBackdrop(bytes,r0,g0,b0){for(var length=bytes.length,i=3;i<length;i+=4){var alpha=bytes[i];if(0===alpha)bytes[i-3]=r0,bytes[i-2]=g0,bytes[i-1]=b0;else if(alpha<255){var alpha_=255-alpha;bytes[i-3]=bytes[i-3]*alpha+r0*alpha_>>8,bytes[i-2]=bytes[i-2]*alpha+g0*alpha_>>8,bytes[i-1]=bytes[i-1]*alpha+b0*alpha_>>8}}}function composeSMaskAlpha(maskData,layerData,transferMap){for(var length=maskData.length,i=3;i<length;i+=4){var alpha=transferMap?transferMap[maskData[i]]:maskData[i];layerData[i]=layerData[i]*alpha*.00392156862745098|0}}function composeSMaskLuminosity(maskData,layerData,transferMap){for(var length=maskData.length,i=3;i<length;i+=4){var y=77*maskData[i-3]+152*maskData[i-2]+28*maskData[i-1];layerData[i]=transferMap?layerData[i]*transferMap[y>>8]>>8:layerData[i]*y>>16}}function composeSMask(ctx,smask,layerCtx,layerBox){var layerOffsetX=layerBox[0],layerOffsetY=layerBox[1],layerWidth=layerBox[2]-layerOffsetX,layerHeight=layerBox[3]-layerOffsetY;0!==layerWidth&&0!==layerHeight&&(function(maskCtx,layerCtx,width,height,subtype,backdrop,transferMap,layerOffsetX,layerOffsetY,maskOffsetX,maskOffsetY){var composeFn,hasBackdrop=!!backdrop,r0=hasBackdrop?backdrop[0]:0,g0=hasBackdrop?backdrop[1]:0,b0=hasBackdrop?backdrop[2]:0;composeFn="Luminosity"===subtype?composeSMaskLuminosity:composeSMaskAlpha;for(var chunkSize=Math.min(height,Math.ceil(1048576/width)),row=0;row<height;row+=chunkSize){var chunkHeight=Math.min(chunkSize,height-row),maskData=maskCtx.getImageData(layerOffsetX-maskOffsetX,row+(layerOffsetY-maskOffsetY),width,chunkHeight),layerData=layerCtx.getImageData(layerOffsetX,row+layerOffsetY,width,chunkHeight);hasBackdrop&&composeSMaskBackdrop(maskData.data,r0,g0,b0),composeFn(maskData.data,layerData.data,transferMap),layerCtx.putImageData(layerData,layerOffsetX,row+layerOffsetY)}}(smask.context,layerCtx,layerWidth,layerHeight,smask.subtype,smask.backdrop,smask.transferMap,layerOffsetX,layerOffsetY,smask.offsetX,smask.offsetY),ctx.save(),ctx.globalAlpha=1,ctx.globalCompositeOperation="source-over",ctx.setTransform(1,0,0,1,0,0),ctx.drawImage(layerCtx.canvas,0,0),ctx.restore())}function getImageSmoothingEnabled(transform,interpolate){var scale=_util.Util.singularValueDecompose2dScale(transform);scale[0]=Math.fround(scale[0]),scale[1]=Math.fround(scale[1]);var actualScale=Math.fround((globalThis.devicePixelRatio||1)*_display_utils.PixelsPerInch.PDF_TO_CSS_UNITS);return void 0!==interpolate?interpolate:scale[0]<=actualScale||scale[1]<=actualScale}var LINE_CAP_STYLES=["butt","round","square"],LINE_JOIN_STYLES=["miter","round","bevel"],NORMAL_CLIP={},EO_CLIP={},_restoreInitialState=new WeakSet,CanvasGraphics=function(){function CanvasGraphics(canvasCtx,commonObjs,objs,canvasFactory,imageLayer,optionalContentConfig,annotationCanvasMap,pageColors){_classCallCheck(this,CanvasGraphics),_classPrivateMethodInitSpec(this,_restoreInitialState),this.ctx=canvasCtx,this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=commonObjs,this.objs=objs,this.canvasFactory=canvasFactory,this.imageLayer=imageLayer,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=optionalContentConfig,this.cachedCanvases=new CachedCanvases(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=annotationCanvasMap,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.backgroundColor=(null==pageColors?void 0:pageColors.background)||null,this.foregroundColor=(null==pageColors?void 0:pageColors.foreground)||null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}return _createClass(CanvasGraphics,[{key:"getObject",value:function(data){var fallback=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"==typeof data?data.startsWith("g_")?this.commonObjs.get(data):this.objs.get(data):fallback}},{key:"beginDrawing",value:function(_ref){var _this$ctx3,_this$ctx2,transform=_ref.transform,viewport=_ref.viewport,_ref$transparency=_ref.transparency,transparency=void 0!==_ref$transparency&&_ref$transparency,_ref$background=_ref.background,background=void 0===_ref$background?null:_ref$background,width=this.ctx.canvas.width,height=this.ctx.canvas.height,defaultBackgroundColor=background||"#ffffff";if(this.ctx.save(),this.foregroundColor&&this.backgroundColor){this.ctx.fillStyle=this.foregroundColor;var fg=this.foregroundColor=this.ctx.fillStyle;this.ctx.fillStyle=this.backgroundColor;var isValidDefaultBg,defaultBg,bg=this.backgroundColor=this.ctx.fillStyle;if(this.ctx.fillStyle=defaultBackgroundColor,isValidDefaultBg="string"==typeof(defaultBg=this.ctx.fillStyle)&&/^#[0-9A-Fa-f]{6}$/.test(defaultBg),"#000000"===fg&&"#ffffff"===bg||fg===bg||!isValidDefaultBg)this.foregroundColor=this.backgroundColor=null;else{var _ref35=_slicedToArray((0,_display_utils.getRGB)(defaultBg),3),rB=_ref35[0],gB=_ref35[1],bB=_ref35[2],newComp=function(x){return(x/=255)<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4)},lumB=Math.round(.2126*newComp(rB)+.7152*newComp(gB)+.0722*newComp(bB));this.selectColor=function(r,g,b){var lumC=.2126*newComp(r)+.7152*newComp(g)+.0722*newComp(b);return Math.round(lumC)===lumB?bg:fg}}}if(this.ctx.fillStyle=this.backgroundColor||defaultBackgroundColor,this.ctx.fillRect(0,0,width,height),this.ctx.restore(),transparency){var _this$ctx,transparentCanvas=this.cachedCanvases.getCanvas("transparent",width,height);this.compositeCtx=this.ctx,this.transparentCanvas=transparentCanvas.canvas,this.ctx=transparentCanvas.context,this.ctx.save(),(_this$ctx=this.ctx).transform.apply(_this$ctx,_toConsumableArray((0,_display_utils.getCurrentTransform)(this.compositeCtx)))}this.ctx.save(),resetCtxToDefault(this.ctx,this.foregroundColor),transform&&((_this$ctx2=this.ctx).transform.apply(_this$ctx2,_toConsumableArray(transform)),this.outputScaleX=transform[0],this.outputScaleY=transform[0]),(_this$ctx3=this.ctx).transform.apply(_this$ctx3,_toConsumableArray(viewport.transform)),this.viewportScale=viewport.scale,this.baseTransform=(0,_display_utils.getCurrentTransform)(this.ctx),this.imageLayer&&((0,_display_utils.deprecated)("The `imageLayer` functionality will be removed in the future."),this.imageLayer.beginLayout())}},{key:"executeOperatorList",value:function(operatorList,executionStartIdx,continueCallback,stepper){var argsArray=operatorList.argsArray,fnArray=operatorList.fnArray,i=executionStartIdx||0,argsArrayLen=argsArray.length;if(argsArrayLen===i)return i;for(var fnId,chunkOperations=argsArrayLen-i>10&&"function"==typeof continueCallback,endTime=chunkOperations?Date.now()+15:0,steps=0,commonObjs=this.commonObjs,objs=this.objs;;){if(void 0!==stepper&&i===stepper.nextBreakPoint)return stepper.breakIt(i,continueCallback),i;if((fnId=fnArray[i])!==_util.OPS.dependency)this[fnId].apply(this,argsArray[i]);else{var _step51,_iterator51=_createForOfIteratorHelper(argsArray[i]);try{for(_iterator51.s();!(_step51=_iterator51.n()).done;){var depObjId=_step51.value,objsPool=depObjId.startsWith("g_")?commonObjs:objs;if(!objsPool.has(depObjId))return objsPool.get(depObjId,continueCallback),i}}catch(err){_iterator51.e(err)}finally{_iterator51.f()}}if(++i===argsArrayLen)return i;if(chunkOperations&&++steps>10){if(Date.now()>endTime)return continueCallback(),i;steps=0}}}},{key:"endDrawing",value:function(){_classPrivateMethodGet(this,_restoreInitialState,_restoreInitialState2).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();var _step52,_iterator52=_createForOfIteratorHelper(this._cachedBitmapsMap.values());try{for(_iterator52.s();!(_step52=_iterator52.n()).done;){var _step53,cache=_step52.value,_iterator53=_createForOfIteratorHelper(cache.values());try{for(_iterator53.s();!(_step53=_iterator53.n()).done;){var canvas=_step53.value;"undefined"!=typeof HTMLCanvasElement&&canvas instanceof HTMLCanvasElement&&(canvas.width=canvas.height=0)}}catch(err){_iterator53.e(err)}finally{_iterator53.f()}cache.clear()}}catch(err){_iterator52.e(err)}finally{_iterator52.f()}this._cachedBitmapsMap.clear(),this.imageLayer&&this.imageLayer.endLayout()}},{key:"_scaleImage",value:function(img,inverseTransform){for(var tmpCanvas,tmpCtx,width=img.width,height=img.height,widthScale=Math.max(Math.hypot(inverseTransform[0],inverseTransform[1]),1),heightScale=Math.max(Math.hypot(inverseTransform[2],inverseTransform[3]),1),paintWidth=width,paintHeight=height,tmpCanvasId="prescale1";widthScale>2&&paintWidth>1||heightScale>2&&paintHeight>1;){var newWidth=paintWidth,newHeight=paintHeight;widthScale>2&&paintWidth>1&&(widthScale/=paintWidth/(newWidth=Math.ceil(paintWidth/2))),heightScale>2&&paintHeight>1&&(heightScale/=paintHeight/(newHeight=Math.ceil(paintHeight/2))),(tmpCtx=(tmpCanvas=this.cachedCanvases.getCanvas(tmpCanvasId,newWidth,newHeight)).context).clearRect(0,0,newWidth,newHeight),tmpCtx.drawImage(img,0,0,paintWidth,paintHeight,0,0,newWidth,newHeight),img=tmpCanvas.canvas,paintWidth=newWidth,paintHeight=newHeight,tmpCanvasId="prescale1"===tmpCanvasId?"prescale2":"prescale1"}return{img:img,paintWidth:paintWidth,paintHeight:paintHeight}}},{key:"_createMaskCanvas",value:function(img){var cache,cacheKey,scaled,maskCanvas,ctx=this.ctx,width=img.width,height=img.height,fillColor=this.current.fillColor,isPatternFill=this.current.patternFill,currentTransform=(0,_display_utils.getCurrentTransform)(ctx);if((img.bitmap||img.data)&&img.count>1){var mainKey=img.bitmap||img.data.buffer,withoutTranslation=currentTransform.slice(0,4);cacheKey=JSON.stringify(isPatternFill?withoutTranslation:[withoutTranslation,fillColor]),(cache=this._cachedBitmapsMap.get(mainKey))||(cache=new Map,this._cachedBitmapsMap.set(mainKey,cache));var cachedImage=cache.get(cacheKey);if(cachedImage&&!isPatternFill)return{canvas:cachedImage,offsetX:Math.round(Math.min(currentTransform[0],currentTransform[2])+currentTransform[4]),offsetY:Math.round(Math.min(currentTransform[1],currentTransform[3])+currentTransform[5])};scaled=cachedImage}scaled||putBinaryImageMask((maskCanvas=this.cachedCanvases.getCanvas("maskCanvas",width,height)).context,img);var maskToCanvas=_util.Util.transform(currentTransform,[1/width,0,0,-1/height,0,0]);maskToCanvas=_util.Util.transform(maskToCanvas,[1,0,0,1,0,-height]);var cord1=_util.Util.applyTransform([0,0],maskToCanvas),cord2=_util.Util.applyTransform([width,height],maskToCanvas),rect=_util.Util.normalizeRect([cord1[0],cord1[1],cord2[0],cord2[1]]),drawnWidth=Math.round(rect[2]-rect[0])||1,drawnHeight=Math.round(rect[3]-rect[1])||1,fillCanvas=this.cachedCanvases.getCanvas("fillCanvas",drawnWidth,drawnHeight),fillCtx=fillCanvas.context,offsetX=Math.min(cord1[0],cord2[0]),offsetY=Math.min(cord1[1],cord2[1]);fillCtx.translate(-offsetX,-offsetY),fillCtx.transform.apply(fillCtx,_toConsumableArray(maskToCanvas)),scaled||(scaled=(scaled=this._scaleImage(maskCanvas.canvas,(0,_display_utils.getCurrentTransformInverse)(fillCtx))).img,cache&&isPatternFill&&cache.set(cacheKey,scaled)),fillCtx.imageSmoothingEnabled=getImageSmoothingEnabled((0,_display_utils.getCurrentTransform)(fillCtx),img.interpolate),drawImageAtIntegerCoords(fillCtx,scaled,0,0,scaled.width,scaled.height,0,0,width,height),fillCtx.globalCompositeOperation="source-in";var inverse=_util.Util.transform((0,_display_utils.getCurrentTransformInverse)(fillCtx),[1,0,0,1,-offsetX,-offsetY]);return fillCtx.fillStyle=isPatternFill?fillColor.getPattern(ctx,this,inverse,_pattern_helper.PathType.FILL):fillColor,fillCtx.fillRect(0,0,width,height),cache&&!isPatternFill&&(this.cachedCanvases.delete("fillCanvas"),cache.set(cacheKey,fillCanvas.canvas)),{canvas:fillCanvas.canvas,offsetX:Math.round(offsetX),offsetY:Math.round(offsetY)}}},{key:"setLineWidth",value:function(width){width!==this.current.lineWidth&&(this._cachedScaleForStroking=null),this.current.lineWidth=width,this.ctx.lineWidth=width}},{key:"setLineCap",value:function(style){this.ctx.lineCap=LINE_CAP_STYLES[style]}},{key:"setLineJoin",value:function(style){this.ctx.lineJoin=LINE_JOIN_STYLES[style]}},{key:"setMiterLimit",value:function(limit){this.ctx.miterLimit=limit}},{key:"setDash",value:function(dashArray,dashPhase){var ctx=this.ctx;void 0!==ctx.setLineDash&&(ctx.setLineDash(dashArray),ctx.lineDashOffset=dashPhase)}},{key:"setRenderingIntent",value:function(intent){}},{key:"setFlatness",value:function(flatness){}},{key:"setGState",value:function(states){for(var i=0,ii=states.length;i<ii;i++){var state=states[i],key=state[0],value=state[1];switch(key){case"LW":this.setLineWidth(value);break;case"LC":this.setLineCap(value);break;case"LJ":this.setLineJoin(value);break;case"ML":this.setMiterLimit(value);break;case"D":this.setDash(value[0],value[1]);break;case"RI":this.setRenderingIntent(value);break;case"FL":this.setFlatness(value);break;case"Font":this.setFont(value[0],value[1]);break;case"CA":this.current.strokeAlpha=state[1];break;case"ca":this.current.fillAlpha=state[1],this.ctx.globalAlpha=state[1];break;case"BM":this.ctx.globalCompositeOperation=value;break;case"SMask":this.current.activeSMask=value?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.current.transferMaps=value}}}},{key:"inSMaskMode",get:function(){return!!this.suspendedCtx}},{key:"checkSMaskState",value:function(){var inSMaskMode=this.inSMaskMode;this.current.activeSMask&&!inSMaskMode?this.beginSMaskMode():!this.current.activeSMask&&inSMaskMode&&this.endSMaskMode()}},{key:"beginSMaskMode",value:function(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");var drawnWidth=this.ctx.canvas.width,drawnHeight=this.ctx.canvas.height,cacheId="smaskGroupAt"+this.groupLevel,scratchCanvas=this.cachedCanvases.getCanvas(cacheId,drawnWidth,drawnHeight);this.suspendedCtx=this.ctx,this.ctx=scratchCanvas.context;var ctx=this.ctx;ctx.setTransform.apply(ctx,_toConsumableArray((0,_display_utils.getCurrentTransform)(this.suspendedCtx))),copyCtxState(this.suspendedCtx,ctx),function(ctx,destCtx){if(ctx._removeMirroring)throw new Error("Context is already forwarding operations.");ctx.__originalSave=ctx.save,ctx.__originalRestore=ctx.restore,ctx.__originalRotate=ctx.rotate,ctx.__originalScale=ctx.scale,ctx.__originalTranslate=ctx.translate,ctx.__originalTransform=ctx.transform,ctx.__originalSetTransform=ctx.setTransform,ctx.__originalResetTransform=ctx.resetTransform,ctx.__originalClip=ctx.clip,ctx.__originalMoveTo=ctx.moveTo,ctx.__originalLineTo=ctx.lineTo,ctx.__originalBezierCurveTo=ctx.bezierCurveTo,ctx.__originalRect=ctx.rect,ctx.__originalClosePath=ctx.closePath,ctx.__originalBeginPath=ctx.beginPath,ctx._removeMirroring=function(){ctx.save=ctx.__originalSave,ctx.restore=ctx.__originalRestore,ctx.rotate=ctx.__originalRotate,ctx.scale=ctx.__originalScale,ctx.translate=ctx.__originalTranslate,ctx.transform=ctx.__originalTransform,ctx.setTransform=ctx.__originalSetTransform,ctx.resetTransform=ctx.__originalResetTransform,ctx.clip=ctx.__originalClip,ctx.moveTo=ctx.__originalMoveTo,ctx.lineTo=ctx.__originalLineTo,ctx.bezierCurveTo=ctx.__originalBezierCurveTo,ctx.rect=ctx.__originalRect,ctx.closePath=ctx.__originalClosePath,ctx.beginPath=ctx.__originalBeginPath,delete ctx._removeMirroring},ctx.save=function(){destCtx.save(),this.__originalSave()},ctx.restore=function(){destCtx.restore(),this.__originalRestore()},ctx.translate=function(x,y){destCtx.translate(x,y),this.__originalTranslate(x,y)},ctx.scale=function(x,y){destCtx.scale(x,y),this.__originalScale(x,y)},ctx.transform=function(a,b,c,d,e,f){destCtx.transform(a,b,c,d,e,f),this.__originalTransform(a,b,c,d,e,f)},ctx.setTransform=function(a,b,c,d,e,f){destCtx.setTransform(a,b,c,d,e,f),this.__originalSetTransform(a,b,c,d,e,f)},ctx.resetTransform=function(){destCtx.resetTransform(),this.__originalResetTransform()},ctx.rotate=function(angle){destCtx.rotate(angle),this.__originalRotate(angle)},ctx.clip=function(rule){destCtx.clip(rule),this.__originalClip(rule)},ctx.moveTo=function(x,y){destCtx.moveTo(x,y),this.__originalMoveTo(x,y)},ctx.lineTo=function(x,y){destCtx.lineTo(x,y),this.__originalLineTo(x,y)},ctx.bezierCurveTo=function(cp1x,cp1y,cp2x,cp2y,x,y){destCtx.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y),this.__originalBezierCurveTo(cp1x,cp1y,cp2x,cp2y,x,y)},ctx.rect=function(x,y,width,height){destCtx.rect(x,y,width,height),this.__originalRect(x,y,width,height)},ctx.closePath=function(){destCtx.closePath(),this.__originalClosePath()},ctx.beginPath=function(){destCtx.beginPath(),this.__originalBeginPath()}}(ctx,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}},{key:"endSMaskMode",value:function(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),copyCtxState(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}},{key:"compose",value:function(dirtyBox){if(this.current.activeSMask){dirtyBox?(dirtyBox[0]=Math.floor(dirtyBox[0]),dirtyBox[1]=Math.floor(dirtyBox[1]),dirtyBox[2]=Math.ceil(dirtyBox[2]),dirtyBox[3]=Math.ceil(dirtyBox[3])):dirtyBox=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];var smask=this.current.activeSMask;composeSMask(this.suspendedCtx,smask,this.ctx,dirtyBox),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}}},{key:"save",value:function(){this.inSMaskMode?(copyCtxState(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();var old=this.current;this.stateStack.push(old),this.current=old.clone()}},{key:"restore",value:function(){0===this.stateStack.length&&this.inSMaskMode&&this.endSMaskMode(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),copyCtxState(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null)}},{key:"transform",value:function(a,b,c,d,e,f){this.ctx.transform(a,b,c,d,e,f),this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null}},{key:"constructPath",value:function(ops,args,minMax){for(var startX,startY,ctx=this.ctx,current=this.current,x=current.x,y=current.y,currentTransform=(0,_display_utils.getCurrentTransform)(ctx),isScalingMatrix=0===currentTransform[0]&&0===currentTransform[3]||0===currentTransform[1]&&0===currentTransform[2],minMaxForBezier=isScalingMatrix?minMax.slice(0):null,i=0,j=0,ii=ops.length;i<ii;i++)switch(0|ops[i]){case _util.OPS.rectangle:x=args[j++],y=args[j++];var width=args[j++],height=args[j++],xw=x+width,yh=y+height;ctx.moveTo(x,y),0===width||0===height?ctx.lineTo(xw,yh):(ctx.lineTo(xw,y),ctx.lineTo(xw,yh),ctx.lineTo(x,yh)),isScalingMatrix||current.updateRectMinMax(currentTransform,[x,y,xw,yh]),ctx.closePath();break;case _util.OPS.moveTo:x=args[j++],y=args[j++],ctx.moveTo(x,y),isScalingMatrix||current.updatePathMinMax(currentTransform,x,y);break;case _util.OPS.lineTo:x=args[j++],y=args[j++],ctx.lineTo(x,y),isScalingMatrix||current.updatePathMinMax(currentTransform,x,y);break;case _util.OPS.curveTo:startX=x,startY=y,x=args[j+4],y=args[j+5],ctx.bezierCurveTo(args[j],args[j+1],args[j+2],args[j+3],x,y),current.updateCurvePathMinMax(currentTransform,startX,startY,args[j],args[j+1],args[j+2],args[j+3],x,y,minMaxForBezier),j+=6;break;case _util.OPS.curveTo2:startX=x,startY=y,ctx.bezierCurveTo(x,y,args[j],args[j+1],args[j+2],args[j+3]),current.updateCurvePathMinMax(currentTransform,startX,startY,x,y,args[j],args[j+1],args[j+2],args[j+3],minMaxForBezier),x=args[j+2],y=args[j+3],j+=4;break;case _util.OPS.curveTo3:startX=x,startY=y,x=args[j+2],y=args[j+3],ctx.bezierCurveTo(args[j],args[j+1],x,y,x,y),current.updateCurvePathMinMax(currentTransform,startX,startY,args[j],args[j+1],x,y,x,y,minMaxForBezier),j+=4;break;case _util.OPS.closePath:ctx.closePath()}isScalingMatrix&&current.updateScalingPathMinMax(currentTransform,minMaxForBezier),current.setCurrentPoint(x,y)}},{key:"closePath",value:function(){this.ctx.closePath()}},{key:"stroke",value:function(consumePath){consumePath=void 0===consumePath||consumePath;var ctx=this.ctx,strokeColor=this.current.strokeColor;ctx.globalAlpha=this.current.strokeAlpha,this.contentVisible&&("object"===_typeof(strokeColor)&&null!=strokeColor&&strokeColor.getPattern?(ctx.save(),ctx.strokeStyle=strokeColor.getPattern(ctx,this,(0,_display_utils.getCurrentTransformInverse)(ctx),_pattern_helper.PathType.STROKE),this.rescaleAndStroke(!1),ctx.restore()):this.rescaleAndStroke(!0)),consumePath&&this.consumePath(this.current.getClippedPathBoundingBox()),ctx.globalAlpha=this.current.fillAlpha}},{key:"closeStroke",value:function(){this.closePath(),this.stroke()}},{key:"fill",value:function(consumePath){consumePath=void 0===consumePath||consumePath;var ctx=this.ctx,fillColor=this.current.fillColor,needRestore=!1;this.current.patternFill&&(ctx.save(),ctx.fillStyle=fillColor.getPattern(ctx,this,(0,_display_utils.getCurrentTransformInverse)(ctx),_pattern_helper.PathType.FILL),needRestore=!0);var intersect=this.current.getClippedPathBoundingBox();this.contentVisible&&null!==intersect&&(this.pendingEOFill?(ctx.fill("evenodd"),this.pendingEOFill=!1):ctx.fill()),needRestore&&ctx.restore(),consumePath&&this.consumePath(intersect)}},{key:"eoFill",value:function(){this.pendingEOFill=!0,this.fill()}},{key:"fillStroke",value:function(){this.fill(!1),this.stroke(!1),this.consumePath()}},{key:"eoFillStroke",value:function(){this.pendingEOFill=!0,this.fillStroke()}},{key:"closeFillStroke",value:function(){this.closePath(),this.fillStroke()}},{key:"closeEOFillStroke",value:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}},{key:"endPath",value:function(){this.consumePath()}},{key:"clip",value:function(){this.pendingClip=NORMAL_CLIP}},{key:"eoClip",value:function(){this.pendingClip=EO_CLIP}},{key:"beginText",value:function(){this.current.textMatrix=_util.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}},{key:"endText",value:function(){var paths=this.pendingTextPaths,ctx=this.ctx;if(void 0!==paths){ctx.save(),ctx.beginPath();var _step54,_iterator54=_createForOfIteratorHelper(paths);try{for(_iterator54.s();!(_step54=_iterator54.n()).done;){var path=_step54.value;ctx.setTransform.apply(ctx,_toConsumableArray(path.transform)),ctx.translate(path.x,path.y),path.addToPath(ctx,path.fontSize)}}catch(err){_iterator54.e(err)}finally{_iterator54.f()}ctx.restore(),ctx.clip(),ctx.beginPath(),delete this.pendingTextPaths}else ctx.beginPath()}},{key:"setCharSpacing",value:function(spacing){this.current.charSpacing=spacing}},{key:"setWordSpacing",value:function(spacing){this.current.wordSpacing=spacing}},{key:"setHScale",value:function(scale){this.current.textHScale=scale/100}},{key:"setLeading",value:function(leading){this.current.leading=-leading}},{key:"setFont",value:function(fontRefName,size){var fontObj=this.commonObjs.get(fontRefName),current=this.current;if(!fontObj)throw new Error("Can't find font for ".concat(fontRefName));if(current.fontMatrix=fontObj.fontMatrix||_util.FONT_IDENTITY_MATRIX,0!==current.fontMatrix[0]&&0!==current.fontMatrix[3]||(0,_util.warn)("Invalid font matrix for font "+fontRefName),size<0?(size=-size,current.fontDirection=-1):current.fontDirection=1,this.current.font=fontObj,this.current.fontSize=size,!fontObj.isType3Font){var name=fontObj.loadedName||"sans-serif",bold="normal";fontObj.black?bold="900":fontObj.bold&&(bold="bold");var italic=fontObj.italic?"italic":"normal",typeface='"'.concat(name,'", ').concat(fontObj.fallbackName),browserFontSize=size;size<16?browserFontSize=16:size>100&&(browserFontSize=100),this.current.fontSizeScale=size/browserFontSize,this.ctx.font="".concat(italic," ").concat(bold," ").concat(browserFontSize,"px ").concat(typeface)}}},{key:"setTextRenderingMode",value:function(mode){this.current.textRenderingMode=mode}},{key:"setTextRise",value:function(rise){this.current.textRise=rise}},{key:"moveText",value:function(x,y){this.current.x=this.current.lineX+=x,this.current.y=this.current.lineY+=y}},{key:"setLeadingMoveText",value:function(x,y){this.setLeading(-y),this.moveText(x,y)}},{key:"setTextMatrix",value:function(a,b,c,d,e,f){this.current.textMatrix=[a,b,c,d,e,f],this.current.textMatrixScale=Math.hypot(a,b),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}},{key:"nextLine",value:function(){this.moveText(0,this.current.leading)}},{key:"paintChar",value:function(character,x,y,patternTransform){var addToPath,ctx=this.ctx,current=this.current,font=current.font,textRenderingMode=current.textRenderingMode,fontSize=current.fontSize/current.fontSizeScale,fillStrokeMode=textRenderingMode&_util.TextRenderingMode.FILL_STROKE_MASK,isAddToPathSet=!!(textRenderingMode&_util.TextRenderingMode.ADD_TO_PATH_FLAG),patternFill=current.patternFill&&!font.missingFile;(font.disableFontFace||isAddToPathSet||patternFill)&&(addToPath=font.getPathGenerator(this.commonObjs,character)),font.disableFontFace||patternFill?(ctx.save(),ctx.translate(x,y),ctx.beginPath(),addToPath(ctx,fontSize),patternTransform&&ctx.setTransform.apply(ctx,_toConsumableArray(patternTransform)),fillStrokeMode!==_util.TextRenderingMode.FILL&&fillStrokeMode!==_util.TextRenderingMode.FILL_STROKE||ctx.fill(),fillStrokeMode!==_util.TextRenderingMode.STROKE&&fillStrokeMode!==_util.TextRenderingMode.FILL_STROKE||ctx.stroke(),ctx.restore()):(fillStrokeMode!==_util.TextRenderingMode.FILL&&fillStrokeMode!==_util.TextRenderingMode.FILL_STROKE||ctx.fillText(character,x,y),fillStrokeMode!==_util.TextRenderingMode.STROKE&&fillStrokeMode!==_util.TextRenderingMode.FILL_STROKE||ctx.strokeText(character,x,y)),isAddToPathSet&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:(0,_display_utils.getCurrentTransform)(ctx),x:x,y:y,fontSize:fontSize,addToPath:addToPath})}},{key:"isFontSubpixelAAEnabled",get:function(){var ctx=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10).context;ctx.scale(1.5,1),ctx.fillText("I",0,10);for(var data=ctx.getImageData(0,0,10,10).data,enabled=!1,i=3;i<data.length;i+=4)if(data[i]>0&&data[i]<255){enabled=!0;break}return(0,_util.shadow)(this,"isFontSubpixelAAEnabled",enabled)}},{key:"showText",value:function(glyphs){var current=this.current,font=current.font;if(font.isType3Font)return this.showType3Text(glyphs);var fontSize=current.fontSize;if(0!==fontSize){var patternTransform,ctx=this.ctx,fontSizeScale=current.fontSizeScale,charSpacing=current.charSpacing,wordSpacing=current.wordSpacing,fontDirection=current.fontDirection,textHScale=current.textHScale*fontDirection,glyphsLength=glyphs.length,vertical=font.vertical,spacingDir=vertical?1:-1,defaultVMetrics=font.defaultVMetrics,widthAdvanceScale=fontSize*current.fontMatrix[0],simpleFillText=current.textRenderingMode===_util.TextRenderingMode.FILL&&!font.disableFontFace&&!current.patternFill;if(ctx.save(),ctx.transform.apply(ctx,_toConsumableArray(current.textMatrix)),ctx.translate(current.x,current.y+current.textRise),fontDirection>0?ctx.scale(textHScale,-1):ctx.scale(textHScale,1),current.patternFill){ctx.save();var pattern=current.fillColor.getPattern(ctx,this,(0,_display_utils.getCurrentTransformInverse)(ctx),_pattern_helper.PathType.FILL);patternTransform=(0,_display_utils.getCurrentTransform)(ctx),ctx.restore(),ctx.fillStyle=pattern}var lineWidth=current.lineWidth,scale=current.textMatrixScale;if(0===scale||0===lineWidth){var fillStrokeMode=current.textRenderingMode&_util.TextRenderingMode.FILL_STROKE_MASK;fillStrokeMode!==_util.TextRenderingMode.STROKE&&fillStrokeMode!==_util.TextRenderingMode.FILL_STROKE||(lineWidth=this.getSinglePixelWidth())}else lineWidth/=scale;1!==fontSizeScale&&(ctx.scale(fontSizeScale,fontSizeScale),lineWidth/=fontSizeScale),ctx.lineWidth=lineWidth;var i,x=0;for(i=0;i<glyphsLength;++i){var glyph=glyphs[i];if("number"!=typeof glyph){var restoreNeeded=!1,spacing=(glyph.isSpace?wordSpacing:0)+charSpacing,character=glyph.fontChar,accent=glyph.accent,scaledX=void 0,scaledY=void 0,width=glyph.width;if(vertical){var vmetric=glyph.vmetric||defaultVMetrics,vx=-(glyph.vmetric?vmetric[1]:.5*width)*widthAdvanceScale,vy=vmetric[2]*widthAdvanceScale;width=vmetric?-vmetric[0]:width,scaledX=vx/fontSizeScale,scaledY=(x+vy)/fontSizeScale}else scaledX=x/fontSizeScale,scaledY=0;if(font.remeasure&&width>0){var measuredWidth=1e3*ctx.measureText(character).width/fontSize*fontSizeScale;if(width<measuredWidth&&this.isFontSubpixelAAEnabled){var characterScaleX=width/measuredWidth;restoreNeeded=!0,ctx.save(),ctx.scale(characterScaleX,1),scaledX/=characterScaleX}else width!==measuredWidth&&(scaledX+=(width-measuredWidth)/2e3*fontSize/fontSizeScale)}if(this.contentVisible&&(glyph.isInFont||font.missingFile))if(simpleFillText&&!accent)ctx.fillText(character,scaledX,scaledY);else if(this.paintChar(character,scaledX,scaledY,patternTransform),accent){var scaledAccentX=scaledX+fontSize*accent.offset.x/fontSizeScale,scaledAccentY=scaledY-fontSize*accent.offset.y/fontSizeScale;this.paintChar(accent.fontChar,scaledAccentX,scaledAccentY,patternTransform)}x+=vertical?width*widthAdvanceScale-spacing*fontDirection:width*widthAdvanceScale+spacing*fontDirection,restoreNeeded&&ctx.restore()}else x+=spacingDir*glyph*fontSize/1e3}vertical?current.y-=x:current.x+=x*textHScale,ctx.restore(),this.compose()}}},{key:"showType3Text",value:function(glyphs){var i,glyph,width,spacingLength,ctx=this.ctx,current=this.current,font=current.font,fontSize=current.fontSize,fontDirection=current.fontDirection,spacingDir=font.vertical?1:-1,charSpacing=current.charSpacing,wordSpacing=current.wordSpacing,textHScale=current.textHScale*fontDirection,fontMatrix=current.fontMatrix||_util.FONT_IDENTITY_MATRIX,glyphsLength=glyphs.length;if(current.textRenderingMode!==_util.TextRenderingMode.INVISIBLE&&0!==fontSize){for(this._cachedScaleForStroking=null,this._cachedGetSinglePixelWidth=null,ctx.save(),ctx.transform.apply(ctx,_toConsumableArray(current.textMatrix)),ctx.translate(current.x,current.y),ctx.scale(textHScale,fontDirection),i=0;i<glyphsLength;++i)if("number"!=typeof(glyph=glyphs[i])){var spacing=(glyph.isSpace?wordSpacing:0)+charSpacing,operatorList=font.charProcOperatorList[glyph.operatorListId];operatorList?(this.contentVisible&&(this.processingType3=glyph,this.save(),ctx.scale(fontSize,fontSize),ctx.transform.apply(ctx,_toConsumableArray(fontMatrix)),this.executeOperatorList(operatorList),this.restore()),width=_util.Util.applyTransform([glyph.width,0],fontMatrix)[0]*fontSize+spacing,ctx.translate(width,0),current.x+=width*textHScale):(0,_util.warn)('Type3 character "'.concat(glyph.operatorListId,'" is not available.'))}else spacingLength=spacingDir*glyph*fontSize/1e3,this.ctx.translate(spacingLength,0),current.x+=spacingLength*textHScale;ctx.restore(),this.processingType3=null}}},{key:"setCharWidth",value:function(xWidth,yWidth){}},{key:"setCharWidthAndBounds",value:function(xWidth,yWidth,llx,lly,urx,ury){this.ctx.rect(llx,lly,urx-llx,ury-lly),this.ctx.clip(),this.endPath()}},{key:"getColorN_Pattern",value:function(IR){var pattern,_this30=this;if("TilingPattern"===IR[0]){var color=IR[1],baseTransform=this.baseTransform||(0,_display_utils.getCurrentTransform)(this.ctx),canvasGraphicsFactory={createCanvasGraphics:function(ctx){return new CanvasGraphics(ctx,_this30.commonObjs,_this30.objs,_this30.canvasFactory)}};pattern=new _pattern_helper.TilingPattern(IR,color,this.ctx,canvasGraphicsFactory,baseTransform)}else pattern=this._getPattern(IR[1],IR[2]);return pattern}},{key:"setStrokeColorN",value:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)}},{key:"setFillColorN",value:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}},{key:"setStrokeRGBColor",value:function(r,g,b){var _this$selectColor,color=(null===(_this$selectColor=this.selectColor)||void 0===_this$selectColor?void 0:_this$selectColor.call(this,r,g,b))||_util.Util.makeHexColor(r,g,b);this.ctx.strokeStyle=color,this.current.strokeColor=color}},{key:"setFillRGBColor",value:function(r,g,b){var _this$selectColor2,color=(null===(_this$selectColor2=this.selectColor)||void 0===_this$selectColor2?void 0:_this$selectColor2.call(this,r,g,b))||_util.Util.makeHexColor(r,g,b);this.ctx.fillStyle=color,this.current.fillColor=color,this.current.patternFill=!1}},{key:"_getPattern",value:function(objId){var pattern,matrix=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.cachedPatterns.has(objId)?pattern=this.cachedPatterns.get(objId):(pattern=(0,_pattern_helper.getShadingPattern)(this.objs.get(objId)),this.cachedPatterns.set(objId,pattern)),matrix&&(pattern.matrix=matrix),pattern}},{key:"shadingFill",value:function(objId){if(this.contentVisible){var ctx=this.ctx;this.save();var pattern=this._getPattern(objId);ctx.fillStyle=pattern.getPattern(ctx,this,(0,_display_utils.getCurrentTransformInverse)(ctx),_pattern_helper.PathType.SHADING);var inv=(0,_display_utils.getCurrentTransformInverse)(ctx);if(inv){var canvas=ctx.canvas,width=canvas.width,height=canvas.height,bl=_util.Util.applyTransform([0,0],inv),br=_util.Util.applyTransform([0,height],inv),ul=_util.Util.applyTransform([width,0],inv),ur=_util.Util.applyTransform([width,height],inv),x0=Math.min(bl[0],br[0],ul[0],ur[0]),y0=Math.min(bl[1],br[1],ul[1],ur[1]),x1=Math.max(bl[0],br[0],ul[0],ur[0]),y1=Math.max(bl[1],br[1],ul[1],ur[1]);this.ctx.fillRect(x0,y0,x1-x0,y1-y0)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}}},{key:"beginInlineImage",value:function(){(0,_util.unreachable)("Should not call beginInlineImage")}},{key:"beginImageData",value:function(){(0,_util.unreachable)("Should not call beginImageData")}},{key:"paintFormXObjectBegin",value:function(matrix,bbox){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(matrix)&&6===matrix.length&&this.transform.apply(this,_toConsumableArray(matrix)),this.baseTransform=(0,_display_utils.getCurrentTransform)(this.ctx),bbox)){var width=bbox[2]-bbox[0],height=bbox[3]-bbox[1];this.ctx.rect(bbox[0],bbox[1],width,height),this.current.updateRectMinMax((0,_display_utils.getCurrentTransform)(this.ctx),bbox),this.clip(),this.endPath()}}},{key:"paintFormXObjectEnd",value:function(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}},{key:"beginGroup",value:function(group){if(this.contentVisible){this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);var currentCtx=this.ctx;group.isolated||(0,_util.info)("TODO: Support non-isolated groups."),group.knockout&&(0,_util.warn)("Knockout groups not supported.");var currentTransform=(0,_display_utils.getCurrentTransform)(currentCtx);if(group.matrix&&currentCtx.transform.apply(currentCtx,_toConsumableArray(group.matrix)),!group.bbox)throw new Error("Bounding box is required.");var bounds=_util.Util.getAxialAlignedBoundingBox(group.bbox,(0,_display_utils.getCurrentTransform)(currentCtx)),canvasBounds=[0,0,currentCtx.canvas.width,currentCtx.canvas.height];bounds=_util.Util.intersect(bounds,canvasBounds)||[0,0,0,0];var offsetX=Math.floor(bounds[0]),offsetY=Math.floor(bounds[1]),drawnWidth=Math.max(Math.ceil(bounds[2])-offsetX,1),drawnHeight=Math.max(Math.ceil(bounds[3])-offsetY,1),scaleX=1,scaleY=1;drawnWidth>4096&&(scaleX=drawnWidth/4096,drawnWidth=4096),drawnHeight>4096&&(scaleY=drawnHeight/4096,drawnHeight=4096),this.current.startNewPathAndClipBox([0,0,drawnWidth,drawnHeight]);var cacheId="groupAt"+this.groupLevel;group.smask&&(cacheId+="_smask_"+this.smaskCounter++%2);var scratchCanvas=this.cachedCanvases.getCanvas(cacheId,drawnWidth,drawnHeight),groupCtx=scratchCanvas.context;groupCtx.scale(1/scaleX,1/scaleY),groupCtx.translate(-offsetX,-offsetY),groupCtx.transform.apply(groupCtx,_toConsumableArray(currentTransform)),group.smask?this.smaskStack.push({canvas:scratchCanvas.canvas,context:groupCtx,offsetX:offsetX,offsetY:offsetY,scaleX:scaleX,scaleY:scaleY,subtype:group.smask.subtype,backdrop:group.smask.backdrop,transferMap:group.smask.transferMap||null,startTransformInverse:null}):(currentCtx.setTransform(1,0,0,1,0,0),currentCtx.translate(offsetX,offsetY),currentCtx.scale(scaleX,scaleY),currentCtx.save()),copyCtxState(currentCtx,groupCtx),this.ctx=groupCtx,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(currentCtx),this.groupLevel++}}},{key:"endGroup",value:function(group){if(this.contentVisible){this.groupLevel--;var groupCtx=this.ctx,ctx=this.groupStack.pop();if(this.ctx=ctx,this.ctx.imageSmoothingEnabled=!1,group.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{var _this$ctx4;this.ctx.restore();var currentMtx=(0,_display_utils.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),(_this$ctx4=this.ctx).setTransform.apply(_this$ctx4,_toConsumableArray(currentMtx));var dirtyBox=_util.Util.getAxialAlignedBoundingBox([0,0,groupCtx.canvas.width,groupCtx.canvas.height],currentMtx);this.ctx.drawImage(groupCtx.canvas,0,0),this.ctx.restore(),this.compose(dirtyBox)}}}},{key:"beginAnnotation",value:function(id,rect,transform,matrix,hasOwnCanvas){var _this$ctx5;if(_classPrivateMethodGet(this,_restoreInitialState,_restoreInitialState2).call(this),resetCtxToDefault(this.ctx,this.foregroundColor),this.ctx.save(),this.save(),this.baseTransform&&(_this$ctx5=this.ctx).setTransform.apply(_this$ctx5,_toConsumableArray(this.baseTransform)),Array.isArray(rect)&&4===rect.length){var width=rect[2]-rect[0],height=rect[3]-rect[1];if(hasOwnCanvas&&this.annotationCanvasMap){(transform=transform.slice())[4]-=rect[0],transform[5]-=rect[1],(rect=rect.slice())[0]=rect[1]=0,rect[2]=width,rect[3]=height;var _util$Util$singularVa2=_slicedToArray(_util.Util.singularValueDecompose2dScale((0,_display_utils.getCurrentTransform)(this.ctx)),2),scaleX=_util$Util$singularVa2[0],scaleY=_util$Util$singularVa2[1],viewportScale=this.viewportScale,canvasWidth=Math.ceil(width*this.outputScaleX*viewportScale),canvasHeight=Math.ceil(height*this.outputScaleY*viewportScale);this.annotationCanvas=this.canvasFactory.create(canvasWidth,canvasHeight);var _this$annotationCanva=this.annotationCanvas,canvas=_this$annotationCanva.canvas,context=_this$annotationCanva.context;this.annotationCanvasMap.set(id,canvas),this.annotationCanvas.savedCtx=this.ctx,this.ctx=context,this.ctx.setTransform(scaleX,0,0,-scaleY,0,height*scaleY),resetCtxToDefault(this.ctx,this.foregroundColor)}else resetCtxToDefault(this.ctx,this.foregroundColor),this.ctx.rect(rect[0],rect[1],width,height),this.ctx.clip(),this.endPath()}this.current=new CanvasExtraState(this.ctx.canvas.width,this.ctx.canvas.height),this.transform.apply(this,_toConsumableArray(transform)),this.transform.apply(this,_toConsumableArray(matrix))}},{key:"endAnnotation",value:function(){this.annotationCanvas&&(this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}},{key:"paintImageMaskXObject",value:function(img){if(this.contentVisible){var count=img.count;(img=this.getObject(img.data,img)).count=count;var ctx=this.ctx,glyph=this.processingType3;if(glyph&&(void 0===glyph.compiled&&(glyph.compiled=function(imgData){var width=imgData.width,height=imgData.height;if(width>MAX_SIZE_TO_COMPILE||height>MAX_SIZE_TO_COMPILE)return null;var i,j,j0,_step50,POINT_TYPES=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),width1=width+1,points=new Uint8Array(width1*(height+1)),lineSize=width+7&-8,data=new Uint8Array(lineSize*height),pos=0,_iterator50=_createForOfIteratorHelper(imgData.data);try{for(_iterator50.s();!(_step50=_iterator50.n()).done;)for(var elem=_step50.value,mask=128;mask>0;)data[pos++]=elem&mask?0:255,mask>>=1}catch(err){_iterator50.e(err)}finally{_iterator50.f()}var count=0;for(0!==data[pos=0]&&(points[0]=1,++count),j=1;j<width;j++)data[pos]!==data[pos+1]&&(points[j]=data[pos]?2:1,++count),pos++;for(0!==data[pos]&&(points[j]=2,++count),i=1;i<height;i++){j0=i*width1,data[(pos=i*lineSize)-lineSize]!==data[pos]&&(points[j0]=data[pos]?1:8,++count);var sum=(data[pos]?4:0)+(data[pos-lineSize]?8:0);for(j=1;j<width;j++)POINT_TYPES[sum=(sum>>2)+(data[pos+1]?4:0)+(data[pos-lineSize+1]?8:0)]&&(points[j0+j]=POINT_TYPES[sum],++count),pos++;if(data[pos-lineSize]!==data[pos]&&(points[j0+j]=data[pos]?2:4,++count),count>1e3)return null}for(j0=i*width1,0!==data[pos=lineSize*(height-1)]&&(points[j0]=8,++count),j=1;j<width;j++)data[pos]!==data[pos+1]&&(points[j0+j]=data[pos]?4:8,++count),pos++;if(0!==data[pos]&&(points[j0+j]=4,++count),count>1e3)return null;var steps=new Int32Array([0,width1,-1,0,-width1,0,0,0,1]),path=new Path2D;for(i=0;count&&i<=height;i++){for(var p=i*width1,end=p+width;p<end&&!points[p];)p++;if(p!==end){path.moveTo(p%width1,i);var p0=p,type=points[p];do{var step=steps[type];do{p+=step}while(!points[p]);var pp=points[p];5!==pp&&10!==pp?(type=pp,points[p]=0):(type=pp&51*type>>4,points[p]&=type>>2|type<<2),path.lineTo(p%width1,p/width1|0),points[p]||--count}while(p0!==p);--i}}return data=null,points=null,function(c){c.save(),c.scale(1/width,-1/height),c.translate(0,-height),c.fill(path),c.beginPath(),c.restore()}}(img)),glyph.compiled))glyph.compiled(ctx);else{var mask=this._createMaskCanvas(img),maskCanvas=mask.canvas;ctx.save(),ctx.setTransform(1,0,0,1,0,0),ctx.drawImage(maskCanvas,mask.offsetX,mask.offsetY),ctx.restore(),this.compose()}}}},{key:"paintImageMaskXObjectRepeat",value:function(img,scaleX){var skewX=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,skewY=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,scaleY=arguments.length>4?arguments[4]:void 0,positions=arguments.length>5?arguments[5]:void 0;if(this.contentVisible){img=this.getObject(img.data,img);var ctx=this.ctx;ctx.save();var currentTransform=(0,_display_utils.getCurrentTransform)(ctx);ctx.transform(scaleX,skewX,skewY,scaleY,0,0);var mask=this._createMaskCanvas(img);ctx.setTransform(1,0,0,1,0,0);for(var i=0,ii=positions.length;i<ii;i+=2){var trans=_util.Util.transform(currentTransform,[scaleX,skewX,skewY,scaleY,positions[i],positions[i+1]]),_util$Util$applyTrans4=_slicedToArray(_util.Util.applyTransform([0,0],trans),2),x=_util$Util$applyTrans4[0],y=_util$Util$applyTrans4[1];ctx.drawImage(mask.canvas,x,y)}ctx.restore(),this.compose()}}},{key:"paintImageMaskXObjectGroup",value:function(images){if(this.contentVisible){var _step55,ctx=this.ctx,fillColor=this.current.fillColor,isPatternFill=this.current.patternFill,_iterator55=_createForOfIteratorHelper(images);try{for(_iterator55.s();!(_step55=_iterator55.n()).done;){var image=_step55.value,data=image.data,width=image.width,height=image.height,transform=image.transform,maskCanvas=this.cachedCanvases.getCanvas("maskCanvas",width,height),maskCtx=maskCanvas.context;maskCtx.save(),putBinaryImageMask(maskCtx,this.getObject(data,image)),maskCtx.globalCompositeOperation="source-in",maskCtx.fillStyle=isPatternFill?fillColor.getPattern(maskCtx,this,(0,_display_utils.getCurrentTransformInverse)(ctx),_pattern_helper.PathType.FILL):fillColor,maskCtx.fillRect(0,0,width,height),maskCtx.restore(),ctx.save(),ctx.transform.apply(ctx,_toConsumableArray(transform)),ctx.scale(1,-1),drawImageAtIntegerCoords(ctx,maskCanvas.canvas,0,0,width,height,0,-1,1,1),ctx.restore()}}catch(err){_iterator55.e(err)}finally{_iterator55.f()}this.compose()}}},{key:"paintImageXObject",value:function(objId){if(this.contentVisible){var imgData=this.getObject(objId);imgData?this.paintInlineImageXObject(imgData):(0,_util.warn)("Dependent image isn't ready yet")}}},{key:"paintImageXObjectRepeat",value:function(objId,scaleX,scaleY,positions){if(this.contentVisible){var imgData=this.getObject(objId);if(imgData){for(var width=imgData.width,height=imgData.height,map=[],i=0,ii=positions.length;i<ii;i+=2)map.push({transform:[scaleX,0,0,scaleY,positions[i],positions[i+1]],x:0,y:0,w:width,h:height});this.paintInlineImageXObjectGroup(imgData,map)}else(0,_util.warn)("Dependent image isn't ready yet")}}},{key:"paintInlineImageXObject",value:function(imgData){if(this.contentVisible){var imgToPaint,width=imgData.width,height=imgData.height,ctx=this.ctx;if(this.save(),ctx.scale(1/width,-1/height),"function"==typeof HTMLElement&&imgData instanceof HTMLElement||!imgData.data)imgToPaint=imgData;else{var tmpCanvas=this.cachedCanvases.getCanvas("inlineImage",width,height);putBinaryImageData(tmpCanvas.context,imgData,this.current.transferMaps),imgToPaint=tmpCanvas.canvas}var scaled=this._scaleImage(imgToPaint,(0,_display_utils.getCurrentTransformInverse)(ctx));ctx.imageSmoothingEnabled=getImageSmoothingEnabled((0,_display_utils.getCurrentTransform)(ctx),imgData.interpolate);var _drawImageAtIntegerCo2=_slicedToArray(drawImageAtIntegerCoords(ctx,scaled.img,0,0,scaled.paintWidth,scaled.paintHeight,0,-height,width,height),2),rWidth=_drawImageAtIntegerCo2[0],rHeight=_drawImageAtIntegerCo2[1];if(this.imageLayer){var _util$Util$applyTrans6=_slicedToArray(_util.Util.applyTransform([0,-height],(0,_display_utils.getCurrentTransform)(this.ctx)),2),left=_util$Util$applyTrans6[0],top=_util$Util$applyTrans6[1];this.imageLayer.appendImage({imgData:imgData,left:left,top:top,width:rWidth,height:rHeight})}this.compose(),this.restore()}}},{key:"paintInlineImageXObjectGroup",value:function(imgData,map){if(this.contentVisible){var ctx=this.ctx,w=imgData.width,h=imgData.height,tmpCanvas=this.cachedCanvases.getCanvas("inlineImage",w,h);putBinaryImageData(tmpCanvas.context,imgData,this.current.transferMaps);var _step56,_iterator56=_createForOfIteratorHelper(map);try{for(_iterator56.s();!(_step56=_iterator56.n()).done;){var entry=_step56.value;if(ctx.save(),ctx.transform.apply(ctx,_toConsumableArray(entry.transform)),ctx.scale(1,-1),drawImageAtIntegerCoords(ctx,tmpCanvas.canvas,entry.x,entry.y,entry.w,entry.h,0,-1,1,1),this.imageLayer){var _util$Util$applyTrans8=_slicedToArray(_util.Util.applyTransform([entry.x,entry.y],(0,_display_utils.getCurrentTransform)(this.ctx)),2),left=_util$Util$applyTrans8[0],top=_util$Util$applyTrans8[1];this.imageLayer.appendImage({imgData:imgData,left:left,top:top,width:w,height:h})}ctx.restore()}}catch(err){_iterator56.e(err)}finally{_iterator56.f()}this.compose()}}},{key:"paintSolidColorImageMask",value:function(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}},{key:"markPoint",value:function(tag){}},{key:"markPointProps",value:function(tag,properties){}},{key:"beginMarkedContent",value:function(tag){this.markedContentStack.push({visible:!0})}},{key:"beginMarkedContentProps",value:function(tag,properties){"OC"===tag?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(properties)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}},{key:"endMarkedContent",value:function(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}},{key:"beginCompat",value:function(){}},{key:"endCompat",value:function(){}},{key:"consumePath",value:function(clipBox){var isEmpty=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(clipBox);var ctx=this.ctx;this.pendingClip&&(isEmpty||(this.pendingClip===EO_CLIP?ctx.clip("evenodd"):ctx.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),ctx.beginPath()}},{key:"getSinglePixelWidth",value:function(){if(!this._cachedGetSinglePixelWidth){var m=(0,_display_utils.getCurrentTransform)(this.ctx);if(0===m[1]&&0===m[2])this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(m[0]),Math.abs(m[3]));else{var absDet=Math.abs(m[0]*m[3]-m[2]*m[1]),normX=Math.hypot(m[0],m[2]),normY=Math.hypot(m[1],m[3]);this._cachedGetSinglePixelWidth=Math.max(normX,normY)/absDet}}return this._cachedGetSinglePixelWidth}},{key:"getScaleForStroking",value:function(){if(!this._cachedScaleForStroking){var scaleX,scaleY,lineWidth=this.current.lineWidth,m=(0,_display_utils.getCurrentTransform)(this.ctx);if(0===m[1]&&0===m[2]){var normX=Math.abs(m[0]),normY=Math.abs(m[3]);if(0===lineWidth)scaleX=1/normX,scaleY=1/normY;else{var scaledXLineWidth=normX*lineWidth,scaledYLineWidth=normY*lineWidth;scaleX=scaledXLineWidth<1?1/scaledXLineWidth:1,scaleY=scaledYLineWidth<1?1/scaledYLineWidth:1}}else{var absDet=Math.abs(m[0]*m[3]-m[2]*m[1]),_normX=Math.hypot(m[0],m[1]),_normY=Math.hypot(m[2],m[3]);if(0===lineWidth)scaleX=_normY/absDet,scaleY=_normX/absDet;else{var baseArea=lineWidth*absDet;scaleX=_normY>baseArea?_normY/baseArea:1,scaleY=_normX>baseArea?_normX/baseArea:1}}this._cachedScaleForStroking=[scaleX,scaleY]}return this._cachedScaleForStroking}},{key:"rescaleAndStroke",value:function(saveRestore){var ctx=this.ctx,lineWidth=this.current.lineWidth,_this$getScaleForStro2=_slicedToArray(this.getScaleForStroking(),2),scaleX=_this$getScaleForStro2[0],scaleY=_this$getScaleForStro2[1];if(ctx.lineWidth=lineWidth||1,1!==scaleX||1!==scaleY){var savedMatrix,savedDashes,savedDashOffset;saveRestore&&(savedMatrix=(0,_display_utils.getCurrentTransform)(ctx),savedDashes=ctx.getLineDash().slice(),savedDashOffset=ctx.lineDashOffset),ctx.scale(scaleX,scaleY);var scale=Math.max(scaleX,scaleY);ctx.setLineDash(ctx.getLineDash().map((function(x){return x/scale}))),ctx.lineDashOffset/=scale,ctx.stroke(),saveRestore&&(ctx.setTransform.apply(ctx,_toConsumableArray(savedMatrix)),ctx.setLineDash(savedDashes),ctx.lineDashOffset=savedDashOffset)}else ctx.stroke()}},{key:"isContentVisible",value:function(){for(var i=this.markedContentStack.length-1;i>=0;i--)if(!this.markedContentStack[i].visible)return!1;return!0}}]),CanvasGraphics}();function _restoreInitialState2(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}for(var op in exports.CanvasGraphics=CanvasGraphics,_util.OPS)void 0!==CanvasGraphics.prototype[op]&&(CanvasGraphics.prototype[_util.OPS[op]]=CanvasGraphics.prototype[op])},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TilingPattern=exports.PathType=void 0,exports.getShadingPattern=function(IR){switch(IR[0]){case"RadialAxial":return new RadialAxialShadingPattern(IR);case"Mesh":return new MeshShadingPattern(IR);case"Dummy":return new DummyShadingPattern}throw new Error("Unknown IR type: ".concat(IR[0]))};var _util=__w_pdfjs_require__(1),_display_utils=__w_pdfjs_require__(133),_is_node=__w_pdfjs_require__(3),PathType={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function applyBoundingBox(ctx,bbox){if(bbox&&!_is_node.isNodeJS){var width=bbox[2]-bbox[0],height=bbox[3]-bbox[1],region=new Path2D;region.rect(bbox[0],bbox[1],width,height),ctx.clip(region)}}exports.PathType=PathType;var BaseShadingPattern=function(){function BaseShadingPattern(){_classCallCheck(this,BaseShadingPattern),this.constructor===BaseShadingPattern&&(0,_util.unreachable)("Cannot initialize BaseShadingPattern.")}return _createClass(BaseShadingPattern,[{key:"getPattern",value:function(){(0,_util.unreachable)("Abstract method `getPattern` called.")}}]),BaseShadingPattern}(),RadialAxialShadingPattern=function(_BaseShadingPattern){function RadialAxialShadingPattern(IR){var _this31;return _classCallCheck(this,RadialAxialShadingPattern),(_this31=_callSuper(this,RadialAxialShadingPattern))._type=IR[1],_this31._bbox=IR[2],_this31._colorStops=IR[3],_this31._p0=IR[4],_this31._p1=IR[5],_this31._r0=IR[6],_this31._r1=IR[7],_this31.matrix=null,_this31}return _inherits(RadialAxialShadingPattern,_BaseShadingPattern),_createClass(RadialAxialShadingPattern,[{key:"_createGradient",value:function(ctx){var grad;"axial"===this._type?grad=ctx.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):"radial"===this._type&&(grad=ctx.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));var _step57,_iterator57=_createForOfIteratorHelper(this._colorStops);try{for(_iterator57.s();!(_step57=_iterator57.n()).done;){var colorStop=_step57.value;grad.addColorStop(colorStop[0],colorStop[1])}}catch(err){_iterator57.e(err)}finally{_iterator57.f()}return grad}},{key:"getPattern",value:function(ctx,owner,inverse,pathType){var pattern;if(pathType===PathType.STROKE||pathType===PathType.FILL){var ownerBBox=owner.current.getClippedPathBoundingBox(pathType,(0,_display_utils.getCurrentTransform)(ctx))||[0,0,0,0],width=Math.ceil(ownerBBox[2]-ownerBBox[0])||1,height=Math.ceil(ownerBBox[3]-ownerBBox[1])||1,tmpCanvas=owner.cachedCanvases.getCanvas("pattern",width,height,!0),tmpCtx=tmpCanvas.context;tmpCtx.clearRect(0,0,tmpCtx.canvas.width,tmpCtx.canvas.height),tmpCtx.beginPath(),tmpCtx.rect(0,0,tmpCtx.canvas.width,tmpCtx.canvas.height),tmpCtx.translate(-ownerBBox[0],-ownerBBox[1]),inverse=_util.Util.transform(inverse,[1,0,0,1,ownerBBox[0],ownerBBox[1]]),tmpCtx.transform.apply(tmpCtx,_toConsumableArray(owner.baseTransform)),this.matrix&&tmpCtx.transform.apply(tmpCtx,_toConsumableArray(this.matrix)),applyBoundingBox(tmpCtx,this._bbox),tmpCtx.fillStyle=this._createGradient(tmpCtx),tmpCtx.fill(),pattern=ctx.createPattern(tmpCanvas.canvas,"no-repeat");var domMatrix=new DOMMatrix(inverse);try{pattern.setTransform(domMatrix)}catch(ex){(0,_util.warn)('RadialAxialShadingPattern.getPattern: "'.concat(null==ex?void 0:ex.message,'".'))}}else applyBoundingBox(ctx,this._bbox),pattern=this._createGradient(ctx);return pattern}}]),RadialAxialShadingPattern}(BaseShadingPattern);function drawTriangle(data,context,p1,p2,p3,c1,c2,c3){var tmp,coords=context.coords,colors=context.colors,bytes=data.data,rowSize=4*data.width;coords[p1+1]>coords[p2+1]&&(tmp=p1,p1=p2,p2=tmp,tmp=c1,c1=c2,c2=tmp),coords[p2+1]>coords[p3+1]&&(tmp=p2,p2=p3,p3=tmp,tmp=c2,c2=c3,c3=tmp),coords[p1+1]>coords[p2+1]&&(tmp=p1,p1=p2,p2=tmp,tmp=c1,c1=c2,c2=tmp);var x1=(coords[p1]+context.offsetX)*context.scaleX,y1=(coords[p1+1]+context.offsetY)*context.scaleY,x2=(coords[p2]+context.offsetX)*context.scaleX,y2=(coords[p2+1]+context.offsetY)*context.scaleY,x3=(coords[p3]+context.offsetX)*context.scaleX,y3=(coords[p3+1]+context.offsetY)*context.scaleY;if(!(y1>=y3))for(var xa,car,cag,cab,xb,cbr,cbg,cbb,c1r=colors[c1],c1g=colors[c1+1],c1b=colors[c1+2],c2r=colors[c2],c2g=colors[c2+1],c2b=colors[c2+2],c3r=colors[c3],c3g=colors[c3+1],c3b=colors[c3+2],minY=Math.round(y1),maxY=Math.round(y3),y=minY;y<=maxY;y++){if(y<y2){var _k4=void 0;xa=x1-(x1-x2)*(_k4=y<y1?0:(y1-y)/(y1-y2)),car=c1r-(c1r-c2r)*_k4,cag=c1g-(c1g-c2g)*_k4,cab=c1b-(c1b-c2b)*_k4}else{var _k5=void 0;xa=x2-(x2-x3)*(_k5=y>y3?1:y2===y3?0:(y2-y)/(y2-y3)),car=c2r-(c2r-c3r)*_k5,cag=c2g-(c2g-c3g)*_k5,cab=c2b-(c2b-c3b)*_k5}var k=void 0;xb=x1-(x1-x3)*(k=y<y1?0:y>y3?1:(y1-y)/(y1-y3)),cbr=c1r-(c1r-c3r)*k,cbg=c1g-(c1g-c3g)*k,cbb=c1b-(c1b-c3b)*k;for(var x1_=Math.round(Math.min(xa,xb)),x2_=Math.round(Math.max(xa,xb)),j=rowSize*y+4*x1_,x=x1_;x<=x2_;x++)(k=(xa-x)/(xa-xb))<0?k=0:k>1&&(k=1),bytes[j++]=car-(car-cbr)*k|0,bytes[j++]=cag-(cag-cbg)*k|0,bytes[j++]=cab-(cab-cbb)*k|0,bytes[j++]=255}}function drawFigure(data,figure,context){var i,ii,ps=figure.coords,cs=figure.colors;switch(figure.type){case"lattice":var verticesPerRow=figure.verticesPerRow,rows=Math.floor(ps.length/verticesPerRow)-1,cols=verticesPerRow-1;for(i=0;i<rows;i++)for(var q=i*verticesPerRow,j=0;j<cols;j++,q++)drawTriangle(data,context,ps[q],ps[q+1],ps[q+verticesPerRow],cs[q],cs[q+1],cs[q+verticesPerRow]),drawTriangle(data,context,ps[q+verticesPerRow+1],ps[q+1],ps[q+verticesPerRow],cs[q+verticesPerRow+1],cs[q+1],cs[q+verticesPerRow]);break;case"triangles":for(i=0,ii=ps.length;i<ii;i+=3)drawTriangle(data,context,ps[i],ps[i+1],ps[i+2],cs[i],cs[i+1],cs[i+2]);break;default:throw new Error("illegal figure")}}var MeshShadingPattern=function(_BaseShadingPattern2){function MeshShadingPattern(IR){var _this32;return _classCallCheck(this,MeshShadingPattern),(_this32=_callSuper(this,MeshShadingPattern))._coords=IR[2],_this32._colors=IR[3],_this32._figures=IR[4],_this32._bounds=IR[5],_this32._bbox=IR[7],_this32._background=IR[8],_this32.matrix=null,_this32}return _inherits(MeshShadingPattern,_BaseShadingPattern2),_createClass(MeshShadingPattern,[{key:"_createMeshCanvas",value:function(combinedScale,backgroundColor,cachedCanvases){var offsetX=Math.floor(this._bounds[0]),offsetY=Math.floor(this._bounds[1]),boundsWidth=Math.ceil(this._bounds[2])-offsetX,boundsHeight=Math.ceil(this._bounds[3])-offsetY,width=Math.min(Math.ceil(Math.abs(boundsWidth*combinedScale[0]*1.1)),3e3),height=Math.min(Math.ceil(Math.abs(boundsHeight*combinedScale[1]*1.1)),3e3),scaleX=boundsWidth/width,scaleY=boundsHeight/height,context={coords:this._coords,colors:this._colors,offsetX:-offsetX,offsetY:-offsetY,scaleX:1/scaleX,scaleY:1/scaleY},paddedWidth=width+4,paddedHeight=height+4,tmpCanvas=cachedCanvases.getCanvas("mesh",paddedWidth,paddedHeight,!1),tmpCtx=tmpCanvas.context,data=tmpCtx.createImageData(width,height);if(backgroundColor)for(var bytes=data.data,i=0,ii=bytes.length;i<ii;i+=4)bytes[i]=backgroundColor[0],bytes[i+1]=backgroundColor[1],bytes[i+2]=backgroundColor[2],bytes[i+3]=255;var _step58,_iterator58=_createForOfIteratorHelper(this._figures);try{for(_iterator58.s();!(_step58=_iterator58.n()).done;)drawFigure(data,_step58.value,context)}catch(err){_iterator58.e(err)}finally{_iterator58.f()}return tmpCtx.putImageData(data,2,2),{canvas:tmpCanvas.canvas,offsetX:offsetX-2*scaleX,offsetY:offsetY-2*scaleY,scaleX:scaleX,scaleY:scaleY}}},{key:"getPattern",value:function(ctx,owner,inverse,pathType){var scale;if(applyBoundingBox(ctx,this._bbox),pathType===PathType.SHADING)scale=_util.Util.singularValueDecompose2dScale((0,_display_utils.getCurrentTransform)(ctx));else if(scale=_util.Util.singularValueDecompose2dScale(owner.baseTransform),this.matrix){var matrixScale=_util.Util.singularValueDecompose2dScale(this.matrix);scale=[scale[0]*matrixScale[0],scale[1]*matrixScale[1]]}var temporaryPatternCanvas=this._createMeshCanvas(scale,pathType===PathType.SHADING?null:this._background,owner.cachedCanvases);return pathType!==PathType.SHADING&&(ctx.setTransform.apply(ctx,_toConsumableArray(owner.baseTransform)),this.matrix&&ctx.transform.apply(ctx,_toConsumableArray(this.matrix))),ctx.translate(temporaryPatternCanvas.offsetX,temporaryPatternCanvas.offsetY),ctx.scale(temporaryPatternCanvas.scaleX,temporaryPatternCanvas.scaleY),ctx.createPattern(temporaryPatternCanvas.canvas,"no-repeat")}}]),MeshShadingPattern}(BaseShadingPattern),DummyShadingPattern=function(_BaseShadingPattern3){function DummyShadingPattern(){return _classCallCheck(this,DummyShadingPattern),_callSuper(this,DummyShadingPattern,arguments)}return _inherits(DummyShadingPattern,_BaseShadingPattern3),_createClass(DummyShadingPattern,[{key:"getPattern",value:function(){return"hotpink"}}]),DummyShadingPattern}(BaseShadingPattern),PaintType_COLORED=1,PaintType_UNCOLORED=2,TilingPattern=function(){function TilingPattern(IR,color,ctx,canvasGraphicsFactory,baseTransform){_classCallCheck(this,TilingPattern),this.operatorList=IR[2],this.matrix=IR[3]||[1,0,0,1,0,0],this.bbox=IR[4],this.xstep=IR[5],this.ystep=IR[6],this.paintType=IR[7],this.tilingType=IR[8],this.color=color,this.ctx=ctx,this.canvasGraphicsFactory=canvasGraphicsFactory,this.baseTransform=baseTransform}return _createClass(TilingPattern,[{key:"createPatternCanvas",value:function(owner){var operatorList=this.operatorList,bbox=this.bbox,xstep=this.xstep,ystep=this.ystep,paintType=this.paintType,tilingType=this.tilingType,color=this.color,canvasGraphicsFactory=this.canvasGraphicsFactory;(0,_util.info)("TilingType: "+tilingType);var x0=bbox[0],y0=bbox[1],x1=bbox[2],y1=bbox[3],matrixScale=_util.Util.singularValueDecompose2dScale(this.matrix),curMatrixScale=_util.Util.singularValueDecompose2dScale(this.baseTransform),combinedScale=[matrixScale[0]*curMatrixScale[0],matrixScale[1]*curMatrixScale[1]],dimx=this.getSizeAndScale(xstep,this.ctx.canvas.width,combinedScale[0]),dimy=this.getSizeAndScale(ystep,this.ctx.canvas.height,combinedScale[1]),tmpCanvas=owner.cachedCanvases.getCanvas("pattern",dimx.size,dimy.size,!0),tmpCtx=tmpCanvas.context,graphics=canvasGraphicsFactory.createCanvasGraphics(tmpCtx);graphics.groupLevel=owner.groupLevel,this.setFillAndStrokeStyleToContext(graphics,paintType,color);var adjustedX0=x0,adjustedY0=y0,adjustedX1=x1,adjustedY1=y1;return x0<0&&(adjustedX0=0,adjustedX1+=Math.abs(x0)),y0<0&&(adjustedY0=0,adjustedY1+=Math.abs(y0)),tmpCtx.translate(-dimx.scale*adjustedX0,-dimy.scale*adjustedY0),graphics.transform(dimx.scale,0,0,dimy.scale,0,0),tmpCtx.save(),this.clipBbox(graphics,adjustedX0,adjustedY0,adjustedX1,adjustedY1),graphics.baseTransform=(0,_display_utils.getCurrentTransform)(graphics.ctx),graphics.executeOperatorList(operatorList),graphics.endDrawing(),{canvas:tmpCanvas.canvas,scaleX:dimx.scale,scaleY:dimy.scale,offsetX:adjustedX0,offsetY:adjustedY0}}},{key:"getSizeAndScale",value:function(step,realOutputSize,scale){step=Math.abs(step);var maxSize=Math.max(TilingPattern.MAX_PATTERN_SIZE,realOutputSize),size=Math.ceil(step*scale);return size>=maxSize?size=maxSize:scale=size/step,{scale:scale,size:size}}},{key:"clipBbox",value:function(graphics,x0,y0,x1,y1){var bboxWidth=x1-x0,bboxHeight=y1-y0;graphics.ctx.rect(x0,y0,bboxWidth,bboxHeight),graphics.current.updateRectMinMax((0,_display_utils.getCurrentTransform)(graphics.ctx),[x0,y0,x1,y1]),graphics.clip(),graphics.endPath()}},{key:"setFillAndStrokeStyleToContext",value:function(graphics,paintType,color){var context=graphics.ctx,current=graphics.current;switch(paintType){case PaintType_COLORED:var ctx=this.ctx;context.fillStyle=ctx.fillStyle,context.strokeStyle=ctx.strokeStyle,current.fillColor=ctx.fillStyle,current.strokeColor=ctx.strokeStyle;break;case PaintType_UNCOLORED:var cssColor=_util.Util.makeHexColor(color[0],color[1],color[2]);context.fillStyle=cssColor,context.strokeStyle=cssColor,current.fillColor=cssColor,current.strokeColor=cssColor;break;default:throw new _util.FormatError("Unsupported paint type: ".concat(paintType))}}},{key:"getPattern",value:function(ctx,owner,inverse,pathType){var matrix=inverse;pathType!==PathType.SHADING&&(matrix=_util.Util.transform(matrix,owner.baseTransform),this.matrix&&(matrix=_util.Util.transform(matrix,this.matrix)));var temporaryPatternCanvas=this.createPatternCanvas(owner),domMatrix=new DOMMatrix(matrix);domMatrix=(domMatrix=domMatrix.translate(temporaryPatternCanvas.offsetX,temporaryPatternCanvas.offsetY)).scale(1/temporaryPatternCanvas.scaleX,1/temporaryPatternCanvas.scaleY);var pattern=ctx.createPattern(temporaryPatternCanvas.canvas,"repeat");try{pattern.setTransform(domMatrix)}catch(ex){(0,_util.warn)('TilingPattern.getPattern: "'.concat(null==ex?void 0:ex.message,'".'))}return pattern}}],[{key:"MAX_PATTERN_SIZE",get:function(){return(0,_util.shadow)(this,"MAX_PATTERN_SIZE",3e3)}}]),TilingPattern}();exports.TilingPattern=TilingPattern},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.applyMaskImageData=function(_ref){var src=_ref.src,_ref$srcPos=_ref.srcPos,srcPos=void 0===_ref$srcPos?0:_ref$srcPos,dest=_ref.dest,_ref$destPos=_ref.destPos,destPos=void 0===_ref$destPos?0:_ref$destPos,width=_ref.width,height=_ref.height,_ref$inverseDecode=_ref.inverseDecode,inverseDecode=void 0!==_ref$inverseDecode&&_ref$inverseDecode,opaque=_util.FeatureTest.isLittleEndian?4278190080:255,_ref37=_slicedToArray(inverseDecode?[0,opaque]:[opaque,0],2),zeroMapping=_ref37[0],oneMapping=_ref37[1],widthInSource=width>>3,widthRemainder=7&width,srcLength=src.length;dest=new Uint32Array(dest.buffer);for(var i=0;i<height;i++){for(var max=srcPos+widthInSource;srcPos<max;srcPos++){var _elem=srcPos<srcLength?src[srcPos]:255;dest[destPos++]=128&_elem?oneMapping:zeroMapping,dest[destPos++]=64&_elem?oneMapping:zeroMapping,dest[destPos++]=32&_elem?oneMapping:zeroMapping,dest[destPos++]=16&_elem?oneMapping:zeroMapping,dest[destPos++]=8&_elem?oneMapping:zeroMapping,dest[destPos++]=4&_elem?oneMapping:zeroMapping,dest[destPos++]=2&_elem?oneMapping:zeroMapping,dest[destPos++]=1&_elem?oneMapping:zeroMapping}if(0!==widthRemainder)for(var elem=srcPos<srcLength?src[srcPos++]:255,j=0;j<widthRemainder;j++)dest[destPos++]=elem&1<<7-j?oneMapping:zeroMapping}return{srcPos:srcPos,destPos:destPos}};var _util=__w_pdfjs_require__(1)},function(__unused_webpack_module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.GlobalWorkerOptions=void 0;var GlobalWorkerOptions=Object.create(null);exports.GlobalWorkerOptions=GlobalWorkerOptions,GlobalWorkerOptions.workerPort=void 0===GlobalWorkerOptions.workerPort?null:GlobalWorkerOptions.workerPort,GlobalWorkerOptions.workerSrc=void 0===GlobalWorkerOptions.workerSrc?"":GlobalWorkerOptions.workerSrc},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.MessageHandler=void 0;var _util=__w_pdfjs_require__(1),CallbackKind_DATA=1,CallbackKind_ERROR=2,StreamKind_CANCEL=1,StreamKind_CANCEL_COMPLETE=2,StreamKind_CLOSE=3,StreamKind_ENQUEUE=4,StreamKind_ERROR=5,StreamKind_PULL=6,StreamKind_PULL_COMPLETE=7,StreamKind_START_COMPLETE=8;function wrapReason(reason){switch(reason instanceof Error||"object"===_typeof(reason)&&null!==reason||(0,_util.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),reason.name){case"AbortException":return new _util.AbortException(reason.message);case"MissingPDFException":return new _util.MissingPDFException(reason.message);case"PasswordException":return new _util.PasswordException(reason.message,reason.code);case"UnexpectedResponseException":return new _util.UnexpectedResponseException(reason.message,reason.status);case"UnknownErrorException":return new _util.UnknownErrorException(reason.message,reason.details);default:return new _util.UnknownErrorException(reason.message,reason.toString())}}var MessageHandler=function(){function MessageHandler(sourceName,targetName,comObj){var _this33=this;_classCallCheck(this,MessageHandler),this.sourceName=sourceName,this.targetName=targetName,this.comObj=comObj,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=function(event){var data=event.data;if(data.targetName===_this33.sourceName)if(data.stream)_this33._processStreamMessage(data);else if(data.callback){var callbackId=data.callbackId,capability=_this33.callbackCapabilities[callbackId];if(!capability)throw new Error("Cannot resolve callback ".concat(callbackId));if(delete _this33.callbackCapabilities[callbackId],data.callback===CallbackKind_DATA)capability.resolve(data.data);else{if(data.callback!==CallbackKind_ERROR)throw new Error("Unexpected callback case");capability.reject(wrapReason(data.reason))}}else{var action=_this33.actionHandler[data.action];if(!action)throw new Error("Unknown action from worker: ".concat(data.action));if(data.callbackId){var cbSourceName=_this33.sourceName,cbTargetName=data.sourceName;new Promise((function(resolve){resolve(action(data.data))})).then((function(result){comObj.postMessage({sourceName:cbSourceName,targetName:cbTargetName,callback:CallbackKind_DATA,callbackId:data.callbackId,data:result})}),(function(reason){comObj.postMessage({sourceName:cbSourceName,targetName:cbTargetName,callback:CallbackKind_ERROR,callbackId:data.callbackId,reason:wrapReason(reason)})}))}else data.streamId?_this33._createStreamSink(data):action(data.data)}},comObj.addEventListener("message",this._onComObjOnMessage)}var _deleteStreamController2;return _createClass(MessageHandler,[{key:"on",value:function(actionName,handler){var ah=this.actionHandler;if(ah[actionName])throw new Error('There is already an actionName called "'.concat(actionName,'"'));ah[actionName]=handler}},{key:"send",value:function(actionName,data,transfers){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:actionName,data:data},transfers)}},{key:"sendWithPromise",value:function(actionName,data,transfers){var callbackId=this.callbackId++,capability=(0,_util.createPromiseCapability)();this.callbackCapabilities[callbackId]=capability;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:actionName,callbackId:callbackId,data:data},transfers)}catch(ex){capability.reject(ex)}return capability.promise}},{key:"sendWithStream",value:function(actionName,data,queueingStrategy,transfers){var _this34=this,streamId=this.streamId++,sourceName=this.sourceName,targetName=this.targetName,comObj=this.comObj;return new ReadableStream({start:function(controller){var startCapability=(0,_util.createPromiseCapability)();return _this34.streamControllers[streamId]={controller:controller,startCall:startCapability,pullCall:null,cancelCall:null,isClosed:!1},comObj.postMessage({sourceName:sourceName,targetName:targetName,action:actionName,streamId:streamId,data:data,desiredSize:controller.desiredSize},transfers),startCapability.promise},pull:function(controller){var pullCapability=(0,_util.createPromiseCapability)();return _this34.streamControllers[streamId].pullCall=pullCapability,comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_PULL,streamId:streamId,desiredSize:controller.desiredSize}),pullCapability.promise},cancel:function(reason){(0,_util.assert)(reason instanceof Error,"cancel must have a valid reason");var cancelCapability=(0,_util.createPromiseCapability)();return _this34.streamControllers[streamId].cancelCall=cancelCapability,_this34.streamControllers[streamId].isClosed=!0,comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_CANCEL,streamId:streamId,reason:wrapReason(reason)}),cancelCapability.promise}},queueingStrategy)}},{key:"_createStreamSink",value:function(data){var streamId=data.streamId,sourceName=this.sourceName,targetName=data.sourceName,comObj=this.comObj,self=this,action=this.actionHandler[data.action],streamSink={enqueue:function(chunk){var size=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,transfers=arguments.length>2?arguments[2]:void 0;if(!this.isCancelled){var lastDesiredSize=this.desiredSize;this.desiredSize-=size,lastDesiredSize>0&&this.desiredSize<=0&&(this.sinkCapability=(0,_util.createPromiseCapability)(),this.ready=this.sinkCapability.promise),comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_ENQUEUE,streamId:streamId,chunk:chunk},transfers)}},close:function(){this.isCancelled||(this.isCancelled=!0,comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_CLOSE,streamId:streamId}),delete self.streamSinks[streamId])},error:function(reason){(0,_util.assert)(reason instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_ERROR,streamId:streamId,reason:wrapReason(reason)}))},sinkCapability:(0,_util.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:data.desiredSize,ready:null};streamSink.sinkCapability.resolve(),streamSink.ready=streamSink.sinkCapability.promise,this.streamSinks[streamId]=streamSink,new Promise((function(resolve){resolve(action(data.data,streamSink))})).then((function(){comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_START_COMPLETE,streamId:streamId,success:!0})}),(function(reason){comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_START_COMPLETE,streamId:streamId,reason:wrapReason(reason)})}))}},{key:"_processStreamMessage",value:function(data){var streamId=data.streamId,sourceName=this.sourceName,targetName=data.sourceName,comObj=this.comObj,streamController=this.streamControllers[streamId],streamSink=this.streamSinks[streamId];switch(data.stream){case StreamKind_START_COMPLETE:data.success?streamController.startCall.resolve():streamController.startCall.reject(wrapReason(data.reason));break;case StreamKind_PULL_COMPLETE:data.success?streamController.pullCall.resolve():streamController.pullCall.reject(wrapReason(data.reason));break;case StreamKind_PULL:if(!streamSink){comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_PULL_COMPLETE,streamId:streamId,success:!0});break}streamSink.desiredSize<=0&&data.desiredSize>0&&streamSink.sinkCapability.resolve(),streamSink.desiredSize=data.desiredSize,new Promise((function(resolve){resolve(streamSink.onPull&&streamSink.onPull())})).then((function(){comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_PULL_COMPLETE,streamId:streamId,success:!0})}),(function(reason){comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_PULL_COMPLETE,streamId:streamId,reason:wrapReason(reason)})}));break;case StreamKind_ENQUEUE:if((0,_util.assert)(streamController,"enqueue should have stream controller"),streamController.isClosed)break;streamController.controller.enqueue(data.chunk);break;case StreamKind_CLOSE:if((0,_util.assert)(streamController,"close should have stream controller"),streamController.isClosed)break;streamController.isClosed=!0,streamController.controller.close(),this._deleteStreamController(streamController,streamId);break;case StreamKind_ERROR:(0,_util.assert)(streamController,"error should have stream controller"),streamController.controller.error(wrapReason(data.reason)),this._deleteStreamController(streamController,streamId);break;case StreamKind_CANCEL_COMPLETE:data.success?streamController.cancelCall.resolve():streamController.cancelCall.reject(wrapReason(data.reason)),this._deleteStreamController(streamController,streamId);break;case StreamKind_CANCEL:if(!streamSink)break;new Promise((function(resolve){resolve(streamSink.onCancel&&streamSink.onCancel(wrapReason(data.reason)))})).then((function(){comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_CANCEL_COMPLETE,streamId:streamId,success:!0})}),(function(reason){comObj.postMessage({sourceName:sourceName,targetName:targetName,stream:StreamKind_CANCEL_COMPLETE,streamId:streamId,reason:wrapReason(reason)})})),streamSink.sinkCapability.reject(wrapReason(data.reason)),streamSink.isCancelled=!0,delete this.streamSinks[streamId];break;default:throw new Error("Unexpected stream case")}}},{key:"_deleteStreamController",value:(_deleteStreamController2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee12(streamController,streamId){return _regeneratorRuntime().wrap((function(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:return _context12.next=2,Promise.allSettled([streamController.startCall&&streamController.startCall.promise,streamController.pullCall&&streamController.pullCall.promise,streamController.cancelCall&&streamController.cancelCall.promise]);case 2:delete this.streamControllers[streamId];case 3:case"end":return _context12.stop()}}),_callee12,this)}))),function(_x9,_x10){return _deleteStreamController2.apply(this,arguments)})},{key:"destroy",value:function(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}]),MessageHandler}();exports.MessageHandler=MessageHandler},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Metadata=void 0;var _util=__w_pdfjs_require__(1);function _classPrivateFieldInitSpec(obj,privateMap,value){!function(obj,privateCollection){if(privateCollection.has(obj))throw new TypeError("Cannot initialize the same private elements twice on an object")}(obj,privateMap),privateMap.set(obj,value)}function _classPrivateFieldGet(receiver,privateMap){return function(receiver,descriptor){return descriptor.get?descriptor.get.call(receiver):descriptor.value}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"get"))}function _classPrivateFieldSet(receiver,privateMap,value){return function(receiver,descriptor,value){if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"set"),value),value}function _classExtractFieldDescriptor(receiver,privateMap,action){if(!privateMap.has(receiver))throw new TypeError("attempted to "+action+" private field on non-instance");return privateMap.get(receiver)}var _metadataMap=new WeakMap,_data=new WeakMap,Metadata=function(){function Metadata(_ref){_classCallCheck(this,Metadata);var parsedData=_ref.parsedData,rawData=_ref.rawData;_classPrivateFieldInitSpec(this,_metadataMap,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_data,{writable:!0,value:void 0}),_classPrivateFieldSet(this,_metadataMap,parsedData),_classPrivateFieldSet(this,_data,rawData)}return _createClass(Metadata,[{key:"getRaw",value:function(){return _classPrivateFieldGet(this,_data)}},{key:"get",value:function(name){var _classPrivateFieldGet2;return null!==(_classPrivateFieldGet2=_classPrivateFieldGet(this,_metadataMap).get(name))&&void 0!==_classPrivateFieldGet2?_classPrivateFieldGet2:null}},{key:"getAll",value:function(){return(0,_util.objectFromMap)(_classPrivateFieldGet(this,_metadataMap))}},{key:"has",value:function(name){return _classPrivateFieldGet(this,_metadataMap).has(name)}}]),Metadata}();exports.Metadata=Metadata},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.OptionalContentConfig=void 0;var _util=__w_pdfjs_require__(1);function _classPrivateMethodGet(receiver,privateSet,fn){if(!privateSet.has(receiver))throw new TypeError("attempted to get private field on non-instance");return fn}function _classPrivateFieldInitSpec(obj,privateMap,value){_checkPrivateRedeclaration(obj,privateMap),privateMap.set(obj,value)}function _checkPrivateRedeclaration(obj,privateCollection){if(privateCollection.has(obj))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldSet(receiver,privateMap,value){return function(receiver,descriptor,value){if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"set"),value),value}function _classPrivateFieldGet(receiver,privateMap){return function(receiver,descriptor){return descriptor.get?descriptor.get.call(receiver):descriptor.value}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"get"))}function _classExtractFieldDescriptor(receiver,privateMap,action){if(!privateMap.has(receiver))throw new TypeError("attempted to "+action+" private field on non-instance");return privateMap.get(receiver)}var INTERNAL=Symbol("INTERNAL"),_visible=new WeakMap,OptionalContentGroup=function(){function OptionalContentGroup(name,intent){_classCallCheck(this,OptionalContentGroup),_classPrivateFieldInitSpec(this,_visible,{writable:!0,value:!0}),this.name=name,this.intent=intent}return _createClass(OptionalContentGroup,[{key:"visible",get:function(){return _classPrivateFieldGet(this,_visible)}},{key:"_setVisible",value:function(internal,visible){internal!==INTERNAL&&(0,_util.unreachable)("Internal method `_setVisible` called."),_classPrivateFieldSet(this,_visible,visible)}}]),OptionalContentGroup}(),_cachedHasInitialVisibility=new WeakMap,_groups=new WeakMap,_initialVisibility=new WeakMap,_order=new WeakMap,_evaluateVisibilityExpression=new WeakSet,OptionalContentConfig=function(){function OptionalContentConfig(data){var obj,privateSet;if(_classCallCheck(this,OptionalContentConfig),_checkPrivateRedeclaration(obj=this,privateSet=_evaluateVisibilityExpression),privateSet.add(obj),_classPrivateFieldInitSpec(this,_cachedHasInitialVisibility,{writable:!0,value:!0}),_classPrivateFieldInitSpec(this,_groups,{writable:!0,value:new Map}),_classPrivateFieldInitSpec(this,_initialVisibility,{writable:!0,value:null}),_classPrivateFieldInitSpec(this,_order,{writable:!0,value:null}),this.name=null,this.creator=null,null!==data){this.name=data.name,this.creator=data.creator,_classPrivateFieldSet(this,_order,data.order);var _step59,_iterator59=_createForOfIteratorHelper(data.groups);try{for(_iterator59.s();!(_step59=_iterator59.n()).done;){var _group=_step59.value;_classPrivateFieldGet(this,_groups).set(_group.id,new OptionalContentGroup(_group.name,_group.intent))}}catch(err){_iterator59.e(err)}finally{_iterator59.f()}if("OFF"===data.baseState){var _step60,_iterator60=_createForOfIteratorHelper(_classPrivateFieldGet(this,_groups).values());try{for(_iterator60.s();!(_step60=_iterator60.n()).done;)_step60.value._setVisible(INTERNAL,!1)}catch(err){_iterator60.e(err)}finally{_iterator60.f()}}var _step61,_iterator61=_createForOfIteratorHelper(data.on);try{for(_iterator61.s();!(_step61=_iterator61.n()).done;){var on=_step61.value;_classPrivateFieldGet(this,_groups).get(on)._setVisible(INTERNAL,!0)}}catch(err){_iterator61.e(err)}finally{_iterator61.f()}var _step62,_iterator62=_createForOfIteratorHelper(data.off);try{for(_iterator62.s();!(_step62=_iterator62.n()).done;){var off=_step62.value;_classPrivateFieldGet(this,_groups).get(off)._setVisible(INTERNAL,!1)}}catch(err){_iterator62.e(err)}finally{_iterator62.f()}_classPrivateFieldSet(this,_initialVisibility,new Map);var _step63,_iterator63=_createForOfIteratorHelper(_classPrivateFieldGet(this,_groups));try{for(_iterator63.s();!(_step63=_iterator63.n()).done;){var _step63$value=_slicedToArray(_step63.value,2),id=_step63$value[0],_group2=_step63$value[1];_classPrivateFieldGet(this,_initialVisibility).set(id,_group2.visible)}}catch(err){_iterator63.e(err)}finally{_iterator63.f()}}}return _createClass(OptionalContentConfig,[{key:"isVisible",value:function(group){if(0===_classPrivateFieldGet(this,_groups).size)return!0;if(!group)return(0,_util.warn)("Optional content group not defined."),!0;if("OCG"===group.type)return _classPrivateFieldGet(this,_groups).has(group.id)?_classPrivateFieldGet(this,_groups).get(group.id).visible:((0,_util.warn)("Optional content group not found: ".concat(group.id)),!0);if("OCMD"===group.type){if(group.expression)return _classPrivateMethodGet(this,_evaluateVisibilityExpression,_evaluateVisibilityExpression2).call(this,group.expression);if(!group.policy||"AnyOn"===group.policy){var _step64,_iterator64=_createForOfIteratorHelper(group.ids);try{for(_iterator64.s();!(_step64=_iterator64.n()).done;){var id=_step64.value;if(!_classPrivateFieldGet(this,_groups).has(id))return(0,_util.warn)("Optional content group not found: ".concat(id)),!0;if(_classPrivateFieldGet(this,_groups).get(id).visible)return!0}}catch(err){_iterator64.e(err)}finally{_iterator64.f()}return!1}if("AllOn"===group.policy){var _step65,_iterator65=_createForOfIteratorHelper(group.ids);try{for(_iterator65.s();!(_step65=_iterator65.n()).done;){var _id2=_step65.value;if(!_classPrivateFieldGet(this,_groups).has(_id2))return(0,_util.warn)("Optional content group not found: ".concat(_id2)),!0;if(!_classPrivateFieldGet(this,_groups).get(_id2).visible)return!1}}catch(err){_iterator65.e(err)}finally{_iterator65.f()}return!0}if("AnyOff"===group.policy){var _step66,_iterator66=_createForOfIteratorHelper(group.ids);try{for(_iterator66.s();!(_step66=_iterator66.n()).done;){var _id3=_step66.value;if(!_classPrivateFieldGet(this,_groups).has(_id3))return(0,_util.warn)("Optional content group not found: ".concat(_id3)),!0;if(!_classPrivateFieldGet(this,_groups).get(_id3).visible)return!0}}catch(err){_iterator66.e(err)}finally{_iterator66.f()}return!1}if("AllOff"===group.policy){var _step67,_iterator67=_createForOfIteratorHelper(group.ids);try{for(_iterator67.s();!(_step67=_iterator67.n()).done;){var _id4=_step67.value;if(!_classPrivateFieldGet(this,_groups).has(_id4))return(0,_util.warn)("Optional content group not found: ".concat(_id4)),!0;if(_classPrivateFieldGet(this,_groups).get(_id4).visible)return!1}}catch(err){_iterator67.e(err)}finally{_iterator67.f()}return!0}return(0,_util.warn)("Unknown optional content policy ".concat(group.policy,".")),!0}return(0,_util.warn)("Unknown group type ".concat(group.type,".")),!0}},{key:"setVisibility",value:function(id){var visible=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];_classPrivateFieldGet(this,_groups).has(id)?(_classPrivateFieldGet(this,_groups).get(id)._setVisible(INTERNAL,!!visible),_classPrivateFieldSet(this,_cachedHasInitialVisibility,null)):(0,_util.warn)("Optional content group not found: ".concat(id))}},{key:"hasInitialVisibility",get:function(){if(null!==_classPrivateFieldGet(this,_cachedHasInitialVisibility))return _classPrivateFieldGet(this,_cachedHasInitialVisibility);var _step68,_iterator68=_createForOfIteratorHelper(_classPrivateFieldGet(this,_groups));try{for(_iterator68.s();!(_step68=_iterator68.n()).done;){var _step68$value=_slicedToArray(_step68.value,2),id=_step68$value[0],group=_step68$value[1],visible=_classPrivateFieldGet(this,_initialVisibility).get(id);if(group.visible!==visible)return _classPrivateFieldSet(this,_cachedHasInitialVisibility,!1)}}catch(err){_iterator68.e(err)}finally{_iterator68.f()}return _classPrivateFieldSet(this,_cachedHasInitialVisibility,!0)}},{key:"getOrder",value:function(){return _classPrivateFieldGet(this,_groups).size?_classPrivateFieldGet(this,_order)?_classPrivateFieldGet(this,_order).slice():_toConsumableArray(_classPrivateFieldGet(this,_groups).keys()):null}},{key:"getGroups",value:function(){return _classPrivateFieldGet(this,_groups).size>0?(0,_util.objectFromMap)(_classPrivateFieldGet(this,_groups)):null}},{key:"getGroup",value:function(id){return _classPrivateFieldGet(this,_groups).get(id)||null}}]),OptionalContentConfig}();function _evaluateVisibilityExpression2(array){var length=array.length;if(length<2)return!0;for(var operator=array[0],i=1;i<length;i++){var element=array[i],state=void 0;if(Array.isArray(element))state=_classPrivateMethodGet(this,_evaluateVisibilityExpression,_evaluateVisibilityExpression2).call(this,element);else{if(!_classPrivateFieldGet(this,_groups).has(element))return(0,_util.warn)("Optional content group not found: ".concat(element)),!0;state=_classPrivateFieldGet(this,_groups).get(element).visible}switch(operator){case"And":if(!state)return!1;break;case"Or":if(state)return!0;break;case"Not":return!state;default:return!0}}return"And"===operator}exports.OptionalContentConfig=OptionalContentConfig},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFDataTransportStream=void 0;var _util=__w_pdfjs_require__(1),_display_utils=__w_pdfjs_require__(133),PDFDataTransportStream=function(){function PDFDataTransportStream(params,pdfDataRangeTransport){var _this35=this;_classCallCheck(this,PDFDataTransportStream),(0,_util.assert)(pdfDataRangeTransport,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=params.progressiveDone||!1,this._contentDispositionFilename=params.contentDispositionFilename||null;var initialData=params.initialData;if((null==initialData?void 0:initialData.length)>0){var buffer=new Uint8Array(initialData).buffer;this._queuedChunks.push(buffer)}this._pdfDataRangeTransport=pdfDataRangeTransport,this._isStreamingSupported=!params.disableStream,this._isRangeSupported=!params.disableRange,this._contentLength=params.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((function(begin,chunk){_this35._onReceiveData({begin:begin,chunk:chunk})})),this._pdfDataRangeTransport.addProgressListener((function(loaded,total){_this35._onProgress({loaded:loaded,total:total})})),this._pdfDataRangeTransport.addProgressiveReadListener((function(chunk){_this35._onReceiveData({chunk:chunk})})),this._pdfDataRangeTransport.addProgressiveDoneListener((function(){_this35._onProgressiveDone()})),this._pdfDataRangeTransport.transportReady()}return _createClass(PDFDataTransportStream,[{key:"_onReceiveData",value:function(args){var buffer=new Uint8Array(args.chunk).buffer;if(void 0===args.begin)this._fullRequestReader?this._fullRequestReader._enqueue(buffer):this._queuedChunks.push(buffer);else{var found=this._rangeReaders.some((function(rangeReader){return rangeReader._begin===args.begin&&(rangeReader._enqueue(buffer),!0)}));(0,_util.assert)(found,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}},{key:"_progressiveDataLength",get:function(){var _this$_fullRequestRea,_this$_fullRequestRea2;return null!==(_this$_fullRequestRea=null===(_this$_fullRequestRea2=this._fullRequestReader)||void 0===_this$_fullRequestRea2?void 0:_this$_fullRequestRea2._loaded)&&void 0!==_this$_fullRequestRea?_this$_fullRequestRea:0}},{key:"_onProgress",value:function(evt){if(void 0===evt.total){var firstReader=this._rangeReaders[0];null!=firstReader&&firstReader.onProgress&&firstReader.onProgress({loaded:evt.loaded})}else{var fullReader=this._fullRequestReader;null!=fullReader&&fullReader.onProgress&&fullReader.onProgress({loaded:evt.loaded,total:evt.total})}}},{key:"_onProgressiveDone",value:function(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}},{key:"_removeRangeReader",value:function(reader){var i=this._rangeReaders.indexOf(reader);i>=0&&this._rangeReaders.splice(i,1)}},{key:"getFullReader",value:function(){(0,_util.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");var queuedChunks=this._queuedChunks;return this._queuedChunks=null,new PDFDataTransportStreamReader(this,queuedChunks,this._progressiveDone,this._contentDispositionFilename)}},{key:"getRangeReader",value:function(begin,end){if(end<=this._progressiveDataLength)return null;var reader=new PDFDataTransportStreamRangeReader(this,begin,end);return this._pdfDataRangeTransport.requestDataRange(begin,end),this._rangeReaders.push(reader),reader}},{key:"cancelAllRequests",value:function(reason){this._fullRequestReader&&this._fullRequestReader.cancel(reason);var _step69,_iterator69=_createForOfIteratorHelper(this._rangeReaders.slice(0));try{for(_iterator69.s();!(_step69=_iterator69.n()).done;)_step69.value.cancel(reason)}catch(err){_iterator69.e(err)}finally{_iterator69.f()}this._pdfDataRangeTransport.abort()}}]),PDFDataTransportStream}();exports.PDFDataTransportStream=PDFDataTransportStream;var PDFDataTransportStreamReader=function(){function PDFDataTransportStreamReader(stream,queuedChunks){_classCallCheck(this,PDFDataTransportStreamReader);var progressiveDone=arguments.length>2&&void 0!==arguments[2]&&arguments[2],contentDispositionFilename=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this._stream=stream,this._done=progressiveDone||!1,this._filename=(0,_display_utils.isPdfFile)(contentDispositionFilename)?contentDispositionFilename:null,this._queuedChunks=queuedChunks||[],this._loaded=0;var _step70,_iterator70=_createForOfIteratorHelper(this._queuedChunks);try{for(_iterator70.s();!(_step70=_iterator70.n()).done;){var chunk=_step70.value;this._loaded+=chunk.byteLength}}catch(err){_iterator70.e(err)}finally{_iterator70.f()}this._requests=[],this._headersReady=Promise.resolve(),stream._fullRequestReader=this,this.onProgress=null}var _read;return _createClass(PDFDataTransportStreamReader,[{key:"_enqueue",value:function(chunk){this._done||(this._requests.length>0?this._requests.shift().resolve({value:chunk,done:!1}):this._queuedChunks.push(chunk),this._loaded+=chunk.byteLength)}},{key:"headersReady",get:function(){return this._headersReady}},{key:"filename",get:function(){return this._filename}},{key:"isRangeSupported",get:function(){return this._stream._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._stream._isStreamingSupported}},{key:"contentLength",get:function(){return this._stream._contentLength}},{key:"read",value:(_read=_asyncToGenerator(_regeneratorRuntime().mark((function _callee13(){var chunk,requestCapability;return _regeneratorRuntime().wrap((function(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:if(!(this._queuedChunks.length>0)){_context13.next=3;break}return chunk=this._queuedChunks.shift(),_context13.abrupt("return",{value:chunk,done:!1});case 3:if(!this._done){_context13.next=5;break}return _context13.abrupt("return",{value:void 0,done:!0});case 5:return requestCapability=(0,_util.createPromiseCapability)(),this._requests.push(requestCapability),_context13.abrupt("return",requestCapability.promise);case 8:case"end":return _context13.stop()}}),_callee13,this)}))),function(){return _read.apply(this,arguments)})},{key:"cancel",value:function(reason){this._done=!0;var _step71,_iterator71=_createForOfIteratorHelper(this._requests);try{for(_iterator71.s();!(_step71=_iterator71.n()).done;)_step71.value.resolve({value:void 0,done:!0})}catch(err){_iterator71.e(err)}finally{_iterator71.f()}this._requests.length=0}},{key:"progressiveDone",value:function(){this._done||(this._done=!0)}}]),PDFDataTransportStreamReader}(),PDFDataTransportStreamRangeReader=function(){function PDFDataTransportStreamRangeReader(stream,begin,end){_classCallCheck(this,PDFDataTransportStreamRangeReader),this._stream=stream,this._begin=begin,this._end=end,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}var _read2;return _createClass(PDFDataTransportStreamRangeReader,[{key:"_enqueue",value:function(chunk){if(!this._done){if(0===this._requests.length)this._queuedChunk=chunk;else{this._requests.shift().resolve({value:chunk,done:!1});var _step72,_iterator72=_createForOfIteratorHelper(this._requests);try{for(_iterator72.s();!(_step72=_iterator72.n()).done;)_step72.value.resolve({value:void 0,done:!0})}catch(err){_iterator72.e(err)}finally{_iterator72.f()}this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}},{key:"isStreamingSupported",get:function(){return!1}},{key:"read",value:(_read2=_asyncToGenerator(_regeneratorRuntime().mark((function _callee14(){var chunk,requestCapability;return _regeneratorRuntime().wrap((function(_context14){for(;;)switch(_context14.prev=_context14.next){case 0:if(!this._queuedChunk){_context14.next=4;break}return chunk=this._queuedChunk,this._queuedChunk=null,_context14.abrupt("return",{value:chunk,done:!1});case 4:if(!this._done){_context14.next=6;break}return _context14.abrupt("return",{value:void 0,done:!0});case 6:return requestCapability=(0,_util.createPromiseCapability)(),this._requests.push(requestCapability),_context14.abrupt("return",requestCapability.promise);case 9:case"end":return _context14.stop()}}),_callee14,this)}))),function(){return _read2.apply(this,arguments)})},{key:"cancel",value:function(reason){this._done=!0;var _step73,_iterator73=_createForOfIteratorHelper(this._requests);try{for(_iterator73.s();!(_step73=_iterator73.n()).done;)_step73.value.resolve({value:void 0,done:!0})}catch(err){_iterator73.e(err)}finally{_iterator73.f()}this._requests.length=0,this._stream._removeRangeReader(this)}}]),PDFDataTransportStreamRangeReader}()},function(__unused_webpack_module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.XfaText=void 0;var XfaText=function(){function XfaText(){_classCallCheck(this,XfaText)}return _createClass(XfaText,null,[{key:"textContent",value:function(xfa){var items=[],output={items:items,styles:Object.create(null)};return function walk(node){var _node$attributes;if(node){var str=null,name=node.name;if("#text"===name)str=node.value;else{if(!XfaText.shouldBuildText(name))return;null!=node&&null!==(_node$attributes=node.attributes)&&void 0!==_node$attributes&&_node$attributes.textContent?str=node.attributes.textContent:node.value&&(str=node.value)}if(null!==str&&items.push({str:str}),node.children){var _step74,_iterator74=_createForOfIteratorHelper(node.children);try{for(_iterator74.s();!(_step74=_iterator74.n()).done;)walk(_step74.value)}catch(err){_iterator74.e(err)}finally{_iterator74.f()}}}}(xfa),output}},{key:"shouldBuildText",value:function(name){return!("textarea"===name||"input"===name||"option"===name||"select"===name)}}]),XfaText}();exports.XfaText=XfaText},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.NodeStandardFontDataFactory=exports.NodeCanvasFactory=exports.NodeCMapReaderFactory=void 0;var _base_factory=__w_pdfjs_require__(134),fetchData=function(url){return new Promise((function(resolve,reject){__webpack_require__(767).readFile(url,(function(error,data){!error&&data?resolve(new Uint8Array(data)):reject(new Error(error))}))}))},NodeCanvasFactory=function(_base_factory$BaseCan2){function NodeCanvasFactory(){return _classCallCheck(this,NodeCanvasFactory),_callSuper(this,NodeCanvasFactory,arguments)}return _inherits(NodeCanvasFactory,_base_factory$BaseCan2),_createClass(NodeCanvasFactory,[{key:"_createCanvas",value:function(width,height){return __webpack_require__(601).createCanvas(width,height)}}]),NodeCanvasFactory}(_base_factory.BaseCanvasFactory);exports.NodeCanvasFactory=NodeCanvasFactory;var NodeCMapReaderFactory=function(_base_factory$BaseCMa2){function NodeCMapReaderFactory(){return _classCallCheck(this,NodeCMapReaderFactory),_callSuper(this,NodeCMapReaderFactory,arguments)}return _inherits(NodeCMapReaderFactory,_base_factory$BaseCMa2),_createClass(NodeCMapReaderFactory,[{key:"_fetchData",value:function(url,compressionType){return fetchData(url).then((function(data){return{cMapData:data,compressionType:compressionType}}))}}]),NodeCMapReaderFactory}(_base_factory.BaseCMapReaderFactory);exports.NodeCMapReaderFactory=NodeCMapReaderFactory;var NodeStandardFontDataFactory=function(_base_factory$BaseSta2){function NodeStandardFontDataFactory(){return _classCallCheck(this,NodeStandardFontDataFactory),_callSuper(this,NodeStandardFontDataFactory,arguments)}return _inherits(NodeStandardFontDataFactory,_base_factory$BaseSta2),_createClass(NodeStandardFontDataFactory,[{key:"_fetchData",value:function(url){return fetchData(url)}}]),NodeStandardFontDataFactory}(_base_factory.BaseStandardFontDataFactory);exports.NodeStandardFontDataFactory=NodeStandardFontDataFactory},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnnotationEditorLayer=void 0;var _tools=__w_pdfjs_require__(132),_util=__w_pdfjs_require__(1),_freetext=__w_pdfjs_require__(148),_ink=__w_pdfjs_require__(149);function _classPrivateMethodInitSpec(obj,privateSet){_checkPrivateRedeclaration(obj,privateSet),privateSet.add(obj)}function _classPrivateFieldInitSpec(obj,privateMap,value){_checkPrivateRedeclaration(obj,privateMap),privateMap.set(obj,value)}function _checkPrivateRedeclaration(obj,privateCollection){if(privateCollection.has(obj))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateMethodGet(receiver,privateSet,fn){if(!privateSet.has(receiver))throw new TypeError("attempted to get private field on non-instance");return fn}function _classPrivateFieldGet(receiver,privateMap){return function(receiver,descriptor){return descriptor.get?descriptor.get.call(receiver):descriptor.value}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"get"))}function _classPrivateFieldSet(receiver,privateMap,value){return function(receiver,descriptor,value){if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"set"),value),value}function _classExtractFieldDescriptor(receiver,privateMap,action){if(!privateMap.has(receiver))throw new TypeError("attempted to "+action+" private field on non-instance");return privateMap.get(receiver)}var obj,key,value,_accessibilityManager=new WeakMap,_allowClick=new WeakMap,_boundPointerup=new WeakMap,_boundPointerdown=new WeakMap,_editors=new WeakMap,_hadPointerDown=new WeakMap,_isCleaningUp=new WeakMap,_uiManager=new WeakMap,_changeParent=new WeakSet,_createNewEditor=new WeakSet,_createAndAddNewEditor=new WeakSet,_cleanup=new WeakSet,AnnotationEditorLayer=function(){function AnnotationEditorLayer(options){_classCallCheck(this,AnnotationEditorLayer),_classPrivateMethodInitSpec(this,_cleanup),_classPrivateMethodInitSpec(this,_createAndAddNewEditor),_classPrivateMethodInitSpec(this,_createNewEditor),_classPrivateMethodInitSpec(this,_changeParent),_classPrivateFieldInitSpec(this,_accessibilityManager,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(this,_allowClick,{writable:!0,value:!1}),_classPrivateFieldInitSpec(this,_boundPointerup,{writable:!0,value:this.pointerup.bind(this)}),_classPrivateFieldInitSpec(this,_boundPointerdown,{writable:!0,value:this.pointerdown.bind(this)}),_classPrivateFieldInitSpec(this,_editors,{writable:!0,value:new Map}),_classPrivateFieldInitSpec(this,_hadPointerDown,{writable:!0,value:!1}),_classPrivateFieldInitSpec(this,_isCleaningUp,{writable:!0,value:!1}),_classPrivateFieldInitSpec(this,_uiManager,{writable:!0,value:void 0}),AnnotationEditorLayer._initialized||(AnnotationEditorLayer._initialized=!0,_freetext.FreeTextEditor.initialize(options.l10n),_ink.InkEditor.initialize(options.l10n),options.uiManager.registerEditorTypes([_freetext.FreeTextEditor,_ink.InkEditor])),_classPrivateFieldSet(this,_uiManager,options.uiManager),this.annotationStorage=options.annotationStorage,this.pageIndex=options.pageIndex,this.div=options.div,_classPrivateFieldSet(this,_accessibilityManager,options.accessibilityManager),_classPrivateFieldGet(this,_uiManager).addLayer(this)}return _createClass(AnnotationEditorLayer,[{key:"updateToolbar",value:function(mode){_classPrivateFieldGet(this,_uiManager).updateToolbar(mode)}},{key:"updateMode",value:function(){var mode=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_classPrivateFieldGet(this,_uiManager).getMode();_classPrivateMethodGet(this,_cleanup,_cleanup2).call(this),mode===_util.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),_classPrivateFieldGet(this,_uiManager).unselectAll()}},{key:"addInkEditorIfNeeded",value:function(isCommitting){if(isCommitting||_classPrivateFieldGet(this,_uiManager).getMode()===_util.AnnotationEditorType.INK){if(!isCommitting){var _step75,_iterator75=_createForOfIteratorHelper(_classPrivateFieldGet(this,_editors).values());try{for(_iterator75.s();!(_step75=_iterator75.n()).done;){var _editor2=_step75.value;if(_editor2.isEmpty())return void _editor2.setInBackground()}}catch(err){_iterator75.e(err)}finally{_iterator75.f()}}_classPrivateMethodGet(this,_createAndAddNewEditor,_createAndAddNewEditor2).call(this,{offsetX:0,offsetY:0}).setInBackground()}}},{key:"setEditingState",value:function(isEditing){_classPrivateFieldGet(this,_uiManager).setEditingState(isEditing)}},{key:"addCommands",value:function(params){_classPrivateFieldGet(this,_uiManager).addCommands(params)}},{key:"enable",value:function(){this.div.style.pointerEvents="auto";var _step76,_iterator76=_createForOfIteratorHelper(_classPrivateFieldGet(this,_editors).values());try{for(_iterator76.s();!(_step76=_iterator76.n()).done;)_step76.value.enableEditing()}catch(err){_iterator76.e(err)}finally{_iterator76.f()}}},{key:"disable",value:function(){this.div.style.pointerEvents="none";var _step77,_iterator77=_createForOfIteratorHelper(_classPrivateFieldGet(this,_editors).values());try{for(_iterator77.s();!(_step77=_iterator77.n()).done;)_step77.value.disableEditing()}catch(err){_iterator77.e(err)}finally{_iterator77.f()}}},{key:"setActiveEditor",value:function(editor){_classPrivateFieldGet(this,_uiManager).getActive()!==editor&&_classPrivateFieldGet(this,_uiManager).setActiveEditor(editor)}},{key:"enableClick",value:function(){this.div.addEventListener("pointerdown",_classPrivateFieldGet(this,_boundPointerdown)),this.div.addEventListener("pointerup",_classPrivateFieldGet(this,_boundPointerup))}},{key:"disableClick",value:function(){this.div.removeEventListener("pointerdown",_classPrivateFieldGet(this,_boundPointerdown)),this.div.removeEventListener("pointerup",_classPrivateFieldGet(this,_boundPointerup))}},{key:"attach",value:function(editor){_classPrivateFieldGet(this,_editors).set(editor.id,editor)}},{key:"detach",value:function(editor){var _classPrivateFieldGet2;_classPrivateFieldGet(this,_editors).delete(editor.id),null===(_classPrivateFieldGet2=_classPrivateFieldGet(this,_accessibilityManager))||void 0===_classPrivateFieldGet2||_classPrivateFieldGet2.removePointerInTextLayer(editor.contentDiv)}},{key:"remove",value:function(editor){var _this36=this;_classPrivateFieldGet(this,_uiManager).removeEditor(editor),this.detach(editor),this.annotationStorage.remove(editor.id),editor.div.style.display="none",setTimeout((function(){editor.div.style.display="",editor.div.remove(),editor.isAttachedToDOM=!1,document.activeElement===document.body&&_classPrivateFieldGet(_this36,_uiManager).focusMainContainer()}),0),_classPrivateFieldGet(this,_isCleaningUp)||this.addInkEditorIfNeeded(!1)}},{key:"add",value:function(editor){if(_classPrivateMethodGet(this,_changeParent,_changeParent2).call(this,editor),_classPrivateFieldGet(this,_uiManager).addEditor(editor),this.attach(editor),!editor.isAttachedToDOM){var div=editor.render();this.div.append(div),editor.isAttachedToDOM=!0}this.moveEditorInDOM(editor),editor.onceAdded(),this.addToAnnotationStorage(editor)}},{key:"moveEditorInDOM",value:function(editor){var _classPrivateFieldGet3;null===(_classPrivateFieldGet3=_classPrivateFieldGet(this,_accessibilityManager))||void 0===_classPrivateFieldGet3||_classPrivateFieldGet3.moveElementInDOM(this.div,editor.div,editor.contentDiv,!0)}},{key:"addToAnnotationStorage",value:function(editor){editor.isEmpty()||this.annotationStorage.has(editor.id)||this.annotationStorage.setValue(editor.id,editor)}},{key:"addOrRebuild",value:function(editor){editor.needsToBeRebuilt()?editor.rebuild():this.add(editor)}},{key:"addANewEditor",value:function(editor){var _this37=this;this.addCommands({cmd:function(){_this37.addOrRebuild(editor)},undo:function(){editor.remove()},mustExec:!0})}},{key:"addUndoableEditor",value:function(editor){var _this38=this;this.addCommands({cmd:function(){_this38.addOrRebuild(editor)},undo:function(){editor.remove()},mustExec:!1})}},{key:"getNextId",value:function(){return _classPrivateFieldGet(this,_uiManager).getId()}},{key:"deserialize",value:function(data){switch(data.annotationType){case _util.AnnotationEditorType.FREETEXT:return _freetext.FreeTextEditor.deserialize(data,this);case _util.AnnotationEditorType.INK:return _ink.InkEditor.deserialize(data,this)}return null}},{key:"setSelected",value:function(editor){_classPrivateFieldGet(this,_uiManager).setSelected(editor)}},{key:"toggleSelected",value:function(editor){_classPrivateFieldGet(this,_uiManager).toggleSelected(editor)}},{key:"isSelected",value:function(editor){return _classPrivateFieldGet(this,_uiManager).isSelected(editor)}},{key:"unselect",value:function(editor){_classPrivateFieldGet(this,_uiManager).unselect(editor)}},{key:"pointerup",value:function(event){var isMac=_tools.KeyboardManager.platform.isMac;0!==event.button||event.ctrlKey&&isMac||event.target===this.div&&_classPrivateFieldGet(this,_hadPointerDown)&&(_classPrivateFieldSet(this,_hadPointerDown,!1),_classPrivateFieldGet(this,_allowClick)?_classPrivateMethodGet(this,_createAndAddNewEditor,_createAndAddNewEditor2).call(this,event):_classPrivateFieldSet(this,_allowClick,!0))}},{key:"pointerdown",value:function(event){var isMac=_tools.KeyboardManager.platform.isMac;if(!(0!==event.button||event.ctrlKey&&isMac)&&event.target===this.div){_classPrivateFieldSet(this,_hadPointerDown,!0);var editor=_classPrivateFieldGet(this,_uiManager).getActive();_classPrivateFieldSet(this,_allowClick,!editor||editor.isEmpty())}}},{key:"drop",value:function(event){var id=event.dataTransfer.getData("text/plain"),editor=_classPrivateFieldGet(this,_uiManager).getEditor(id);if(editor){event.preventDefault(),event.dataTransfer.dropEffect="move",_classPrivateMethodGet(this,_changeParent,_changeParent2).call(this,editor);var rect=this.div.getBoundingClientRect(),endX=event.clientX-rect.x,endY=event.clientY-rect.y;editor.translate(endX-editor.startX,endY-editor.startY),this.moveEditorInDOM(editor),editor.div.focus()}}},{key:"dragover",value:function(event){event.preventDefault()}},{key:"destroy",value:function(){var _classPrivateFieldGet4;(null===(_classPrivateFieldGet4=_classPrivateFieldGet(this,_uiManager).getActive())||void 0===_classPrivateFieldGet4?void 0:_classPrivateFieldGet4.parent)===this&&_classPrivateFieldGet(this,_uiManager).setActiveEditor(null);var _step78,_iterator78=_createForOfIteratorHelper(_classPrivateFieldGet(this,_editors).values());try{for(_iterator78.s();!(_step78=_iterator78.n()).done;){var _classPrivateFieldGet5,editor=_step78.value;null===(_classPrivateFieldGet5=_classPrivateFieldGet(this,_accessibilityManager))||void 0===_classPrivateFieldGet5||_classPrivateFieldGet5.removePointerInTextLayer(editor.contentDiv),editor.isAttachedToDOM=!1,editor.div.remove(),editor.parent=null}}catch(err){_iterator78.e(err)}finally{_iterator78.f()}this.div=null,_classPrivateFieldGet(this,_editors).clear(),_classPrivateFieldGet(this,_uiManager).removeLayer(this)}},{key:"render",value:function(parameters){this.viewport=parameters.viewport,(0,_tools.bindEvents)(this,this.div,["dragover","drop"]),this.setDimensions();var _step79,_iterator79=_createForOfIteratorHelper(_classPrivateFieldGet(this,_uiManager).getEditors(this.pageIndex));try{for(_iterator79.s();!(_step79=_iterator79.n()).done;){var editor=_step79.value;this.add(editor)}}catch(err){_iterator79.e(err)}finally{_iterator79.f()}this.updateMode()}},{key:"update",value:function(parameters){this.viewport=parameters.viewport,this.setDimensions(),this.updateMode()}},{key:"scaleFactor",get:function(){return this.viewport.scale}},{key:"pageDimensions",get:function(){var _this$viewport$viewBo=_slicedToArray(this.viewport.viewBox,4),pageLLx=_this$viewport$viewBo[0],pageLLy=_this$viewport$viewBo[1];return[_this$viewport$viewBo[2]-pageLLx,_this$viewport$viewBo[3]-pageLLy]}},{key:"viewportBaseDimensions",get:function(){var _this$viewport=this.viewport,width=_this$viewport.width,height=_this$viewport.height;return _this$viewport.rotation%180==0?[width,height]:[height,width]}},{key:"setDimensions",value:function(){var _this$viewport2=this.viewport,width=_this$viewport2.width,height=_this$viewport2.height,rotation=_this$viewport2.rotation,flipOrientation=rotation%180!=0,widthStr=Math.floor(width)+"px",heightStr=Math.floor(height)+"px";this.div.style.width=flipOrientation?heightStr:widthStr,this.div.style.height=flipOrientation?widthStr:heightStr,this.div.setAttribute("data-main-rotation",rotation)}}]),AnnotationEditorLayer}();function _changeParent2(editor){var _editor$parent;editor.parent!==this&&(this.attach(editor),editor.pageIndex=this.pageIndex,null===(_editor$parent=editor.parent)||void 0===_editor$parent||_editor$parent.detach(editor),editor.parent=this,editor.div&&editor.isAttachedToDOM&&(editor.div.remove(),this.div.append(editor.div)))}function _createNewEditor2(params){switch(_classPrivateFieldGet(this,_uiManager).getMode()){case _util.AnnotationEditorType.FREETEXT:return new _freetext.FreeTextEditor(params);case _util.AnnotationEditorType.INK:return new _ink.InkEditor(params)}return null}function _createAndAddNewEditor2(event){var id=this.getNextId(),editor=_classPrivateMethodGet(this,_createNewEditor,_createNewEditor2).call(this,{parent:this,id:id,x:event.offsetX,y:event.offsetY});return editor&&this.add(editor),editor}function _cleanup2(){_classPrivateFieldSet(this,_isCleaningUp,!0);var _step80,_iterator80=_createForOfIteratorHelper(_classPrivateFieldGet(this,_editors).values());try{for(_iterator80.s();!(_step80=_iterator80.n()).done;){var editor=_step80.value;editor.isEmpty()&&editor.remove()}}catch(err){_iterator80.e(err)}finally{_iterator80.f()}_classPrivateFieldSet(this,_isCleaningUp,!1)}exports.AnnotationEditorLayer=AnnotationEditorLayer,value=!1,(key="_initialized")in(obj=AnnotationEditorLayer)?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.FreeTextEditor=void 0;var _util=__w_pdfjs_require__(1),_tools=__w_pdfjs_require__(132),_editor=__w_pdfjs_require__(131);function _classPrivateMethodInitSpec(obj,privateSet){_checkPrivateRedeclaration(obj,privateSet),privateSet.add(obj)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldInitSpec(obj,privateMap,value){_checkPrivateRedeclaration(obj,privateMap),privateMap.set(obj,value)}function _checkPrivateRedeclaration(obj,privateCollection){if(privateCollection.has(obj))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateFieldGet(receiver,privateMap){return function(receiver,descriptor){return descriptor.get?descriptor.get.call(receiver):descriptor.value}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"get"))}function _classPrivateMethodGet(receiver,privateSet,fn){if(!privateSet.has(receiver))throw new TypeError("attempted to get private field on non-instance");return fn}function _classPrivateFieldSet(receiver,privateMap,value){return function(receiver,descriptor,value){if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"set"),value),value}function _classExtractFieldDescriptor(receiver,privateMap,action){if(!privateMap.has(receiver))throw new TypeError("attempted to "+action+" private field on non-instance");return privateMap.get(receiver)}var _boundEditorDivBlur=new WeakMap,_boundEditorDivFocus=new WeakMap,_boundEditorDivKeydown=new WeakMap,_color=new WeakMap,_content=new WeakMap,_hasAlreadyBeenCommitted=new WeakMap,_fontSize=new WeakMap,_updateFontSize=new WeakSet,_updateColor=new WeakSet,_extractText=new WeakSet,_setEditorDimensions=new WeakSet,FreeTextEditor=function(_editor$AnnotationEdi){function FreeTextEditor(params){var _this39;return _classCallCheck(this,FreeTextEditor),_classPrivateMethodInitSpec(_assertThisInitialized(_this39=_callSuper(this,FreeTextEditor,[_objectSpread(_objectSpread({},params),{},{name:"freeTextEditor"})])),_setEditorDimensions),_classPrivateMethodInitSpec(_assertThisInitialized(_this39),_extractText),_classPrivateMethodInitSpec(_assertThisInitialized(_this39),_updateColor),_classPrivateMethodInitSpec(_assertThisInitialized(_this39),_updateFontSize),_classPrivateFieldInitSpec(_assertThisInitialized(_this39),_boundEditorDivBlur,{writable:!0,value:_this39.editorDivBlur.bind(_assertThisInitialized(_this39))}),_classPrivateFieldInitSpec(_assertThisInitialized(_this39),_boundEditorDivFocus,{writable:!0,value:_this39.editorDivFocus.bind(_assertThisInitialized(_this39))}),_classPrivateFieldInitSpec(_assertThisInitialized(_this39),_boundEditorDivKeydown,{writable:!0,value:_this39.editorDivKeydown.bind(_assertThisInitialized(_this39))}),_classPrivateFieldInitSpec(_assertThisInitialized(_this39),_color,{writable:!0,value:void 0}),_classPrivateFieldInitSpec(_assertThisInitialized(_this39),_content,{writable:!0,value:""}),_classPrivateFieldInitSpec(_assertThisInitialized(_this39),_hasAlreadyBeenCommitted,{writable:!0,value:!1}),_classPrivateFieldInitSpec(_assertThisInitialized(_this39),_fontSize,{writable:!0,value:void 0}),_classPrivateFieldSet(_assertThisInitialized(_this39),_color,params.color||FreeTextEditor._defaultColor||_editor.AnnotationEditor._defaultLineColor),_classPrivateFieldSet(_assertThisInitialized(_this39),_fontSize,params.fontSize||FreeTextEditor._defaultFontSize),_this39}return _inherits(FreeTextEditor,_editor$AnnotationEdi),_createClass(FreeTextEditor,[{key:"updateParams",value:function(type,value){switch(type){case _util.AnnotationEditorParamsType.FREETEXT_SIZE:_classPrivateMethodGet(this,_updateFontSize,_updateFontSize2).call(this,value);break;case _util.AnnotationEditorParamsType.FREETEXT_COLOR:_classPrivateMethodGet(this,_updateColor,_updateColor2).call(this,value)}}},{key:"propertiesToUpdate",get:function(){return[[_util.AnnotationEditorParamsType.FREETEXT_SIZE,_classPrivateFieldGet(this,_fontSize)],[_util.AnnotationEditorParamsType.FREETEXT_COLOR,_classPrivateFieldGet(this,_color)]]}},{key:"getInitialTranslation",value:function(){return[-FreeTextEditor._internalPadding*this.parent.scaleFactor,-(FreeTextEditor._internalPadding+_classPrivateFieldGet(this,_fontSize))*this.parent.scaleFactor]}},{key:"rebuild",value:function(){_get(_getPrototypeOf(FreeTextEditor.prototype),"rebuild",this).call(this),null!==this.div&&(this.isAttachedToDOM||this.parent.add(this))}},{key:"enableEditMode",value:function(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(_util.AnnotationEditorType.FREETEXT),_get(_getPrototypeOf(FreeTextEditor.prototype),"enableEditMode",this).call(this),this.enableEditing(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this.div.draggable=!1,this.editorDiv.addEventListener("keydown",_classPrivateFieldGet(this,_boundEditorDivKeydown)),this.editorDiv.addEventListener("focus",_classPrivateFieldGet(this,_boundEditorDivFocus)),this.editorDiv.addEventListener("blur",_classPrivateFieldGet(this,_boundEditorDivBlur)))}},{key:"disableEditMode",value:function(){this.isInEditMode()&&(this.parent.setEditingState(!0),_get(_getPrototypeOf(FreeTextEditor.prototype),"disableEditMode",this).call(this),this.disableEditing(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.draggable=!0,this.editorDiv.removeEventListener("keydown",_classPrivateFieldGet(this,_boundEditorDivKeydown)),this.editorDiv.removeEventListener("focus",_classPrivateFieldGet(this,_boundEditorDivFocus)),this.editorDiv.removeEventListener("blur",_classPrivateFieldGet(this,_boundEditorDivBlur)),this.div.focus(),this.isEditing=!1)}},{key:"focusin",value:function(event){_get(_getPrototypeOf(FreeTextEditor.prototype),"focusin",this).call(this,event),event.target!==this.editorDiv&&this.editorDiv.focus()}},{key:"onceAdded",value:function(){this.width||(this.enableEditMode(),this.editorDiv.focus())}},{key:"isEmpty",value:function(){return!this.editorDiv||""===this.editorDiv.innerText.trim()}},{key:"remove",value:function(){this.isEditing=!1,this.parent.setEditingState(!0),_get(_getPrototypeOf(FreeTextEditor.prototype),"remove",this).call(this)}},{key:"commit",value:function(){_get(_getPrototypeOf(FreeTextEditor.prototype),"commit",this).call(this),_classPrivateFieldGet(this,_hasAlreadyBeenCommitted)||(_classPrivateFieldSet(this,_hasAlreadyBeenCommitted,!0),this.parent.addUndoableEditor(this)),this.disableEditMode(),_classPrivateFieldSet(this,_content,_classPrivateMethodGet(this,_extractText,_extractText2).call(this).trimEnd()),_classPrivateMethodGet(this,_setEditorDimensions,_setEditorDimensions2).call(this)}},{key:"shouldGetKeyboardEvents",value:function(){return this.isInEditMode()}},{key:"dblclick",value:function(event){this.enableEditMode(),this.editorDiv.focus()}},{key:"keydown",value:function(event){event.target===this.div&&"Enter"===event.key&&(this.enableEditMode(),this.editorDiv.focus())}},{key:"editorDivKeydown",value:function(event){FreeTextEditor._keyboardManager.exec(this,event)}},{key:"editorDivFocus",value:function(event){this.isEditing=!0}},{key:"editorDivBlur",value:function(event){this.isEditing=!1}},{key:"disableEditing",value:function(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}},{key:"enableEditing",value:function(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}},{key:"render",value:function(){var baseX,baseY,_this40=this;if(this.div)return this.div;this.width&&(baseX=this.x,baseY=this.y),_get(_getPrototypeOf(FreeTextEditor.prototype),"render",this).call(this),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id","".concat(this.id,"-editor")),this.enableEditing(),FreeTextEditor._l10nPromise.get("editor_free_text_aria_label").then((function(msg){var _this$editorDiv;return null===(_this$editorDiv=_this40.editorDiv)||void 0===_this$editorDiv?void 0:_this$editorDiv.setAttribute("aria-label",msg)})),FreeTextEditor._l10nPromise.get("free_text_default_content").then((function(msg){var _this$editorDiv2;return null===(_this$editorDiv2=_this40.editorDiv)||void 0===_this$editorDiv2?void 0:_this$editorDiv2.setAttribute("default-content",msg)})),this.editorDiv.contentEditable=!0;var style=this.editorDiv.style;if(style.fontSize="calc(".concat(_classPrivateFieldGet(this,_fontSize),"px * var(--scale-factor))"),style.color=_classPrivateFieldGet(this,_color),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,_tools.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){var _this$parent$viewport6=_slicedToArray(this.parent.viewportBaseDimensions,2),parentWidth=_this$parent$viewport6[0],parentHeight=_this$parent$viewport6[1];this.setAt(baseX*parentWidth,baseY*parentHeight,this.width*parentWidth,this.height*parentHeight);var _step81,_iterator81=_createForOfIteratorHelper(_classPrivateFieldGet(this,_content).split("\n"));try{for(_iterator81.s();!(_step81=_iterator81.n()).done;){var line=_step81.value,div=document.createElement("div");div.append(line?document.createTextNode(line):document.createElement("br")),this.editorDiv.append(div)}}catch(err){_iterator81.e(err)}finally{_iterator81.f()}this.div.draggable=!0,this.editorDiv.contentEditable=!1}else this.div.draggable=!1,this.editorDiv.contentEditable=!0;return this.div}},{key:"contentDiv",get:function(){return this.editorDiv}},{key:"serialize",value:function(){if(this.isEmpty())return null;var padding=FreeTextEditor._internalPadding*this.parent.scaleFactor,rect=this.getRect(padding,padding),color=_editor.AnnotationEditor._colorManager.convert(getComputedStyle(this.editorDiv).color);return{annotationType:_util.AnnotationEditorType.FREETEXT,color:color,fontSize:_classPrivateFieldGet(this,_fontSize),value:_classPrivateFieldGet(this,_content),pageIndex:this.parent.pageIndex,rect:rect,rotation:this.rotation}}}],[{key:"initialize",value:function(l10n){this._l10nPromise=new Map(["free_text_default_content","editor_free_text_aria_label"].map((function(str){return[str,l10n.get(str)]})));var style=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(style.getPropertyValue("--freetext-padding"))}},{key:"updateDefaultParams",value:function(type,value){switch(type){case _util.AnnotationEditorParamsType.FREETEXT_SIZE:FreeTextEditor._defaultFontSize=value;break;case _util.AnnotationEditorParamsType.FREETEXT_COLOR:FreeTextEditor._defaultColor=value}}},{key:"defaultPropertiesToUpdate",get:function(){return[[_util.AnnotationEditorParamsType.FREETEXT_SIZE,FreeTextEditor._defaultFontSize],[_util.AnnotationEditorParamsType.FREETEXT_COLOR,FreeTextEditor._defaultColor||_editor.AnnotationEditor._defaultLineColor]]}},{key:"deserialize",value:function(data,parent){var _util$Util2,editor=_get(_getPrototypeOf(FreeTextEditor),"deserialize",this).call(this,data,parent);return _classPrivateFieldSet(editor,_fontSize,data.fontSize),_classPrivateFieldSet(editor,_color,(_util$Util2=_util.Util).makeHexColor.apply(_util$Util2,_toConsumableArray(data.color))),_classPrivateFieldSet(editor,_content,data.value),editor}}]),FreeTextEditor}(_editor.AnnotationEditor);function _updateFontSize2(fontSize){var _this41=this,setFontsize=function(size){_this41.editorDiv.style.fontSize="calc(".concat(size,"px * var(--scale-factor))"),_this41.translate(0,-(size-_classPrivateFieldGet(_this41,_fontSize))*_this41.parent.scaleFactor),_classPrivateFieldSet(_this41,_fontSize,size),_classPrivateMethodGet(_this41,_setEditorDimensions,_setEditorDimensions2).call(_this41)},savedFontsize=_classPrivateFieldGet(this,_fontSize);this.parent.addCommands({cmd:function(){setFontsize(fontSize)},undo:function(){setFontsize(savedFontsize)},mustExec:!0,type:_util.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}function _updateColor2(color){var _this42=this,savedColor=_classPrivateFieldGet(this,_color);this.parent.addCommands({cmd:function(){_classPrivateFieldSet(_this42,_color,color),_this42.editorDiv.style.color=color},undo:function(){_classPrivateFieldSet(_this42,_color,savedColor),_this42.editorDiv.style.color=savedColor},mustExec:!0,type:_util.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function _extractText2(){var divs=this.editorDiv.getElementsByTagName("div");if(0===divs.length)return this.editorDiv.innerText;for(var buffer=[],i=0,ii=divs.length;i<ii;i++){var first=divs[i].firstChild;"#text"===(null==first?void 0:first.nodeName)?buffer.push(first.data):buffer.push("")}return buffer.join("\n")}function _setEditorDimensions2(){var _this$parent$viewport7=_slicedToArray(this.parent.viewportBaseDimensions,2),parentWidth=_this$parent$viewport7[0],parentHeight=_this$parent$viewport7[1],rect=this.div.getBoundingClientRect();this.width=rect.width/parentWidth,this.height=rect.height/parentHeight}exports.FreeTextEditor=FreeTextEditor,_defineProperty(FreeTextEditor,"_freeTextDefaultContent",""),_defineProperty(FreeTextEditor,"_l10nPromise",void 0),_defineProperty(FreeTextEditor,"_internalPadding",0),_defineProperty(FreeTextEditor,"_defaultColor",null),_defineProperty(FreeTextEditor,"_defaultFontSize",10),_defineProperty(FreeTextEditor,"_keyboardManager",new _tools.KeyboardManager([[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],FreeTextEditor.prototype.commitOrRemove]])),_defineProperty(FreeTextEditor,"_type","freetext")},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.InkEditor=void 0,Object.defineProperty(exports,"fitCurve",{enumerable:!0,get:function(){return _pdfjsFitCurve.fitCurve}});var _util=__w_pdfjs_require__(1),_editor=__w_pdfjs_require__(131),_pdfjsFitCurve=__w_pdfjs_require__(150),_tools=__w_pdfjs_require__(132);function _classPrivateMethodInitSpec(obj,privateSet){_checkPrivateRedeclaration(obj,privateSet),privateSet.add(obj)}function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function _classPrivateFieldInitSpec(obj,privateMap,value){_checkPrivateRedeclaration(obj,privateMap),privateMap.set(obj,value)}function _checkPrivateRedeclaration(obj,privateCollection){if(privateCollection.has(obj))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classStaticPrivateMethodGet(receiver,classConstructor,method){return function(receiver,classConstructor){if(receiver!==classConstructor)throw new TypeError("Private static access of wrong provenance")}(receiver,classConstructor),method}function _classPrivateFieldSet(receiver,privateMap,value){return function(receiver,descriptor,value){if(descriptor.set)descriptor.set.call(receiver,value);else{if(!descriptor.writable)throw new TypeError("attempted to set read only private field");descriptor.value=value}}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"set"),value),value}function _classPrivateFieldGet(receiver,privateMap){return function(receiver,descriptor){return descriptor.get?descriptor.get.call(receiver):descriptor.value}(receiver,_classExtractFieldDescriptor(receiver,privateMap,"get"))}function _classExtractFieldDescriptor(receiver,privateMap,action){if(!privateMap.has(receiver))throw new TypeError("attempted to "+action+" private field on non-instance");return privateMap.get(receiver)}function _classPrivateMethodGet(receiver,privateSet,fn){if(!privateSet.has(receiver))throw new TypeError("attempted to get private field on non-instance");return fn}var RESIZER_SIZE=16,_aspectRatio=new WeakMap,_baseHeight=new WeakMap,_baseWidth=new WeakMap,_boundCanvasPointermove=new WeakMap,_boundCanvasPointerleave=new WeakMap,_boundCanvasPointerup=new WeakMap,_boundCanvasPointerdown=new WeakMap,_disableEditing=new WeakMap,_isCanvasInitialized=new WeakMap,_lastPoint=new WeakMap,_observer=new WeakMap,_realWidth=new WeakMap,_realHeight=new WeakMap,_requestFrameCallback=new WeakMap,_updateThickness=new WeakSet,_updateColor=new WeakSet,_updateOpacity=new WeakSet,_getInitialBBox=new WeakSet,_setStroke=new WeakSet,_startDrawing=new WeakSet,_draw=new WeakSet,_stopDrawing=new WeakSet,_redraw=new WeakSet,_endDrawing=new WeakSet,_createCanvas=new WeakSet,_createObserver=new WeakSet,_setCanvasDims=new WeakSet,_setScaleFactor=new WeakSet,_updateTransform=new WeakSet,_serializePaths=new WeakSet,_extractPointsOnBezier=new WeakSet,_isAlmostFlat=new WeakSet,_getBbox=new WeakSet,_getPadding=new WeakSet,_fitToContent=new WeakSet,_setMinDims=new WeakSet,InkEditor=function(_editor$AnnotationEdi2){function InkEditor(params){var _this43;return _classCallCheck(this,InkEditor),_classPrivateMethodInitSpec(_assertThisInitialized(_this43=_callSuper(this,InkEditor,[_objectSpread(_objectSpread({},params),{},{name:"inkEditor"})])),_setMinDims),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_fitToContent),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_getPadding),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_getBbox),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_isAlmostFlat),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_extractPointsOnBezier),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_serializePaths),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_updateTransform),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_setScaleFactor),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_setCanvasDims),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_createObserver),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_createCanvas),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_endDrawing),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_redraw),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_stopDrawing),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_draw),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_startDrawing),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_setStroke),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_getInitialBBox),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_updateOpacity),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_updateColor),_classPrivateMethodInitSpec(_assertThisInitialized(_this43),_updateThickness),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_aspectRatio,{writable:!0,value:0}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_baseHeight,{writable:!0,value:0}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_baseWidth,{writable:!0,value:0}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_boundCanvasPointermove,{writable:!0,value:_this43.canvasPointermove.bind(_assertThisInitialized(_this43))}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_boundCanvasPointerleave,{writable:!0,value:_this43.canvasPointerleave.bind(_assertThisInitialized(_this43))}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_boundCanvasPointerup,{writable:!0,value:_this43.canvasPointerup.bind(_assertThisInitialized(_this43))}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_boundCanvasPointerdown,{writable:!0,value:_this43.canvasPointerdown.bind(_assertThisInitialized(_this43))}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_disableEditing,{writable:!0,value:!1}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_isCanvasInitialized,{writable:!0,value:!1}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_lastPoint,{writable:!0,value:null}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_observer,{writable:!0,value:null}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_realWidth,{writable:!0,value:0}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_realHeight,{writable:!0,value:0}),_classPrivateFieldInitSpec(_assertThisInitialized(_this43),_requestFrameCallback,{writable:!0,value:null}),_this43.color=params.color||null,_this43.thickness=params.thickness||null,_this43.opacity=params.opacity||null,_this43.paths=[],_this43.bezierPath2D=[],_this43.currentPath=[],_this43.scaleFactor=1,_this43.translationX=_this43.translationY=0,_this43.x=0,_this43.y=0,_this43}return _inherits(InkEditor,_editor$AnnotationEdi2),_createClass(InkEditor,[{key:"updateParams",value:function(type,value){switch(type){case _util.AnnotationEditorParamsType.INK_THICKNESS:_classPrivateMethodGet(this,_updateThickness,_updateThickness2).call(this,value);break;case _util.AnnotationEditorParamsType.INK_COLOR:_classPrivateMethodGet(this,_updateColor,_updateColor2).call(this,value);break;case _util.AnnotationEditorParamsType.INK_OPACITY:_classPrivateMethodGet(this,_updateOpacity,_updateOpacity2).call(this,value)}}},{key:"propertiesToUpdate",get:function(){var _this$opacity;return[[_util.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||InkEditor._defaultThickness],[_util.AnnotationEditorParamsType.INK_COLOR,this.color||InkEditor._defaultColor||_editor.AnnotationEditor._defaultLineColor],[_util.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(null!==(_this$opacity=this.opacity)&&void 0!==_this$opacity?_this$opacity:InkEditor._defaultOpacity))]]}},{key:"rebuild",value:function(){_get(_getPrototypeOf(InkEditor.prototype),"rebuild",this).call(this),null!==this.div&&(this.canvas||(_classPrivateMethodGet(this,_createCanvas,_createCanvas2).call(this),_classPrivateMethodGet(this,_createObserver,_createObserver2).call(this)),this.isAttachedToDOM||(this.parent.add(this),_classPrivateMethodGet(this,_setCanvasDims,_setCanvasDims2).call(this)),_classPrivateMethodGet(this,_fitToContent,_fitToContent2).call(this))}},{key:"remove",value:function(){null!==this.canvas&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,_classPrivateFieldGet(this,_observer).disconnect(),_classPrivateFieldSet(this,_observer,null),_get(_getPrototypeOf(InkEditor.prototype),"remove",this).call(this))}},{key:"enableEditMode",value:function(){_classPrivateFieldGet(this,_disableEditing)||null===this.canvas||(_get(_getPrototypeOf(InkEditor.prototype),"enableEditMode",this).call(this),this.div.draggable=!1,this.canvas.addEventListener("pointerdown",_classPrivateFieldGet(this,_boundCanvasPointerdown)),this.canvas.addEventListener("pointerup",_classPrivateFieldGet(this,_boundCanvasPointerup)))}},{key:"disableEditMode",value:function(){this.isInEditMode()&&null!==this.canvas&&(_get(_getPrototypeOf(InkEditor.prototype),"disableEditMode",this).call(this),this.div.draggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",_classPrivateFieldGet(this,_boundCanvasPointerdown)),this.canvas.removeEventListener("pointerup",_classPrivateFieldGet(this,_boundCanvasPointerup)))}},{key:"onceAdded",value:function(){this.div.draggable=!this.isEmpty()}},{key:"isEmpty",value:function(){return 0===this.paths.length||1===this.paths.length&&0===this.paths[0].length}},{key:"commit",value:function(){_classPrivateFieldGet(this,_disableEditing)||(_get(_getPrototypeOf(InkEditor.prototype),"commit",this).call(this),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),_classPrivateFieldSet(this,_disableEditing,!0),this.div.classList.add("disabled"),_classPrivateMethodGet(this,_fitToContent,_fitToContent2).call(this,!0),this.parent.addInkEditorIfNeeded(!0),this.parent.moveEditorInDOM(this),this.div.focus())}},{key:"focusin",value:function(event){_get(_getPrototypeOf(InkEditor.prototype),"focusin",this).call(this,event),this.enableEditMode()}},{key:"canvasPointerdown",value:function(event){0===event.button&&this.isInEditMode()&&!_classPrivateFieldGet(this,_disableEditing)&&(this.setInForeground(),"mouse"!==event.type&&this.div.focus(),event.stopPropagation(),this.canvas.addEventListener("pointerleave",_classPrivateFieldGet(this,_boundCanvasPointerleave)),this.canvas.addEventListener("pointermove",_classPrivateFieldGet(this,_boundCanvasPointermove)),_classPrivateMethodGet(this,_startDrawing,_startDrawing2).call(this,event.offsetX,event.offsetY))}},{key:"canvasPointermove",value:function(event){event.stopPropagation(),_classPrivateMethodGet(this,_draw,_draw2).call(this,event.offsetX,event.offsetY)}},{key:"canvasPointerup",value:function(event){0===event.button&&this.isInEditMode()&&0!==this.currentPath.length&&(event.stopPropagation(),_classPrivateMethodGet(this,_endDrawing,_endDrawing2).call(this,event),this.setInBackground())}},{key:"canvasPointerleave",value:function(event){_classPrivateMethodGet(this,_endDrawing,_endDrawing2).call(this,event),this.setInBackground()}},{key:"render",value:function(){var baseX,baseY,_this44=this;if(this.div)return this.div;this.width&&(baseX=this.x,baseY=this.y),_get(_getPrototypeOf(InkEditor.prototype),"render",this).call(this),InkEditor._l10nPromise.get("editor_ink_aria_label").then((function(msg){var _this$div;return null===(_this$div=_this44.div)||void 0===_this$div?void 0:_this$div.setAttribute("aria-label",msg)}));var _classPrivateMethodGe2=_slicedToArray(_classPrivateMethodGet(this,_getInitialBBox,_getInitialBBox2).call(this),4),x=_classPrivateMethodGe2[0],y=_classPrivateMethodGe2[1],w=_classPrivateMethodGe2[2],h=_classPrivateMethodGe2[3];if(this.setAt(x,y,0,0),this.setDims(w,h),_classPrivateMethodGet(this,_createCanvas,_createCanvas2).call(this),this.width){var _this$parent$viewport8=_slicedToArray(this.parent.viewportBaseDimensions,2),parentWidth=_this$parent$viewport8[0],parentHeight=_this$parent$viewport8[1];this.setAt(baseX*parentWidth,baseY*parentHeight,this.width*parentWidth,this.height*parentHeight),_classPrivateFieldSet(this,_isCanvasInitialized,!0),_classPrivateMethodGet(this,_setCanvasDims,_setCanvasDims2).call(this),this.setDims(this.width*parentWidth,this.height*parentHeight),_classPrivateMethodGet(this,_redraw,_redraw2).call(this),_classPrivateMethodGet(this,_setMinDims,_setMinDims2).call(this),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return _classPrivateMethodGet(this,_createObserver,_createObserver2).call(this),this.div}},{key:"setDimensions",value:function(width,height){var roundedWidth=Math.round(width),roundedHeight=Math.round(height);if(_classPrivateFieldGet(this,_realWidth)!==roundedWidth||_classPrivateFieldGet(this,_realHeight)!==roundedHeight){_classPrivateFieldSet(this,_realWidth,roundedWidth),_classPrivateFieldSet(this,_realHeight,roundedHeight),this.canvas.style.visibility="hidden",_classPrivateFieldGet(this,_aspectRatio)&&Math.abs(_classPrivateFieldGet(this,_aspectRatio)-width/height)>.01&&(height=Math.ceil(width/_classPrivateFieldGet(this,_aspectRatio)),this.setDims(width,height));var _this$parent$viewport9=_slicedToArray(this.parent.viewportBaseDimensions,2),parentWidth=_this$parent$viewport9[0],parentHeight=_this$parent$viewport9[1];this.width=width/parentWidth,this.height=height/parentHeight,_classPrivateFieldGet(this,_disableEditing)&&_classPrivateMethodGet(this,_setScaleFactor,_setScaleFactor2).call(this,width,height),_classPrivateMethodGet(this,_setCanvasDims,_setCanvasDims2).call(this),_classPrivateMethodGet(this,_redraw,_redraw2).call(this),this.canvas.style.visibility="visible"}}},{key:"serialize",value:function(){if(this.isEmpty())return null;var rect=this.getRect(0,0),height=this.rotation%180==0?rect[3]-rect[1]:rect[2]-rect[0],color=_editor.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:_util.AnnotationEditorType.INK,color:color,thickness:this.thickness,opacity:this.opacity,paths:_classPrivateMethodGet(this,_serializePaths,_serializePaths2).call(this,this.scaleFactor/this.parent.scaleFactor,this.translationX,this.translationY,height),pageIndex:this.parent.pageIndex,rect:rect,rotation:this.rotation}}}],[{key:"initialize",value:function(l10n){this._l10nPromise=new Map(["editor_ink_canvas_aria_label","editor_ink_aria_label"].map((function(str){return[str,l10n.get(str)]})))}},{key:"updateDefaultParams",value:function(type,value){switch(type){case _util.AnnotationEditorParamsType.INK_THICKNESS:InkEditor._defaultThickness=value;break;case _util.AnnotationEditorParamsType.INK_COLOR:InkEditor._defaultColor=value;break;case _util.AnnotationEditorParamsType.INK_OPACITY:InkEditor._defaultOpacity=value/100}}},{key:"defaultPropertiesToUpdate",get:function(){return[[_util.AnnotationEditorParamsType.INK_THICKNESS,InkEditor._defaultThickness],[_util.AnnotationEditorParamsType.INK_COLOR,InkEditor._defaultColor||_editor.AnnotationEditor._defaultLineColor],[_util.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*InkEditor._defaultOpacity)]]}},{key:"deserialize",value:function(data,parent){var _util$Util3,editor=_get(_getPrototypeOf(InkEditor),"deserialize",this).call(this,data,parent);editor.thickness=data.thickness,editor.color=(_util$Util3=_util.Util).makeHexColor.apply(_util$Util3,_toConsumableArray(data.color)),editor.opacity=data.opacity;var _parent$pageDimension2=_slicedToArray(parent.pageDimensions,2),pageWidth=_parent$pageDimension2[0],pageHeight=_parent$pageDimension2[1],width=editor.width*pageWidth,height=editor.height*pageHeight,scaleFactor=parent.scaleFactor,padding=data.thickness/2;_classPrivateFieldSet(editor,_aspectRatio,width/height),_classPrivateFieldSet(editor,_disableEditing,!0),_classPrivateFieldSet(editor,_realWidth,Math.round(width)),_classPrivateFieldSet(editor,_realHeight,Math.round(height));var _step82,_iterator82=_createForOfIteratorHelper(data.paths);try{for(_iterator82.s();!(_step82=_iterator82.n()).done;){var bezier=_step82.value.bezier,path=[];editor.paths.push(path);for(var p0=scaleFactor*(bezier[0]-padding),p1=scaleFactor*(height-bezier[1]-padding),i=2,ii=bezier.length;i<ii;i+=6){var p10=scaleFactor*(bezier[i]-padding),p11=scaleFactor*(height-bezier[i+1]-padding),p20=scaleFactor*(bezier[i+2]-padding),p21=scaleFactor*(height-bezier[i+3]-padding),p30=scaleFactor*(bezier[i+4]-padding),p31=scaleFactor*(height-bezier[i+5]-padding);path.push([[p0,p1],[p10,p11],[p20,p21],[p30,p31]]),p0=p30,p1=p31}var path2D=_classStaticPrivateMethodGet(this,InkEditor,_buildPath2D).call(this,path);editor.bezierPath2D.push(path2D)}}catch(err){_iterator82.e(err)}finally{_iterator82.f()}var bbox=_classPrivateMethodGet(editor,_getBbox,_getBbox2).call(editor);return _classPrivateFieldSet(editor,_baseWidth,Math.max(RESIZER_SIZE,bbox[2]-bbox[0])),_classPrivateFieldSet(editor,_baseHeight,Math.max(RESIZER_SIZE,bbox[3]-bbox[1])),_classPrivateMethodGet(editor,_setScaleFactor,_setScaleFactor2).call(editor,width,height),editor}}]),InkEditor}(_editor.AnnotationEditor);function _updateThickness2(thickness){var _this45=this,savedThickness=this.thickness;this.parent.addCommands({cmd:function(){_this45.thickness=thickness,_classPrivateMethodGet(_this45,_fitToContent,_fitToContent2).call(_this45)},undo:function(){_this45.thickness=savedThickness,_classPrivateMethodGet(_this45,_fitToContent,_fitToContent2).call(_this45)},mustExec:!0,type:_util.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}function _updateColor2(color){var _this46=this,savedColor=this.color;this.parent.addCommands({cmd:function(){_this46.color=color,_classPrivateMethodGet(_this46,_redraw,_redraw2).call(_this46)},undo:function(){_this46.color=savedColor,_classPrivateMethodGet(_this46,_redraw,_redraw2).call(_this46)},mustExec:!0,type:_util.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}function _updateOpacity2(opacity){var _this47=this;opacity/=100;var savedOpacity=this.opacity;this.parent.addCommands({cmd:function(){_this47.opacity=opacity,_classPrivateMethodGet(_this47,_redraw,_redraw2).call(_this47)},undo:function(){_this47.opacity=savedOpacity,_classPrivateMethodGet(_this47,_redraw,_redraw2).call(_this47)},mustExec:!0,type:_util.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}function _getInitialBBox2(){var _this$parent$viewport10=this.parent.viewport,width=_this$parent$viewport10.width,height=_this$parent$viewport10.height;switch(_this$parent$viewport10.rotation){case 90:return[0,width,width,height];case 180:return[width,height,width,height];case 270:return[height,0,width,height];default:return[0,0,width,height]}}function _setStroke2(){this.ctx.lineWidth=this.thickness*this.parent.scaleFactor/this.scaleFactor,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.miterLimit=10,this.ctx.strokeStyle="".concat(this.color).concat((0,_tools.opacityToHex)(this.opacity))}function _startDrawing2(x,y){var _this$opacity2,_this48=this;this.isEditing=!0,_classPrivateFieldGet(this,_isCanvasInitialized)||(_classPrivateFieldSet(this,_isCanvasInitialized,!0),_classPrivateMethodGet(this,_setCanvasDims,_setCanvasDims2).call(this),this.thickness||(this.thickness=InkEditor._defaultThickness),this.color||(this.color=InkEditor._defaultColor||_editor.AnnotationEditor._defaultLineColor),null!==(_this$opacity2=this.opacity)&&void 0!==_this$opacity2||(this.opacity=InkEditor._defaultOpacity)),this.currentPath.push([x,y]),_classPrivateFieldSet(this,_lastPoint,null),_classPrivateMethodGet(this,_setStroke,_setStroke2).call(this),this.ctx.beginPath(),this.ctx.moveTo(x,y),_classPrivateFieldSet(this,_requestFrameCallback,(function(){var _this48$ctx;_classPrivateFieldGet(_this48,_requestFrameCallback)&&(_classPrivateFieldGet(_this48,_lastPoint)&&(_this48.isEmpty()?(_this48.ctx.setTransform(1,0,0,1,0,0),_this48.ctx.clearRect(0,0,_this48.canvas.width,_this48.canvas.height)):_classPrivateMethodGet(_this48,_redraw,_redraw2).call(_this48),(_this48$ctx=_this48.ctx).lineTo.apply(_this48$ctx,_toConsumableArray(_classPrivateFieldGet(_this48,_lastPoint))),_classPrivateFieldSet(_this48,_lastPoint,null),_this48.ctx.stroke()),window.requestAnimationFrame(_classPrivateFieldGet(_this48,_requestFrameCallback)))})),window.requestAnimationFrame(_classPrivateFieldGet(this,_requestFrameCallback))}function _draw2(x,y){var _this$currentPath$at2=_slicedToArray(this.currentPath.at(-1),2),lastX=_this$currentPath$at2[0],lastY=_this$currentPath$at2[1];x===lastX&&y===lastY||(this.currentPath.push([x,y]),_classPrivateFieldSet(this,_lastPoint,[x,y]))}function _stopDrawing2(x,y){var _this49=this;this.ctx.closePath(),_classPrivateFieldSet(this,_requestFrameCallback,null),x=Math.min(Math.max(x,0),this.canvas.width),y=Math.min(Math.max(y,0),this.canvas.height);var bezier,_this$currentPath$at4=_slicedToArray(this.currentPath.at(-1),2),lastX=_this$currentPath$at4[0],lastY=_this$currentPath$at4[1];if(x===lastX&&y===lastY||this.currentPath.push([x,y]),1!==this.currentPath.length)bezier=(0,_pdfjsFitCurve.fitCurve)(this.currentPath,30,null);else{var xy=[x,y];bezier=[[xy,xy.slice(),xy.slice(),xy]]}var path2D=_classStaticPrivateMethodGet(InkEditor,InkEditor,_buildPath2D).call(InkEditor,bezier);this.currentPath.length=0,this.parent.addCommands({cmd:function(){_this49.paths.push(bezier),_this49.bezierPath2D.push(path2D),_this49.rebuild()},undo:function(){_this49.paths.pop(),_this49.bezierPath2D.pop(),0===_this49.paths.length?_this49.remove():(_this49.canvas||(_classPrivateMethodGet(_this49,_createCanvas,_createCanvas2).call(_this49),_classPrivateMethodGet(_this49,_createObserver,_createObserver2).call(_this49)),_classPrivateMethodGet(_this49,_fitToContent,_fitToContent2).call(_this49))},mustExec:!0})}function _redraw2(){if(this.isEmpty())_classPrivateMethodGet(this,_updateTransform,_updateTransform2).call(this);else{_classPrivateMethodGet(this,_setStroke,_setStroke2).call(this);var canvas=this.canvas,ctx=this.ctx;ctx.setTransform(1,0,0,1,0,0),ctx.clearRect(0,0,canvas.width,canvas.height),_classPrivateMethodGet(this,_updateTransform,_updateTransform2).call(this);var _step83,_iterator83=_createForOfIteratorHelper(this.bezierPath2D);try{for(_iterator83.s();!(_step83=_iterator83.n()).done;){var path=_step83.value;ctx.stroke(path)}}catch(err){_iterator83.e(err)}finally{_iterator83.f()}}}function _endDrawing2(event){_classPrivateMethodGet(this,_stopDrawing,_stopDrawing2).call(this,event.offsetX,event.offsetY),this.canvas.removeEventListener("pointerleave",_classPrivateFieldGet(this,_boundCanvasPointerleave)),this.canvas.removeEventListener("pointermove",_classPrivateFieldGet(this,_boundCanvasPointermove)),this.parent.addToAnnotationStorage(this)}function _createCanvas2(){var _this50=this;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",InkEditor._l10nPromise.get("editor_ink_canvas_aria_label").then((function(msg){var _this$canvas;return null===(_this$canvas=_this50.canvas)||void 0===_this$canvas?void 0:_this$canvas.setAttribute("aria-label",msg)})),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}function _createObserver2(){var _this51=this;_classPrivateFieldSet(this,_observer,new ResizeObserver((function(entries){var rect=entries[0].contentRect;rect.width&&rect.height&&_this51.setDimensions(rect.width,rect.height)}))),_classPrivateFieldGet(this,_observer).observe(this.div)}function _setCanvasDims2(){if(_classPrivateFieldGet(this,_isCanvasInitialized)){var _this$parent$viewport11=_slicedToArray(this.parent.viewportBaseDimensions,2),parentWidth=_this$parent$viewport11[0],parentHeight=_this$parent$viewport11[1];this.canvas.width=Math.ceil(this.width*parentWidth),this.canvas.height=Math.ceil(this.height*parentHeight),_classPrivateMethodGet(this,_updateTransform,_updateTransform2).call(this)}}function _setScaleFactor2(width,height){var padding=_classPrivateMethodGet(this,_getPadding,_getPadding2).call(this),scaleFactorW=(width-padding)/_classPrivateFieldGet(this,_baseWidth),scaleFactorH=(height-padding)/_classPrivateFieldGet(this,_baseHeight);this.scaleFactor=Math.min(scaleFactorW,scaleFactorH)}function _updateTransform2(){var padding=_classPrivateMethodGet(this,_getPadding,_getPadding2).call(this)/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+padding,this.translationY*this.scaleFactor+padding)}function _buildPath2D(bezier){for(var path2D=new Path2D,i=0,ii=bezier.length;i<ii;i++){var _bezier$i=_slicedToArray(bezier[i],4),first=_bezier$i[0],control1=_bezier$i[1],control2=_bezier$i[2],second=_bezier$i[3];0===i&&path2D.moveTo.apply(path2D,_toConsumableArray(first)),path2D.bezierCurveTo(control1[0],control1[1],control2[0],control2[1],second[0],second[1])}return path2D}function _serializePaths2(s,tx,ty,h){var buffer,points,_step84,paths=[],padding=this.thickness/2,_iterator84=_createForOfIteratorHelper(this.paths);try{for(_iterator84.s();!(_step84=_iterator84.n()).done;){var bezier=_step84.value;buffer=[],points=[];for(var i=0,ii=bezier.length;i<ii;i++){var _bezier$i2=_slicedToArray(bezier[i],4),first=_bezier$i2[0],control1=_bezier$i2[1],control2=_bezier$i2[2],second=_bezier$i2[3],p10=s*(first[0]+tx)+padding,p11=h-s*(first[1]+ty)-padding,p20=s*(control1[0]+tx)+padding,p21=h-s*(control1[1]+ty)-padding,p30=s*(control2[0]+tx)+padding,p31=h-s*(control2[1]+ty)-padding,p40=s*(second[0]+tx)+padding,p41=h-s*(second[1]+ty)-padding;0===i&&(buffer.push(p10,p11),points.push(p10,p11)),buffer.push(p20,p21,p30,p31,p40,p41),_classPrivateMethodGet(this,_extractPointsOnBezier,_extractPointsOnBezier2).call(this,p10,p11,p20,p21,p30,p31,p40,p41,4,points)}paths.push({bezier:buffer,points:points})}}catch(err){_iterator84.e(err)}finally{_iterator84.f()}return paths}function _extractPointsOnBezier2(p10,p11,p20,p21,p30,p31,p40,p41,n,points){if(_classPrivateMethodGet(this,_isAlmostFlat,_isAlmostFlat2).call(this,p10,p11,p20,p21,p30,p31,p40,p41))points.push(p40,p41);else{for(var i=1;i<n-1;i++){var t=i/n,mt=1-t,q10=t*p10+mt*p20,q11=t*p11+mt*p21,q20=t*p20+mt*p30,q21=t*p21+mt*p31;q10=t*(q10=t*q10+mt*q20)+mt*(q20=t*q20+mt*(t*p30+mt*p40)),q11=t*(q11=t*q11+mt*q21)+mt*(q21=t*q21+mt*(t*p31+mt*p41)),points.push(q10,q11)}points.push(p40,p41)}}function _isAlmostFlat2(p10,p11,p20,p21,p30,p31,p40,p41){var ax=Math.pow(3*p20-2*p10-p40,2),ay=Math.pow(3*p21-2*p11-p41,2),bx=Math.pow(3*p30-p10-2*p40,2),by=Math.pow(3*p31-p11-2*p41,2);return Math.max(ax,bx)+Math.max(ay,by)<=10}function _getBbox2(){var _step85,xMin=1/0,xMax=-1/0,yMin=1/0,yMax=-1/0,_iterator85=_createForOfIteratorHelper(this.paths);try{for(_iterator85.s();!(_step85=_iterator85.n()).done;){var _step86,_iterator86=_createForOfIteratorHelper(_step85.value);try{for(_iterator86.s();!(_step86=_iterator86.n()).done;){var _util$Util4,_step86$value=_slicedToArray(_step86.value,4),first=_step86$value[0],control1=_step86$value[1],control2=_step86$value[2],second=_step86$value[3],bbox=(_util$Util4=_util.Util).bezierBoundingBox.apply(_util$Util4,_toConsumableArray(first).concat(_toConsumableArray(control1),_toConsumableArray(control2),_toConsumableArray(second)));xMin=Math.min(xMin,bbox[0]),yMin=Math.min(yMin,bbox[1]),xMax=Math.max(xMax,bbox[2]),yMax=Math.max(yMax,bbox[3])}}catch(err){_iterator86.e(err)}finally{_iterator86.f()}}}catch(err){_iterator85.e(err)}finally{_iterator85.f()}return[xMin,yMin,xMax,yMax]}function _getPadding2(){return _classPrivateFieldGet(this,_disableEditing)?Math.ceil(this.thickness*this.parent.scaleFactor):0}function _fitToContent2(){var firstTime=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isEmpty())if(_classPrivateFieldGet(this,_disableEditing)){var bbox=_classPrivateMethodGet(this,_getBbox,_getBbox2).call(this),padding=_classPrivateMethodGet(this,_getPadding,_getPadding2).call(this);_classPrivateFieldSet(this,_baseWidth,Math.max(RESIZER_SIZE,bbox[2]-bbox[0])),_classPrivateFieldSet(this,_baseHeight,Math.max(RESIZER_SIZE,bbox[3]-bbox[1]));var width=Math.ceil(padding+_classPrivateFieldGet(this,_baseWidth)*this.scaleFactor),height=Math.ceil(padding+_classPrivateFieldGet(this,_baseHeight)*this.scaleFactor),_this$parent$viewport12=_slicedToArray(this.parent.viewportBaseDimensions,2),parentWidth=_this$parent$viewport12[0],parentHeight=_this$parent$viewport12[1];this.width=width/parentWidth,this.height=height/parentHeight,_classPrivateFieldSet(this,_aspectRatio,width/height),_classPrivateMethodGet(this,_setMinDims,_setMinDims2).call(this);var prevTranslationX=this.translationX,prevTranslationY=this.translationY;this.translationX=-bbox[0],this.translationY=-bbox[1],_classPrivateMethodGet(this,_setCanvasDims,_setCanvasDims2).call(this),_classPrivateMethodGet(this,_redraw,_redraw2).call(this),_classPrivateFieldSet(this,_realWidth,width),_classPrivateFieldSet(this,_realHeight,height),this.setDims(width,height);var unscaledPadding=firstTime?padding/this.scaleFactor/2:0;this.translate(prevTranslationX-this.translationX-unscaledPadding,prevTranslationY-this.translationY-unscaledPadding)}else _classPrivateMethodGet(this,_redraw,_redraw2).call(this)}function _setMinDims2(){var style=this.div.style;_classPrivateFieldGet(this,_aspectRatio)>=1?(style.minHeight="".concat(RESIZER_SIZE,"px"),style.minWidth="".concat(Math.round(_classPrivateFieldGet(this,_aspectRatio)*RESIZER_SIZE),"px")):(style.minWidth="".concat(RESIZER_SIZE,"px"),style.minHeight="".concat(Math.round(RESIZER_SIZE/_classPrivateFieldGet(this,_aspectRatio)),"px"))}exports.InkEditor=InkEditor,_defineProperty(InkEditor,"_defaultColor",null),_defineProperty(InkEditor,"_defaultOpacity",1),_defineProperty(InkEditor,"_defaultThickness",1),_defineProperty(InkEditor,"_l10nPromise",void 0),_defineProperty(InkEditor,"_type","ink")},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.fitCurve=void 0;var fitCurve=__w_pdfjs_require__(151);exports.fitCurve=fitCurve},function(module){"use strict";function fitCubic(points,leftTangent,rightTangent,error,progressCallback){var bezCurve,u,uPrime,maxError,prevErr,splitPoint,prevSplit,centerVector,toCenterTangent,fromCenterTangent,beziers,dist,i;if(2===points.length)return dist=maths.vectorLen(maths.subtract(points[0],points[1]))/3,[bezCurve=[points[0],maths.addArrays(points[0],maths.mulItems(leftTangent,dist)),maths.addArrays(points[1],maths.mulItems(rightTangent,dist)),points[1]]];u=function(points){var currU,prevU,prevP,u=[];return points.forEach((function(p,i){currU=i?prevU+maths.vectorLen(maths.subtract(p,prevP)):0,u.push(currU),prevU=currU,prevP=p})),u=u.map((function(x){return x/prevU}))}(points);var _generateAndReport2=_slicedToArray(generateAndReport(points,u,u,leftTangent,rightTangent,progressCallback),3);if(bezCurve=_generateAndReport2[0],maxError=_generateAndReport2[1],splitPoint=_generateAndReport2[2],0===maxError||maxError<error)return[bezCurve];if(maxError<error*error)for(uPrime=u,prevErr=maxError,prevSplit=splitPoint,i=0;i<20;i++){var _generateAndReport4=_slicedToArray(generateAndReport(points,u,uPrime=reparameterize(bezCurve,points,uPrime),leftTangent,rightTangent,progressCallback),3);if(bezCurve=_generateAndReport4[0],maxError=_generateAndReport4[1],splitPoint=_generateAndReport4[2],maxError<error)return[bezCurve];if(splitPoint===prevSplit){var errChange=maxError/prevErr;if(errChange>.9999&&errChange<1.0001)break}prevErr=maxError,prevSplit=splitPoint}if(beziers=[],(centerVector=maths.subtract(points[splitPoint-1],points[splitPoint+1])).every((function(val){return 0===val}))){var _ref38=[-(centerVector=maths.subtract(points[splitPoint-1],points[splitPoint]))[1],centerVector[0]];centerVector[0]=_ref38[0],centerVector[1]=_ref38[1]}return toCenterTangent=maths.normalize(centerVector),fromCenterTangent=maths.mulItems(toCenterTangent,-1),beziers=(beziers=beziers.concat(fitCubic(points.slice(0,splitPoint+1),leftTangent,toCenterTangent,error,progressCallback))).concat(fitCubic(points.slice(splitPoint),fromCenterTangent,rightTangent,error,progressCallback))}function generateAndReport(points,paramsOrig,paramsPrime,leftTangent,rightTangent,progressCallback){var bezCurve,maxError,splitPoint;bezCurve=function(points,parameters,leftTangent,rightTangent){var bezCurve,A,a,C,X,det_C0_C1,det_C0_X,det_X_C1,alpha_l,alpha_r,epsilon,segLength,i,len,tmp,u,ux,firstPoint=points[0],lastPoint=points[points.length-1];for(bezCurve=[firstPoint,null,null,lastPoint],A=maths.zeros_Xx2x2(parameters.length),i=0,len=parameters.length;i<len;i++)ux=1-(u=parameters[i]),(a=A[i])[0]=maths.mulItems(leftTangent,3*u*(ux*ux)),a[1]=maths.mulItems(rightTangent,3*ux*(u*u));for(C=[[0,0],[0,0]],X=[0,0],i=0,len=points.length;i<len;i++)u=parameters[i],a=A[i],C[0][0]+=maths.dot(a[0],a[0]),C[0][1]+=maths.dot(a[0],a[1]),C[1][0]+=maths.dot(a[0],a[1]),C[1][1]+=maths.dot(a[1],a[1]),tmp=maths.subtract(points[i],bezier.q([firstPoint,firstPoint,lastPoint,lastPoint],u)),X[0]+=maths.dot(a[0],tmp),X[1]+=maths.dot(a[1],tmp);return det_C0_C1=C[0][0]*C[1][1]-C[1][0]*C[0][1],det_C0_X=C[0][0]*X[1]-C[1][0]*X[0],det_X_C1=X[0]*C[1][1]-X[1]*C[0][1],alpha_l=0===det_C0_C1?0:det_X_C1/det_C0_C1,alpha_r=0===det_C0_C1?0:det_C0_X/det_C0_C1,segLength=maths.vectorLen(maths.subtract(firstPoint,lastPoint)),alpha_l<(epsilon=1e-6*segLength)||alpha_r<epsilon?(bezCurve[1]=maths.addArrays(firstPoint,maths.mulItems(leftTangent,segLength/3)),bezCurve[2]=maths.addArrays(lastPoint,maths.mulItems(rightTangent,segLength/3))):(bezCurve[1]=maths.addArrays(firstPoint,maths.mulItems(leftTangent,alpha_l)),bezCurve[2]=maths.addArrays(lastPoint,maths.mulItems(rightTangent,alpha_r))),bezCurve}(points,paramsPrime,leftTangent,rightTangent);var _computeMaxError=function(points,bez,parameters){var dist,maxDist,splitPoint,v,i,count,point,t;maxDist=0,splitPoint=Math.floor(points.length/2);var t_distMap=mapTtoRelativeDistances(bez,10);for(i=0,count=points.length;i<count;i++)point=points[i],t=find_t(0,parameters[i],t_distMap,10),(dist=(v=maths.subtract(bezier.q(bez,t),point))[0]*v[0]+v[1]*v[1])>maxDist&&(maxDist=dist,splitPoint=i);return[maxDist,splitPoint]}(points,bezCurve,paramsOrig),_computeMaxError2=_slicedToArray(_computeMaxError,2);return maxError=_computeMaxError2[0],splitPoint=_computeMaxError2[1],progressCallback&&progressCallback({bez:bezCurve,points:points,params:paramsOrig,maxErr:maxError,maxPoint:splitPoint}),[bezCurve,maxError,splitPoint]}function reparameterize(bezier,points,parameters){return parameters.map((function(p,i){return newtonRaphsonRootFind(bezier,points[i],p)}))}function newtonRaphsonRootFind(bez,point,u){var d=maths.subtract(bezier.q(bez,u),point),qprime=bezier.qprime(bez,u),numerator=maths.mulMatrix(d,qprime),denominator=maths.sum(maths.squareItems(qprime))+2*maths.mulMatrix(d,bezier.qprimeprime(bez,u));return 0===denominator?u:u-numerator/denominator}var mapTtoRelativeDistances=function(bez,B_parts){for(var B_t_curr,B_t_dist=[0],B_t_prev=bez[0],sumLen=0,i=1;i<=B_parts;i++)B_t_curr=bezier.q(bez,i/B_parts),sumLen+=maths.vectorLen(maths.subtract(B_t_curr,B_t_prev)),B_t_dist.push(sumLen),B_t_prev=B_t_curr;return B_t_dist=B_t_dist.map((function(x){return x/sumLen}))};function find_t(bez,param,t_distMap,B_parts){if(param<0)return 0;if(param>1)return 1;for(var lenMin,tMax,tMin,t,i=1;i<=B_parts;i++)if(param<=t_distMap[i]){tMin=(i-1)/B_parts,tMax=i/B_parts,t=(param-(lenMin=t_distMap[i-1]))/(t_distMap[i]-lenMin)*(tMax-tMin)+tMin;break}return t}function createTangent(pointA,pointB){return maths.normalize(maths.subtract(pointA,pointB))}var maths=function(){function maths(){_classCallCheck(this,maths)}return _createClass(maths,null,[{key:"zeros_Xx2x2",value:function(x){for(var zs=[];x--;)zs.push([0,0]);return zs}},{key:"mulItems",value:function(items,multiplier){return items.map((function(x){return x*multiplier}))}},{key:"mulMatrix",value:function(m1,m2){return m1.reduce((function(sum,x1,i){return sum+x1*m2[i]}),0)}},{key:"subtract",value:function(arr1,arr2){return arr1.map((function(x1,i){return x1-arr2[i]}))}},{key:"addArrays",value:function(arr1,arr2){return arr1.map((function(x1,i){return x1+arr2[i]}))}},{key:"addItems",value:function(items,addition){return items.map((function(x){return x+addition}))}},{key:"sum",value:function(items){return items.reduce((function(sum,x){return sum+x}))}},{key:"dot",value:function(m1,m2){return maths.mulMatrix(m1,m2)}},{key:"vectorLen",value:function(v){return Math.hypot.apply(Math,_toConsumableArray(v))}},{key:"divItems",value:function(items,divisor){return items.map((function(x){return x/divisor}))}},{key:"squareItems",value:function(items){return items.map((function(x){return x*x}))}},{key:"normalize",value:function(v){return this.divItems(v,this.vectorLen(v))}}]),maths}(),bezier=function(){function bezier(){_classCallCheck(this,bezier)}return _createClass(bezier,null,[{key:"q",value:function(ctrlPoly,t){var tx=1-t,pA=maths.mulItems(ctrlPoly[0],tx*tx*tx),pB=maths.mulItems(ctrlPoly[1],3*tx*tx*t),pC=maths.mulItems(ctrlPoly[2],3*tx*t*t),pD=maths.mulItems(ctrlPoly[3],t*t*t);return maths.addArrays(maths.addArrays(pA,pB),maths.addArrays(pC,pD))}},{key:"qprime",value:function(ctrlPoly,t){var tx=1-t,pA=maths.mulItems(maths.subtract(ctrlPoly[1],ctrlPoly[0]),3*tx*tx),pB=maths.mulItems(maths.subtract(ctrlPoly[2],ctrlPoly[1]),6*tx*t),pC=maths.mulItems(maths.subtract(ctrlPoly[3],ctrlPoly[2]),3*t*t);return maths.addArrays(maths.addArrays(pA,pB),pC)}},{key:"qprimeprime",value:function(ctrlPoly,t){return maths.addArrays(maths.mulItems(maths.addArrays(maths.subtract(ctrlPoly[2],maths.mulItems(ctrlPoly[1],2)),ctrlPoly[0]),6*(1-t)),maths.mulItems(maths.addArrays(maths.subtract(ctrlPoly[3],maths.mulItems(ctrlPoly[2],2)),ctrlPoly[1]),6*t))}}]),bezier}();module.exports=function(points,maxError,progressCallback){if(!Array.isArray(points))throw new TypeError("First argument should be an array");if(points.forEach((function(point){if(!Array.isArray(point)||point.some((function(item){return"number"!=typeof item}))||point.length!==points[0].length)throw Error("Each point should be an array of numbers. Each point should have the same amount of numbers.")})),(points=points.filter((function(point,i){return 0===i||!point.every((function(val,j){return val===points[i-1][j]}))}))).length<2)return[];var len=points.length,leftTangent=createTangent(points[1],points[0]),rightTangent=createTangent(points[len-2],points[len-1]);return fitCubic(points,leftTangent,rightTangent,maxError,progressCallback)},module.exports.fitCubic=fitCubic,module.exports.createTangent=createTangent},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.AnnotationLayer=void 0;var _util=__w_pdfjs_require__(1),_display_utils=__w_pdfjs_require__(133),_annotation_storage=__w_pdfjs_require__(130),_scripting_utils=__w_pdfjs_require__(153),_xfa_layer=__w_pdfjs_require__(154);function _classStaticPrivateMethodGet(receiver,classConstructor,method){return function(receiver,classConstructor){if(receiver!==classConstructor)throw new TypeError("Private static access of wrong provenance")}(receiver,classConstructor),method}var GetElementsByNameSet=new WeakSet;function getRectDims(rect){return{width:rect[2]-rect[0],height:rect[3]-rect[1]}}var AnnotationElementFactory=function(){function AnnotationElementFactory(){_classCallCheck(this,AnnotationElementFactory)}return _createClass(AnnotationElementFactory,null,[{key:"create",value:function(parameters){switch(parameters.data.annotationType){case _util.AnnotationType.LINK:return new LinkAnnotationElement(parameters);case _util.AnnotationType.TEXT:return new TextAnnotationElement(parameters);case _util.AnnotationType.WIDGET:switch(parameters.data.fieldType){case"Tx":return new TextWidgetAnnotationElement(parameters);case"Btn":return parameters.data.radioButton?new RadioButtonWidgetAnnotationElement(parameters):parameters.data.checkBox?new CheckboxWidgetAnnotationElement(parameters):new PushButtonWidgetAnnotationElement(parameters);case"Ch":return new ChoiceWidgetAnnotationElement(parameters)}return new WidgetAnnotationElement(parameters);case _util.AnnotationType.POPUP:return new PopupAnnotationElement(parameters);case _util.AnnotationType.FREETEXT:return new FreeTextAnnotationElement(parameters);case _util.AnnotationType.LINE:return new LineAnnotationElement(parameters);case _util.AnnotationType.SQUARE:return new SquareAnnotationElement(parameters);case _util.AnnotationType.CIRCLE:return new CircleAnnotationElement(parameters);case _util.AnnotationType.POLYLINE:return new PolylineAnnotationElement(parameters);case _util.AnnotationType.CARET:return new CaretAnnotationElement(parameters);case _util.AnnotationType.INK:return new InkAnnotationElement(parameters);case _util.AnnotationType.POLYGON:return new PolygonAnnotationElement(parameters);case _util.AnnotationType.HIGHLIGHT:return new HighlightAnnotationElement(parameters);case _util.AnnotationType.UNDERLINE:return new UnderlineAnnotationElement(parameters);case _util.AnnotationType.SQUIGGLY:return new SquigglyAnnotationElement(parameters);case _util.AnnotationType.STRIKEOUT:return new StrikeOutAnnotationElement(parameters);case _util.AnnotationType.STAMP:return new StampAnnotationElement(parameters);case _util.AnnotationType.FILEATTACHMENT:return new FileAttachmentAnnotationElement(parameters);default:return new AnnotationElement(parameters)}}}]),AnnotationElementFactory}(),AnnotationElement=function(){function AnnotationElement(parameters){_classCallCheck(this,AnnotationElement);var _ref39=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},_ref39$isRenderable=_ref39.isRenderable,isRenderable=void 0!==_ref39$isRenderable&&_ref39$isRenderable,_ref39$ignoreBorder=_ref39.ignoreBorder,ignoreBorder=void 0!==_ref39$ignoreBorder&&_ref39$ignoreBorder,_ref39$createQuadrila=_ref39.createQuadrilaterals,createQuadrilaterals=void 0!==_ref39$createQuadrila&&_ref39$createQuadrila;this.isRenderable=isRenderable,this.data=parameters.data,this.layer=parameters.layer,this.page=parameters.page,this.viewport=parameters.viewport,this.linkService=parameters.linkService,this.downloadManager=parameters.downloadManager,this.imageResourcesPath=parameters.imageResourcesPath,this.renderForms=parameters.renderForms,this.svgFactory=parameters.svgFactory,this.annotationStorage=parameters.annotationStorage,this.enableScripting=parameters.enableScripting,this.hasJSActions=parameters.hasJSActions,this._fieldObjects=parameters.fieldObjects,this._mouseState=parameters.mouseState,isRenderable&&(this.container=this._createContainer(ignoreBorder)),createQuadrilaterals&&(this.quadrilaterals=this._createQuadrilaterals(ignoreBorder))}return _createClass(AnnotationElement,[{key:"_createContainer",value:function(){var ignoreBorder=arguments.length>0&&void 0!==arguments[0]&&arguments[0],data=this.data,page=this.page,viewport=this.viewport,container=document.createElement("section"),_getRectDims=getRectDims(data.rect),width=_getRectDims.width,height=_getRectDims.height,_viewport$viewBox=_slicedToArray(viewport.viewBox,4),pageLLx=_viewport$viewBox[0],pageLLy=_viewport$viewBox[1],pageWidth=_viewport$viewBox[2]-pageLLx,pageHeight=_viewport$viewBox[3]-pageLLy;container.setAttribute("data-annotation-id",data.id);var rect=_util.Util.normalizeRect([data.rect[0],page.view[3]-data.rect[1]+page.view[1],data.rect[2],page.view[3]-data.rect[3]+page.view[1]]);if(!ignoreBorder&&data.borderStyle.width>0){container.style.borderWidth="".concat(data.borderStyle.width,"px");var horizontalRadius=data.borderStyle.horizontalCornerRadius,verticalRadius=data.borderStyle.verticalCornerRadius;if(horizontalRadius>0||verticalRadius>0){var radius="calc(".concat(horizontalRadius,"px * var(--scale-factor)) / calc(").concat(verticalRadius,"px * var(--scale-factor))");container.style.borderRadius=radius}else if(this instanceof RadioButtonWidgetAnnotationElement){var _radius="calc(".concat(width,"px * var(--scale-factor)) / calc(").concat(height,"px * var(--scale-factor))");container.style.borderRadius=_radius}switch(data.borderStyle.style){case _util.AnnotationBorderStyleType.SOLID:container.style.borderStyle="solid";break;case _util.AnnotationBorderStyleType.DASHED:container.style.borderStyle="dashed";break;case _util.AnnotationBorderStyleType.BEVELED:(0,_util.warn)("Unimplemented border style: beveled");break;case _util.AnnotationBorderStyleType.INSET:(0,_util.warn)("Unimplemented border style: inset");break;case _util.AnnotationBorderStyleType.UNDERLINE:container.style.borderBottomStyle="solid"}var borderColor=data.borderColor||null;borderColor?container.style.borderColor=_util.Util.makeHexColor(0|borderColor[0],0|borderColor[1],0|borderColor[2]):container.style.borderWidth=0}container.style.left="".concat(100*(rect[0]-pageLLx)/pageWidth,"%"),container.style.top="".concat(100*(rect[1]-pageLLy)/pageHeight,"%");var rotation=data.rotation;return data.hasOwnCanvas||0===rotation?(container.style.width="".concat(100*width/pageWidth,"%"),container.style.height="".concat(100*height/pageHeight,"%")):this.setRotation(rotation,container),container}},{key:"setRotation",value:function(angle){var elementWidth,elementHeight,container=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.container,_this$viewport$viewBo2=_slicedToArray(this.viewport.viewBox,4),pageLLx=_this$viewport$viewBo2[0],pageLLy=_this$viewport$viewBo2[1],pageWidth=_this$viewport$viewBo2[2]-pageLLx,pageHeight=_this$viewport$viewBo2[3]-pageLLy,_getRectDims2=getRectDims(this.data.rect),width=_getRectDims2.width,height=_getRectDims2.height;angle%180==0?(elementWidth=100*width/pageWidth,elementHeight=100*height/pageHeight):(elementWidth=100*height/pageWidth,elementHeight=100*width/pageHeight),container.style.width="".concat(elementWidth,"%"),container.style.height="".concat(elementHeight,"%"),container.setAttribute("data-main-rotation",(360-angle)%360)}},{key:"_commonActions",get:function(){var _this52=this,setColor=function(jsName,styleName,event){var color=event.detail[jsName];event.target.style[styleName]=_scripting_utils.ColorConverters["".concat(color[0],"_HTML")](color.slice(1))};return(0,_util.shadow)(this,"_commonActions",{display:function(event){var hidden=event.detail.display%2==1;_this52.container.style.visibility=hidden?"hidden":"visible",_this52.annotationStorage.setValue(_this52.data.id,{hidden:hidden,print:0===event.detail.display||3===event.detail.display})},print:function(event){_this52.annotationStorage.setValue(_this52.data.id,{print:event.detail.print})},hidden:function(event){_this52.container.style.visibility=event.detail.hidden?"hidden":"visible",_this52.annotationStorage.setValue(_this52.data.id,{hidden:event.detail.hidden})},focus:function(event){setTimeout((function(){return event.target.focus({preventScroll:!1})}),0)},userName:function(event){event.target.title=event.detail.userName},readonly:function(event){event.detail.readonly?event.target.setAttribute("readonly",""):event.target.removeAttribute("readonly")},required:function(event){_this52._setRequired(event.target,event.detail.required)},bgColor:function(event){setColor("bgColor","backgroundColor",event)},fillColor:function(event){setColor("fillColor","backgroundColor",event)},fgColor:function(event){setColor("fgColor","color",event)},textColor:function(event){setColor("textColor","color",event)},borderColor:function(event){setColor("borderColor","borderColor",event)},strokeColor:function(event){setColor("strokeColor","borderColor",event)},rotation:function(event){var angle=event.detail.rotation;_this52.setRotation(angle),_this52.annotationStorage.setValue(_this52.data.id,{rotation:angle})}})}},{key:"_dispatchEventFromSandbox",value:function(actions,jsEvent){for(var commonActions=this._commonActions,_i5=0,_Object$keys=Object.keys(jsEvent.detail);_i5<_Object$keys.length;_i5++){var name=_Object$keys[_i5],action=actions[name]||commonActions[name];action&&action(jsEvent)}}},{key:"_setDefaultPropertiesFromJS",value:function(element){if(this.enableScripting){var storedData=this.annotationStorage.getRawValue(this.data.id);if(storedData)for(var commonActions=this._commonActions,_i6=0,_Object$entries2=Object.entries(storedData);_i6<_Object$entries2.length;_i6++){var _Object$entries2$_i=_slicedToArray(_Object$entries2[_i6],2),actionName=_Object$entries2$_i[0],detail=_Object$entries2$_i[1],action=commonActions[actionName];action&&(action({detail:_defineProperty2({},actionName,detail),target:element}),delete storedData[actionName])}}}},{key:"_createQuadrilaterals",value:function(){var ignoreBorder=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.data.quadPoints)return null;var _step87,quadrilaterals=[],savedRect=this.data.rect,_iterator87=_createForOfIteratorHelper(this.data.quadPoints);try{for(_iterator87.s();!(_step87=_iterator87.n()).done;){var quadPoint=_step87.value;this.data.rect=[quadPoint[2].x,quadPoint[2].y,quadPoint[1].x,quadPoint[1].y],quadrilaterals.push(this._createContainer(ignoreBorder))}}catch(err){_iterator87.e(err)}finally{_iterator87.f()}return this.data.rect=savedRect,quadrilaterals}},{key:"_createPopup",value:function(trigger,data){var container=this.container;this.quadrilaterals&&(trigger=trigger||this.quadrilaterals,container=this.quadrilaterals[0]),trigger||((trigger=document.createElement("div")).className="popupTriggerArea",container.append(trigger));var popup=new PopupElement({container:container,trigger:trigger,color:data.color,titleObj:data.titleObj,modificationDate:data.modificationDate,contentsObj:data.contentsObj,richText:data.richText,hideWrapper:!0}).render();popup.style.left="100%",container.append(popup)}},{key:"_renderQuadrilaterals",value:function(className){var _step88,_iterator88=_createForOfIteratorHelper(this.quadrilaterals);try{for(_iterator88.s();!(_step88=_iterator88.n()).done;)_step88.value.className=className}catch(err){_iterator88.e(err)}finally{_iterator88.f()}return this.quadrilaterals}},{key:"render",value:function(){(0,_util.unreachable)("Abstract method `AnnotationElement.render` called")}},{key:"_getElementsByName",value:function(name){var skipId=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,fields=[];if(this._fieldObjects){var fieldObj=this._fieldObjects[name];if(fieldObj){var _step89,_iterator89=_createForOfIteratorHelper(fieldObj);try{for(_iterator89.s();!(_step89=_iterator89.n()).done;){var _step89$value=_step89.value,page=_step89$value.page,id=_step89$value.id,exportValues=_step89$value.exportValues;if(-1!==page&&id!==skipId){var exportValue="string"==typeof exportValues?exportValues:null,domElement=document.querySelector('[data-element-id="'.concat(id,'"]'));!domElement||GetElementsByNameSet.has(domElement)?fields.push({id:id,exportValue:exportValue,domElement:domElement}):(0,_util.warn)("_getElementsByName - element not allowed: ".concat(id))}}}catch(err){_iterator89.e(err)}finally{_iterator89.f()}}return fields}var _step90,_iterator90=_createForOfIteratorHelper(document.getElementsByName(name));try{for(_iterator90.s();!(_step90=_iterator90.n()).done;){var _domElement=_step90.value,_id5=_domElement.id,_exportValue=_domElement.exportValue;_id5!==skipId&&GetElementsByNameSet.has(_domElement)&&fields.push({id:_id5,exportValue:_exportValue,domElement:_domElement})}}catch(err){_iterator90.e(err)}finally{_iterator90.f()}return fields}}],[{key:"platform",get:function(){var platform="undefined"!=typeof navigator?navigator.platform:"";return(0,_util.shadow)(this,"platform",{isWin:platform.includes("Win"),isMac:platform.includes("Mac")})}}]),AnnotationElement}(),LinkAnnotationElement=function(_AnnotationElement){function LinkAnnotationElement(parameters){var _this53;_classCallCheck(this,LinkAnnotationElement);var options=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(_this53=_callSuper(this,LinkAnnotationElement,[parameters,{isRenderable:!0,ignoreBorder:!(null==options||!options.ignoreBorder),createQuadrilaterals:!0}])).isTooltipOnly=parameters.data.isTooltipOnly,_this53}return _inherits(LinkAnnotationElement,_AnnotationElement),_createClass(LinkAnnotationElement,[{key:"render",value:function(){var data=this.data,linkService=this.linkService,link=document.createElement("a");link.setAttribute("data-element-id",data.id);var isBound=!1;return data.url?(linkService.addLinkAttributes(link,data.url,data.newWindow),isBound=!0):data.action?(this._bindNamedAction(link,data.action),isBound=!0):data.dest?(this._bindLink(link,data.dest),isBound=!0):(data.actions&&(data.actions.Action||data.actions["Mouse Up"]||data.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(link,data),isBound=!0),data.resetForm?(this._bindResetFormAction(link,data.resetForm),isBound=!0):this.isTooltipOnly&&!isBound&&(this._bindLink(link,""),isBound=!0)),this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((function(quadrilateral,index){var linkElement=0===index?link:link.cloneNode();return quadrilateral.append(linkElement),quadrilateral})):(this.container.className="linkAnnotation",isBound&&this.container.append(link),this.container)}},{key:"_bindLink",value:function(link,destination){var _this54=this;link.href=this.linkService.getDestinationHash(destination),link.onclick=function(){return destination&&_this54.linkService.goToDestination(destination),!1},(destination||""===destination)&&(link.className="internalLink")}},{key:"_bindNamedAction",value:function(link,action){var _this55=this;link.href=this.linkService.getAnchorUrl(""),link.onclick=function(){return _this55.linkService.executeNamedAction(action),!1},link.className="internalLink"}},{key:"_bindJSAction",value:function(link,data){var _this56=this;link.href=this.linkService.getAnchorUrl("");for(var map=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]),_loop2=function(){var name=_Object$keys2[_i7],jsName=map.get(name);if(!jsName)return 1;link[jsName]=function(){var _this$linkService$eve;return null===(_this$linkService$eve=_this56.linkService.eventBus)||void 0===_this$linkService$eve||_this$linkService$eve.dispatch("dispatcheventinsandbox",{source:_this56,detail:{id:data.id,name:name}}),!1}},_i7=0,_Object$keys2=Object.keys(data.actions);_i7<_Object$keys2.length;_i7++)_loop2();link.onclick||(link.onclick=function(){return!1}),link.className="internalLink"}},{key:"_bindResetFormAction",value:function(link,resetForm){var _this57=this,otherClickAction=link.onclick;if(otherClickAction||(link.href=this.linkService.getAnchorUrl("")),link.className="internalLink",!this._fieldObjects)return(0,_util.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),void(otherClickAction||(link.onclick=function(){return!1}));link.onclick=function(){otherClickAction&&otherClickAction();var resetFormFields=resetForm.fields,resetFormRefs=resetForm.refs,include=resetForm.include,allFields=[];if(0!==resetFormFields.length||0!==resetFormRefs.length){var _step91,fieldIds=new Set(resetFormRefs),_iterator91=_createForOfIteratorHelper(resetFormFields);try{for(_iterator91.s();!(_step91=_iterator91.n()).done;){var _step93,fieldName=_step91.value,_iterator93=_createForOfIteratorHelper(_this57._fieldObjects[fieldName]||[]);try{for(_iterator93.s();!(_step93=_iterator93.n()).done;){var id=_step93.value.id;fieldIds.add(id)}}catch(err){_iterator93.e(err)}finally{_iterator93.f()}}}catch(err){_iterator91.e(err)}finally{_iterator91.f()}for(var _i8=0,_Object$values=Object.values(_this57._fieldObjects);_i8<_Object$values.length;_i8++){var _step92,_iterator92=_createForOfIteratorHelper(_Object$values[_i8]);try{for(_iterator92.s();!(_step92=_iterator92.n()).done;){var field=_step92.value;fieldIds.has(field.id)===include&&allFields.push(field)}}catch(err){_iterator92.e(err)}finally{_iterator92.f()}}}else for(var _i9=0,_Object$values2=Object.values(_this57._fieldObjects);_i9<_Object$values2.length;_i9++){var _fields2=_Object$values2[_i9];allFields.push.apply(allFields,_toConsumableArray(_fields2))}for(var _this$linkService$eve2,storage=_this57.annotationStorage,allIds=[],_i10=0,_allFields=allFields;_i10<_allFields.length;_i10++){var _field=_allFields[_i10],_id6=_field.id;switch(allIds.push(_id6),_field.type){case"text":var value=_field.defaultValue||"";storage.setValue(_id6,{value:value});break;case"checkbox":case"radiobutton":var _value2=_field.defaultValue===_field.exportValues;storage.setValue(_id6,{value:_value2});break;case"combobox":case"listbox":var _value3=_field.defaultValue||"";storage.setValue(_id6,{value:_value3});break;default:continue}var domElement=document.querySelector('[data-element-id="'.concat(_id6,'"]'));domElement&&(GetElementsByNameSet.has(domElement)?domElement.dispatchEvent(new Event("resetform")):(0,_util.warn)("_bindResetFormAction - element not allowed: ".concat(_id6)))}return _this57.enableScripting&&(null===(_this$linkService$eve2=_this57.linkService.eventBus)||void 0===_this$linkService$eve2||_this$linkService$eve2.dispatch("dispatcheventinsandbox",{source:_this57,detail:{id:"app",ids:allIds,name:"ResetForm"}})),!1}}}]),LinkAnnotationElement}(AnnotationElement),TextAnnotationElement=function(_AnnotationElement2){function TextAnnotationElement(parameters){var _parameters$data$titl,_parameters$data$cont,_parameters$data$rich;return _classCallCheck(this,TextAnnotationElement),_callSuper(this,TextAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl=parameters.data.titleObj)&&void 0!==_parameters$data$titl&&_parameters$data$titl.str||null!==(_parameters$data$cont=parameters.data.contentsObj)&&void 0!==_parameters$data$cont&&_parameters$data$cont.str||null!==(_parameters$data$rich=parameters.data.richText)&&void 0!==_parameters$data$rich&&_parameters$data$rich.str)}])}return _inherits(TextAnnotationElement,_AnnotationElement2),_createClass(TextAnnotationElement,[{key:"render",value:function(){this.container.className="textAnnotation";var image=document.createElement("img");return image.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",image.alt="[{{type}} Annotation]",image.dataset.l10nId="text_annotation_type",image.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(image,this.data),this.container.append(image),this.container}}]),TextAnnotationElement}(AnnotationElement),WidgetAnnotationElement=function(_AnnotationElement3){function WidgetAnnotationElement(){return _classCallCheck(this,WidgetAnnotationElement),_callSuper(this,WidgetAnnotationElement,arguments)}return _inherits(WidgetAnnotationElement,_AnnotationElement3),_createClass(WidgetAnnotationElement,[{key:"render",value:function(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}},{key:"_getKeyModifier",value:function(event){var _AnnotationElement$pl=AnnotationElement.platform,isWin=_AnnotationElement$pl.isWin,isMac=_AnnotationElement$pl.isMac;return isWin&&event.ctrlKey||isMac&&event.metaKey}},{key:"_setEventListener",value:function(element,baseName,eventName,valueGetter){var _this58=this;baseName.includes("mouse")?element.addEventListener(baseName,(function(event){var _this$linkService$eve3;null===(_this$linkService$eve3=_this58.linkService.eventBus)||void 0===_this$linkService$eve3||_this$linkService$eve3.dispatch("dispatcheventinsandbox",{source:_this58,detail:{id:_this58.data.id,name:eventName,value:valueGetter(event),shift:event.shiftKey,modifier:_this58._getKeyModifier(event)}})})):element.addEventListener(baseName,(function(event){var _this$linkService$eve4;null===(_this$linkService$eve4=_this58.linkService.eventBus)||void 0===_this$linkService$eve4||_this$linkService$eve4.dispatch("dispatcheventinsandbox",{source:_this58,detail:{id:_this58.data.id,name:eventName,value:valueGetter(event)}})}))}},{key:"_setEventListeners",value:function(element,names,getter){var _step94,_iterator94=_createForOfIteratorHelper(names);try{for(_iterator94.s();!(_step94=_iterator94.n()).done;){var _this$data$actions,_step94$value=_slicedToArray(_step94.value,2),baseName=_step94$value[0],eventName=_step94$value[1];("Action"===eventName||null!==(_this$data$actions=this.data.actions)&&void 0!==_this$data$actions&&_this$data$actions[eventName])&&this._setEventListener(element,baseName,eventName,getter)}}catch(err){_iterator94.e(err)}finally{_iterator94.f()}}},{key:"_setBackgroundColor",value:function(element){var color=this.data.backgroundColor||null;element.style.backgroundColor=null===color?"transparent":_util.Util.makeHexColor(color[0],color[1],color[2])}},{key:"_setTextStyle",value:function(element){var computedFontSize,fontColor=this.data.defaultAppearanceData.fontColor,fontSize=this.data.defaultAppearanceData.fontSize||9,style=element.style;if(this.data.multiLine){var height=Math.abs(this.data.rect[3]-this.data.rect[1]),lineHeight=height/(Math.round(height/(_util.LINE_FACTOR*fontSize))||1);computedFontSize=Math.min(fontSize,Math.round(lineHeight/_util.LINE_FACTOR))}else{var _height=Math.abs(this.data.rect[3]-this.data.rect[1]);computedFontSize=Math.min(fontSize,Math.round(_height/_util.LINE_FACTOR))}style.fontSize="calc(".concat(computedFontSize,"px * var(--scale-factor))"),style.color=_util.Util.makeHexColor(fontColor[0],fontColor[1],fontColor[2]),null!==this.data.textAlignment&&(style.textAlign=["left","center","right"][this.data.textAlignment])}},{key:"_setRequired",value:function(element,isRequired){isRequired?element.setAttribute("required",!0):element.removeAttribute("required"),element.setAttribute("aria-required",isRequired)}}]),WidgetAnnotationElement}(AnnotationElement),TextWidgetAnnotationElement=function(_WidgetAnnotationElem){function TextWidgetAnnotationElement(parameters){return _classCallCheck(this,TextWidgetAnnotationElement),_callSuper(this,TextWidgetAnnotationElement,[parameters,{isRenderable:parameters.renderForms||!parameters.data.hasAppearance&&!!parameters.data.fieldValue}])}return _inherits(TextWidgetAnnotationElement,_WidgetAnnotationElem),_createClass(TextWidgetAnnotationElement,[{key:"setPropertyOnSiblings",value:function(base,key,value,keyInStorage){var _step95,storage=this.annotationStorage,_iterator95=_createForOfIteratorHelper(this._getElementsByName(base.name,base.id));try{for(_iterator95.s();!(_step95=_iterator95.n()).done;){var element=_step95.value;element.domElement&&(element.domElement[key]=value),storage.setValue(element.id,_defineProperty2({},keyInStorage,value))}}catch(err){_iterator95.e(err)}finally{_iterator95.f()}}},{key:"render",value:function(){var _this59=this,storage=this.annotationStorage,id=this.data.id;this.container.className="textWidgetAnnotation";var element=null;if(this.renderForms){var storedData=storage.getValue(id,{value:this.data.fieldValue}),textContent=storedData.formattedValue||storedData.value||"",maxLen=storage.getValue(id,{charLimit:this.data.maxLen}).charLimit;maxLen&&textContent.length>maxLen&&(textContent=textContent.slice(0,maxLen));var elementData={userValue:textContent,formattedValue:null,valueOnFocus:""};this.data.multiLine?((element=document.createElement("textarea")).textContent=textContent,this.data.doNotScroll&&(element.style.overflowY="hidden")):((element=document.createElement("input")).type="text",element.setAttribute("value",textContent),this.data.doNotScroll&&(element.style.overflowX="hidden")),GetElementsByNameSet.add(element),element.setAttribute("data-element-id",id),element.disabled=this.data.readOnly,element.name=this.data.fieldName,element.tabIndex=1e3,this._setRequired(element,this.data.required),maxLen&&(element.maxLength=maxLen),element.addEventListener("input",(function(event){storage.setValue(id,{value:event.target.value}),_this59.setPropertyOnSiblings(element,"value",event.target.value,"value")})),element.addEventListener("resetform",(function(event){var _this$data$defaultFie,defaultValue=null!==(_this$data$defaultFie=_this59.data.defaultFieldValue)&&void 0!==_this$data$defaultFie?_this$data$defaultFie:"";element.value=elementData.userValue=defaultValue,elementData.formattedValue=null}));var blurListener=function(event){var formattedValue=elementData.formattedValue;null!=formattedValue&&(event.target.value=formattedValue),event.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){var _this$data$actions2;element.addEventListener("focus",(function(event){elementData.userValue&&(event.target.value=elementData.userValue),elementData.valueOnFocus=event.target.value})),element.addEventListener("updatefromsandbox",(function(jsEvent){var actions={value:function(event){var _event$detail$value;elementData.userValue=null!==(_event$detail$value=event.detail.value)&&void 0!==_event$detail$value?_event$detail$value:"",storage.setValue(id,{value:elementData.userValue.toString()}),event.target.value=elementData.userValue},formattedValue:function(event){var formattedValue=event.detail.formattedValue;elementData.formattedValue=formattedValue,null!=formattedValue&&event.target!==document.activeElement&&(event.target.value=formattedValue),storage.setValue(id,{formattedValue:formattedValue})},selRange:function(event){var _event$target;(_event$target=event.target).setSelectionRange.apply(_event$target,_toConsumableArray(event.detail.selRange))},charLimit:function(event){var _this$linkService$eve5,charLimit=event.detail.charLimit,target=event.target;if(0!==charLimit){target.setAttribute("maxLength",charLimit);var value=elementData.userValue;!value||value.length<=charLimit||(value=value.slice(0,charLimit),target.value=elementData.userValue=value,storage.setValue(id,{value:value}),null===(_this$linkService$eve5=_this59.linkService.eventBus)||void 0===_this$linkService$eve5||_this$linkService$eve5.dispatch("dispatcheventinsandbox",{source:_this59,detail:{id:id,name:"Keystroke",value:value,willCommit:!0,commitKey:1,selStart:target.selectionStart,selEnd:target.selectionEnd}}))}else target.removeAttribute("maxLength")}};_this59._dispatchEventFromSandbox(actions,jsEvent)})),element.addEventListener("keydown",(function(event){var _this$linkService$eve6,commitKey=-1;if("Escape"===event.key?commitKey=0:"Enter"===event.key?commitKey=2:"Tab"===event.key&&(commitKey=3),-1!==commitKey){var value=event.target.value;elementData.valueOnFocus!==value&&(elementData.userValue=value,null===(_this$linkService$eve6=_this59.linkService.eventBus)||void 0===_this$linkService$eve6||_this$linkService$eve6.dispatch("dispatcheventinsandbox",{source:_this59,detail:{id:id,name:"Keystroke",value:value,willCommit:!0,commitKey:commitKey,selStart:event.target.selectionStart,selEnd:event.target.selectionEnd}}))}}));var _blurListener=blurListener;blurListener=null,element.addEventListener("blur",(function(event){var _this$linkService$eve7,value=event.target.value;elementData.userValue=value,_this59._mouseState.isDown&&elementData.valueOnFocus!==value&&(null===(_this$linkService$eve7=_this59.linkService.eventBus)||void 0===_this$linkService$eve7||_this$linkService$eve7.dispatch("dispatcheventinsandbox",{source:_this59,detail:{id:id,name:"Keystroke",value:value,willCommit:!0,commitKey:1,selStart:event.target.selectionStart,selEnd:event.target.selectionEnd}})),_blurListener(event)})),null!==(_this$data$actions2=this.data.actions)&&void 0!==_this$data$actions2&&_this$data$actions2.Keystroke&&element.addEventListener("beforeinput",(function(event){var _this$linkService$eve8,data=event.data,target=event.target,value=target.value,selectionStart=target.selectionStart,selectionEnd=target.selectionEnd,selStart=selectionStart,selEnd=selectionEnd;switch(event.inputType){case"deleteWordBackward":var match=value.substring(0,selectionStart).match(/\w*[^\w]*$/);match&&(selStart-=match[0].length);break;case"deleteWordForward":var _match=value.substring(selectionStart).match(/^[^\w]*\w*/);_match&&(selEnd+=_match[0].length);break;case"deleteContentBackward":selectionStart===selectionEnd&&(selStart-=1);break;case"deleteContentForward":selectionStart===selectionEnd&&(selEnd+=1)}event.preventDefault(),null===(_this$linkService$eve8=_this59.linkService.eventBus)||void 0===_this$linkService$eve8||_this$linkService$eve8.dispatch("dispatcheventinsandbox",{source:_this59,detail:{id:id,name:"Keystroke",value:value,change:data||"",willCommit:!1,selStart:selStart,selEnd:selEnd}})})),this._setEventListeners(element,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(function(event){return event.target.value}))}if(blurListener&&element.addEventListener("blur",blurListener),this.data.comb){var combWidth=(this.data.rect[2]-this.data.rect[0])/maxLen;element.classList.add("comb"),element.style.letterSpacing="calc(".concat(combWidth,"px * var(--scale-factor) - 1ch)")}}else(element=document.createElement("div")).textContent=this.data.fieldValue,element.style.verticalAlign="middle",element.style.display="table-cell";return this._setTextStyle(element),this._setBackgroundColor(element),this._setDefaultPropertiesFromJS(element),this.container.append(element),this.container}}]),TextWidgetAnnotationElement}(WidgetAnnotationElement),CheckboxWidgetAnnotationElement=function(_WidgetAnnotationElem2){function CheckboxWidgetAnnotationElement(parameters){return _classCallCheck(this,CheckboxWidgetAnnotationElement),_callSuper(this,CheckboxWidgetAnnotationElement,[parameters,{isRenderable:parameters.renderForms}])}return _inherits(CheckboxWidgetAnnotationElement,_WidgetAnnotationElem2),_createClass(CheckboxWidgetAnnotationElement,[{key:"render",value:function(){var _this60=this,storage=this.annotationStorage,data=this.data,id=data.id,value=storage.getValue(id,{value:data.exportValue===data.fieldValue}).value;"string"==typeof value&&(value="Off"!==value,storage.setValue(id,{value:value})),this.container.className="buttonWidgetAnnotation checkBox";var element=document.createElement("input");return GetElementsByNameSet.add(element),element.setAttribute("data-element-id",id),element.disabled=data.readOnly,this._setRequired(element,this.data.required),element.type="checkbox",element.name=data.fieldName,value&&element.setAttribute("checked",!0),element.setAttribute("exportValue",data.exportValue),element.tabIndex=1e3,element.addEventListener("change",(function(event){var _step96,_event$target2=event.target,name=_event$target2.name,checked=_event$target2.checked,_iterator96=_createForOfIteratorHelper(_this60._getElementsByName(name,id));try{for(_iterator96.s();!(_step96=_iterator96.n()).done;){var checkbox=_step96.value,curChecked=checked&&checkbox.exportValue===data.exportValue;checkbox.domElement&&(checkbox.domElement.checked=curChecked),storage.setValue(checkbox.id,{value:curChecked})}}catch(err){_iterator96.e(err)}finally{_iterator96.f()}storage.setValue(id,{value:checked})})),element.addEventListener("resetform",(function(event){var defaultValue=data.defaultFieldValue||"Off";event.target.checked=defaultValue===data.exportValue})),this.enableScripting&&this.hasJSActions&&(element.addEventListener("updatefromsandbox",(function(jsEvent){var actions={value:function(event){event.target.checked="Off"!==event.detail.value,storage.setValue(id,{value:event.target.checked})}};_this60._dispatchEventFromSandbox(actions,jsEvent)})),this._setEventListeners(element,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(function(event){return event.target.checked}))),this._setBackgroundColor(element),this._setDefaultPropertiesFromJS(element),this.container.append(element),this.container}}]),CheckboxWidgetAnnotationElement}(WidgetAnnotationElement),RadioButtonWidgetAnnotationElement=function(_WidgetAnnotationElem3){function RadioButtonWidgetAnnotationElement(parameters){return _classCallCheck(this,RadioButtonWidgetAnnotationElement),_callSuper(this,RadioButtonWidgetAnnotationElement,[parameters,{isRenderable:parameters.renderForms}])}return _inherits(RadioButtonWidgetAnnotationElement,_WidgetAnnotationElem3),_createClass(RadioButtonWidgetAnnotationElement,[{key:"render",value:function(){var _this61=this;this.container.className="buttonWidgetAnnotation radioButton";var storage=this.annotationStorage,data=this.data,id=data.id,value=storage.getValue(id,{value:data.fieldValue===data.buttonValue}).value;"string"==typeof value&&(value=value!==data.buttonValue,storage.setValue(id,{value:value}));var element=document.createElement("input");if(GetElementsByNameSet.add(element),element.setAttribute("data-element-id",id),element.disabled=data.readOnly,this._setRequired(element,this.data.required),element.type="radio",element.name=data.fieldName,value&&element.setAttribute("checked",!0),element.tabIndex=1e3,element.addEventListener("change",(function(event){var _step97,_event$target3=event.target,name=_event$target3.name,checked=_event$target3.checked,_iterator97=_createForOfIteratorHelper(_this61._getElementsByName(name,id));try{for(_iterator97.s();!(_step97=_iterator97.n()).done;){var radio=_step97.value;storage.setValue(radio.id,{value:!1})}}catch(err){_iterator97.e(err)}finally{_iterator97.f()}storage.setValue(id,{value:checked})})),element.addEventListener("resetform",(function(event){var defaultValue=data.defaultFieldValue;event.target.checked=null!=defaultValue&&defaultValue===data.buttonValue})),this.enableScripting&&this.hasJSActions){var pdfButtonValue=data.buttonValue;element.addEventListener("updatefromsandbox",(function(jsEvent){var actions={value:function(event){var _step98,checked=pdfButtonValue===event.detail.value,_iterator98=_createForOfIteratorHelper(_this61._getElementsByName(event.target.name));try{for(_iterator98.s();!(_step98=_iterator98.n()).done;){var radio=_step98.value,curChecked=checked&&radio.id===id;radio.domElement&&(radio.domElement.checked=curChecked),storage.setValue(radio.id,{value:curChecked})}}catch(err){_iterator98.e(err)}finally{_iterator98.f()}}};_this61._dispatchEventFromSandbox(actions,jsEvent)})),this._setEventListeners(element,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],(function(event){return event.target.checked}))}return this._setBackgroundColor(element),this._setDefaultPropertiesFromJS(element),this.container.append(element),this.container}}]),RadioButtonWidgetAnnotationElement}(WidgetAnnotationElement),PushButtonWidgetAnnotationElement=function(_LinkAnnotationElemen){function PushButtonWidgetAnnotationElement(parameters){return _classCallCheck(this,PushButtonWidgetAnnotationElement),_callSuper(this,PushButtonWidgetAnnotationElement,[parameters,{ignoreBorder:parameters.data.hasAppearance}])}return _inherits(PushButtonWidgetAnnotationElement,_LinkAnnotationElemen),_createClass(PushButtonWidgetAnnotationElement,[{key:"render",value:function(){var _this62=this,container=_get(_getPrototypeOf(PushButtonWidgetAnnotationElement.prototype),"render",this).call(this);container.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(container.title=this.data.alternativeText);var linkElement=container.lastChild;return this.enableScripting&&this.hasJSActions&&linkElement&&(this._setDefaultPropertiesFromJS(linkElement),linkElement.addEventListener("updatefromsandbox",(function(jsEvent){_this62._dispatchEventFromSandbox({},jsEvent)}))),container}}]),PushButtonWidgetAnnotationElement}(LinkAnnotationElement),ChoiceWidgetAnnotationElement=function(_WidgetAnnotationElem4){function ChoiceWidgetAnnotationElement(parameters){return _classCallCheck(this,ChoiceWidgetAnnotationElement),_callSuper(this,ChoiceWidgetAnnotationElement,[parameters,{isRenderable:parameters.renderForms}])}return _inherits(ChoiceWidgetAnnotationElement,_WidgetAnnotationElem4),_createClass(ChoiceWidgetAnnotationElement,[{key:"render",value:function(){var _this63=this;this.container.className="choiceWidgetAnnotation";var storage=this.annotationStorage,id=this.data.id,storedData=storage.getValue(id,{value:this.data.fieldValue}),selectElement=document.createElement("select");GetElementsByNameSet.add(selectElement),selectElement.setAttribute("data-element-id",id),selectElement.disabled=this.data.readOnly,this._setRequired(selectElement,this.data.required),selectElement.name=this.data.fieldName,selectElement.tabIndex=1e3;var addAnEmptyEntry=this.data.combo&&this.data.options.length>0;this.data.combo||(selectElement.size=this.data.options.length,this.data.multiSelect&&(selectElement.multiple=!0)),selectElement.addEventListener("resetform",(function(event){var _step99,defaultValue=_this63.data.defaultFieldValue,_iterator99=_createForOfIteratorHelper(selectElement.options);try{for(_iterator99.s();!(_step99=_iterator99.n()).done;){var option=_step99.value;option.selected=option.value===defaultValue}}catch(err){_iterator99.e(err)}finally{_iterator99.f()}}));var _step100,_iterator100=_createForOfIteratorHelper(this.data.options);try{for(_iterator100.s();!(_step100=_iterator100.n()).done;){var option=_step100.value,optionElement=document.createElement("option");optionElement.textContent=option.displayValue,optionElement.value=option.exportValue,storedData.value.includes(option.exportValue)&&(optionElement.setAttribute("selected",!0),addAnEmptyEntry=!1),selectElement.append(optionElement)}}catch(err){_iterator100.e(err)}finally{_iterator100.f()}var _removeEmptyEntry2=null;if(addAnEmptyEntry){var noneOptionElement=document.createElement("option");noneOptionElement.value=" ",noneOptionElement.setAttribute("hidden",!0),noneOptionElement.setAttribute("selected",!0),selectElement.prepend(noneOptionElement),_removeEmptyEntry2=function(){noneOptionElement.remove(),selectElement.removeEventListener("input",_removeEmptyEntry2),_removeEmptyEntry2=null},selectElement.addEventListener("input",_removeEmptyEntry2)}var getValue=function(event,isExport){var name=isExport?"value":"textContent",options=event.target.options;return event.target.multiple?Array.prototype.filter.call(options,(function(option){return option.selected})).map((function(option){return option[name]})):-1===options.selectedIndex?null:options[options.selectedIndex][name]},getItems=function(event){var options=event.target.options;return Array.prototype.map.call(options,(function(option){return{displayValue:option.textContent,exportValue:option.value}}))};return this.enableScripting&&this.hasJSActions?(selectElement.addEventListener("updatefromsandbox",(function(jsEvent){var actions={value:function(event){var _removeEmptyEntry;null===(_removeEmptyEntry=_removeEmptyEntry2)||void 0===_removeEmptyEntry||_removeEmptyEntry();var _step101,value=event.detail.value,values=new Set(Array.isArray(value)?value:[value]),_iterator101=_createForOfIteratorHelper(selectElement.options);try{for(_iterator101.s();!(_step101=_iterator101.n()).done;){var option=_step101.value;option.selected=values.has(option.value)}}catch(err){_iterator101.e(err)}finally{_iterator101.f()}storage.setValue(id,{value:getValue(event,!0)})},multipleSelection:function(event){selectElement.multiple=!0},remove:function(event){var options=selectElement.options,index=event.detail.remove;if(options[index].selected=!1,selectElement.remove(index),options.length>0){var i=Array.prototype.findIndex.call(options,(function(option){return option.selected}));-1===i&&(options[0].selected=!0)}storage.setValue(id,{value:getValue(event,!0),items:getItems(event)})},clear:function(event){for(;0!==selectElement.length;)selectElement.remove(0);storage.setValue(id,{value:null,items:[]})},insert:function(event){var _event$detail$insert=event.detail.insert,index=_event$detail$insert.index,displayValue=_event$detail$insert.displayValue,exportValue=_event$detail$insert.exportValue,selectChild=selectElement.children[index],optionElement=document.createElement("option");optionElement.textContent=displayValue,optionElement.value=exportValue,selectChild?selectChild.before(optionElement):selectElement.append(optionElement),storage.setValue(id,{value:getValue(event,!0),items:getItems(event)})},items:function(event){for(var items=event.detail.items;0!==selectElement.length;)selectElement.remove(0);var _step102,_iterator102=_createForOfIteratorHelper(items);try{for(_iterator102.s();!(_step102=_iterator102.n()).done;){var item=_step102.value,displayValue=item.displayValue,exportValue=item.exportValue,optionElement=document.createElement("option");optionElement.textContent=displayValue,optionElement.value=exportValue,selectElement.append(optionElement)}}catch(err){_iterator102.e(err)}finally{_iterator102.f()}selectElement.options.length>0&&(selectElement.options[0].selected=!0),storage.setValue(id,{value:getValue(event,!0),items:getItems(event)})},indices:function(event){var _step103,indices=new Set(event.detail.indices),_iterator103=_createForOfIteratorHelper(event.target.options);try{for(_iterator103.s();!(_step103=_iterator103.n()).done;){var option=_step103.value;option.selected=indices.has(option.index)}}catch(err){_iterator103.e(err)}finally{_iterator103.f()}storage.setValue(id,{value:getValue(event,!0)})},editable:function(event){event.target.disabled=!event.detail.editable}};_this63._dispatchEventFromSandbox(actions,jsEvent)})),selectElement.addEventListener("input",(function(event){var _this$linkService$eve9,exportValue=getValue(event,!0),value=getValue(event,!1);storage.setValue(id,{value:exportValue}),null===(_this$linkService$eve9=_this63.linkService.eventBus)||void 0===_this$linkService$eve9||_this$linkService$eve9.dispatch("dispatcheventinsandbox",{source:_this63,detail:{id:id,name:"Keystroke",value:value,changeEx:exportValue,willCommit:!0,commitKey:1,keyDown:!1}})})),this._setEventListeners(selectElement,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],(function(event){return event.target.checked}))):selectElement.addEventListener("input",(function(event){storage.setValue(id,{value:getValue(event,!0)})})),this.data.combo&&this._setTextStyle(selectElement),this._setBackgroundColor(selectElement),this._setDefaultPropertiesFromJS(selectElement),this.container.append(selectElement),this.container}}]),ChoiceWidgetAnnotationElement}(WidgetAnnotationElement),PopupAnnotationElement=function(_AnnotationElement4){function PopupAnnotationElement(parameters){var _parameters$data$titl2,_parameters$data$cont2,_parameters$data$rich2;return _classCallCheck(this,PopupAnnotationElement),_callSuper(this,PopupAnnotationElement,[parameters,{isRenderable:!!(null!==(_parameters$data$titl2=parameters.data.titleObj)&&void 0!==_parameters$data$titl2&&_parameters$data$titl2.str||null!==(_parameters$data$cont2=parameters.data.contentsObj)&&void 0!==_parameters$data$cont2&&_parameters$data$cont2.str||null!==(_parameters$data$rich2=parameters.data.richText)&&void 0!==_parameters$data$rich2&&_parameters$data$rich2.str)}])}return _inherits(PopupAnnotationElement,_AnnotationElement4),_createClass(PopupAnnotationElement,[{key:"render",value:function(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;var selector='[data-annotation-id="'.concat(this.data.parentId,'"]'),parentElements=this.layer.querySelectorAll(selector);if(0===parentElements.length)return this.container;var popup=new PopupElement({container:this.container,trigger:Array.from(parentElements),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText}),page=this.page,rect=_util.Util.normalizeRect([this.data.parentRect[0],page.view[3]-this.data.parentRect[1]+page.view[1],this.data.parentRect[2],page.view[3]-this.data.parentRect[3]+page.view[1]]),popupLeft=rect[0]+this.data.parentRect[2]-this.data.parentRect[0],popupTop=rect[1],_this$viewport$viewBo3=_slicedToArray(this.viewport.viewBox,4),pageLLx=_this$viewport$viewBo3[0],pageLLy=_this$viewport$viewBo3[1],pageWidth=_this$viewport$viewBo3[2]-pageLLx,pageHeight=_this$viewport$viewBo3[3]-pageLLy;return this.container.style.left="".concat(100*(popupLeft-pageLLx)/pageWidth,"%"),this.container.style.top="".concat(100*(popupTop-pageLLy)/pageHeight,"%"),this.container.append(popup.render()),this.container}}]),PopupAnnotationElement}(AnnotationElement),PopupElement=function(){function PopupElement(parameters){_classCallCheck(this,PopupElement),this.container=parameters.container,this.trigger=parameters.trigger,this.color=parameters.color,this.titleObj=parameters.titleObj,this.modificationDate=parameters.modificationDate,this.contentsObj=parameters.contentsObj,this.richText=parameters.richText,this.hideWrapper=parameters.hideWrapper||!1,this.pinned=!1}return _createClass(PopupElement,[{key:"render",value:function(){var _this$richText,_this$contentsObj,wrapper=document.createElement("div");wrapper.className="popupWrapper",this.hideElement=this.hideWrapper?wrapper:this.container,this.hideElement.hidden=!0;var popup=document.createElement("div");popup.className="popup";var color=this.color;if(color){var r=.7*(255-color[0])+color[0],g=.7*(255-color[1])+color[1],b=.7*(255-color[2])+color[2];popup.style.backgroundColor=_util.Util.makeHexColor(0|r,0|g,0|b)}var title=document.createElement("h1");title.dir=this.titleObj.dir,title.textContent=this.titleObj.str,popup.append(title);var dateObject=_display_utils.PDFDateString.toDateObject(this.modificationDate);if(dateObject){var modificationDate=document.createElement("span");modificationDate.className="popupDate",modificationDate.textContent="{{date}}, {{time}}",modificationDate.dataset.l10nId="annotation_date_string",modificationDate.dataset.l10nArgs=JSON.stringify({date:dateObject.toLocaleDateString(),time:dateObject.toLocaleTimeString()}),popup.append(modificationDate)}if(null===(_this$richText=this.richText)||void 0===_this$richText||!_this$richText.str||null!==(_this$contentsObj=this.contentsObj)&&void 0!==_this$contentsObj&&_this$contentsObj.str&&this.contentsObj.str!==this.richText.str){var contents=this._formatContents(this.contentsObj);popup.append(contents)}else _xfa_layer.XfaLayer.render({xfaHtml:this.richText.html,intent:"richText",div:popup}),popup.lastChild.className="richText popupContent";Array.isArray(this.trigger)||(this.trigger=[this.trigger]);var _step104,_iterator104=_createForOfIteratorHelper(this.trigger);try{for(_iterator104.s();!(_step104=_iterator104.n()).done;){var element=_step104.value;element.addEventListener("click",this._toggle.bind(this)),element.addEventListener("mouseover",this._show.bind(this,!1)),element.addEventListener("mouseout",this._hide.bind(this,!1))}}catch(err){_iterator104.e(err)}finally{_iterator104.f()}return popup.addEventListener("click",this._hide.bind(this,!0)),wrapper.append(popup),wrapper}},{key:"_formatContents",value:function(_ref){var str=_ref.str,dir=_ref.dir,p=document.createElement("p");p.className="popupContent",p.dir=dir;for(var lines=str.split(/(?:\r\n?|\n)/),i=0,ii=lines.length;i<ii;++i){var line=lines[i];p.append(document.createTextNode(line)),i<ii-1&&p.append(document.createElement("br"))}return p}},{key:"_toggle",value:function(){this.pinned?this._hide(!0):this._show(!0)}},{key:"_show",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex=parseInt(this.container.style.zIndex)+1e3)}},{key:"_hide",value:function(){(!(arguments.length>0&&void 0!==arguments[0])||arguments[0])&&(this.pinned=!1),this.hideElement.hidden||this.pinned||(this.hideElement.hidden=!0,this.container.style.zIndex=parseInt(this.container.style.zIndex)-1e3)}}]),PopupElement}(),FreeTextAnnotationElement=function(_AnnotationElement5){function FreeTextAnnotationElement(parameters){var _this64,_parameters$data$titl3,_parameters$data$cont3,_parameters$data$rich3;return _classCallCheck(this,FreeTextAnnotationElement),(_this64=_callSuper(this,FreeTextAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl3=parameters.data.titleObj)&&void 0!==_parameters$data$titl3&&_parameters$data$titl3.str||null!==(_parameters$data$cont3=parameters.data.contentsObj)&&void 0!==_parameters$data$cont3&&_parameters$data$cont3.str||null!==(_parameters$data$rich3=parameters.data.richText)&&void 0!==_parameters$data$rich3&&_parameters$data$rich3.str),ignoreBorder:!0}])).textContent=parameters.data.textContent,_this64}return _inherits(FreeTextAnnotationElement,_AnnotationElement5),_createClass(FreeTextAnnotationElement,[{key:"render",value:function(){if(this.container.className="freeTextAnnotation",this.textContent){var content=document.createElement("div");content.className="annotationTextContent",content.setAttribute("role","comment");var _step105,_iterator105=_createForOfIteratorHelper(this.textContent);try{for(_iterator105.s();!(_step105=_iterator105.n()).done;){var line=_step105.value,lineSpan=document.createElement("span");lineSpan.textContent=line,content.append(lineSpan)}}catch(err){_iterator105.e(err)}finally{_iterator105.f()}this.container.append(content)}return this.data.hasPopup||this._createPopup(null,this.data),this.container}}]),FreeTextAnnotationElement}(AnnotationElement),LineAnnotationElement=function(_AnnotationElement6){function LineAnnotationElement(parameters){var _parameters$data$titl4,_parameters$data$cont4,_parameters$data$rich4;return _classCallCheck(this,LineAnnotationElement),_callSuper(this,LineAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl4=parameters.data.titleObj)&&void 0!==_parameters$data$titl4&&_parameters$data$titl4.str||null!==(_parameters$data$cont4=parameters.data.contentsObj)&&void 0!==_parameters$data$cont4&&_parameters$data$cont4.str||null!==(_parameters$data$rich4=parameters.data.richText)&&void 0!==_parameters$data$rich4&&_parameters$data$rich4.str),ignoreBorder:!0}])}return _inherits(LineAnnotationElement,_AnnotationElement6),_createClass(LineAnnotationElement,[{key:"render",value:function(){this.container.className="lineAnnotation";var data=this.data,_getRectDims3=getRectDims(data.rect),width=_getRectDims3.width,height=_getRectDims3.height,svg=this.svgFactory.create(width,height,!0),line=this.svgFactory.createElement("svg:line");return line.setAttribute("x1",data.rect[2]-data.lineCoordinates[0]),line.setAttribute("y1",data.rect[3]-data.lineCoordinates[1]),line.setAttribute("x2",data.rect[2]-data.lineCoordinates[2]),line.setAttribute("y2",data.rect[3]-data.lineCoordinates[3]),line.setAttribute("stroke-width",data.borderStyle.width||1),line.setAttribute("stroke","transparent"),line.setAttribute("fill","transparent"),svg.append(line),this.container.append(svg),this._createPopup(line,data),this.container}}]),LineAnnotationElement}(AnnotationElement),SquareAnnotationElement=function(_AnnotationElement7){function SquareAnnotationElement(parameters){var _parameters$data$titl5,_parameters$data$cont5,_parameters$data$rich5;return _classCallCheck(this,SquareAnnotationElement),_callSuper(this,SquareAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl5=parameters.data.titleObj)&&void 0!==_parameters$data$titl5&&_parameters$data$titl5.str||null!==(_parameters$data$cont5=parameters.data.contentsObj)&&void 0!==_parameters$data$cont5&&_parameters$data$cont5.str||null!==(_parameters$data$rich5=parameters.data.richText)&&void 0!==_parameters$data$rich5&&_parameters$data$rich5.str),ignoreBorder:!0}])}return _inherits(SquareAnnotationElement,_AnnotationElement7),_createClass(SquareAnnotationElement,[{key:"render",value:function(){this.container.className="squareAnnotation";var data=this.data,_getRectDims4=getRectDims(data.rect),width=_getRectDims4.width,height=_getRectDims4.height,svg=this.svgFactory.create(width,height,!0),borderWidth=data.borderStyle.width,square=this.svgFactory.createElement("svg:rect");return square.setAttribute("x",borderWidth/2),square.setAttribute("y",borderWidth/2),square.setAttribute("width",width-borderWidth),square.setAttribute("height",height-borderWidth),square.setAttribute("stroke-width",borderWidth||1),square.setAttribute("stroke","transparent"),square.setAttribute("fill","transparent"),svg.append(square),this.container.append(svg),this._createPopup(square,data),this.container}}]),SquareAnnotationElement}(AnnotationElement),CircleAnnotationElement=function(_AnnotationElement8){function CircleAnnotationElement(parameters){var _parameters$data$titl6,_parameters$data$cont6,_parameters$data$rich6;return _classCallCheck(this,CircleAnnotationElement),_callSuper(this,CircleAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl6=parameters.data.titleObj)&&void 0!==_parameters$data$titl6&&_parameters$data$titl6.str||null!==(_parameters$data$cont6=parameters.data.contentsObj)&&void 0!==_parameters$data$cont6&&_parameters$data$cont6.str||null!==(_parameters$data$rich6=parameters.data.richText)&&void 0!==_parameters$data$rich6&&_parameters$data$rich6.str),ignoreBorder:!0}])}return _inherits(CircleAnnotationElement,_AnnotationElement8),_createClass(CircleAnnotationElement,[{key:"render",value:function(){this.container.className="circleAnnotation";var data=this.data,_getRectDims5=getRectDims(data.rect),width=_getRectDims5.width,height=_getRectDims5.height,svg=this.svgFactory.create(width,height,!0),borderWidth=data.borderStyle.width,circle=this.svgFactory.createElement("svg:ellipse");return circle.setAttribute("cx",width/2),circle.setAttribute("cy",height/2),circle.setAttribute("rx",width/2-borderWidth/2),circle.setAttribute("ry",height/2-borderWidth/2),circle.setAttribute("stroke-width",borderWidth||1),circle.setAttribute("stroke","transparent"),circle.setAttribute("fill","transparent"),svg.append(circle),this.container.append(svg),this._createPopup(circle,data),this.container}}]),CircleAnnotationElement}(AnnotationElement),PolylineAnnotationElement=function(_AnnotationElement9){function PolylineAnnotationElement(parameters){var _this65,_parameters$data$titl7,_parameters$data$cont7,_parameters$data$rich7;return _classCallCheck(this,PolylineAnnotationElement),(_this65=_callSuper(this,PolylineAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl7=parameters.data.titleObj)&&void 0!==_parameters$data$titl7&&_parameters$data$titl7.str||null!==(_parameters$data$cont7=parameters.data.contentsObj)&&void 0!==_parameters$data$cont7&&_parameters$data$cont7.str||null!==(_parameters$data$rich7=parameters.data.richText)&&void 0!==_parameters$data$rich7&&_parameters$data$rich7.str),ignoreBorder:!0}])).containerClassName="polylineAnnotation",_this65.svgElementName="svg:polyline",_this65}return _inherits(PolylineAnnotationElement,_AnnotationElement9),_createClass(PolylineAnnotationElement,[{key:"render",value:function(){this.container.className=this.containerClassName;var _step106,data=this.data,_getRectDims6=getRectDims(data.rect),width=_getRectDims6.width,height=_getRectDims6.height,svg=this.svgFactory.create(width,height,!0),points=[],_iterator106=_createForOfIteratorHelper(data.vertices);try{for(_iterator106.s();!(_step106=_iterator106.n()).done;){var coordinate=_step106.value,x=coordinate.x-data.rect[0],y=data.rect[3]-coordinate.y;points.push(x+","+y)}}catch(err){_iterator106.e(err)}finally{_iterator106.f()}points=points.join(" ");var polyline=this.svgFactory.createElement(this.svgElementName);return polyline.setAttribute("points",points),polyline.setAttribute("stroke-width",data.borderStyle.width||1),polyline.setAttribute("stroke","transparent"),polyline.setAttribute("fill","transparent"),svg.append(polyline),this.container.append(svg),this._createPopup(polyline,data),this.container}}]),PolylineAnnotationElement}(AnnotationElement),PolygonAnnotationElement=function(_PolylineAnnotationEl){function PolygonAnnotationElement(parameters){var _this66;return _classCallCheck(this,PolygonAnnotationElement),(_this66=_callSuper(this,PolygonAnnotationElement,[parameters])).containerClassName="polygonAnnotation",_this66.svgElementName="svg:polygon",_this66}return _inherits(PolygonAnnotationElement,_PolylineAnnotationEl),_createClass(PolygonAnnotationElement)}(PolylineAnnotationElement),CaretAnnotationElement=function(_AnnotationElement10){function CaretAnnotationElement(parameters){var _parameters$data$titl8,_parameters$data$cont8,_parameters$data$rich8;return _classCallCheck(this,CaretAnnotationElement),_callSuper(this,CaretAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl8=parameters.data.titleObj)&&void 0!==_parameters$data$titl8&&_parameters$data$titl8.str||null!==(_parameters$data$cont8=parameters.data.contentsObj)&&void 0!==_parameters$data$cont8&&_parameters$data$cont8.str||null!==(_parameters$data$rich8=parameters.data.richText)&&void 0!==_parameters$data$rich8&&_parameters$data$rich8.str),ignoreBorder:!0}])}return _inherits(CaretAnnotationElement,_AnnotationElement10),_createClass(CaretAnnotationElement,[{key:"render",value:function(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}]),CaretAnnotationElement}(AnnotationElement),InkAnnotationElement=function(_AnnotationElement11){function InkAnnotationElement(parameters){var _this67,_parameters$data$titl9,_parameters$data$cont9,_parameters$data$rich9;return _classCallCheck(this,InkAnnotationElement),(_this67=_callSuper(this,InkAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl9=parameters.data.titleObj)&&void 0!==_parameters$data$titl9&&_parameters$data$titl9.str||null!==(_parameters$data$cont9=parameters.data.contentsObj)&&void 0!==_parameters$data$cont9&&_parameters$data$cont9.str||null!==(_parameters$data$rich9=parameters.data.richText)&&void 0!==_parameters$data$rich9&&_parameters$data$rich9.str),ignoreBorder:!0}])).containerClassName="inkAnnotation",_this67.svgElementName="svg:polyline",_this67}return _inherits(InkAnnotationElement,_AnnotationElement11),_createClass(InkAnnotationElement,[{key:"render",value:function(){this.container.className=this.containerClassName;var _step107,data=this.data,_getRectDims7=getRectDims(data.rect),width=_getRectDims7.width,height=_getRectDims7.height,svg=this.svgFactory.create(width,height,!0),_iterator107=_createForOfIteratorHelper(data.inkLists);try{for(_iterator107.s();!(_step107=_iterator107.n()).done;){var _step108,inkList=_step107.value,points=[],_iterator108=_createForOfIteratorHelper(inkList);try{for(_iterator108.s();!(_step108=_iterator108.n()).done;){var coordinate=_step108.value,x=coordinate.x-data.rect[0],y=data.rect[3]-coordinate.y;points.push("".concat(x,",").concat(y))}}catch(err){_iterator108.e(err)}finally{_iterator108.f()}points=points.join(" ");var polyline=this.svgFactory.createElement(this.svgElementName);polyline.setAttribute("points",points),polyline.setAttribute("stroke-width",data.borderStyle.width||1),polyline.setAttribute("stroke","transparent"),polyline.setAttribute("fill","transparent"),this._createPopup(polyline,data),svg.append(polyline)}}catch(err){_iterator107.e(err)}finally{_iterator107.f()}return this.container.append(svg),this.container}}]),InkAnnotationElement}(AnnotationElement),HighlightAnnotationElement=function(_AnnotationElement12){function HighlightAnnotationElement(parameters){var _parameters$data$titl10,_parameters$data$cont10,_parameters$data$rich10;return _classCallCheck(this,HighlightAnnotationElement),_callSuper(this,HighlightAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl10=parameters.data.titleObj)&&void 0!==_parameters$data$titl10&&_parameters$data$titl10.str||null!==(_parameters$data$cont10=parameters.data.contentsObj)&&void 0!==_parameters$data$cont10&&_parameters$data$cont10.str||null!==(_parameters$data$rich10=parameters.data.richText)&&void 0!==_parameters$data$rich10&&_parameters$data$rich10.str),ignoreBorder:!0,createQuadrilaterals:!0}])}return _inherits(HighlightAnnotationElement,_AnnotationElement12),_createClass(HighlightAnnotationElement,[{key:"render",value:function(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}]),HighlightAnnotationElement}(AnnotationElement),UnderlineAnnotationElement=function(_AnnotationElement13){function UnderlineAnnotationElement(parameters){var _parameters$data$titl11,_parameters$data$cont11,_parameters$data$rich11;return _classCallCheck(this,UnderlineAnnotationElement),_callSuper(this,UnderlineAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl11=parameters.data.titleObj)&&void 0!==_parameters$data$titl11&&_parameters$data$titl11.str||null!==(_parameters$data$cont11=parameters.data.contentsObj)&&void 0!==_parameters$data$cont11&&_parameters$data$cont11.str||null!==(_parameters$data$rich11=parameters.data.richText)&&void 0!==_parameters$data$rich11&&_parameters$data$rich11.str),ignoreBorder:!0,createQuadrilaterals:!0}])}return _inherits(UnderlineAnnotationElement,_AnnotationElement13),_createClass(UnderlineAnnotationElement,[{key:"render",value:function(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}]),UnderlineAnnotationElement}(AnnotationElement),SquigglyAnnotationElement=function(_AnnotationElement14){function SquigglyAnnotationElement(parameters){var _parameters$data$titl12,_parameters$data$cont12,_parameters$data$rich12;return _classCallCheck(this,SquigglyAnnotationElement),_callSuper(this,SquigglyAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl12=parameters.data.titleObj)&&void 0!==_parameters$data$titl12&&_parameters$data$titl12.str||null!==(_parameters$data$cont12=parameters.data.contentsObj)&&void 0!==_parameters$data$cont12&&_parameters$data$cont12.str||null!==(_parameters$data$rich12=parameters.data.richText)&&void 0!==_parameters$data$rich12&&_parameters$data$rich12.str),ignoreBorder:!0,createQuadrilaterals:!0}])}return _inherits(SquigglyAnnotationElement,_AnnotationElement14),_createClass(SquigglyAnnotationElement,[{key:"render",value:function(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}]),SquigglyAnnotationElement}(AnnotationElement),StrikeOutAnnotationElement=function(_AnnotationElement15){function StrikeOutAnnotationElement(parameters){var _parameters$data$titl13,_parameters$data$cont13,_parameters$data$rich13;return _classCallCheck(this,StrikeOutAnnotationElement),_callSuper(this,StrikeOutAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl13=parameters.data.titleObj)&&void 0!==_parameters$data$titl13&&_parameters$data$titl13.str||null!==(_parameters$data$cont13=parameters.data.contentsObj)&&void 0!==_parameters$data$cont13&&_parameters$data$cont13.str||null!==(_parameters$data$rich13=parameters.data.richText)&&void 0!==_parameters$data$rich13&&_parameters$data$rich13.str),ignoreBorder:!0,createQuadrilaterals:!0}])}return _inherits(StrikeOutAnnotationElement,_AnnotationElement15),_createClass(StrikeOutAnnotationElement,[{key:"render",value:function(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}]),StrikeOutAnnotationElement}(AnnotationElement),StampAnnotationElement=function(_AnnotationElement16){function StampAnnotationElement(parameters){var _parameters$data$titl14,_parameters$data$cont14,_parameters$data$rich14;return _classCallCheck(this,StampAnnotationElement),_callSuper(this,StampAnnotationElement,[parameters,{isRenderable:!!(parameters.data.hasPopup||null!==(_parameters$data$titl14=parameters.data.titleObj)&&void 0!==_parameters$data$titl14&&_parameters$data$titl14.str||null!==(_parameters$data$cont14=parameters.data.contentsObj)&&void 0!==_parameters$data$cont14&&_parameters$data$cont14.str||null!==(_parameters$data$rich14=parameters.data.richText)&&void 0!==_parameters$data$rich14&&_parameters$data$rich14.str),ignoreBorder:!0}])}return _inherits(StampAnnotationElement,_AnnotationElement16),_createClass(StampAnnotationElement,[{key:"render",value:function(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}]),StampAnnotationElement}(AnnotationElement),FileAttachmentAnnotationElement=function(_AnnotationElement17){function FileAttachmentAnnotationElement(parameters){var _this68,_this$linkService$eve10;_classCallCheck(this,FileAttachmentAnnotationElement);var _this68$data$file=(_this68=_callSuper(this,FileAttachmentAnnotationElement,[parameters,{isRenderable:!0}])).data.file,filename=_this68$data$file.filename,content=_this68$data$file.content;return _this68.filename=(0,_display_utils.getFilenameFromUrl)(filename),_this68.content=content,null===(_this$linkService$eve10=_this68.linkService.eventBus)||void 0===_this$linkService$eve10||_this$linkService$eve10.dispatch("fileattachmentannotation",{source:_assertThisInitialized(_this68),filename:filename,content:content}),_this68}return _inherits(FileAttachmentAnnotationElement,_AnnotationElement17),_createClass(FileAttachmentAnnotationElement,[{key:"render",value:function(){var _this$data$titleObj,_this$data$contentsOb;this.container.className="fileAttachmentAnnotation";var trigger=document.createElement("div");return trigger.className="popupTriggerArea",trigger.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&(null!==(_this$data$titleObj=this.data.titleObj)&&void 0!==_this$data$titleObj&&_this$data$titleObj.str||null!==(_this$data$contentsOb=this.data.contentsObj)&&void 0!==_this$data$contentsOb&&_this$data$contentsOb.str||this.data.richText)&&this._createPopup(trigger,this.data),this.container.append(trigger),this.container}},{key:"_download",value:function(){var _this$downloadManager;null===(_this$downloadManager=this.downloadManager)||void 0===_this$downloadManager||_this$downloadManager.openOrDownloadData(this.container,this.content,this.filename)}}]),FileAttachmentAnnotationElement}(AnnotationElement),AnnotationLayer=function(){function AnnotationLayer(){_classCallCheck(this,AnnotationLayer)}return _createClass(AnnotationLayer,null,[{key:"render",value:function(parameters){var annotations=parameters.annotations,div=parameters.div,viewport=parameters.viewport,accessibilityManager=parameters.accessibilityManager;_classStaticPrivateMethodGet(this,AnnotationLayer,_setDimensions).call(this,div,viewport);var _step109,zIndex=0,_iterator109=_createForOfIteratorHelper(annotations);try{for(_iterator109.s();!(_step109=_iterator109.n()).done;){var data=_step109.value;if(data.annotationType!==_util.AnnotationType.POPUP){var _getRectDims8=getRectDims(data.rect),width=_getRectDims8.width,height=_getRectDims8.height;if(width<=0||height<=0)continue}var element=AnnotationElementFactory.create({data:data,layer:div,page:parameters.page,viewport:viewport,linkService:parameters.linkService,downloadManager:parameters.downloadManager,imageResourcesPath:parameters.imageResourcesPath||"",renderForms:!1!==parameters.renderForms,svgFactory:new _display_utils.DOMSVGFactory,annotationStorage:parameters.annotationStorage||new _annotation_storage.AnnotationStorage,enableScripting:parameters.enableScripting,hasJSActions:parameters.hasJSActions,fieldObjects:parameters.fieldObjects,mouseState:parameters.mouseState||{isDown:!1}});if(element.isRenderable){var rendered=element.render();if(data.hidden&&(rendered.style.visibility="hidden"),Array.isArray(rendered)){var _step110,_iterator110=_createForOfIteratorHelper(rendered);try{for(_iterator110.s();!(_step110=_iterator110.n()).done;){var renderedElement=_step110.value;renderedElement.style.zIndex=zIndex++,_classStaticPrivateMethodGet(AnnotationLayer,AnnotationLayer,_appendElement).call(AnnotationLayer,renderedElement,data.id,div,accessibilityManager)}}catch(err){_iterator110.e(err)}finally{_iterator110.f()}}else rendered.style.zIndex=zIndex++,element instanceof PopupAnnotationElement?div.prepend(rendered):_classStaticPrivateMethodGet(AnnotationLayer,AnnotationLayer,_appendElement).call(AnnotationLayer,rendered,data.id,div,accessibilityManager)}}}catch(err){_iterator109.e(err)}finally{_iterator109.f()}_classStaticPrivateMethodGet(this,AnnotationLayer,_setAnnotationCanvasMap).call(this,div,parameters.annotationCanvasMap)}},{key:"update",value:function(parameters){var annotationCanvasMap=parameters.annotationCanvasMap,div=parameters.div,viewport=parameters.viewport;_classStaticPrivateMethodGet(this,AnnotationLayer,_setDimensions).call(this,div,viewport),_classStaticPrivateMethodGet(this,AnnotationLayer,_setAnnotationCanvasMap).call(this,div,annotationCanvasMap),div.hidden=!1}}]),AnnotationLayer}();function _appendElement(element,id,div,accessibilityManager){var contentElement=element.firstChild||element;contentElement.id="".concat(_display_utils.AnnotationPrefix).concat(id),div.append(element),null==accessibilityManager||accessibilityManager.moveElementInDOM(div,element,contentElement,!1)}function _setDimensions(div,_ref2){var width=_ref2.width,height=_ref2.height,rotation=_ref2.rotation,style=div.style,flipOrientation=rotation%180!=0,widthStr=Math.floor(width)+"px",heightStr=Math.floor(height)+"px";style.width=flipOrientation?heightStr:widthStr,style.height=flipOrientation?widthStr:heightStr,div.setAttribute("data-main-rotation",rotation)}function _setAnnotationCanvasMap(div,annotationCanvasMap){if(annotationCanvasMap){var _step111,_iterator111=_createForOfIteratorHelper(annotationCanvasMap);try{for(_iterator111.s();!(_step111=_iterator111.n()).done;){var _step111$value=_slicedToArray(_step111.value,2),id=_step111$value[0],canvas=_step111$value[1],element=div.querySelector('[data-annotation-id="'.concat(id,'"]'));if(element){var firstChild=element.firstChild;firstChild?"CANVAS"===firstChild.nodeName?firstChild.replaceWith(canvas):firstChild.before(canvas):element.append(canvas)}}}catch(err){_iterator111.e(err)}finally{_iterator111.f()}annotationCanvasMap.clear()}}exports.AnnotationLayer=AnnotationLayer},function(__unused_webpack_module,exports){"use strict";function makeColorComp(n){return Math.floor(255*Math.max(0,Math.min(1,n))).toString(16).padStart(2,"0")}Object.defineProperty(exports,"__esModule",{value:!0}),exports.ColorConverters=void 0;var ColorConverters=function(){function ColorConverters(){_classCallCheck(this,ColorConverters)}return _createClass(ColorConverters,null,[{key:"CMYK_G",value:function(_ref){var _ref40=_slicedToArray(_ref,4),c=_ref40[0],y=_ref40[1],m=_ref40[2],k=_ref40[3];return["G",1-Math.min(1,.3*c+.59*m+.11*y+k)]}},{key:"G_CMYK",value:function(_ref2){return["CMYK",0,0,0,1-_slicedToArray(_ref2,1)[0]]}},{key:"G_RGB",value:function(_ref3){var g=_slicedToArray(_ref3,1)[0];return["RGB",g,g,g]}},{key:"G_HTML",value:function(_ref4){var G=makeColorComp(_slicedToArray(_ref4,1)[0]);return"#".concat(G).concat(G).concat(G)}},{key:"RGB_G",value:function(_ref5){var _ref44=_slicedToArray(_ref5,3);return["G",.3*_ref44[0]+.59*_ref44[1]+.11*_ref44[2]]}},{key:"RGB_HTML",value:function(_ref6){var _ref45=_slicedToArray(_ref6,3),r=_ref45[0],g=_ref45[1],b=_ref45[2],R=makeColorComp(r),G=makeColorComp(g),B=makeColorComp(b);return"#".concat(R).concat(G).concat(B)}},{key:"T_HTML",value:function(){return"#00000000"}},{key:"CMYK_RGB",value:function(_ref7){var _ref46=_slicedToArray(_ref7,4),c=_ref46[0],y=_ref46[1],m=_ref46[2],k=_ref46[3];return["RGB",1-Math.min(1,c+k),1-Math.min(1,m+k),1-Math.min(1,y+k)]}},{key:"CMYK_HTML",value:function(components){var rgb=this.CMYK_RGB(components).slice(1);return this.RGB_HTML(rgb)}},{key:"RGB_CMYK",value:function(_ref8){var _ref47=_slicedToArray(_ref8,3),c=1-_ref47[0],m=1-_ref47[1],y=1-_ref47[2];return["CMYK",c,m,y,Math.min(c,m,y)]}}]),ColorConverters}();exports.ColorConverters=ColorConverters},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.XfaLayer=void 0;var _xfa_text=__w_pdfjs_require__(145),XfaLayer=function(){function XfaLayer(){_classCallCheck(this,XfaLayer)}return _createClass(XfaLayer,null,[{key:"setupStorage",value:function(html,id,element,storage,intent){var storedData=storage.getValue(id,{value:null});switch(element.name){case"textarea":if(null!==storedData.value&&(html.textContent=storedData.value),"print"===intent)break;html.addEventListener("input",(function(event){storage.setValue(id,{value:event.target.value})}));break;case"input":if("radio"===element.attributes.type||"checkbox"===element.attributes.type){if(storedData.value===element.attributes.xfaOn?html.setAttribute("checked",!0):storedData.value===element.attributes.xfaOff&&html.removeAttribute("checked"),"print"===intent)break;html.addEventListener("change",(function(event){storage.setValue(id,{value:event.target.checked?event.target.getAttribute("xfaOn"):event.target.getAttribute("xfaOff")})}))}else{if(null!==storedData.value&&html.setAttribute("value",storedData.value),"print"===intent)break;html.addEventListener("input",(function(event){storage.setValue(id,{value:event.target.value})}))}break;case"select":if(null!==storedData.value){var _step112,_iterator112=_createForOfIteratorHelper(element.children);try{for(_iterator112.s();!(_step112=_iterator112.n()).done;){var option=_step112.value;option.attributes.value===storedData.value&&(option.attributes.selected=!0)}}catch(err){_iterator112.e(err)}finally{_iterator112.f()}}html.addEventListener("input",(function(event){var options=event.target.options,value=-1===options.selectedIndex?"":options[options.selectedIndex].value;storage.setValue(id,{value:value})}))}}},{key:"setAttributes",value:function(_ref){var html=_ref.html,element=_ref.element,_ref$storage=_ref.storage,storage=void 0===_ref$storage?null:_ref$storage,intent=_ref.intent,linkService=_ref.linkService,attributes=element.attributes,isHTMLAnchorElement=html instanceof HTMLAnchorElement;"radio"===attributes.type&&(attributes.name="".concat(attributes.name,"-").concat(intent));for(var _i11=0,_Object$entries3=Object.entries(attributes);_i11<_Object$entries3.length;_i11++){var _Object$entries3$_i=_slicedToArray(_Object$entries3[_i11],2),key=_Object$entries3$_i[0],value=_Object$entries3$_i[1];if(null!=value)switch(key){case"class":value.length&&html.setAttribute(key,value.join(" "));break;case"dataId":break;case"id":html.setAttribute("data-element-id",value);break;case"style":Object.assign(html.style,value);break;case"textContent":html.textContent=value;break;default:(!isHTMLAnchorElement||"href"!==key&&"newWindow"!==key)&&html.setAttribute(key,value)}}isHTMLAnchorElement&&linkService.addLinkAttributes(html,attributes.href,attributes.newWindow),storage&&attributes.dataId&&this.setupStorage(html,attributes.dataId,element,storage)}},{key:"render",value:function(parameters){var storage=parameters.annotationStorage,linkService=parameters.linkService,root=parameters.xfaHtml,intent=parameters.intent||"display",rootHtml=document.createElement(root.name);root.attributes&&this.setAttributes({html:rootHtml,element:root,intent:intent,linkService:linkService});var stack=[[root,-1,rootHtml]],rootDiv=parameters.div;if(rootDiv.append(rootHtml),parameters.viewport){var transform="matrix(".concat(parameters.viewport.transform.join(","),")");rootDiv.style.transform=transform}"richText"!==intent&&rootDiv.setAttribute("class","xfaLayer xfaFont");for(var textDivs=[];stack.length>0;){var _child$attributes,_stack$at2=_slicedToArray(stack.at(-1),3),parent=_stack$at2[0],i=_stack$at2[1],html=_stack$at2[2];if(i+1!==parent.children.length){var child=parent.children[++stack.at(-1)[1]];if(null!==child){var name=child.name;if("#text"!==name){var childHtml=void 0;if(childHtml=null!=child&&null!==(_child$attributes=child.attributes)&&void 0!==_child$attributes&&_child$attributes.xmlns?document.createElementNS(child.attributes.xmlns,name):document.createElement(name),html.append(childHtml),child.attributes&&this.setAttributes({html:childHtml,element:child,storage:storage,intent:intent,linkService:linkService}),child.children&&child.children.length>0)stack.push([child,-1,childHtml]);else if(child.value){var _node=document.createTextNode(child.value);_xfa_text.XfaText.shouldBuildText(name)&&textDivs.push(_node),childHtml.append(_node)}}else{var node=document.createTextNode(child.value);textDivs.push(node),html.append(node)}}}else stack.pop()}var _step113,_iterator113=_createForOfIteratorHelper(rootDiv.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"));try{for(_iterator113.s();!(_step113=_iterator113.n()).done;)_step113.value.setAttribute("readOnly",!0)}catch(err){_iterator113.e(err)}finally{_iterator113.f()}return{textDivs:textDivs}}},{key:"update",value:function(parameters){var transform="matrix(".concat(parameters.viewport.transform.join(","),")");parameters.div.style.transform=transform,parameters.div.hidden=!1}}]),XfaLayer}();exports.XfaLayer=XfaLayer},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TextLayerRenderTask=void 0,exports.renderTextLayer=function(renderParameters){var task=new TextLayerRenderTask({textContent:renderParameters.textContent,textContentStream:renderParameters.textContentStream,container:renderParameters.container,viewport:renderParameters.viewport,textDivs:renderParameters.textDivs,textContentItemsStr:renderParameters.textContentItemsStr,enhanceTextSelection:renderParameters.enhanceTextSelection});return task._render(renderParameters.timeout),task};var _util=__w_pdfjs_require__(1),_display_utils=__w_pdfjs_require__(133),DEFAULT_FONT_SIZE=30,DEFAULT_FONT_ASCENT=.8,ascentCache=new Map,AllWhitespaceRegexp=/^\s+$/g;function appendText(task,geom,styles,ctx){var textDiv=document.createElement("span"),textDivProperties=task._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:""!==geom.str,hasEOL:geom.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1,fontSize:0}:{angle:0,canvasWidth:0,hasText:""!==geom.str,hasEOL:geom.hasEOL,fontSize:0};task._textDivs.push(textDiv);var tx=_util.Util.transform(task._viewport.transform,geom.transform),angle=Math.atan2(tx[1],tx[0]),style=styles[geom.fontName];style.vertical&&(angle+=Math.PI/2);var left,top,fontHeight=Math.hypot(tx[2],tx[3]),fontAscent=fontHeight*function(fontFamily,ctx){var cachedAscent=ascentCache.get(fontFamily);if(cachedAscent)return cachedAscent;ctx.save(),ctx.font="".concat(DEFAULT_FONT_SIZE,"px ").concat(fontFamily);var metrics=ctx.measureText(""),ascent=metrics.fontBoundingBoxAscent,descent=Math.abs(metrics.fontBoundingBoxDescent);if(ascent){ctx.restore();var ratio=ascent/(ascent+descent);return ascentCache.set(fontFamily,ratio),ratio}ctx.strokeStyle="red",ctx.clearRect(0,0,DEFAULT_FONT_SIZE,DEFAULT_FONT_SIZE),ctx.strokeText("g",0,0);var pixels=ctx.getImageData(0,0,DEFAULT_FONT_SIZE,DEFAULT_FONT_SIZE).data;descent=0;for(var i=pixels.length-1-3;i>=0;i-=4)if(pixels[i]>0){descent=Math.ceil(i/4/DEFAULT_FONT_SIZE);break}ctx.clearRect(0,0,DEFAULT_FONT_SIZE,DEFAULT_FONT_SIZE),ctx.strokeText("A",0,DEFAULT_FONT_SIZE),ascent=0;for(var _i12=0,ii=(pixels=ctx.getImageData(0,0,DEFAULT_FONT_SIZE,DEFAULT_FONT_SIZE).data).length;_i12<ii;_i12+=4)if(pixels[_i12]>0){ascent=DEFAULT_FONT_SIZE-Math.floor(_i12/4/DEFAULT_FONT_SIZE);break}if(ctx.restore(),ascent){var _ratio=ascent/(ascent+descent);return ascentCache.set(fontFamily,_ratio),_ratio}return ascentCache.set(fontFamily,DEFAULT_FONT_ASCENT),DEFAULT_FONT_ASCENT}(style.fontFamily,ctx);0===angle?(left=tx[4],top=tx[5]-fontAscent):(left=tx[4]+fontAscent*Math.sin(angle),top=tx[5]-fontAscent*Math.cos(angle)),textDiv.style.left="".concat(left,"px"),textDiv.style.top="".concat(top,"px"),textDiv.style.fontSize="".concat(fontHeight,"px"),textDiv.style.fontFamily=style.fontFamily,textDivProperties.fontSize=fontHeight,textDiv.setAttribute("role","presentation"),textDiv.textContent=geom.str,textDiv.dir=geom.dir,task._fontInspectorEnabled&&(textDiv.dataset.fontName=geom.fontName),0!==angle&&(textDivProperties.angle=angle*(180/Math.PI));var shouldScaleText=!1;if(geom.str.length>1||task._enhanceTextSelection&&AllWhitespaceRegexp.test(geom.str))shouldScaleText=!0;else if(" "!==geom.str&&geom.transform[0]!==geom.transform[3]){var absScaleX=Math.abs(geom.transform[0]),absScaleY=Math.abs(geom.transform[3]);absScaleX!==absScaleY&&Math.max(absScaleX,absScaleY)/Math.min(absScaleX,absScaleY)>1.5&&(shouldScaleText=!0)}if(shouldScaleText&&(style.vertical?textDivProperties.canvasWidth=geom.height*task._viewport.scale:textDivProperties.canvasWidth=geom.width*task._viewport.scale),task._textDivProperties.set(textDiv,textDivProperties),task._textContentStream&&task._layoutText(textDiv),task._enhanceTextSelection&&textDivProperties.hasText){var angleCos=1,angleSin=0;0!==angle&&(angleCos=Math.cos(angle),angleSin=Math.sin(angle));var m,b,divWidth=(style.vertical?geom.height:geom.width)*task._viewport.scale,divHeight=fontHeight;0!==angle?(m=[angleCos,angleSin,-angleSin,angleCos,left,top],b=_util.Util.getAxialAlignedBoundingBox([0,0,divWidth,divHeight],m)):b=[left,top,left+divWidth,top+divHeight],task._bounds.push({left:b[0],top:b[1],right:b[2],bottom:b[3],div:textDiv,size:[divWidth,divHeight],m:m})}}function render(task){if(!task._canceled){var textDivs=task._textDivs,capability=task._capability,textDivsLength=textDivs.length;if(textDivsLength>1e5)return task._renderingDone=!0,void capability.resolve();if(!task._textContentStream)for(var i=0;i<textDivsLength;i++)task._layoutText(textDivs[i]);task._renderingDone=!0,capability.resolve()}}function findPositiveMin(ts,offset,count){for(var result=0,i=0;i<count;i++){var t=ts[offset++];t>0&&(result=result?Math.min(t,result):t)}return result}function expand(task){for(var bounds=task._bounds,viewport=task._viewport,expanded=function(width,height,boxes){var bounds=boxes.map((function(box,i){return{x1:box.left,y1:box.top,x2:box.right,y2:box.bottom,index:i,x1New:void 0,x2New:void 0}}));expandBoundsLTR(width,bounds);var _step114,expanded=new Array(boxes.length),_iterator114=_createForOfIteratorHelper(bounds);try{for(_iterator114.s();!(_step114=_iterator114.n()).done;){var b=_step114.value,i=b.index;expanded[i]={left:b.x1New,top:0,right:b.x2New,bottom:0}}}catch(err){_iterator114.e(err)}finally{_iterator114.f()}boxes.map((function(box,i){var e=expanded[i],b=bounds[i];b.x1=box.top,b.y1=width-e.right,b.x2=box.bottom,b.y2=width-e.left,b.index=i,b.x1New=void 0,b.x2New=void 0})),expandBoundsLTR(height,bounds);var _step115,_iterator115=_createForOfIteratorHelper(bounds);try{for(_iterator115.s();!(_step115=_iterator115.n()).done;){var _b=_step115.value,_i13=_b.index;expanded[_i13].top=_b.x1New,expanded[_i13].bottom=_b.x2New}}catch(err){_iterator115.e(err)}finally{_iterator115.f()}return expanded}(viewport.width,viewport.height,bounds),i=0;i<expanded.length;i++){var div=bounds[i].div,divProperties=task._textDivProperties.get(div);if(0!==divProperties.angle){for(var e=expanded[i],b=bounds[i],m=b.m,c=m[0],s=m[1],points=[[0,0],[0,b.size[1]],[b.size[0],0],b.size],ts=new Float64Array(64),j=0,jj=points.length;j<jj;j++){var t=_util.Util.applyTransform(points[j],m);ts[j+0]=c&&(e.left-t[0])/c,ts[j+4]=s&&(e.top-t[1])/s,ts[j+8]=c&&(e.right-t[0])/c,ts[j+12]=s&&(e.bottom-t[1])/s,ts[j+16]=s&&(e.left-t[0])/-s,ts[j+20]=c&&(e.top-t[1])/c,ts[j+24]=s&&(e.right-t[0])/-s,ts[j+28]=c&&(e.bottom-t[1])/c,ts[j+32]=c&&(e.left-t[0])/-c,ts[j+36]=s&&(e.top-t[1])/-s,ts[j+40]=c&&(e.right-t[0])/-c,ts[j+44]=s&&(e.bottom-t[1])/-s,ts[j+48]=s&&(e.left-t[0])/s,ts[j+52]=c&&(e.top-t[1])/-c,ts[j+56]=s&&(e.right-t[0])/s,ts[j+60]=c&&(e.bottom-t[1])/-c}var boxScale=1+Math.min(Math.abs(c),Math.abs(s));divProperties.paddingLeft=findPositiveMin(ts,32,16)/boxScale,divProperties.paddingTop=findPositiveMin(ts,48,16)/boxScale,divProperties.paddingRight=findPositiveMin(ts,0,16)/boxScale,divProperties.paddingBottom=findPositiveMin(ts,16,16)/boxScale,task._textDivProperties.set(div,divProperties)}else divProperties.paddingLeft=bounds[i].left-expanded[i].left,divProperties.paddingTop=bounds[i].top-expanded[i].top,divProperties.paddingRight=expanded[i].right-bounds[i].right,divProperties.paddingBottom=expanded[i].bottom-bounds[i].bottom,task._textDivProperties.set(div,divProperties)}}function expandBoundsLTR(width,bounds){bounds.sort((function(a,b){return a.x1-b.x1||a.index-b.index}));var _step116,horizon=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}],_iterator116=_createForOfIteratorHelper(bounds);try{for(_iterator116.s();!(_step116=_iterator116.n()).done;){for(var boundary=_step116.value,i=0;i<horizon.length&&horizon[i].end<=boundary.y1;)i++;for(var j=horizon.length-1;j>=0&&horizon[j].start>=boundary.y2;)j--;var _horizonPart=void 0,_affectedBoundary=void 0,q=void 0,k=void 0,maxXNew=-1/0;for(q=i;q<=j;q++){_affectedBoundary=(_horizonPart=horizon[q]).boundary;var xNew=void 0;(xNew=_affectedBoundary.x2>boundary.x1?_affectedBoundary.index>boundary.index?_affectedBoundary.x1New:boundary.x1:void 0===_affectedBoundary.x2New?(_affectedBoundary.x2+boundary.x1)/2:_affectedBoundary.x2New)>maxXNew&&(maxXNew=xNew)}for(boundary.x1New=maxXNew,q=i;q<=j;q++)void 0===(_affectedBoundary=(_horizonPart=horizon[q]).boundary).x2New?_affectedBoundary.x2>boundary.x1?_affectedBoundary.index>boundary.index&&(_affectedBoundary.x2New=_affectedBoundary.x2):_affectedBoundary.x2New=maxXNew:_affectedBoundary.x2New>maxXNew&&(_affectedBoundary.x2New=Math.max(maxXNew,_affectedBoundary.x2));var changedHorizon=[],lastBoundary=null;for(q=i;q<=j;q++){var useBoundary=(_affectedBoundary=(_horizonPart=horizon[q]).boundary).x2>boundary.x2?_affectedBoundary:boundary;lastBoundary===useBoundary?changedHorizon.at(-1).end=_horizonPart.end:(changedHorizon.push({start:_horizonPart.start,end:_horizonPart.end,boundary:useBoundary}),lastBoundary=useBoundary)}for(horizon[i].start<boundary.y1&&(changedHorizon[0].start=boundary.y1,changedHorizon.unshift({start:horizon[i].start,end:boundary.y1,boundary:horizon[i].boundary})),boundary.y2<horizon[j].end&&(changedHorizon.at(-1).end=boundary.y2,changedHorizon.push({start:boundary.y2,end:horizon[j].end,boundary:horizon[j].boundary})),q=i;q<=j;q++)if(void 0===(_affectedBoundary=(_horizonPart=horizon[q]).boundary).x2New){var used=!1;for(k=i-1;!used&&k>=0&&horizon[k].start>=_affectedBoundary.y1;k--)used=horizon[k].boundary===_affectedBoundary;for(k=j+1;!used&&k<horizon.length&&horizon[k].end<=_affectedBoundary.y2;k++)used=horizon[k].boundary===_affectedBoundary;for(k=0;!used&&k<changedHorizon.length;k++)used=changedHorizon[k].boundary===_affectedBoundary;used||(_affectedBoundary.x2New=maxXNew)}Array.prototype.splice.apply(horizon,[i,j-i+1].concat(changedHorizon))}}catch(err){_iterator116.e(err)}finally{_iterator116.f()}for(var _i14=0,_horizon=horizon;_i14<_horizon.length;_i14++){var affectedBoundary=_horizon[_i14].boundary;void 0===affectedBoundary.x2New&&(affectedBoundary.x2New=Math.max(width,affectedBoundary.x2))}}var TextLayerRenderTask=function(){function TextLayerRenderTask(_ref){var _globalThis$FontInspe,_this69=this;_classCallCheck(this,TextLayerRenderTask);var textContent=_ref.textContent,textContentStream=_ref.textContentStream,container=_ref.container,viewport=_ref.viewport,textDivs=_ref.textDivs,textContentItemsStr=_ref.textContentItemsStr,enhanceTextSelection=_ref.enhanceTextSelection;enhanceTextSelection&&(0,_display_utils.deprecated)("The `enhanceTextSelection` functionality will be removed in the future."),this._textContent=textContent,this._textContentStream=textContentStream,this._container=container,this._document=container.ownerDocument,this._viewport=viewport,this._textDivs=textDivs||[],this._textContentItemsStr=textContentItemsStr||[],this._enhanceTextSelection=!!enhanceTextSelection,this._fontInspectorEnabled=!(null===(_globalThis$FontInspe=globalThis.FontInspector)||void 0===_globalThis$FontInspe||!_globalThis$FontInspe.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,_util.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._devicePixelRatio=globalThis.devicePixelRatio||1,this._capability.promise.finally((function(){_this69._enhanceTextSelection||(_this69._textDivProperties=null),_this69._layoutTextCtx&&(_this69._layoutTextCtx.canvas.width=0,_this69._layoutTextCtx.canvas.height=0,_this69._layoutTextCtx=null)})).catch((function(){}))}return _createClass(TextLayerRenderTask,[{key:"promise",get:function(){return this._capability.promise}},{key:"cancel",value:function(){this._canceled=!0,this._reader&&(this._reader.cancel(new _util.AbortException("TextLayer task cancelled.")).catch((function(){})),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}},{key:"_processItems",value:function(items,styleCache){for(var i=0,len=items.length;i<len;i++)if(void 0!==items[i].str)this._textContentItemsStr.push(items[i].str),appendText(this,items[i],styleCache,this._layoutTextCtx);else if("beginMarkedContentProps"===items[i].type||"beginMarkedContent"===items[i].type){var parent=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),null!==items[i].id&&this._container.setAttribute("id","".concat(items[i].id)),parent.append(this._container)}else"endMarkedContent"===items[i].type&&(this._container=this._container.parentNode)}},{key:"_layoutText",value:function(textDiv){var textDivProperties=this._textDivProperties.get(textDiv),transform="";if(0!==textDivProperties.canvasWidth&&textDivProperties.hasText){var fontFamily=textDiv.style.fontFamily,fontSize=textDivProperties.fontSize;fontSize===this._layoutTextLastFontSize&&fontFamily===this._layoutTextLastFontFamily||(this._layoutTextCtx.font="".concat(fontSize*this._devicePixelRatio,"px ").concat(fontFamily),this._layoutTextLastFontSize=fontSize,this._layoutTextLastFontFamily=fontFamily);var width=this._layoutTextCtx.measureText(textDiv.textContent).width;if(width>0){var scale=this._devicePixelRatio*textDivProperties.canvasWidth/width;this._enhanceTextSelection&&(textDivProperties.scale=scale),transform="scaleX(".concat(scale,")")}}if(0!==textDivProperties.angle&&(transform="rotate(".concat(textDivProperties.angle,"deg) ").concat(transform)),transform.length>0&&(this._enhanceTextSelection&&(textDivProperties.originalTransform=transform),textDiv.style.transform=transform),textDivProperties.hasText&&this._container.append(textDiv),textDivProperties.hasEOL){var br=document.createElement("br");br.setAttribute("role","presentation"),this._container.append(br)}}},{key:"_render",value:function(){var _this70=this,timeout=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,capability=(0,_util.createPromiseCapability)(),styleCache=Object.create(null),canvas=this._document.createElement("canvas");if(canvas.height=canvas.width=DEFAULT_FONT_SIZE,this._layoutTextCtx=canvas.getContext("2d",{alpha:!1}),this._textContent){var textItems=this._textContent.items,textStyles=this._textContent.styles;this._processItems(textItems,textStyles),capability.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');this._reader=this._textContentStream.getReader(),function pump(){_this70._reader.read().then((function(_ref2){var value=_ref2.value;_ref2.done?capability.resolve():(Object.assign(styleCache,value.styles),_this70._processItems(value.items,styleCache),pump())}),capability.reject)}()}capability.promise.then((function(){styleCache=null,timeout?_this70._renderTimer=setTimeout((function(){render(_this70),_this70._renderTimer=null}),timeout):render(_this70)}),this._capability.reject)}},{key:"expandTextDivs",value:function(){var expandDivs=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this._enhanceTextSelection&&this._renderingDone){null!==this._bounds&&(expand(this),this._bounds=null);for(var transformBuf=[],paddingBuf=[],i=0,ii=this._textDivs.length;i<ii;i++){var div=this._textDivs[i],divProps=this._textDivProperties.get(div);divProps.hasText&&(expandDivs?(transformBuf.length=0,paddingBuf.length=0,divProps.originalTransform&&transformBuf.push(divProps.originalTransform),divProps.paddingTop>0?(paddingBuf.push("".concat(divProps.paddingTop,"px")),transformBuf.push("translateY(".concat(-divProps.paddingTop,"px)"))):paddingBuf.push(0),divProps.paddingRight>0?paddingBuf.push("".concat(divProps.paddingRight/divProps.scale,"px")):paddingBuf.push(0),divProps.paddingBottom>0?paddingBuf.push("".concat(divProps.paddingBottom,"px")):paddingBuf.push(0),divProps.paddingLeft>0?(paddingBuf.push("".concat(divProps.paddingLeft/divProps.scale,"px")),transformBuf.push("translateX(".concat(-divProps.paddingLeft/divProps.scale,"px)"))):paddingBuf.push(0),div.style.padding=paddingBuf.join(" "),transformBuf.length&&(div.style.transform=transformBuf.join(" "))):(div.style.padding=null,div.style.transform=divProps.originalTransform))}}}}]),TextLayerRenderTask}();exports.TextLayerRenderTask=TextLayerRenderTask},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SVGGraphics=void 0;var _display_utils=__w_pdfjs_require__(133),_util=__w_pdfjs_require__(1),_is_node=__w_pdfjs_require__(3),SVGGraphics=_createClass((function SVGGraphics(){_classCallCheck(this,SVGGraphics),(0,_util.unreachable)("Not implemented: SVGGraphics")}));exports.SVGGraphics=SVGGraphics;var pf=function(value){if(Number.isInteger(value))return value.toString();var s=value.toFixed(10),i=s.length-1;if("0"!==s[i])return s;do{i--}while("0"===s[i]);return s.substring(0,"."===s[i]?i:i+1)},pm=function(m){if(0===m[4]&&0===m[5]){if(0===m[1]&&0===m[2])return 1===m[0]&&1===m[3]?"":"scale(".concat(pf(m[0])," ").concat(pf(m[3]),")");if(m[0]===m[3]&&m[1]===-m[2]){var a=180*Math.acos(m[0])/Math.PI;return"rotate(".concat(pf(a),")")}}else if(1===m[0]&&0===m[1]&&0===m[2]&&1===m[3])return"translate(".concat(pf(m[4])," ").concat(pf(m[5]),")");return"matrix(".concat(pf(m[0])," ").concat(pf(m[1])," ").concat(pf(m[2])," ").concat(pf(m[3])," ").concat(pf(m[4])," ")+"".concat(pf(m[5]),")")},SVG_DEFAULTS={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},LINE_CAP_STYLES=["butt","round","square"],LINE_JOIN_STYLES=["miter","round","bevel"],createObjectURL=function(data){var contentType=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",forceDataSchema=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(URL.createObjectURL&&"undefined"!=typeof Blob&&!forceDataSchema)return URL.createObjectURL(new Blob([data],{type:contentType}));for(var digits="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",buffer="data:".concat(contentType,";base64,"),i=0,ii=data.length;i<ii;i+=3){var b1=255&data[i],b2=255&data[i+1],b3=255&data[i+2];buffer+=digits[b1>>2]+digits[(3&b1)<<4|b2>>4]+digits[i+1<ii?(15&b2)<<2|b3>>6:64]+digits[i+2<ii?63&b3:64]}return buffer},convertImgDataToPng=function(){for(var PNG_HEADER=new Uint8Array([137,80,78,71,13,10,26,10]),crcTable=new Int32Array(256),i=0;i<256;i++){for(var c=i,h=0;h<8;h++)c=1&c?3988292384^c>>1&2147483647:c>>1&2147483647;crcTable[i]=c}function writePngChunk(type,body,data,offset){var p=offset,len=body.length;data[p]=len>>24&255,data[p+1]=len>>16&255,data[p+2]=len>>8&255,data[p+3]=255&len,data[p+=4]=255&type.charCodeAt(0),data[p+1]=255&type.charCodeAt(1),data[p+2]=255&type.charCodeAt(2),data[p+3]=255&type.charCodeAt(3),p+=4,data.set(body,p);var crc=function(data,start,end){for(var crc=-1,_i15=start;_i15<end;_i15++){var a=255&(crc^data[_i15]);crc=crc>>>8^crcTable[a]}return-1^crc}(data,offset+4,p+=body.length);data[p]=crc>>24&255,data[p+1]=crc>>16&255,data[p+2]=crc>>8&255,data[p+3]=255&crc}function deflateSyncUncompressed(literals){var len=literals.length,deflateBlocks=Math.ceil(len/65535),idat=new Uint8Array(2+len+5*deflateBlocks+4),pi=0;idat[pi++]=120,idat[pi++]=156;for(var pos=0;len>65535;)idat[pi++]=0,idat[pi++]=255,idat[pi++]=255,idat[pi++]=0,idat[pi++]=0,idat.set(literals.subarray(pos,pos+65535),pi),pi+=65535,pos+=65535,len-=65535;idat[pi++]=1,idat[pi++]=255&len,idat[pi++]=len>>8&255,idat[pi++]=255&~len,idat[pi++]=(65535&~len)>>8&255,idat.set(literals.subarray(pos),pi),pi+=literals.length-pos;var adler=function(data,start,end){for(var a=1,b=0,_i16=start;_i16<end;++_i16)b=(b+(a=(a+(255&data[_i16]))%65521))%65521;return b<<16|a}(literals,0,literals.length);return idat[pi++]=adler>>24&255,idat[pi++]=adler>>16&255,idat[pi++]=adler>>8&255,idat[pi++]=255&adler,idat}function encode(imgData,kind,forceDataSchema,isMask){var bitDepth,colorType,lineSize,width=imgData.width,height=imgData.height,bytes=imgData.data;switch(kind){case _util.ImageKind.GRAYSCALE_1BPP:colorType=0,bitDepth=1,lineSize=width+7>>3;break;case _util.ImageKind.RGB_24BPP:colorType=2,bitDepth=8,lineSize=3*width;break;case _util.ImageKind.RGBA_32BPP:colorType=6,bitDepth=8,lineSize=4*width;break;default:throw new Error("invalid format")}for(var literals=new Uint8Array((1+lineSize)*height),offsetLiterals=0,offsetBytes=0,y=0;y<height;++y)literals[offsetLiterals++]=0,literals.set(bytes.subarray(offsetBytes,offsetBytes+lineSize),offsetLiterals),offsetBytes+=lineSize,offsetLiterals+=lineSize;if(kind===_util.ImageKind.GRAYSCALE_1BPP&&isMask){offsetLiterals=0;for(var _y=0;_y<height;_y++){offsetLiterals++;for(var _i17=0;_i17<lineSize;_i17++)literals[offsetLiterals++]^=255}}var ihdr=new Uint8Array([width>>24&255,width>>16&255,width>>8&255,255&width,height>>24&255,height>>16&255,height>>8&255,255&height,bitDepth,colorType,0,0,0]),idat=function(literals){if(!_is_node.isNodeJS)return deflateSyncUncompressed(literals);try{var input;input=parseInt(process.versions.node)>=8?literals:Buffer.from(literals);var output=__webpack_require__(324).deflateSync(input,{level:9});return output instanceof Uint8Array?output:new Uint8Array(output)}catch(e){(0,_util.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+e)}return deflateSyncUncompressed(literals)}(literals),pngLength=PNG_HEADER.length+36+ihdr.length+idat.length,data=new Uint8Array(pngLength),offset=0;return data.set(PNG_HEADER,offset),writePngChunk("IHDR",ihdr,data,offset+=PNG_HEADER.length),writePngChunk("IDATA",idat,data,offset+=12+ihdr.length),offset+=12+idat.length,writePngChunk("IEND",new Uint8Array(0),data,offset),createObjectURL(data,"image/png",forceDataSchema)}return function(imgData,forceDataSchema,isMask){return encode(imgData,void 0===imgData.kind?_util.ImageKind.GRAYSCALE_1BPP:imgData.kind,forceDataSchema,isMask)}}(),SVGExtraState=function(){function SVGExtraState(){_classCallCheck(this,SVGExtraState),this.fontSizeScale=1,this.fontWeight=SVG_DEFAULTS.fontWeight,this.fontSize=0,this.textMatrix=_util.IDENTITY_MATRIX,this.fontMatrix=_util.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=_util.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=SVG_DEFAULTS.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}return _createClass(SVGExtraState,[{key:"clone",value:function(){return Object.create(this)}},{key:"setCurrentPoint",value:function(x,y){this.x=x,this.y=y}}]),SVGExtraState}(),clipCount=0,maskCount=0,shadingCount=0;exports.SVGGraphics=SVGGraphics=function(){function SVGGraphics(commonObjs,objs){_classCallCheck(this,SVGGraphics);var forceDataSchema=arguments.length>2&&void 0!==arguments[2]&&arguments[2];for(var op in(0,_display_utils.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new _display_utils.DOMSVGFactory,this.current=new SVGExtraState,this.transformMatrix=_util.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=commonObjs,this.objs=objs,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!forceDataSchema,this._operatorIdMapping=[],_util.OPS)this._operatorIdMapping[_util.OPS[op]]=op}return _createClass(SVGGraphics,[{key:"save",value:function(){this.transformStack.push(this.transformMatrix);var old=this.current;this.extraStack.push(old),this.current=old.clone()}},{key:"restore",value:function(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}},{key:"group",value:function(items){this.save(),this.executeOpTree(items),this.restore()}},{key:"loadDependencies",value:function(operatorList){for(var _this71=this,fnArray=operatorList.fnArray,argsArray=operatorList.argsArray,i=0,ii=fnArray.length;i<ii;i++)if(fnArray[i]===_util.OPS.dependency){var _step118,_iterator118=_createForOfIteratorHelper(argsArray[i]);try{var _loop3=function(){var obj=_step118.value,objsPool=obj.startsWith("g_")?_this71.commonObjs:_this71.objs,promise=new Promise((function(resolve){objsPool.get(obj,resolve)}));_this71.current.dependencies.push(promise)};for(_iterator118.s();!(_step118=_iterator118.n()).done;)_loop3()}catch(err){_iterator118.e(err)}finally{_iterator118.f()}}return Promise.all(this.current.dependencies)}},{key:"transform",value:function(a,b,c,d,e,f){var transformMatrix=[a,b,c,d,e,f];this.transformMatrix=_util.Util.transform(this.transformMatrix,transformMatrix),this.tgrp=null}},{key:"getSVG",value:function(operatorList,viewport){var _this72=this;this.viewport=viewport;var svgElement=this._initialize(viewport);return this.loadDependencies(operatorList).then((function(){return _this72.transformMatrix=_util.IDENTITY_MATRIX,_this72.executeOpTree(_this72.convertOpList(operatorList)),svgElement}))}},{key:"convertOpList",value:function(operatorList){for(var operatorIdMapping=this._operatorIdMapping,argsArray=operatorList.argsArray,fnArray=operatorList.fnArray,opList=[],i=0,ii=fnArray.length;i<ii;i++){var fnId=fnArray[i];opList.push({fnId:fnId,fn:operatorIdMapping[fnId],args:argsArray[i]})}return function(opList){var _step117,opTree=[],tmp=[],_iterator117=_createForOfIteratorHelper(opList);try{for(_iterator117.s();!(_step117=_iterator117.n()).done;){var opListElement=_step117.value;"save"!==opListElement.fn?"restore"===opListElement.fn?opTree=tmp.pop():opTree.push(opListElement):(opTree.push({fnId:92,fn:"group",items:[]}),tmp.push(opTree),opTree=opTree.at(-1).items)}}catch(err){_iterator117.e(err)}finally{_iterator117.f()}return opTree}(opList)}},{key:"executeOpTree",value:function(opTree){var _step119,_iterator119=_createForOfIteratorHelper(opTree);try{for(_iterator119.s();!(_step119=_iterator119.n()).done;){var opTreeElement=_step119.value,fn=opTreeElement.fn,fnId=opTreeElement.fnId,args=opTreeElement.args;switch(0|fnId){case _util.OPS.beginText:this.beginText();break;case _util.OPS.dependency:break;case _util.OPS.setLeading:this.setLeading(args);break;case _util.OPS.setLeadingMoveText:this.setLeadingMoveText(args[0],args[1]);break;case _util.OPS.setFont:this.setFont(args);break;case _util.OPS.showText:case _util.OPS.showSpacedText:this.showText(args[0]);break;case _util.OPS.endText:this.endText();break;case _util.OPS.moveText:this.moveText(args[0],args[1]);break;case _util.OPS.setCharSpacing:this.setCharSpacing(args[0]);break;case _util.OPS.setWordSpacing:this.setWordSpacing(args[0]);break;case _util.OPS.setHScale:this.setHScale(args[0]);break;case _util.OPS.setTextMatrix:this.setTextMatrix(args[0],args[1],args[2],args[3],args[4],args[5]);break;case _util.OPS.setTextRise:this.setTextRise(args[0]);break;case _util.OPS.setTextRenderingMode:this.setTextRenderingMode(args[0]);break;case _util.OPS.setLineWidth:this.setLineWidth(args[0]);break;case _util.OPS.setLineJoin:this.setLineJoin(args[0]);break;case _util.OPS.setLineCap:this.setLineCap(args[0]);break;case _util.OPS.setMiterLimit:this.setMiterLimit(args[0]);break;case _util.OPS.setFillRGBColor:this.setFillRGBColor(args[0],args[1],args[2]);break;case _util.OPS.setStrokeRGBColor:this.setStrokeRGBColor(args[0],args[1],args[2]);break;case _util.OPS.setStrokeColorN:this.setStrokeColorN(args);break;case _util.OPS.setFillColorN:this.setFillColorN(args);break;case _util.OPS.shadingFill:this.shadingFill(args[0]);break;case _util.OPS.setDash:this.setDash(args[0],args[1]);break;case _util.OPS.setRenderingIntent:this.setRenderingIntent(args[0]);break;case _util.OPS.setFlatness:this.setFlatness(args[0]);break;case _util.OPS.setGState:this.setGState(args[0]);break;case _util.OPS.fill:this.fill();break;case _util.OPS.eoFill:this.eoFill();break;case _util.OPS.stroke:this.stroke();break;case _util.OPS.fillStroke:this.fillStroke();break;case _util.OPS.eoFillStroke:this.eoFillStroke();break;case _util.OPS.clip:this.clip("nonzero");break;case _util.OPS.eoClip:this.clip("evenodd");break;case _util.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case _util.OPS.paintImageXObject:this.paintImageXObject(args[0]);break;case _util.OPS.paintInlineImageXObject:this.paintInlineImageXObject(args[0]);break;case _util.OPS.paintImageMaskXObject:this.paintImageMaskXObject(args[0]);break;case _util.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(args[0],args[1]);break;case _util.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case _util.OPS.closePath:this.closePath();break;case _util.OPS.closeStroke:this.closeStroke();break;case _util.OPS.closeFillStroke:this.closeFillStroke();break;case _util.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case _util.OPS.nextLine:this.nextLine();break;case _util.OPS.transform:this.transform(args[0],args[1],args[2],args[3],args[4],args[5]);break;case _util.OPS.constructPath:this.constructPath(args[0],args[1]);break;case _util.OPS.endPath:this.endPath();break;case 92:this.group(opTreeElement.items);break;default:(0,_util.warn)("Unimplemented operator ".concat(fn))}}}catch(err){_iterator119.e(err)}finally{_iterator119.f()}}},{key:"setWordSpacing",value:function(wordSpacing){this.current.wordSpacing=wordSpacing}},{key:"setCharSpacing",value:function(charSpacing){this.current.charSpacing=charSpacing}},{key:"nextLine",value:function(){this.moveText(0,this.current.leading)}},{key:"setTextMatrix",value:function(a,b,c,d,e,f){var current=this.current;current.textMatrix=current.lineMatrix=[a,b,c,d,e,f],current.textMatrixScale=Math.hypot(a,b),current.x=current.lineX=0,current.y=current.lineY=0,current.xcoords=[],current.ycoords=[],current.tspan=this.svgFactory.createElement("svg:tspan"),current.tspan.setAttributeNS(null,"font-family",current.fontFamily),current.tspan.setAttributeNS(null,"font-size","".concat(pf(current.fontSize),"px")),current.tspan.setAttributeNS(null,"y",pf(-current.y)),current.txtElement=this.svgFactory.createElement("svg:text"),current.txtElement.append(current.tspan)}},{key:"beginText",value:function(){var current=this.current;current.x=current.lineX=0,current.y=current.lineY=0,current.textMatrix=_util.IDENTITY_MATRIX,current.lineMatrix=_util.IDENTITY_MATRIX,current.textMatrixScale=1,current.tspan=this.svgFactory.createElement("svg:tspan"),current.txtElement=this.svgFactory.createElement("svg:text"),current.txtgrp=this.svgFactory.createElement("svg:g"),current.xcoords=[],current.ycoords=[]}},{key:"moveText",value:function(x,y){var current=this.current;current.x=current.lineX+=x,current.y=current.lineY+=y,current.xcoords=[],current.ycoords=[],current.tspan=this.svgFactory.createElement("svg:tspan"),current.tspan.setAttributeNS(null,"font-family",current.fontFamily),current.tspan.setAttributeNS(null,"font-size","".concat(pf(current.fontSize),"px")),current.tspan.setAttributeNS(null,"y",pf(-current.y))}},{key:"showText",value:function(glyphs){var current=this.current,font=current.font,fontSize=current.fontSize;if(0!==fontSize){var _step120,fontSizeScale=current.fontSizeScale,charSpacing=current.charSpacing,wordSpacing=current.wordSpacing,fontDirection=current.fontDirection,textHScale=current.textHScale*fontDirection,vertical=font.vertical,spacingDir=vertical?1:-1,defaultVMetrics=font.defaultVMetrics,widthAdvanceScale=fontSize*current.fontMatrix[0],x=0,_iterator120=_createForOfIteratorHelper(glyphs);try{for(_iterator120.s();!(_step120=_iterator120.n()).done;){var glyph=_step120.value;if(null!==glyph)if("number"!=typeof glyph){var spacing=(glyph.isSpace?wordSpacing:0)+charSpacing,character=glyph.fontChar,scaledX=void 0,scaledY=void 0,width=glyph.width;if(vertical){var vx=void 0,vmetric=glyph.vmetric||defaultVMetrics;vx=-(vx=glyph.vmetric?vmetric[1]:.5*width)*widthAdvanceScale;var vy=vmetric[2]*widthAdvanceScale;width=vmetric?-vmetric[0]:width,scaledX=vx/fontSizeScale,scaledY=(x+vy)/fontSizeScale}else scaledX=x/fontSizeScale,scaledY=0;(glyph.isInFont||font.missingFile)&&(current.xcoords.push(current.x+scaledX),vertical&&current.ycoords.push(-current.y+scaledY),current.tspan.textContent+=character),x+=vertical?width*widthAdvanceScale-spacing*fontDirection:width*widthAdvanceScale+spacing*fontDirection}else x+=spacingDir*glyph*fontSize/1e3;else x+=fontDirection*wordSpacing}}catch(err){_iterator120.e(err)}finally{_iterator120.f()}current.tspan.setAttributeNS(null,"x",current.xcoords.map(pf).join(" ")),vertical?current.tspan.setAttributeNS(null,"y",current.ycoords.map(pf).join(" ")):current.tspan.setAttributeNS(null,"y",pf(-current.y)),vertical?current.y-=x:current.x+=x*textHScale,current.tspan.setAttributeNS(null,"font-family",current.fontFamily),current.tspan.setAttributeNS(null,"font-size","".concat(pf(current.fontSize),"px")),current.fontStyle!==SVG_DEFAULTS.fontStyle&&current.tspan.setAttributeNS(null,"font-style",current.fontStyle),current.fontWeight!==SVG_DEFAULTS.fontWeight&&current.tspan.setAttributeNS(null,"font-weight",current.fontWeight);var fillStrokeMode=current.textRenderingMode&_util.TextRenderingMode.FILL_STROKE_MASK;if(fillStrokeMode===_util.TextRenderingMode.FILL||fillStrokeMode===_util.TextRenderingMode.FILL_STROKE?(current.fillColor!==SVG_DEFAULTS.fillColor&&current.tspan.setAttributeNS(null,"fill",current.fillColor),current.fillAlpha<1&&current.tspan.setAttributeNS(null,"fill-opacity",current.fillAlpha)):current.textRenderingMode===_util.TextRenderingMode.ADD_TO_PATH?current.tspan.setAttributeNS(null,"fill","transparent"):current.tspan.setAttributeNS(null,"fill","none"),fillStrokeMode===_util.TextRenderingMode.STROKE||fillStrokeMode===_util.TextRenderingMode.FILL_STROKE){var lineWidthScale=1/(current.textMatrixScale||1);this._setStrokeAttributes(current.tspan,lineWidthScale)}var textMatrix=current.textMatrix;0!==current.textRise&&((textMatrix=textMatrix.slice())[5]+=current.textRise),current.txtElement.setAttributeNS(null,"transform","".concat(pm(textMatrix)," scale(").concat(pf(textHScale),", -1)")),current.txtElement.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),current.txtElement.append(current.tspan),current.txtgrp.append(current.txtElement),this._ensureTransformGroup().append(current.txtElement)}}},{key:"setLeadingMoveText",value:function(x,y){this.setLeading(-y),this.moveText(x,y)}},{key:"addFontStyle",value:function(fontObj){if(!fontObj.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));var url=createObjectURL(fontObj.data,fontObj.mimetype,this.forceDataSchema);this.cssStyle.textContent+='@font-face { font-family: "'.concat(fontObj.loadedName,'";')+" src: url(".concat(url,"); }\n")}},{key:"setFont",value:function(details){var current=this.current,fontObj=this.commonObjs.get(details[0]),size=details[1];current.font=fontObj,!this.embedFonts||fontObj.missingFile||this.embeddedFonts[fontObj.loadedName]||(this.addFontStyle(fontObj),this.embeddedFonts[fontObj.loadedName]=fontObj),current.fontMatrix=fontObj.fontMatrix||_util.FONT_IDENTITY_MATRIX;var bold="normal";fontObj.black?bold="900":fontObj.bold&&(bold="bold");var italic=fontObj.italic?"italic":"normal";size<0?(size=-size,current.fontDirection=-1):current.fontDirection=1,current.fontSize=size,current.fontFamily=fontObj.loadedName,current.fontWeight=bold,current.fontStyle=italic,current.tspan=this.svgFactory.createElement("svg:tspan"),current.tspan.setAttributeNS(null,"y",pf(-current.y)),current.xcoords=[],current.ycoords=[]}},{key:"endText",value:function(){var _current$txtElement,current=this.current;current.textRenderingMode&_util.TextRenderingMode.ADD_TO_PATH_FLAG&&null!==(_current$txtElement=current.txtElement)&&void 0!==_current$txtElement&&_current$txtElement.hasChildNodes()&&(current.element=current.txtElement,this.clip("nonzero"),this.endPath())}},{key:"setLineWidth",value:function(width){width>0&&(this.current.lineWidth=width)}},{key:"setLineCap",value:function(style){this.current.lineCap=LINE_CAP_STYLES[style]}},{key:"setLineJoin",value:function(style){this.current.lineJoin=LINE_JOIN_STYLES[style]}},{key:"setMiterLimit",value:function(limit){this.current.miterLimit=limit}},{key:"setStrokeAlpha",value:function(strokeAlpha){this.current.strokeAlpha=strokeAlpha}},{key:"setStrokeRGBColor",value:function(r,g,b){this.current.strokeColor=_util.Util.makeHexColor(r,g,b)}},{key:"setFillAlpha",value:function(fillAlpha){this.current.fillAlpha=fillAlpha}},{key:"setFillRGBColor",value:function(r,g,b){this.current.fillColor=_util.Util.makeHexColor(r,g,b),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}},{key:"setStrokeColorN",value:function(args){this.current.strokeColor=this._makeColorN_Pattern(args)}},{key:"setFillColorN",value:function(args){this.current.fillColor=this._makeColorN_Pattern(args)}},{key:"shadingFill",value:function(args){var width=this.viewport.width,height=this.viewport.height,inv=_util.Util.inverseTransform(this.transformMatrix),bl=_util.Util.applyTransform([0,0],inv),br=_util.Util.applyTransform([0,height],inv),ul=_util.Util.applyTransform([width,0],inv),ur=_util.Util.applyTransform([width,height],inv),x0=Math.min(bl[0],br[0],ul[0],ur[0]),y0=Math.min(bl[1],br[1],ul[1],ur[1]),x1=Math.max(bl[0],br[0],ul[0],ur[0]),y1=Math.max(bl[1],br[1],ul[1],ur[1]),rect=this.svgFactory.createElement("svg:rect");rect.setAttributeNS(null,"x",x0),rect.setAttributeNS(null,"y",y0),rect.setAttributeNS(null,"width",x1-x0),rect.setAttributeNS(null,"height",y1-y0),rect.setAttributeNS(null,"fill",this._makeShadingPattern(args)),this.current.fillAlpha<1&&rect.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(rect)}},{key:"_makeColorN_Pattern",value:function(args){return"TilingPattern"===args[0]?this._makeTilingPattern(args):this._makeShadingPattern(args)}},{key:"_makeTilingPattern",value:function(args){var color=args[1],operatorList=args[2],matrix=args[3]||_util.IDENTITY_MATRIX,_args$=_slicedToArray(args[4],4),x0=_args$[0],y0=_args$[1],x1=_args$[2],y1=_args$[3],xstep=args[5],ystep=args[6],paintType=args[7],tilingId="shading".concat(shadingCount++),_util$Util$normalizeR2=_slicedToArray(_util.Util.normalizeRect([].concat(_toConsumableArray(_util.Util.applyTransform([x0,y0],matrix)),_toConsumableArray(_util.Util.applyTransform([x1,y1],matrix)))),4),tx0=_util$Util$normalizeR2[0],ty0=_util$Util$normalizeR2[1],tx1=_util$Util$normalizeR2[2],ty1=_util$Util$normalizeR2[3],_util$Util$singularVa4=_slicedToArray(_util.Util.singularValueDecompose2dScale(matrix),2),txstep=xstep*_util$Util$singularVa4[0],tystep=ystep*_util$Util$singularVa4[1],tiling=this.svgFactory.createElement("svg:pattern");tiling.setAttributeNS(null,"id",tilingId),tiling.setAttributeNS(null,"patternUnits","userSpaceOnUse"),tiling.setAttributeNS(null,"width",txstep),tiling.setAttributeNS(null,"height",tystep),tiling.setAttributeNS(null,"x","".concat(tx0)),tiling.setAttributeNS(null,"y","".concat(ty0));var svg=this.svg,transformMatrix=this.transformMatrix,fillColor=this.current.fillColor,strokeColor=this.current.strokeColor,bbox=this.svgFactory.create(tx1-tx0,ty1-ty0);if(this.svg=bbox,this.transformMatrix=matrix,2===paintType){var _util$Util5,cssColor=(_util$Util5=_util.Util).makeHexColor.apply(_util$Util5,_toConsumableArray(color));this.current.fillColor=cssColor,this.current.strokeColor=cssColor}return this.executeOpTree(this.convertOpList(operatorList)),this.svg=svg,this.transformMatrix=transformMatrix,this.current.fillColor=fillColor,this.current.strokeColor=strokeColor,tiling.append(bbox.childNodes[0]),this.defs.append(tiling),"url(#".concat(tilingId,")")}},{key:"_makeShadingPattern",value:function(args){switch("string"==typeof args&&(args=this.objs.get(args)),args[0]){case"RadialAxial":var gradient,shadingId="shading".concat(shadingCount++),colorStops=args[3];switch(args[1]){case"axial":var point0=args[4],point1=args[5];(gradient=this.svgFactory.createElement("svg:linearGradient")).setAttributeNS(null,"id",shadingId),gradient.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),gradient.setAttributeNS(null,"x1",point0[0]),gradient.setAttributeNS(null,"y1",point0[1]),gradient.setAttributeNS(null,"x2",point1[0]),gradient.setAttributeNS(null,"y2",point1[1]);break;case"radial":var focalPoint=args[4],circlePoint=args[5],focalRadius=args[6],circleRadius=args[7];(gradient=this.svgFactory.createElement("svg:radialGradient")).setAttributeNS(null,"id",shadingId),gradient.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),gradient.setAttributeNS(null,"cx",circlePoint[0]),gradient.setAttributeNS(null,"cy",circlePoint[1]),gradient.setAttributeNS(null,"r",circleRadius),gradient.setAttributeNS(null,"fx",focalPoint[0]),gradient.setAttributeNS(null,"fy",focalPoint[1]),gradient.setAttributeNS(null,"fr",focalRadius);break;default:throw new Error("Unknown RadialAxial type: ".concat(args[1]))}var _step121,_iterator121=_createForOfIteratorHelper(colorStops);try{for(_iterator121.s();!(_step121=_iterator121.n()).done;){var colorStop=_step121.value,stop=this.svgFactory.createElement("svg:stop");stop.setAttributeNS(null,"offset",colorStop[0]),stop.setAttributeNS(null,"stop-color",colorStop[1]),gradient.append(stop)}}catch(err){_iterator121.e(err)}finally{_iterator121.f()}return this.defs.append(gradient),"url(#".concat(shadingId,")");case"Mesh":return(0,_util.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error("Unknown IR type: ".concat(args[0]))}}},{key:"setDash",value:function(dashArray,dashPhase){this.current.dashArray=dashArray,this.current.dashPhase=dashPhase}},{key:"constructPath",value:function(ops,args){var _step122,current=this.current,x=current.x,y=current.y,d=[],j=0,_iterator122=_createForOfIteratorHelper(ops);try{for(_iterator122.s();!(_step122=_iterator122.n()).done;)switch(0|_step122.value){case _util.OPS.rectangle:x=args[j++],y=args[j++];var width=args[j++],height=args[j++],xw=x+width,yh=y+height;d.push("M",pf(x),pf(y),"L",pf(xw),pf(y),"L",pf(xw),pf(yh),"L",pf(x),pf(yh),"Z");break;case _util.OPS.moveTo:x=args[j++],y=args[j++],d.push("M",pf(x),pf(y));break;case _util.OPS.lineTo:x=args[j++],y=args[j++],d.push("L",pf(x),pf(y));break;case _util.OPS.curveTo:x=args[j+4],y=args[j+5],d.push("C",pf(args[j]),pf(args[j+1]),pf(args[j+2]),pf(args[j+3]),pf(x),pf(y)),j+=6;break;case _util.OPS.curveTo2:d.push("C",pf(x),pf(y),pf(args[j]),pf(args[j+1]),pf(args[j+2]),pf(args[j+3])),x=args[j+2],y=args[j+3],j+=4;break;case _util.OPS.curveTo3:x=args[j+2],y=args[j+3],d.push("C",pf(args[j]),pf(args[j+1]),pf(x),pf(y),pf(x),pf(y)),j+=4;break;case _util.OPS.closePath:d.push("Z")}}catch(err){_iterator122.e(err)}finally{_iterator122.f()}d=d.join(" "),current.path&&ops.length>0&&ops[0]!==_util.OPS.rectangle&&ops[0]!==_util.OPS.moveTo?d=current.path.getAttributeNS(null,"d")+d:(current.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(current.path)),current.path.setAttributeNS(null,"d",d),current.path.setAttributeNS(null,"fill","none"),current.element=current.path,current.setCurrentPoint(x,y)}},{key:"endPath",value:function(){var current=this.current;if(current.path=null,this.pendingClip)if(current.element){var clipId="clippath".concat(clipCount++),clipPath=this.svgFactory.createElement("svg:clipPath");clipPath.setAttributeNS(null,"id",clipId),clipPath.setAttributeNS(null,"transform",pm(this.transformMatrix));var clipElement=current.element.cloneNode(!0);if("evenodd"===this.pendingClip?clipElement.setAttributeNS(null,"clip-rule","evenodd"):clipElement.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,clipPath.append(clipElement),this.defs.append(clipPath),current.activeClipUrl){current.clipGroup=null;var _step123,_iterator123=_createForOfIteratorHelper(this.extraStack);try{for(_iterator123.s();!(_step123=_iterator123.n()).done;)_step123.value.clipGroup=null}catch(err){_iterator123.e(err)}finally{_iterator123.f()}clipPath.setAttributeNS(null,"clip-path",current.activeClipUrl)}current.activeClipUrl="url(#".concat(clipId,")"),this.tgrp=null}else this.pendingClip=null}},{key:"clip",value:function(type){this.pendingClip=type}},{key:"closePath",value:function(){var current=this.current;if(current.path){var d="".concat(current.path.getAttributeNS(null,"d"),"Z");current.path.setAttributeNS(null,"d",d)}}},{key:"setLeading",value:function(leading){this.current.leading=-leading}},{key:"setTextRise",value:function(textRise){this.current.textRise=textRise}},{key:"setTextRenderingMode",value:function(textRenderingMode){this.current.textRenderingMode=textRenderingMode}},{key:"setHScale",value:function(scale){this.current.textHScale=scale/100}},{key:"setRenderingIntent",value:function(intent){}},{key:"setFlatness",value:function(flatness){}},{key:"setGState",value:function(states){var _step124,_iterator124=_createForOfIteratorHelper(states);try{for(_iterator124.s();!(_step124=_iterator124.n()).done;){var _step124$value=_slicedToArray(_step124.value,2),key=_step124$value[0],value=_step124$value[1];switch(key){case"LW":this.setLineWidth(value);break;case"LC":this.setLineCap(value);break;case"LJ":this.setLineJoin(value);break;case"ML":this.setMiterLimit(value);break;case"D":this.setDash(value[0],value[1]);break;case"RI":this.setRenderingIntent(value);break;case"FL":this.setFlatness(value);break;case"Font":this.setFont(value);break;case"CA":this.setStrokeAlpha(value);break;case"ca":this.setFillAlpha(value);break;default:(0,_util.warn)("Unimplemented graphic state operator ".concat(key))}}}catch(err){_iterator124.e(err)}finally{_iterator124.f()}}},{key:"fill",value:function(){var current=this.current;current.element&&(current.element.setAttributeNS(null,"fill",current.fillColor),current.element.setAttributeNS(null,"fill-opacity",current.fillAlpha),this.endPath())}},{key:"stroke",value:function(){var current=this.current;current.element&&(this._setStrokeAttributes(current.element),current.element.setAttributeNS(null,"fill","none"),this.endPath())}},{key:"_setStrokeAttributes",value:function(element){var lineWidthScale=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,current=this.current,dashArray=current.dashArray;1!==lineWidthScale&&dashArray.length>0&&(dashArray=dashArray.map((function(value){return lineWidthScale*value}))),element.setAttributeNS(null,"stroke",current.strokeColor),element.setAttributeNS(null,"stroke-opacity",current.strokeAlpha),element.setAttributeNS(null,"stroke-miterlimit",pf(current.miterLimit)),element.setAttributeNS(null,"stroke-linecap",current.lineCap),element.setAttributeNS(null,"stroke-linejoin",current.lineJoin),element.setAttributeNS(null,"stroke-width",pf(lineWidthScale*current.lineWidth)+"px"),element.setAttributeNS(null,"stroke-dasharray",dashArray.map(pf).join(" ")),element.setAttributeNS(null,"stroke-dashoffset",pf(lineWidthScale*current.dashPhase)+"px")}},{key:"eoFill",value:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}},{key:"fillStroke",value:function(){this.stroke(),this.fill()}},{key:"eoFillStroke",value:function(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}},{key:"closeStroke",value:function(){this.closePath(),this.stroke()}},{key:"closeFillStroke",value:function(){this.closePath(),this.fillStroke()}},{key:"closeEOFillStroke",value:function(){this.closePath(),this.eoFillStroke()}},{key:"paintSolidColorImageMask",value:function(){var rect=this.svgFactory.createElement("svg:rect");rect.setAttributeNS(null,"x","0"),rect.setAttributeNS(null,"y","0"),rect.setAttributeNS(null,"width","1px"),rect.setAttributeNS(null,"height","1px"),rect.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(rect)}},{key:"paintImageXObject",value:function(objId){var imgData=objId.startsWith("g_")?this.commonObjs.get(objId):this.objs.get(objId);imgData?this.paintInlineImageXObject(imgData):(0,_util.warn)("Dependent image with object ID ".concat(objId," is not ready yet"))}},{key:"paintInlineImageXObject",value:function(imgData,mask){var width=imgData.width,height=imgData.height,imgSrc=convertImgDataToPng(imgData,this.forceDataSchema,!!mask),cliprect=this.svgFactory.createElement("svg:rect");cliprect.setAttributeNS(null,"x","0"),cliprect.setAttributeNS(null,"y","0"),cliprect.setAttributeNS(null,"width",pf(width)),cliprect.setAttributeNS(null,"height",pf(height)),this.current.element=cliprect,this.clip("nonzero");var imgEl=this.svgFactory.createElement("svg:image");imgEl.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",imgSrc),imgEl.setAttributeNS(null,"x","0"),imgEl.setAttributeNS(null,"y",pf(-height)),imgEl.setAttributeNS(null,"width",pf(width)+"px"),imgEl.setAttributeNS(null,"height",pf(height)+"px"),imgEl.setAttributeNS(null,"transform","scale(".concat(pf(1/width)," ").concat(pf(-1/height),")")),mask?mask.append(imgEl):this._ensureTransformGroup().append(imgEl)}},{key:"paintImageMaskXObject",value:function(imgData){var current=this.current,width=imgData.width,height=imgData.height,fillColor=current.fillColor;current.maskId="mask".concat(maskCount++);var mask=this.svgFactory.createElement("svg:mask");mask.setAttributeNS(null,"id",current.maskId);var rect=this.svgFactory.createElement("svg:rect");rect.setAttributeNS(null,"x","0"),rect.setAttributeNS(null,"y","0"),rect.setAttributeNS(null,"width",pf(width)),rect.setAttributeNS(null,"height",pf(height)),rect.setAttributeNS(null,"fill",fillColor),rect.setAttributeNS(null,"mask","url(#".concat(current.maskId,")")),this.defs.append(mask),this._ensureTransformGroup().append(rect),this.paintInlineImageXObject(imgData,mask)}},{key:"paintFormXObjectBegin",value:function(matrix,bbox){if(Array.isArray(matrix)&&6===matrix.length&&this.transform(matrix[0],matrix[1],matrix[2],matrix[3],matrix[4],matrix[5]),bbox){var width=bbox[2]-bbox[0],height=bbox[3]-bbox[1],cliprect=this.svgFactory.createElement("svg:rect");cliprect.setAttributeNS(null,"x",bbox[0]),cliprect.setAttributeNS(null,"y",bbox[1]),cliprect.setAttributeNS(null,"width",pf(width)),cliprect.setAttributeNS(null,"height",pf(height)),this.current.element=cliprect,this.clip("nonzero"),this.endPath()}}},{key:"paintFormXObjectEnd",value:function(){}},{key:"_initialize",value:function(viewport){var svg=this.svgFactory.create(viewport.width,viewport.height),definitions=this.svgFactory.createElement("svg:defs");svg.append(definitions),this.defs=definitions;var rootGroup=this.svgFactory.createElement("svg:g");return rootGroup.setAttributeNS(null,"transform",pm(viewport.transform)),svg.append(rootGroup),this.svg=rootGroup,svg}},{key:"_ensureClipGroup",value:function(){if(!this.current.clipGroup){var clipGroup=this.svgFactory.createElement("svg:g");clipGroup.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(clipGroup),this.current.clipGroup=clipGroup}return this.current.clipGroup}},{key:"_ensureTransformGroup",value:function(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",pm(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}]),SVGGraphics}()},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFNodeStream=void 0;var _util=__w_pdfjs_require__(1),_network_utils=__w_pdfjs_require__(158),fs=__webpack_require__(767),http=__webpack_require__(251),https=__webpack_require__(677),url=__webpack_require__(543),fileUriRegex=/^file:\/\/\/[a-zA-Z]:\//,PDFNodeStream=function(){function PDFNodeStream(source){var sourceUrl,parsedUrl;_classCallCheck(this,PDFNodeStream),this.source=source,this.url=(sourceUrl=source.url,"file:"===(parsedUrl=url.parse(sourceUrl)).protocol||parsedUrl.host?parsedUrl:/^[a-z]:[/\\]/i.test(sourceUrl)?url.parse("file:///".concat(sourceUrl)):(parsedUrl.host||(parsedUrl.protocol="file:"),parsedUrl)),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&source.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}return _createClass(PDFNodeStream,[{key:"_progressiveDataLength",get:function(){var _this$_fullRequestRea,_this$_fullRequestRea2;return null!==(_this$_fullRequestRea=null===(_this$_fullRequestRea2=this._fullRequestReader)||void 0===_this$_fullRequestRea2?void 0:_this$_fullRequestRea2._loaded)&&void 0!==_this$_fullRequestRea?_this$_fullRequestRea:0}},{key:"getFullReader",value:function(){return(0,_util.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new PDFNodeStreamFsFullReader(this):new PDFNodeStreamFullReader(this),this._fullRequestReader}},{key:"getRangeReader",value:function(start,end){if(end<=this._progressiveDataLength)return null;var rangeReader=this.isFsUrl?new PDFNodeStreamFsRangeReader(this,start,end):new PDFNodeStreamRangeReader(this,start,end);return this._rangeRequestReaders.push(rangeReader),rangeReader}},{key:"cancelAllRequests",value:function(reason){this._fullRequestReader&&this._fullRequestReader.cancel(reason);var _step125,_iterator125=_createForOfIteratorHelper(this._rangeRequestReaders.slice(0));try{for(_iterator125.s();!(_step125=_iterator125.n()).done;)_step125.value.cancel(reason)}catch(err){_iterator125.e(err)}finally{_iterator125.f()}}}]),PDFNodeStream}();exports.PDFNodeStream=PDFNodeStream;var BaseFullReader=function(){function BaseFullReader(stream){_classCallCheck(this,BaseFullReader),this._url=stream.url,this._done=!1,this._storedError=null,this.onProgress=null;var source=stream.source;this._contentLength=source.length,this._loaded=0,this._filename=null,this._disableRange=source.disableRange||!1,this._rangeChunkSize=source.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!source.disableStream,this._isRangeSupported=!source.disableRange,this._readableStream=null,this._readCapability=(0,_util.createPromiseCapability)(),this._headersCapability=(0,_util.createPromiseCapability)()}var _read3;return _createClass(BaseFullReader,[{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(_read3=_asyncToGenerator(_regeneratorRuntime().mark((function _callee15(){var chunk,buffer;return _regeneratorRuntime().wrap((function(_context15){for(;;)switch(_context15.prev=_context15.next){case 0:return _context15.next=2,this._readCapability.promise;case 2:if(!this._done){_context15.next=4;break}return _context15.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){_context15.next=6;break}throw this._storedError;case 6:if(null!==(chunk=this._readableStream.read())){_context15.next=10;break}return this._readCapability=(0,_util.createPromiseCapability)(),_context15.abrupt("return",this.read());case 10:return this._loaded+=chunk.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),buffer=new Uint8Array(chunk).buffer,_context15.abrupt("return",{value:buffer,done:!1});case 14:case"end":return _context15.stop()}}),_callee15,this)}))),function(){return _read3.apply(this,arguments)})},{key:"cancel",value:function(reason){this._readableStream?this._readableStream.destroy(reason):this._error(reason)}},{key:"_error",value:function(reason){this._storedError=reason,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(readableStream){var _this73=this;this._readableStream=readableStream,readableStream.on("readable",(function(){_this73._readCapability.resolve()})),readableStream.on("end",(function(){readableStream.destroy(),_this73._done=!0,_this73._readCapability.resolve()})),readableStream.on("error",(function(reason){_this73._error(reason)})),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new _util.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}]),BaseFullReader}(),BaseRangeReader=function(){function BaseRangeReader(stream){_classCallCheck(this,BaseRangeReader),this._url=stream.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,_util.createPromiseCapability)();var source=stream.source;this._isStreamingSupported=!source.disableStream}var _read4;return _createClass(BaseRangeReader,[{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(_read4=_asyncToGenerator(_regeneratorRuntime().mark((function _callee16(){var chunk,buffer;return _regeneratorRuntime().wrap((function(_context16){for(;;)switch(_context16.prev=_context16.next){case 0:return _context16.next=2,this._readCapability.promise;case 2:if(!this._done){_context16.next=4;break}return _context16.abrupt("return",{value:void 0,done:!0});case 4:if(!this._storedError){_context16.next=6;break}throw this._storedError;case 6:if(null!==(chunk=this._readableStream.read())){_context16.next=10;break}return this._readCapability=(0,_util.createPromiseCapability)(),_context16.abrupt("return",this.read());case 10:return this._loaded+=chunk.length,this.onProgress&&this.onProgress({loaded:this._loaded}),buffer=new Uint8Array(chunk).buffer,_context16.abrupt("return",{value:buffer,done:!1});case 14:case"end":return _context16.stop()}}),_callee16,this)}))),function(){return _read4.apply(this,arguments)})},{key:"cancel",value:function(reason){this._readableStream?this._readableStream.destroy(reason):this._error(reason)}},{key:"_error",value:function(reason){this._storedError=reason,this._readCapability.resolve()}},{key:"_setReadableStream",value:function(readableStream){var _this74=this;this._readableStream=readableStream,readableStream.on("readable",(function(){_this74._readCapability.resolve()})),readableStream.on("end",(function(){readableStream.destroy(),_this74._done=!0,_this74._readCapability.resolve()})),readableStream.on("error",(function(reason){_this74._error(reason)})),this._storedError&&this._readableStream.destroy(this._storedError)}}]),BaseRangeReader}();function createRequestOptions(parsedUrl,headers){return{protocol:parsedUrl.protocol,auth:parsedUrl.auth,host:parsedUrl.hostname,port:parsedUrl.port,path:parsedUrl.path,method:"GET",headers:headers}}var PDFNodeStreamFullReader=function(_BaseFullReader){function PDFNodeStreamFullReader(stream){var _this75;_classCallCheck(this,PDFNodeStreamFullReader);var handleResponse=function(response){if(404===response.statusCode){var error=new _util.MissingPDFException('Missing PDF "'.concat(_this75._url,'".'));return _this75._storedError=error,void _this75._headersCapability.reject(error)}_this75._headersCapability.resolve(),_this75._setReadableStream(response);var getResponseHeader=function(name){return _this75._readableStream.headers[name.toLowerCase()]},_ref48=(0,_network_utils.validateRangeRequestCapabilities)({getResponseHeader:getResponseHeader,isHttp:stream.isHttp,rangeChunkSize:_this75._rangeChunkSize,disableRange:_this75._disableRange}),allowRangeRequests=_ref48.allowRangeRequests,suggestedLength=_ref48.suggestedLength;_this75._isRangeSupported=allowRangeRequests,_this75._contentLength=suggestedLength||_this75._contentLength,_this75._filename=(0,_network_utils.extractFilenameFromHeader)(getResponseHeader)};return(_this75=_callSuper(this,PDFNodeStreamFullReader,[stream]))._request=null,"http:"===_this75._url.protocol?_this75._request=http.request(createRequestOptions(_this75._url,stream.httpHeaders),handleResponse):_this75._request=https.request(createRequestOptions(_this75._url,stream.httpHeaders),handleResponse),_this75._request.on("error",(function(reason){_this75._storedError=reason,_this75._headersCapability.reject(reason)})),_this75._request.end(),_this75}return _inherits(PDFNodeStreamFullReader,_BaseFullReader),_createClass(PDFNodeStreamFullReader)}(BaseFullReader),PDFNodeStreamRangeReader=function(_BaseRangeReader){function PDFNodeStreamRangeReader(stream,start,end){var _this76;for(var property in _classCallCheck(this,PDFNodeStreamRangeReader),(_this76=_callSuper(this,PDFNodeStreamRangeReader,[stream]))._httpHeaders={},stream.httpHeaders){var value=stream.httpHeaders[property];void 0!==value&&(_this76._httpHeaders[property]=value)}_this76._httpHeaders.Range="bytes=".concat(start,"-").concat(end-1);var handleResponse=function(response){if(404!==response.statusCode)_this76._setReadableStream(response);else{var error=new _util.MissingPDFException('Missing PDF "'.concat(_this76._url,'".'));_this76._storedError=error}};return _this76._request=null,"http:"===_this76._url.protocol?_this76._request=http.request(createRequestOptions(_this76._url,_this76._httpHeaders),handleResponse):_this76._request=https.request(createRequestOptions(_this76._url,_this76._httpHeaders),handleResponse),_this76._request.on("error",(function(reason){_this76._storedError=reason})),_this76._request.end(),_this76}return _inherits(PDFNodeStreamRangeReader,_BaseRangeReader),_createClass(PDFNodeStreamRangeReader)}(BaseRangeReader),PDFNodeStreamFsFullReader=function(_BaseFullReader2){function PDFNodeStreamFsFullReader(stream){var _this77;_classCallCheck(this,PDFNodeStreamFsFullReader),_this77=_callSuper(this,PDFNodeStreamFsFullReader,[stream]);var path=decodeURIComponent(_this77._url.path);return fileUriRegex.test(_this77._url.href)&&(path=path.replace(/^\//,"")),fs.lstat(path,(function(error,stat){if(error)return"ENOENT"===error.code&&(error=new _util.MissingPDFException('Missing PDF "'.concat(path,'".'))),_this77._storedError=error,void _this77._headersCapability.reject(error);_this77._contentLength=stat.size,_this77._setReadableStream(fs.createReadStream(path)),_this77._headersCapability.resolve()})),_this77}return _inherits(PDFNodeStreamFsFullReader,_BaseFullReader2),_createClass(PDFNodeStreamFsFullReader)}(BaseFullReader),PDFNodeStreamFsRangeReader=function(_BaseRangeReader2){function PDFNodeStreamFsRangeReader(stream,start,end){var _this78;_classCallCheck(this,PDFNodeStreamFsRangeReader),_this78=_callSuper(this,PDFNodeStreamFsRangeReader,[stream]);var path=decodeURIComponent(_this78._url.path);return fileUriRegex.test(_this78._url.href)&&(path=path.replace(/^\//,"")),_this78._setReadableStream(fs.createReadStream(path,{start:start,end:end-1})),_this78}return _inherits(PDFNodeStreamFsRangeReader,_BaseRangeReader2),_createClass(PDFNodeStreamFsRangeReader)}(BaseRangeReader)},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createResponseStatusError=function(status,url){return 404===status||0===status&&url.startsWith("file:")?new _util.MissingPDFException('Missing PDF "'+url+'".'):new _util.UnexpectedResponseException("Unexpected server response (".concat(status,') while retrieving PDF "').concat(url,'".'),status)},exports.extractFilenameFromHeader=function(getResponseHeader){var contentDisposition=getResponseHeader("Content-Disposition");if(contentDisposition){var filename=(0,_content_disposition.getFilenameFromContentDispositionHeader)(contentDisposition);if(filename.includes("%"))try{filename=decodeURIComponent(filename)}catch(ex){}if((0,_display_utils.isPdfFile)(filename))return filename}return null},exports.validateRangeRequestCapabilities=function(_ref){var getResponseHeader=_ref.getResponseHeader,isHttp=_ref.isHttp,rangeChunkSize=_ref.rangeChunkSize,disableRange=_ref.disableRange,returnValues={allowRangeRequests:!1,suggestedLength:void 0},length=parseInt(getResponseHeader("Content-Length"),10);return Number.isInteger(length)?(returnValues.suggestedLength=length,length<=2*rangeChunkSize||disableRange||!isHttp||"bytes"!==getResponseHeader("Accept-Ranges")||"identity"!==(getResponseHeader("Content-Encoding")||"identity")||(returnValues.allowRangeRequests=!0),returnValues):returnValues},exports.validateResponseStatus=function(status){return 200===status||206===status};var _util=__w_pdfjs_require__(1),_content_disposition=__w_pdfjs_require__(159),_display_utils=__w_pdfjs_require__(133)},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getFilenameFromContentDispositionHeader=function(contentDisposition){var needsEncodingFixup=!0,tmp=toParamRegExp("filename\\*","i").exec(contentDisposition);if(tmp){var filename=rfc2616unquote(tmp=tmp[1]);return fixupEncoding(filename=rfc2047decode(filename=rfc5987decode(filename=unescape(filename))))}if(tmp=function(contentDispositionStr){for(var match,matches=[],iter=toParamRegExp("filename\\*((?!0\\d)\\d+)(\\*?)","ig");null!==(match=iter.exec(contentDispositionStr));){var _match3=_slicedToArray(match,4),n=_match3[1],quot=_match3[2],part=_match3[3];if((n=parseInt(n,10))in matches){if(0===n)break}else matches[n]=[quot,part]}for(var parts=[],_n=0;_n<matches.length&&_n in matches;++_n){var _matches$_n=_slicedToArray(matches[_n],2),_quot=_matches$_n[0],_part=_matches$_n[1];_part=rfc2616unquote(_part),_quot&&(_part=unescape(_part),0===_n&&(_part=rfc5987decode(_part))),parts.push(_part)}return parts.join("")}(contentDisposition))return fixupEncoding(rfc2047decode(tmp));if(tmp=toParamRegExp("filename","i").exec(contentDisposition)){var _filename2=rfc2616unquote(tmp=tmp[1]);return fixupEncoding(_filename2=rfc2047decode(_filename2))}function toParamRegExp(attributePattern,flags){return new RegExp("(?:^|;)\\s*"+attributePattern+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',flags)}function textdecode(encoding,value){if(encoding){if(!/^[\x00-\xFF]+$/.test(value))return value;try{var decoder=new TextDecoder(encoding,{fatal:!0}),buffer=(0,_util.stringToBytes)(value);value=decoder.decode(buffer),needsEncodingFixup=!1}catch(e){}}return value}function fixupEncoding(value){return needsEncodingFixup&&/[\x80-\xff]/.test(value)&&(value=textdecode("utf-8",value),needsEncodingFixup&&(value=textdecode("iso-8859-1",value))),value}function rfc2616unquote(value){if(value.startsWith('"')){for(var parts=value.slice(1).split('\\"'),i=0;i<parts.length;++i){var quotindex=parts[i].indexOf('"');-1!==quotindex&&(parts[i]=parts[i].slice(0,quotindex),parts.length=i+1),parts[i]=parts[i].replace(/\\(.)/g,"$1")}value=parts.join('"')}return value}function rfc5987decode(extvalue){var encodingend=extvalue.indexOf("'");return-1===encodingend?extvalue:textdecode(extvalue.slice(0,encodingend),extvalue.slice(encodingend+1).replace(/^[^']*'/,""))}function rfc2047decode(value){return!value.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(value)?value:value.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(matches,charset,encoding,text){if("q"===encoding||"Q"===encoding)return textdecode(charset,text=(text=text.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,(function(match,hex){return String.fromCharCode(parseInt(hex,16))})));try{text=atob(text)}catch(e){}return textdecode(charset,text)}))}return""};var _util=__w_pdfjs_require__(1)},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFNetworkStream=void 0;var _util=__w_pdfjs_require__(1),_network_utils=__w_pdfjs_require__(158),NetworkManager=function(){function NetworkManager(url){_classCallCheck(this,NetworkManager);var args=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.url=url,this.isHttp=/^https?:/i.test(url),this.httpHeaders=this.isHttp&&args.httpHeaders||Object.create(null),this.withCredentials=args.withCredentials||!1,this.getXhr=args.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}return _createClass(NetworkManager,[{key:"requestRange",value:function(begin,end,listeners){var args={begin:begin,end:end};for(var prop in listeners)args[prop]=listeners[prop];return this.request(args)}},{key:"requestFull",value:function(listeners){return this.request(listeners)}},{key:"request",value:function(args){var xhr=this.getXhr(),xhrId=this.currXhrId++,pendingRequest=this.pendingRequests[xhrId]={xhr:xhr};for(var property in xhr.open("GET",this.url),xhr.withCredentials=this.withCredentials,this.httpHeaders){var value=this.httpHeaders[property];void 0!==value&&xhr.setRequestHeader(property,value)}return this.isHttp&&"begin"in args&&"end"in args?(xhr.setRequestHeader("Range","bytes=".concat(args.begin,"-").concat(args.end-1)),pendingRequest.expectedStatus=206):pendingRequest.expectedStatus=200,xhr.responseType="arraybuffer",args.onError&&(xhr.onerror=function(evt){args.onError(xhr.status)}),xhr.onreadystatechange=this.onStateChange.bind(this,xhrId),xhr.onprogress=this.onProgress.bind(this,xhrId),pendingRequest.onHeadersReceived=args.onHeadersReceived,pendingRequest.onDone=args.onDone,pendingRequest.onError=args.onError,pendingRequest.onProgress=args.onProgress,xhr.send(null),xhrId}},{key:"onProgress",value:function(xhrId,evt){var _pendingRequest$onPro,pendingRequest=this.pendingRequests[xhrId];pendingRequest&&(null===(_pendingRequest$onPro=pendingRequest.onProgress)||void 0===_pendingRequest$onPro||_pendingRequest$onPro.call(pendingRequest,evt))}},{key:"onStateChange",value:function(xhrId,evt){var pendingRequest=this.pendingRequests[xhrId];if(pendingRequest){var xhr=pendingRequest.xhr;if(xhr.readyState>=2&&pendingRequest.onHeadersReceived&&(pendingRequest.onHeadersReceived(),delete pendingRequest.onHeadersReceived),4===xhr.readyState&&xhrId in this.pendingRequests)if(delete this.pendingRequests[xhrId],0===xhr.status&&this.isHttp){var _pendingRequest$onErr;null===(_pendingRequest$onErr=pendingRequest.onError)||void 0===_pendingRequest$onErr||_pendingRequest$onErr.call(pendingRequest,xhr.status)}else{var xhrStatus=xhr.status||200;if(200===xhrStatus&&206===pendingRequest.expectedStatus||xhrStatus===pendingRequest.expectedStatus){var chunk=function(xhr){var data=xhr.response;return"string"!=typeof data?data:(0,_util.stringToBytes)(data).buffer}(xhr);if(206===xhrStatus){var rangeHeader=xhr.getResponseHeader("Content-Range"),matches=/bytes (\d+)-(\d+)\/(\d+)/.exec(rangeHeader);pendingRequest.onDone({begin:parseInt(matches[1],10),chunk:chunk})}else if(chunk)pendingRequest.onDone({begin:0,chunk:chunk});else{var _pendingRequest$onErr3;null===(_pendingRequest$onErr3=pendingRequest.onError)||void 0===_pendingRequest$onErr3||_pendingRequest$onErr3.call(pendingRequest,xhr.status)}}else{var _pendingRequest$onErr2;null===(_pendingRequest$onErr2=pendingRequest.onError)||void 0===_pendingRequest$onErr2||_pendingRequest$onErr2.call(pendingRequest,xhr.status)}}}}},{key:"getRequestXhr",value:function(xhrId){return this.pendingRequests[xhrId].xhr}},{key:"isPendingRequest",value:function(xhrId){return xhrId in this.pendingRequests}},{key:"abortRequest",value:function(xhrId){var xhr=this.pendingRequests[xhrId].xhr;delete this.pendingRequests[xhrId],xhr.abort()}}]),NetworkManager}(),PDFNetworkStream=function(){function PDFNetworkStream(source){_classCallCheck(this,PDFNetworkStream),this._source=source,this._manager=new NetworkManager(source.url,{httpHeaders:source.httpHeaders,withCredentials:source.withCredentials}),this._rangeChunkSize=source.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}return _createClass(PDFNetworkStream,[{key:"_onRangeRequestReaderClosed",value:function(reader){var i=this._rangeRequestReaders.indexOf(reader);i>=0&&this._rangeRequestReaders.splice(i,1)}},{key:"getFullReader",value:function(){return(0,_util.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new PDFNetworkStreamFullRequestReader(this._manager,this._source),this._fullRequestReader}},{key:"getRangeReader",value:function(begin,end){var reader=new PDFNetworkStreamRangeRequestReader(this._manager,begin,end);return reader.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(reader),reader}},{key:"cancelAllRequests",value:function(reason){var _this$_fullRequestRea;null===(_this$_fullRequestRea=this._fullRequestReader)||void 0===_this$_fullRequestRea||_this$_fullRequestRea.cancel(reason);var _step126,_iterator126=_createForOfIteratorHelper(this._rangeRequestReaders.slice(0));try{for(_iterator126.s();!(_step126=_iterator126.n()).done;)_step126.value.cancel(reason)}catch(err){_iterator126.e(err)}finally{_iterator126.f()}}}]),PDFNetworkStream}();exports.PDFNetworkStream=PDFNetworkStream;var PDFNetworkStreamFullRequestReader=function(){function PDFNetworkStreamFullRequestReader(manager,source){_classCallCheck(this,PDFNetworkStreamFullRequestReader),this._manager=manager;var args={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=source.url,this._fullRequestId=manager.requestFull(args),this._headersReceivedCapability=(0,_util.createPromiseCapability)(),this._disableRange=source.disableRange||!1,this._contentLength=source.length,this._rangeChunkSize=source.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}var _read5;return _createClass(PDFNetworkStreamFullRequestReader,[{key:"_onHeadersReceived",value:function(){var fullRequestXhrId=this._fullRequestId,fullRequestXhr=this._manager.getRequestXhr(fullRequestXhrId),getResponseHeader=function(name){return fullRequestXhr.getResponseHeader(name)},_ref49=(0,_network_utils.validateRangeRequestCapabilities)({getResponseHeader:getResponseHeader,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange}),allowRangeRequests=_ref49.allowRangeRequests,suggestedLength=_ref49.suggestedLength;allowRangeRequests&&(this._isRangeSupported=!0),this._contentLength=suggestedLength||this._contentLength,this._filename=(0,_network_utils.extractFilenameFromHeader)(getResponseHeader),this._isRangeSupported&&this._manager.abortRequest(fullRequestXhrId),this._headersReceivedCapability.resolve()}},{key:"_onDone",value:function(data){if(data&&(this._requests.length>0?this._requests.shift().resolve({value:data.chunk,done:!1}):this._cachedChunks.push(data.chunk)),this._done=!0,!(this._cachedChunks.length>0)){var _step127,_iterator127=_createForOfIteratorHelper(this._requests);try{for(_iterator127.s();!(_step127=_iterator127.n()).done;)_step127.value.resolve({value:void 0,done:!0})}catch(err){_iterator127.e(err)}finally{_iterator127.f()}this._requests.length=0}}},{key:"_onError",value:function(status){this._storedError=(0,_network_utils.createResponseStatusError)(status,this._url),this._headersReceivedCapability.reject(this._storedError);var _step128,_iterator128=_createForOfIteratorHelper(this._requests);try{for(_iterator128.s();!(_step128=_iterator128.n()).done;)_step128.value.reject(this._storedError)}catch(err){_iterator128.e(err)}finally{_iterator128.f()}this._requests.length=0,this._cachedChunks.length=0}},{key:"_onProgress",value:function(evt){var _this$onProgress;null===(_this$onProgress=this.onProgress)||void 0===_this$onProgress||_this$onProgress.call(this,{loaded:evt.loaded,total:evt.lengthComputable?evt.total:this._contentLength})}},{key:"filename",get:function(){return this._filename}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"contentLength",get:function(){return this._contentLength}},{key:"headersReady",get:function(){return this._headersReceivedCapability.promise}},{key:"read",value:(_read5=_asyncToGenerator(_regeneratorRuntime().mark((function _callee17(){var chunk,requestCapability;return _regeneratorRuntime().wrap((function(_context17){for(;;)switch(_context17.prev=_context17.next){case 0:if(!this._storedError){_context17.next=2;break}throw this._storedError;case 2:if(!(this._cachedChunks.length>0)){_context17.next=5;break}return chunk=this._cachedChunks.shift(),_context17.abrupt("return",{value:chunk,done:!1});case 5:if(!this._done){_context17.next=7;break}return _context17.abrupt("return",{value:void 0,done:!0});case 7:return requestCapability=(0,_util.createPromiseCapability)(),this._requests.push(requestCapability),_context17.abrupt("return",requestCapability.promise);case 10:case"end":return _context17.stop()}}),_callee17,this)}))),function(){return _read5.apply(this,arguments)})},{key:"cancel",value:function(reason){this._done=!0,this._headersReceivedCapability.reject(reason);var _step129,_iterator129=_createForOfIteratorHelper(this._requests);try{for(_iterator129.s();!(_step129=_iterator129.n()).done;)_step129.value.resolve({value:void 0,done:!0})}catch(err){_iterator129.e(err)}finally{_iterator129.f()}this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}]),PDFNetworkStreamFullRequestReader}(),PDFNetworkStreamRangeRequestReader=function(){function PDFNetworkStreamRangeRequestReader(manager,begin,end){_classCallCheck(this,PDFNetworkStreamRangeRequestReader),this._manager=manager;var args={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=manager.url,this._requestId=manager.requestRange(begin,end,args),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}var _read6;return _createClass(PDFNetworkStreamRangeRequestReader,[{key:"_close",value:function(){var _this$onClosed;null===(_this$onClosed=this.onClosed)||void 0===_this$onClosed||_this$onClosed.call(this,this)}},{key:"_onDone",value:function(data){var chunk=data.chunk;this._requests.length>0?this._requests.shift().resolve({value:chunk,done:!1}):this._queuedChunk=chunk,this._done=!0;var _step130,_iterator130=_createForOfIteratorHelper(this._requests);try{for(_iterator130.s();!(_step130=_iterator130.n()).done;)_step130.value.resolve({value:void 0,done:!0})}catch(err){_iterator130.e(err)}finally{_iterator130.f()}this._requests.length=0,this._close()}},{key:"_onError",value:function(status){this._storedError=(0,_network_utils.createResponseStatusError)(status,this._url);var _step131,_iterator131=_createForOfIteratorHelper(this._requests);try{for(_iterator131.s();!(_step131=_iterator131.n()).done;)_step131.value.reject(this._storedError)}catch(err){_iterator131.e(err)}finally{_iterator131.f()}this._requests.length=0,this._queuedChunk=null}},{key:"_onProgress",value:function(evt){var _this$onProgress2;this.isStreamingSupported||null===(_this$onProgress2=this.onProgress)||void 0===_this$onProgress2||_this$onProgress2.call(this,{loaded:evt.loaded})}},{key:"isStreamingSupported",get:function(){return!1}},{key:"read",value:(_read6=_asyncToGenerator(_regeneratorRuntime().mark((function _callee18(){var chunk,requestCapability;return _regeneratorRuntime().wrap((function(_context18){for(;;)switch(_context18.prev=_context18.next){case 0:if(!this._storedError){_context18.next=2;break}throw this._storedError;case 2:if(null===this._queuedChunk){_context18.next=6;break}return chunk=this._queuedChunk,this._queuedChunk=null,_context18.abrupt("return",{value:chunk,done:!1});case 6:if(!this._done){_context18.next=8;break}return _context18.abrupt("return",{value:void 0,done:!0});case 8:return requestCapability=(0,_util.createPromiseCapability)(),this._requests.push(requestCapability),_context18.abrupt("return",requestCapability.promise);case 11:case"end":return _context18.stop()}}),_callee18,this)}))),function(){return _read6.apply(this,arguments)})},{key:"cancel",value:function(reason){this._done=!0;var _step132,_iterator132=_createForOfIteratorHelper(this._requests);try{for(_iterator132.s();!(_step132=_iterator132.n()).done;)_step132.value.resolve({value:void 0,done:!0})}catch(err){_iterator132.e(err)}finally{_iterator132.f()}this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}]),PDFNetworkStreamRangeRequestReader}()},function(__unused_webpack_module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.PDFFetchStream=void 0;var _util=__w_pdfjs_require__(1),_network_utils=__w_pdfjs_require__(158);function createFetchOptions(headers,withCredentials,abortController){return{method:"GET",headers:headers,signal:abortController.signal,mode:"cors",credentials:withCredentials?"include":"same-origin",redirect:"follow"}}function createHeaders(httpHeaders){var headers=new Headers;for(var property in httpHeaders){var value=httpHeaders[property];void 0!==value&&headers.append(property,value)}return headers}var PDFFetchStream=function(){function PDFFetchStream(source){_classCallCheck(this,PDFFetchStream),this.source=source,this.isHttp=/^https?:/i.test(source.url),this.httpHeaders=this.isHttp&&source.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}return _createClass(PDFFetchStream,[{key:"_progressiveDataLength",get:function(){var _this$_fullRequestRea,_this$_fullRequestRea2;return null!==(_this$_fullRequestRea=null===(_this$_fullRequestRea2=this._fullRequestReader)||void 0===_this$_fullRequestRea2?void 0:_this$_fullRequestRea2._loaded)&&void 0!==_this$_fullRequestRea?_this$_fullRequestRea:0}},{key:"getFullReader",value:function(){return(0,_util.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new PDFFetchStreamReader(this),this._fullRequestReader}},{key:"getRangeReader",value:function(begin,end){if(end<=this._progressiveDataLength)return null;var reader=new PDFFetchStreamRangeReader(this,begin,end);return this._rangeRequestReaders.push(reader),reader}},{key:"cancelAllRequests",value:function(reason){this._fullRequestReader&&this._fullRequestReader.cancel(reason);var _step133,_iterator133=_createForOfIteratorHelper(this._rangeRequestReaders.slice(0));try{for(_iterator133.s();!(_step133=_iterator133.n()).done;)_step133.value.cancel(reason)}catch(err){_iterator133.e(err)}finally{_iterator133.f()}}}]),PDFFetchStream}();exports.PDFFetchStream=PDFFetchStream;var PDFFetchStreamReader=function(){function PDFFetchStreamReader(stream){var _this79=this;_classCallCheck(this,PDFFetchStreamReader),this._stream=stream,this._reader=null,this._loaded=0,this._filename=null;var source=stream.source;this._withCredentials=source.withCredentials||!1,this._contentLength=source.length,this._headersCapability=(0,_util.createPromiseCapability)(),this._disableRange=source.disableRange||!1,this._rangeChunkSize=source.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!source.disableStream,this._isRangeSupported=!source.disableRange,this._headers=createHeaders(this._stream.httpHeaders);var url=source.url;fetch(url,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then((function(response){if(!(0,_network_utils.validateResponseStatus)(response.status))throw(0,_network_utils.createResponseStatusError)(response.status,url);_this79._reader=response.body.getReader(),_this79._headersCapability.resolve();var getResponseHeader=function(name){return response.headers.get(name)},_ref50=(0,_network_utils.validateRangeRequestCapabilities)({getResponseHeader:getResponseHeader,isHttp:_this79._stream.isHttp,rangeChunkSize:_this79._rangeChunkSize,disableRange:_this79._disableRange}),allowRangeRequests=_ref50.allowRangeRequests,suggestedLength=_ref50.suggestedLength;_this79._isRangeSupported=allowRangeRequests,_this79._contentLength=suggestedLength||_this79._contentLength,_this79._filename=(0,_network_utils.extractFilenameFromHeader)(getResponseHeader),!_this79._isStreamingSupported&&_this79._isRangeSupported&&_this79.cancel(new _util.AbortException("Streaming is disabled."))})).catch(this._headersCapability.reject),this.onProgress=null}var _read7;return _createClass(PDFFetchStreamReader,[{key:"headersReady",get:function(){return this._headersCapability.promise}},{key:"filename",get:function(){return this._filename}},{key:"contentLength",get:function(){return this._contentLength}},{key:"isRangeSupported",get:function(){return this._isRangeSupported}},{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(_read7=_asyncToGenerator(_regeneratorRuntime().mark((function _callee19(){var _yield$this$_reader$r,value,done,buffer;return _regeneratorRuntime().wrap((function(_context19){for(;;)switch(_context19.prev=_context19.next){case 0:return _context19.next=2,this._headersCapability.promise;case 2:return _context19.next=4,this._reader.read();case 4:if(_yield$this$_reader$r=_context19.sent,value=_yield$this$_reader$r.value,!(done=_yield$this$_reader$r.done)){_context19.next=9;break}return _context19.abrupt("return",{value:value,done:done});case 9:return this._loaded+=value.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),buffer=new Uint8Array(value).buffer,_context19.abrupt("return",{value:buffer,done:!1});case 13:case"end":return _context19.stop()}}),_callee19,this)}))),function(){return _read7.apply(this,arguments)})},{key:"cancel",value:function(reason){this._reader&&this._reader.cancel(reason),this._abortController.abort()}}]),PDFFetchStreamReader}(),PDFFetchStreamRangeReader=function(){function PDFFetchStreamRangeReader(stream,begin,end){var _this80=this;_classCallCheck(this,PDFFetchStreamRangeReader),this._stream=stream,this._reader=null,this._loaded=0;var source=stream.source;this._withCredentials=source.withCredentials||!1,this._readCapability=(0,_util.createPromiseCapability)(),this._isStreamingSupported=!source.disableStream,this._abortController=new AbortController,this._headers=createHeaders(this._stream.httpHeaders),this._headers.append("Range","bytes=".concat(begin,"-").concat(end-1));var url=source.url;fetch(url,createFetchOptions(this._headers,this._withCredentials,this._abortController)).then((function(response){if(!(0,_network_utils.validateResponseStatus)(response.status))throw(0,_network_utils.createResponseStatusError)(response.status,url);_this80._readCapability.resolve(),_this80._reader=response.body.getReader()})).catch(this._readCapability.reject),this.onProgress=null}var _read8;return _createClass(PDFFetchStreamRangeReader,[{key:"isStreamingSupported",get:function(){return this._isStreamingSupported}},{key:"read",value:(_read8=_asyncToGenerator(_regeneratorRuntime().mark((function _callee20(){var _yield$this$_reader$r2,value,done,buffer;return _regeneratorRuntime().wrap((function(_context20){for(;;)switch(_context20.prev=_context20.next){case 0:return _context20.next=2,this._readCapability.promise;case 2:return _context20.next=4,this._reader.read();case 4:if(_yield$this$_reader$r2=_context20.sent,value=_yield$this$_reader$r2.value,!(done=_yield$this$_reader$r2.done)){_context20.next=9;break}return _context20.abrupt("return",{value:value,done:done});case 9:return this._loaded+=value.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),buffer=new Uint8Array(value).buffer,_context20.abrupt("return",{value:buffer,done:!1});case 13:case"end":return _context20.stop()}}),_callee20,this)}))),function(){return _read8.apply(this,arguments)})},{key:"cancel",value:function(reason){this._reader&&this._reader.cancel(reason),this._abortController.abort()}}]),PDFFetchStreamRangeReader}()}],__webpack_module_cache__={};function __w_pdfjs_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__w_pdfjs_require__),module.exports}var __nested_webpack_exports__={};return function(){"use strict";var exports=__nested_webpack_exports__;Object.defineProperty(exports,"__esModule",{value:!0}),Object.defineProperty(exports,"AnnotationEditorLayer",{enumerable:!0,get:function(){return _annotation_editor_layer.AnnotationEditorLayer}}),Object.defineProperty(exports,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return _util.AnnotationEditorParamsType}}),Object.defineProperty(exports,"AnnotationEditorType",{enumerable:!0,get:function(){return _util.AnnotationEditorType}}),Object.defineProperty(exports,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return _tools.AnnotationEditorUIManager}}),Object.defineProperty(exports,"AnnotationLayer",{enumerable:!0,get:function(){return _annotation_layer.AnnotationLayer}}),Object.defineProperty(exports,"AnnotationMode",{enumerable:!0,get:function(){return _util.AnnotationMode}}),Object.defineProperty(exports,"CMapCompressionType",{enumerable:!0,get:function(){return _util.CMapCompressionType}}),Object.defineProperty(exports,"GlobalWorkerOptions",{enumerable:!0,get:function(){return _worker_options.GlobalWorkerOptions}}),Object.defineProperty(exports,"InvalidPDFException",{enumerable:!0,get:function(){return _util.InvalidPDFException}}),Object.defineProperty(exports,"LoopbackPort",{enumerable:!0,get:function(){return _api.LoopbackPort}}),Object.defineProperty(exports,"MissingPDFException",{enumerable:!0,get:function(){return _util.MissingPDFException}}),Object.defineProperty(exports,"OPS",{enumerable:!0,get:function(){return _util.OPS}}),Object.defineProperty(exports,"PDFDataRangeTransport",{enumerable:!0,get:function(){return _api.PDFDataRangeTransport}}),Object.defineProperty(exports,"PDFDateString",{enumerable:!0,get:function(){return _display_utils.PDFDateString}}),Object.defineProperty(exports,"PDFWorker",{enumerable:!0,get:function(){return _api.PDFWorker}}),Object.defineProperty(exports,"PasswordResponses",{enumerable:!0,get:function(){return _util.PasswordResponses}}),Object.defineProperty(exports,"PermissionFlag",{enumerable:!0,get:function(){return _util.PermissionFlag}}),Object.defineProperty(exports,"PixelsPerInch",{enumerable:!0,get:function(){return _display_utils.PixelsPerInch}}),Object.defineProperty(exports,"RenderingCancelledException",{enumerable:!0,get:function(){return _display_utils.RenderingCancelledException}}),Object.defineProperty(exports,"SVGGraphics",{enumerable:!0,get:function(){return _svg.SVGGraphics}}),Object.defineProperty(exports,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return _util.UNSUPPORTED_FEATURES}}),Object.defineProperty(exports,"UnexpectedResponseException",{enumerable:!0,get:function(){return _util.UnexpectedResponseException}}),Object.defineProperty(exports,"Util",{enumerable:!0,get:function(){return _util.Util}}),Object.defineProperty(exports,"VerbosityLevel",{enumerable:!0,get:function(){return _util.VerbosityLevel}}),Object.defineProperty(exports,"XfaLayer",{enumerable:!0,get:function(){return _xfa_layer.XfaLayer}}),Object.defineProperty(exports,"build",{enumerable:!0,get:function(){return _api.build}}),Object.defineProperty(exports,"createPromiseCapability",{enumerable:!0,get:function(){return _util.createPromiseCapability}}),Object.defineProperty(exports,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return _util.createValidAbsoluteUrl}}),Object.defineProperty(exports,"getDocument",{enumerable:!0,get:function(){return _api.getDocument}}),Object.defineProperty(exports,"getFilenameFromUrl",{enumerable:!0,get:function(){return _display_utils.getFilenameFromUrl}}),Object.defineProperty(exports,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return _display_utils.getPdfFilenameFromUrl}}),Object.defineProperty(exports,"getXfaPageViewport",{enumerable:!0,get:function(){return _display_utils.getXfaPageViewport}}),Object.defineProperty(exports,"isPdfFile",{enumerable:!0,get:function(){return _display_utils.isPdfFile}}),Object.defineProperty(exports,"loadScript",{enumerable:!0,get:function(){return _display_utils.loadScript}}),Object.defineProperty(exports,"renderTextLayer",{enumerable:!0,get:function(){return _text_layer.renderTextLayer}}),Object.defineProperty(exports,"shadow",{enumerable:!0,get:function(){return _util.shadow}}),Object.defineProperty(exports,"version",{enumerable:!0,get:function(){return _api.version}});var _util=__w_pdfjs_require__(1),_api=__w_pdfjs_require__(129),_display_utils=__w_pdfjs_require__(133),_annotation_editor_layer=__w_pdfjs_require__(147),_tools=__w_pdfjs_require__(132),_annotation_layer=__w_pdfjs_require__(152),_worker_options=__w_pdfjs_require__(140),_is_node=__w_pdfjs_require__(3),_text_layer=__w_pdfjs_require__(155),_svg=__w_pdfjs_require__(156),_xfa_layer=__w_pdfjs_require__(154);if(_is_node.isNodeJS){var PDFNodeStream=__w_pdfjs_require__(157).PDFNodeStream;(0,_api.setPDFNetworkStreamFactory)((function(params){return new PDFNodeStream(params)}))}else{var PDFNetworkStream=__w_pdfjs_require__(160).PDFNetworkStream,PDFFetchStream=__w_pdfjs_require__(161).PDFFetchStream;(0,_api.setPDFNetworkStreamFactory)((function(params){return(0,_display_utils.isValidFetchUrl)(params.url)?new PDFFetchStream(params):new PDFNetworkStream(params)}))}}(),__nested_webpack_exports__}()},"object"===_typeof(exports)&&"object"===_typeof(module)?module.exports=factory():(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},76:function(module){var cachedSetTimeout,cachedClearTimeout,process=module.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(fun){if(cachedSetTimeout===setTimeout)return setTimeout(fun,0);if((cachedSetTimeout===defaultSetTimout||!cachedSetTimeout)&&setTimeout)return cachedSetTimeout=setTimeout,setTimeout(fun,0);try{return cachedSetTimeout(fun,0)}catch(e){try{return cachedSetTimeout.call(null,fun,0)}catch(e){return cachedSetTimeout.call(this,fun,0)}}}!function(){try{cachedSetTimeout="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){cachedSetTimeout=defaultSetTimout}try{cachedClearTimeout="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){cachedClearTimeout=defaultClearTimeout}}();var currentQueue,queue=[],draining=!1,queueIndex=-1;function cleanUpNextTick(){draining&&currentQueue&&(draining=!1,currentQueue.length?queue=currentQueue.concat(queue):queueIndex=-1,queue.length&&drainQueue())}function drainQueue(){if(!draining){var timeout=runTimeout(cleanUpNextTick);draining=!0;for(var len=queue.length;len;){for(currentQueue=queue,queue=[];++queueIndex<len;)currentQueue&&currentQueue[queueIndex].run();queueIndex=-1,len=queue.length}currentQueue=null,draining=!1,function(marker){if(cachedClearTimeout===clearTimeout)return clearTimeout(marker);if((cachedClearTimeout===defaultClearTimeout||!cachedClearTimeout)&&clearTimeout)return cachedClearTimeout=clearTimeout,clearTimeout(marker);try{return cachedClearTimeout(marker)}catch(e){try{return cachedClearTimeout.call(null,marker)}catch(e){return cachedClearTimeout.call(this,marker)}}}(timeout)}}function Item(fun,array){this.fun=fun,this.array=array}function noop(){}process.nextTick=function(fun){var args=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)args[i-1]=arguments[i];queue.push(new Item(fun,args)),1!==queue.length||draining||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},process.title="browser",process.browser=!0,process.env={},process.argv=[],process.version="",process.versions={},process.on=noop,process.addListener=noop,process.once=noop,process.off=noop,process.removeListener=noop,process.removeAllListeners=noop,process.emit=noop,process.prependListener=noop,process.prependOnceListener=noop,process.listeners=function(name){return[]},process.binding=function(name){throw new Error("process.binding is not supported")},process.cwd=function(){return"/"},process.chdir=function(dir){throw new Error("process.chdir is not supported")},process.umask=function(){return 0}},339:function(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}factory=function(exports){"use strict";var SymbolPolyfill="function"==typeof Symbol&&"symbol"===_typeof(Symbol.iterator)?Symbol:function(description){return"Symbol("+description+")"};function noop(){}var globals="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:void 0;function typeIsObject(x){return"object"===_typeof(x)&&null!==x||"function"==typeof x}var rethrowAssertionErrorRejection=noop,originalPromise=Promise,originalPromiseThen=Promise.prototype.then,originalPromiseResolve=Promise.resolve.bind(originalPromise),originalPromiseReject=Promise.reject.bind(originalPromise);function newPromise(executor){return new originalPromise(executor)}function promiseResolvedWith(value){return originalPromiseResolve(value)}function promiseRejectedWith(reason){return originalPromiseReject(reason)}function PerformPromiseThen(promise,onFulfilled,onRejected){return originalPromiseThen.call(promise,onFulfilled,onRejected)}function uponPromise(promise,onFulfilled,onRejected){PerformPromiseThen(PerformPromiseThen(promise,onFulfilled,onRejected),void 0,rethrowAssertionErrorRejection)}function uponFulfillment(promise,onFulfilled){uponPromise(promise,onFulfilled)}function uponRejection(promise,onRejected){uponPromise(promise,void 0,onRejected)}function transformPromiseWith(promise,fulfillmentHandler,rejectionHandler){return PerformPromiseThen(promise,fulfillmentHandler,rejectionHandler)}function setPromiseIsHandledToTrue(promise){PerformPromiseThen(promise,void 0,rethrowAssertionErrorRejection)}var queueMicrotask=function(){var globalQueueMicrotask=globals&&globals.queueMicrotask;if("function"==typeof globalQueueMicrotask)return globalQueueMicrotask;var resolvedPromise=promiseResolvedWith(void 0);return function(fn){return PerformPromiseThen(resolvedPromise,fn)}}();function reflectCall(F,V,args){if("function"!=typeof F)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(F,V,args)}function promiseCall(F,V,args){try{return promiseResolvedWith(reflectCall(F,V,args))}catch(value){return promiseRejectedWith(value)}}var SimpleQueue=function(){function SimpleQueue(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}return Object.defineProperty(SimpleQueue.prototype,"length",{get:function(){return this._size},enumerable:!1,configurable:!0}),SimpleQueue.prototype.push=function(element){var oldBack=this._back,newBack=oldBack;16383===oldBack._elements.length&&(newBack={_elements:[],_next:void 0}),oldBack._elements.push(element),newBack!==oldBack&&(this._back=newBack,oldBack._next=newBack),++this._size},SimpleQueue.prototype.shift=function(){var oldFront=this._front,newFront=oldFront,oldCursor=this._cursor,newCursor=oldCursor+1,elements=oldFront._elements,element=elements[oldCursor];return 16384===newCursor&&(newFront=oldFront._next,newCursor=0),--this._size,this._cursor=newCursor,oldFront!==newFront&&(this._front=newFront),elements[oldCursor]=void 0,element},SimpleQueue.prototype.forEach=function(callback){for(var i=this._cursor,node=this._front,elements=node._elements;!(i===elements.length&&void 0===node._next||i===elements.length&&(i=0,0===(elements=(node=node._next)._elements).length));)callback(elements[i]),++i},SimpleQueue.prototype.peek=function(){var front=this._front,cursor=this._cursor;return front._elements[cursor]},SimpleQueue}();function ReadableStreamReaderGenericInitialize(reader,stream){reader._ownerReadableStream=stream,stream._reader=reader,"readable"===stream._state?defaultReaderClosedPromiseInitialize(reader):"closed"===stream._state?function(reader){defaultReaderClosedPromiseInitialize(reader),defaultReaderClosedPromiseResolve(reader)}(reader):defaultReaderClosedPromiseInitializeAsRejected(reader,stream._storedError)}function ReadableStreamReaderGenericCancel(reader,reason){return ReadableStreamCancel(reader._ownerReadableStream,reason)}function ReadableStreamReaderGenericRelease(reader){"readable"===reader._ownerReadableStream._state?defaultReaderClosedPromiseReject(reader,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):function(reader,reason){defaultReaderClosedPromiseInitializeAsRejected(reader,reason)}(reader,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),reader._ownerReadableStream._reader=void 0,reader._ownerReadableStream=void 0}function readerLockException(name){return new TypeError("Cannot "+name+" a stream using a released reader")}function defaultReaderClosedPromiseInitialize(reader){reader._closedPromise=newPromise((function(resolve,reject){reader._closedPromise_resolve=resolve,reader._closedPromise_reject=reject}))}function defaultReaderClosedPromiseInitializeAsRejected(reader,reason){defaultReaderClosedPromiseInitialize(reader),defaultReaderClosedPromiseReject(reader,reason)}function defaultReaderClosedPromiseReject(reader,reason){void 0!==reader._closedPromise_reject&&(setPromiseIsHandledToTrue(reader._closedPromise),reader._closedPromise_reject(reason),reader._closedPromise_resolve=void 0,reader._closedPromise_reject=void 0)}function defaultReaderClosedPromiseResolve(reader){void 0!==reader._closedPromise_resolve&&(reader._closedPromise_resolve(void 0),reader._closedPromise_resolve=void 0,reader._closedPromise_reject=void 0)}var AbortSteps=SymbolPolyfill("[[AbortSteps]]"),ErrorSteps=SymbolPolyfill("[[ErrorSteps]]"),CancelSteps=SymbolPolyfill("[[CancelSteps]]"),PullSteps=SymbolPolyfill("[[PullSteps]]"),NumberIsFinite=Number.isFinite||function(x){return"number"==typeof x&&isFinite(x)},MathTrunc=Math.trunc||function(v){return v<0?Math.ceil(v):Math.floor(v)};function assertDictionary(obj,context){if(void 0!==obj&&"object"!==_typeof(x=obj)&&"function"!=typeof x)throw new TypeError(context+" is not an object.");var x}function assertFunction(x,context){if("function"!=typeof x)throw new TypeError(context+" is not a function.")}function assertObject(x,context){if(!function(x){return"object"===_typeof(x)&&null!==x||"function"==typeof x}(x))throw new TypeError(context+" is not an object.")}function assertRequiredArgument(x,position,context){if(void 0===x)throw new TypeError("Parameter "+position+" is required in '"+context+"'.")}function assertRequiredField(x,field,context){if(void 0===x)throw new TypeError(field+" is required in '"+context+"'.")}function convertUnrestrictedDouble(value){return Number(value)}function censorNegativeZero(x){return 0===x?0:x}function convertUnsignedLongLongWithEnforceRange(value,context){var upperBound=Number.MAX_SAFE_INTEGER,x=Number(value);if(x=censorNegativeZero(x),!NumberIsFinite(x))throw new TypeError(context+" is not a finite number");if((x=function(x){return censorNegativeZero(MathTrunc(x))}(x))<0||x>upperBound)throw new TypeError(context+" is outside the accepted range of 0 to "+upperBound+", inclusive");return NumberIsFinite(x)&&0!==x?x:0}function assertReadableStream(x,context){if(!IsReadableStream(x))throw new TypeError(context+" is not a ReadableStream.")}function AcquireReadableStreamDefaultReader(stream){return new ReadableStreamDefaultReader(stream)}function ReadableStreamAddReadRequest(stream,readRequest){stream._reader._readRequests.push(readRequest)}function ReadableStreamFulfillReadRequest(stream,chunk,done){var readRequest=stream._reader._readRequests.shift();done?readRequest._closeSteps():readRequest._chunkSteps(chunk)}function ReadableStreamGetNumReadRequests(stream){return stream._reader._readRequests.length}function ReadableStreamHasDefaultReader(stream){var reader=stream._reader;return void 0!==reader&&!!IsReadableStreamDefaultReader(reader)}var _a,AsyncIteratorPrototype,ReadableStreamDefaultReader=function(){function ReadableStreamDefaultReader(stream){if(assertRequiredArgument(stream,1,"ReadableStreamDefaultReader"),assertReadableStream(stream,"First parameter"),IsReadableStreamLocked(stream))throw new TypeError("This stream has already been locked for exclusive reading by another reader");ReadableStreamReaderGenericInitialize(this,stream),this._readRequests=new SimpleQueue}return Object.defineProperty(ReadableStreamDefaultReader.prototype,"closed",{get:function(){return IsReadableStreamDefaultReader(this)?this._closedPromise:promiseRejectedWith(defaultReaderBrandCheckException("closed"))},enumerable:!1,configurable:!0}),ReadableStreamDefaultReader.prototype.cancel=function(reason){return void 0===reason&&(reason=void 0),IsReadableStreamDefaultReader(this)?void 0===this._ownerReadableStream?promiseRejectedWith(readerLockException("cancel")):ReadableStreamReaderGenericCancel(this,reason):promiseRejectedWith(defaultReaderBrandCheckException("cancel"))},ReadableStreamDefaultReader.prototype.read=function(){if(!IsReadableStreamDefaultReader(this))return promiseRejectedWith(defaultReaderBrandCheckException("read"));if(void 0===this._ownerReadableStream)return promiseRejectedWith(readerLockException("read from"));var resolvePromise,rejectPromise,promise=newPromise((function(resolve,reject){resolvePromise=resolve,rejectPromise=reject}));return ReadableStreamDefaultReaderRead(this,{_chunkSteps:function(chunk){return resolvePromise({value:chunk,done:!1})},_closeSteps:function(){return resolvePromise({value:void 0,done:!0})},_errorSteps:function(e){return rejectPromise(e)}}),promise},ReadableStreamDefaultReader.prototype.releaseLock=function(){if(!IsReadableStreamDefaultReader(this))throw defaultReaderBrandCheckException("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ReadableStreamReaderGenericRelease(this)}},ReadableStreamDefaultReader}();function IsReadableStreamDefaultReader(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_readRequests")&&x instanceof ReadableStreamDefaultReader}function ReadableStreamDefaultReaderRead(reader,readRequest){var stream=reader._ownerReadableStream;stream._disturbed=!0,"closed"===stream._state?readRequest._closeSteps():"errored"===stream._state?readRequest._errorSteps(stream._storedError):stream._readableStreamController[PullSteps](readRequest)}function defaultReaderBrandCheckException(name){return new TypeError("ReadableStreamDefaultReader.prototype."+name+" can only be used on a ReadableStreamDefaultReader")}Object.defineProperties(ReadableStreamDefaultReader.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(ReadableStreamDefaultReader.prototype,SymbolPolyfill.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0}),"symbol"===_typeof(SymbolPolyfill.asyncIterator)&&((_a={})[SymbolPolyfill.asyncIterator]=function(){return this},AsyncIteratorPrototype=_a,Object.defineProperty(AsyncIteratorPrototype,SymbolPolyfill.asyncIterator,{enumerable:!1}));var ReadableStreamAsyncIteratorImpl=function(){function ReadableStreamAsyncIteratorImpl(reader,preventCancel){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=reader,this._preventCancel=preventCancel}return ReadableStreamAsyncIteratorImpl.prototype.next=function(){var _this=this,nextSteps=function(){return _this._nextSteps()};return this._ongoingPromise=this._ongoingPromise?transformPromiseWith(this._ongoingPromise,nextSteps,nextSteps):nextSteps(),this._ongoingPromise},ReadableStreamAsyncIteratorImpl.prototype.return=function(value){var _this=this,returnSteps=function(){return _this._returnSteps(value)};return this._ongoingPromise?transformPromiseWith(this._ongoingPromise,returnSteps,returnSteps):returnSteps()},ReadableStreamAsyncIteratorImpl.prototype._nextSteps=function(){var _this=this;if(this._isFinished)return Promise.resolve({value:void 0,done:!0});var resolvePromise,rejectPromise,reader=this._reader;if(void 0===reader._ownerReadableStream)return promiseRejectedWith(readerLockException("iterate"));var promise=newPromise((function(resolve,reject){resolvePromise=resolve,rejectPromise=reject}));return ReadableStreamDefaultReaderRead(reader,{_chunkSteps:function(chunk){_this._ongoingPromise=void 0,queueMicrotask((function(){return resolvePromise({value:chunk,done:!1})}))},_closeSteps:function(){_this._ongoingPromise=void 0,_this._isFinished=!0,ReadableStreamReaderGenericRelease(reader),resolvePromise({value:void 0,done:!0})},_errorSteps:function(reason){_this._ongoingPromise=void 0,_this._isFinished=!0,ReadableStreamReaderGenericRelease(reader),rejectPromise(reason)}}),promise},ReadableStreamAsyncIteratorImpl.prototype._returnSteps=function(value){if(this._isFinished)return Promise.resolve({value:value,done:!0});this._isFinished=!0;var reader=this._reader;if(void 0===reader._ownerReadableStream)return promiseRejectedWith(readerLockException("finish iterating"));if(!this._preventCancel){var result=ReadableStreamReaderGenericCancel(reader,value);return ReadableStreamReaderGenericRelease(reader),transformPromiseWith(result,(function(){return{value:value,done:!0}}))}return ReadableStreamReaderGenericRelease(reader),promiseResolvedWith({value:value,done:!0})},ReadableStreamAsyncIteratorImpl}(),ReadableStreamAsyncIteratorPrototype={next:function(){return IsReadableStreamAsyncIterator(this)?this._asyncIteratorImpl.next():promiseRejectedWith(streamAsyncIteratorBrandCheckException("next"))},return:function(value){return IsReadableStreamAsyncIterator(this)?this._asyncIteratorImpl.return(value):promiseRejectedWith(streamAsyncIteratorBrandCheckException("return"))}};function IsReadableStreamAsyncIterator(x){if(!typeIsObject(x))return!1;if(!Object.prototype.hasOwnProperty.call(x,"_asyncIteratorImpl"))return!1;try{return x._asyncIteratorImpl instanceof ReadableStreamAsyncIteratorImpl}catch(_a){return!1}}function streamAsyncIteratorBrandCheckException(name){return new TypeError("ReadableStreamAsyncIterator."+name+" can only be used on a ReadableSteamAsyncIterator")}void 0!==AsyncIteratorPrototype&&Object.setPrototypeOf(ReadableStreamAsyncIteratorPrototype,AsyncIteratorPrototype);var NumberIsNaN=Number.isNaN||function(x){return x!=x};function CreateArrayFromList(elements){return elements.slice()}function CopyDataBlockBytes(dest,destOffset,src,srcOffset,n){new Uint8Array(dest).set(new Uint8Array(src,srcOffset,n),destOffset)}function ArrayBufferSlice(buffer,begin,end){if(buffer.slice)return buffer.slice(begin,end);var length=end-begin,slice=new ArrayBuffer(length);return CopyDataBlockBytes(slice,0,buffer,begin,length),slice}function CloneAsUint8Array(O){var buffer=ArrayBufferSlice(O.buffer,O.byteOffset,O.byteOffset+O.byteLength);return new Uint8Array(buffer)}function DequeueValue(container){var pair=container._queue.shift();return container._queueTotalSize-=pair.size,container._queueTotalSize<0&&(container._queueTotalSize=0),pair.value}function EnqueueValueWithSize(container,value,size){if("number"!=typeof(v=size)||NumberIsNaN(v)||v<0||size===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");var v;container._queue.push({value:value,size:size}),container._queueTotalSize+=size}function ResetQueue(container){container._queue=new SimpleQueue,container._queueTotalSize=0}var ReadableStreamBYOBRequest=function(){function ReadableStreamBYOBRequest(){throw new TypeError("Illegal constructor")}return Object.defineProperty(ReadableStreamBYOBRequest.prototype,"view",{get:function(){if(!IsReadableStreamBYOBRequest(this))throw byobRequestBrandCheckException("view");return this._view},enumerable:!1,configurable:!0}),ReadableStreamBYOBRequest.prototype.respond=function(bytesWritten){if(!IsReadableStreamBYOBRequest(this))throw byobRequestBrandCheckException("respond");if(assertRequiredArgument(bytesWritten,1,"respond"),bytesWritten=convertUnsignedLongLongWithEnforceRange(bytesWritten,"First parameter"),void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");this._view.buffer,ReadableByteStreamControllerRespond(this._associatedReadableByteStreamController,bytesWritten)},ReadableStreamBYOBRequest.prototype.respondWithNewView=function(view){if(!IsReadableStreamBYOBRequest(this))throw byobRequestBrandCheckException("respondWithNewView");if(assertRequiredArgument(view,1,"respondWithNewView"),!ArrayBuffer.isView(view))throw new TypeError("You can only respond with array buffer views");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");view.buffer,ReadableByteStreamControllerRespondWithNewView(this._associatedReadableByteStreamController,view)},ReadableStreamBYOBRequest}();Object.defineProperties(ReadableStreamBYOBRequest.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(ReadableStreamBYOBRequest.prototype,SymbolPolyfill.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});var ReadableByteStreamController=function(){function ReadableByteStreamController(){throw new TypeError("Illegal constructor")}return Object.defineProperty(ReadableByteStreamController.prototype,"byobRequest",{get:function(){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("byobRequest");return ReadableByteStreamControllerGetBYOBRequest(this)},enumerable:!1,configurable:!0}),Object.defineProperty(ReadableByteStreamController.prototype,"desiredSize",{get:function(){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("desiredSize");return ReadableByteStreamControllerGetDesiredSize(this)},enumerable:!1,configurable:!0}),ReadableByteStreamController.prototype.close=function(){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");var state=this._controlledReadableByteStream._state;if("readable"!==state)throw new TypeError("The stream (in "+state+" state) is not in the readable state and cannot be closed");ReadableByteStreamControllerClose(this)},ReadableByteStreamController.prototype.enqueue=function(chunk){if(!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("enqueue");if(assertRequiredArgument(chunk,1,"enqueue"),!ArrayBuffer.isView(chunk))throw new TypeError("chunk must be an array buffer view");if(0===chunk.byteLength)throw new TypeError("chunk must have non-zero byteLength");if(0===chunk.buffer.byteLength)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");var state=this._controlledReadableByteStream._state;if("readable"!==state)throw new TypeError("The stream (in "+state+" state) is not in the readable state and cannot be enqueued to");ReadableByteStreamControllerEnqueue(this,chunk)},ReadableByteStreamController.prototype.error=function(e){if(void 0===e&&(e=void 0),!IsReadableByteStreamController(this))throw byteStreamControllerBrandCheckException("error");ReadableByteStreamControllerError(this,e)},ReadableByteStreamController.prototype[CancelSteps]=function(reason){ReadableByteStreamControllerClearPendingPullIntos(this),ResetQueue(this);var result=this._cancelAlgorithm(reason);return ReadableByteStreamControllerClearAlgorithms(this),result},ReadableByteStreamController.prototype[PullSteps]=function(readRequest){var stream=this._controlledReadableByteStream;if(this._queueTotalSize>0){var entry=this._queue.shift();this._queueTotalSize-=entry.byteLength,ReadableByteStreamControllerHandleQueueDrain(this);var view=new Uint8Array(entry.buffer,entry.byteOffset,entry.byteLength);readRequest._chunkSteps(view)}else{var autoAllocateChunkSize=this._autoAllocateChunkSize;if(void 0!==autoAllocateChunkSize){var buffer=void 0;try{buffer=new ArrayBuffer(autoAllocateChunkSize)}catch(bufferE){return void readRequest._errorSteps(bufferE)}var pullIntoDescriptor={buffer:buffer,bufferByteLength:autoAllocateChunkSize,byteOffset:0,byteLength:autoAllocateChunkSize,bytesFilled:0,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(pullIntoDescriptor)}ReadableStreamAddReadRequest(stream,readRequest),ReadableByteStreamControllerCallPullIfNeeded(this)}},ReadableByteStreamController}();function IsReadableByteStreamController(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_controlledReadableByteStream")&&x instanceof ReadableByteStreamController}function IsReadableStreamBYOBRequest(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_associatedReadableByteStreamController")&&x instanceof ReadableStreamBYOBRequest}function ReadableByteStreamControllerCallPullIfNeeded(controller){var shouldPull=function(controller){var stream=controller._controlledReadableByteStream;if("readable"!==stream._state)return!1;if(controller._closeRequested)return!1;if(!controller._started)return!1;if(ReadableStreamHasDefaultReader(stream)&&ReadableStreamGetNumReadRequests(stream)>0)return!0;if(ReadableStreamHasBYOBReader(stream)&&ReadableStreamGetNumReadIntoRequests(stream)>0)return!0;var desiredSize=ReadableByteStreamControllerGetDesiredSize(controller);return desiredSize>0}(controller);shouldPull&&(controller._pulling?controller._pullAgain=!0:(controller._pulling=!0,uponPromise(controller._pullAlgorithm(),(function(){controller._pulling=!1,controller._pullAgain&&(controller._pullAgain=!1,ReadableByteStreamControllerCallPullIfNeeded(controller))}),(function(e){ReadableByteStreamControllerError(controller,e)}))))}function ReadableByteStreamControllerClearPendingPullIntos(controller){ReadableByteStreamControllerInvalidateBYOBRequest(controller),controller._pendingPullIntos=new SimpleQueue}function ReadableByteStreamControllerCommitPullIntoDescriptor(stream,pullIntoDescriptor){var done=!1;"closed"===stream._state&&(done=!0);var filledView=ReadableByteStreamControllerConvertPullIntoDescriptor(pullIntoDescriptor);"default"===pullIntoDescriptor.readerType?ReadableStreamFulfillReadRequest(stream,filledView,done):function(stream,chunk,done){var reader=stream._reader,readIntoRequest=reader._readIntoRequests.shift();done?readIntoRequest._closeSteps(chunk):readIntoRequest._chunkSteps(chunk)}(stream,filledView,done)}function ReadableByteStreamControllerConvertPullIntoDescriptor(pullIntoDescriptor){var bytesFilled=pullIntoDescriptor.bytesFilled,elementSize=pullIntoDescriptor.elementSize;return new pullIntoDescriptor.viewConstructor(pullIntoDescriptor.buffer,pullIntoDescriptor.byteOffset,bytesFilled/elementSize)}function ReadableByteStreamControllerEnqueueChunkToQueue(controller,buffer,byteOffset,byteLength){controller._queue.push({buffer:buffer,byteOffset:byteOffset,byteLength:byteLength}),controller._queueTotalSize+=byteLength}function ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(controller,pullIntoDescriptor){var elementSize=pullIntoDescriptor.elementSize,currentAlignedBytes=pullIntoDescriptor.bytesFilled-pullIntoDescriptor.bytesFilled%elementSize,maxBytesToCopy=Math.min(controller._queueTotalSize,pullIntoDescriptor.byteLength-pullIntoDescriptor.bytesFilled),maxBytesFilled=pullIntoDescriptor.bytesFilled+maxBytesToCopy,maxAlignedBytes=maxBytesFilled-maxBytesFilled%elementSize,totalBytesToCopyRemaining=maxBytesToCopy,ready=!1;maxAlignedBytes>currentAlignedBytes&&(totalBytesToCopyRemaining=maxAlignedBytes-pullIntoDescriptor.bytesFilled,ready=!0);for(var queue=controller._queue;totalBytesToCopyRemaining>0;){var headOfQueue=queue.peek(),bytesToCopy=Math.min(totalBytesToCopyRemaining,headOfQueue.byteLength),destStart=pullIntoDescriptor.byteOffset+pullIntoDescriptor.bytesFilled;CopyDataBlockBytes(pullIntoDescriptor.buffer,destStart,headOfQueue.buffer,headOfQueue.byteOffset,bytesToCopy),headOfQueue.byteLength===bytesToCopy?queue.shift():(headOfQueue.byteOffset+=bytesToCopy,headOfQueue.byteLength-=bytesToCopy),controller._queueTotalSize-=bytesToCopy,ReadableByteStreamControllerFillHeadPullIntoDescriptor(0,bytesToCopy,pullIntoDescriptor),totalBytesToCopyRemaining-=bytesToCopy}return ready}function ReadableByteStreamControllerFillHeadPullIntoDescriptor(controller,size,pullIntoDescriptor){pullIntoDescriptor.bytesFilled+=size}function ReadableByteStreamControllerHandleQueueDrain(controller){0===controller._queueTotalSize&&controller._closeRequested?(ReadableByteStreamControllerClearAlgorithms(controller),ReadableStreamClose(controller._controlledReadableByteStream)):ReadableByteStreamControllerCallPullIfNeeded(controller)}function ReadableByteStreamControllerInvalidateBYOBRequest(controller){null!==controller._byobRequest&&(controller._byobRequest._associatedReadableByteStreamController=void 0,controller._byobRequest._view=null,controller._byobRequest=null)}function ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(controller){for(;controller._pendingPullIntos.length>0;){if(0===controller._queueTotalSize)return;var pullIntoDescriptor=controller._pendingPullIntos.peek();ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(controller,pullIntoDescriptor)&&(ReadableByteStreamControllerShiftPendingPullInto(controller),ReadableByteStreamControllerCommitPullIntoDescriptor(controller._controlledReadableByteStream,pullIntoDescriptor))}}function ReadableByteStreamControllerRespondInternal(controller,bytesWritten){var firstDescriptor=controller._pendingPullIntos.peek();ReadableByteStreamControllerInvalidateBYOBRequest(controller),"closed"===controller._controlledReadableByteStream._state?function(controller,firstDescriptor){var stream=controller._controlledReadableByteStream;if(ReadableStreamHasBYOBReader(stream))for(;ReadableStreamGetNumReadIntoRequests(stream)>0;)ReadableByteStreamControllerCommitPullIntoDescriptor(stream,ReadableByteStreamControllerShiftPendingPullInto(controller))}(controller):function(controller,bytesWritten,pullIntoDescriptor){if(ReadableByteStreamControllerFillHeadPullIntoDescriptor(0,bytesWritten,pullIntoDescriptor),!(pullIntoDescriptor.bytesFilled<pullIntoDescriptor.elementSize)){ReadableByteStreamControllerShiftPendingPullInto(controller);var remainderSize=pullIntoDescriptor.bytesFilled%pullIntoDescriptor.elementSize;if(remainderSize>0){var end=pullIntoDescriptor.byteOffset+pullIntoDescriptor.bytesFilled,remainder=ArrayBufferSlice(pullIntoDescriptor.buffer,end-remainderSize,end);ReadableByteStreamControllerEnqueueChunkToQueue(controller,remainder,0,remainder.byteLength)}pullIntoDescriptor.bytesFilled-=remainderSize,ReadableByteStreamControllerCommitPullIntoDescriptor(controller._controlledReadableByteStream,pullIntoDescriptor),ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(controller)}}(controller,bytesWritten,firstDescriptor),ReadableByteStreamControllerCallPullIfNeeded(controller)}function ReadableByteStreamControllerShiftPendingPullInto(controller){return controller._pendingPullIntos.shift()}function ReadableByteStreamControllerClearAlgorithms(controller){controller._pullAlgorithm=void 0,controller._cancelAlgorithm=void 0}function ReadableByteStreamControllerClose(controller){var stream=controller._controlledReadableByteStream;if(!controller._closeRequested&&"readable"===stream._state)if(controller._queueTotalSize>0)controller._closeRequested=!0;else{if(controller._pendingPullIntos.length>0&&controller._pendingPullIntos.peek().bytesFilled>0){var e=new TypeError("Insufficient bytes to fill elements in the given buffer");throw ReadableByteStreamControllerError(controller,e),e}ReadableByteStreamControllerClearAlgorithms(controller),ReadableStreamClose(stream)}}function ReadableByteStreamControllerEnqueue(controller,chunk){var stream=controller._controlledReadableByteStream;if(!controller._closeRequested&&"readable"===stream._state){var buffer=chunk.buffer,byteOffset=chunk.byteOffset,byteLength=chunk.byteLength,transferredBuffer=buffer;if(controller._pendingPullIntos.length>0){var firstPendingPullInto=controller._pendingPullIntos.peek();firstPendingPullInto.buffer,firstPendingPullInto.buffer=firstPendingPullInto.buffer}ReadableByteStreamControllerInvalidateBYOBRequest(controller),ReadableStreamHasDefaultReader(stream)?0===ReadableStreamGetNumReadRequests(stream)?ReadableByteStreamControllerEnqueueChunkToQueue(controller,transferredBuffer,byteOffset,byteLength):(controller._pendingPullIntos.length>0&&ReadableByteStreamControllerShiftPendingPullInto(controller),ReadableStreamFulfillReadRequest(stream,new Uint8Array(transferredBuffer,byteOffset,byteLength),!1)):ReadableStreamHasBYOBReader(stream)?(ReadableByteStreamControllerEnqueueChunkToQueue(controller,transferredBuffer,byteOffset,byteLength),ReadableByteStreamControllerProcessPullIntoDescriptorsUsingQueue(controller)):ReadableByteStreamControllerEnqueueChunkToQueue(controller,transferredBuffer,byteOffset,byteLength),ReadableByteStreamControllerCallPullIfNeeded(controller)}}function ReadableByteStreamControllerError(controller,e){var stream=controller._controlledReadableByteStream;"readable"===stream._state&&(ReadableByteStreamControllerClearPendingPullIntos(controller),ResetQueue(controller),ReadableByteStreamControllerClearAlgorithms(controller),ReadableStreamError(stream,e))}function ReadableByteStreamControllerGetBYOBRequest(controller){if(null===controller._byobRequest&&controller._pendingPullIntos.length>0){var firstDescriptor=controller._pendingPullIntos.peek(),view=new Uint8Array(firstDescriptor.buffer,firstDescriptor.byteOffset+firstDescriptor.bytesFilled,firstDescriptor.byteLength-firstDescriptor.bytesFilled),byobRequest=Object.create(ReadableStreamBYOBRequest.prototype);!function(request,controller,view){request._associatedReadableByteStreamController=controller,request._view=view}(byobRequest,controller,view),controller._byobRequest=byobRequest}return controller._byobRequest}function ReadableByteStreamControllerGetDesiredSize(controller){var state=controller._controlledReadableByteStream._state;return"errored"===state?null:"closed"===state?0:controller._strategyHWM-controller._queueTotalSize}function ReadableByteStreamControllerRespond(controller,bytesWritten){var firstDescriptor=controller._pendingPullIntos.peek();if("closed"===controller._controlledReadableByteStream._state){if(0!==bytesWritten)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(0===bytesWritten)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(firstDescriptor.bytesFilled+bytesWritten>firstDescriptor.byteLength)throw new RangeError("bytesWritten out of range")}firstDescriptor.buffer=firstDescriptor.buffer,ReadableByteStreamControllerRespondInternal(controller,bytesWritten)}function ReadableByteStreamControllerRespondWithNewView(controller,view){var firstDescriptor=controller._pendingPullIntos.peek();if("closed"===controller._controlledReadableByteStream._state){if(0!==view.byteLength)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(0===view.byteLength)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(firstDescriptor.byteOffset+firstDescriptor.bytesFilled!==view.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(firstDescriptor.bufferByteLength!==view.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(firstDescriptor.bytesFilled+view.byteLength>firstDescriptor.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");var viewByteLength=view.byteLength;firstDescriptor.buffer=view.buffer,ReadableByteStreamControllerRespondInternal(controller,viewByteLength)}function SetUpReadableByteStreamController(stream,controller,startAlgorithm,pullAlgorithm,cancelAlgorithm,highWaterMark,autoAllocateChunkSize){controller._controlledReadableByteStream=stream,controller._pullAgain=!1,controller._pulling=!1,controller._byobRequest=null,controller._queue=controller._queueTotalSize=void 0,ResetQueue(controller),controller._closeRequested=!1,controller._started=!1,controller._strategyHWM=highWaterMark,controller._pullAlgorithm=pullAlgorithm,controller._cancelAlgorithm=cancelAlgorithm,controller._autoAllocateChunkSize=autoAllocateChunkSize,controller._pendingPullIntos=new SimpleQueue,stream._readableStreamController=controller,uponPromise(promiseResolvedWith(startAlgorithm()),(function(){controller._started=!0,ReadableByteStreamControllerCallPullIfNeeded(controller)}),(function(r){ReadableByteStreamControllerError(controller,r)}))}function byobRequestBrandCheckException(name){return new TypeError("ReadableStreamBYOBRequest.prototype."+name+" can only be used on a ReadableStreamBYOBRequest")}function byteStreamControllerBrandCheckException(name){return new TypeError("ReadableByteStreamController.prototype."+name+" can only be used on a ReadableByteStreamController")}function AcquireReadableStreamBYOBReader(stream){return new ReadableStreamBYOBReader(stream)}function ReadableStreamAddReadIntoRequest(stream,readIntoRequest){stream._reader._readIntoRequests.push(readIntoRequest)}function ReadableStreamGetNumReadIntoRequests(stream){return stream._reader._readIntoRequests.length}function ReadableStreamHasBYOBReader(stream){var reader=stream._reader;return void 0!==reader&&!!IsReadableStreamBYOBReader(reader)}Object.defineProperties(ReadableByteStreamController.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(ReadableByteStreamController.prototype,SymbolPolyfill.toStringTag,{value:"ReadableByteStreamController",configurable:!0});var ReadableStreamBYOBReader=function(){function ReadableStreamBYOBReader(stream){if(assertRequiredArgument(stream,1,"ReadableStreamBYOBReader"),assertReadableStream(stream,"First parameter"),IsReadableStreamLocked(stream))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!IsReadableByteStreamController(stream._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");ReadableStreamReaderGenericInitialize(this,stream),this._readIntoRequests=new SimpleQueue}return Object.defineProperty(ReadableStreamBYOBReader.prototype,"closed",{get:function(){return IsReadableStreamBYOBReader(this)?this._closedPromise:promiseRejectedWith(byobReaderBrandCheckException("closed"))},enumerable:!1,configurable:!0}),ReadableStreamBYOBReader.prototype.cancel=function(reason){return void 0===reason&&(reason=void 0),IsReadableStreamBYOBReader(this)?void 0===this._ownerReadableStream?promiseRejectedWith(readerLockException("cancel")):ReadableStreamReaderGenericCancel(this,reason):promiseRejectedWith(byobReaderBrandCheckException("cancel"))},ReadableStreamBYOBReader.prototype.read=function(view){if(!IsReadableStreamBYOBReader(this))return promiseRejectedWith(byobReaderBrandCheckException("read"));if(!ArrayBuffer.isView(view))return promiseRejectedWith(new TypeError("view must be an array buffer view"));if(0===view.byteLength)return promiseRejectedWith(new TypeError("view must have non-zero byteLength"));if(0===view.buffer.byteLength)return promiseRejectedWith(new TypeError("view's buffer must have non-zero byteLength"));if(view.buffer,void 0===this._ownerReadableStream)return promiseRejectedWith(readerLockException("read from"));var resolvePromise,rejectPromise,promise=newPromise((function(resolve,reject){resolvePromise=resolve,rejectPromise=reject}));return ReadableStreamBYOBReaderRead(this,view,{_chunkSteps:function(chunk){return resolvePromise({value:chunk,done:!1})},_closeSteps:function(chunk){return resolvePromise({value:chunk,done:!0})},_errorSteps:function(e){return rejectPromise(e)}}),promise},ReadableStreamBYOBReader.prototype.releaseLock=function(){if(!IsReadableStreamBYOBReader(this))throw byobReaderBrandCheckException("releaseLock");if(void 0!==this._ownerReadableStream){if(this._readIntoRequests.length>0)throw new TypeError("Tried to release a reader lock when that reader has pending read() calls un-settled");ReadableStreamReaderGenericRelease(this)}},ReadableStreamBYOBReader}();function IsReadableStreamBYOBReader(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_readIntoRequests")&&x instanceof ReadableStreamBYOBReader}function ReadableStreamBYOBReaderRead(reader,view,readIntoRequest){var stream=reader._ownerReadableStream;stream._disturbed=!0,"errored"===stream._state?readIntoRequest._errorSteps(stream._storedError):function(controller,view,readIntoRequest){var stream=controller._controlledReadableByteStream,elementSize=1;view.constructor!==DataView&&(elementSize=view.constructor.BYTES_PER_ELEMENT);var ctor=view.constructor,buffer=view.buffer,pullIntoDescriptor={buffer:buffer,bufferByteLength:buffer.byteLength,byteOffset:view.byteOffset,byteLength:view.byteLength,bytesFilled:0,elementSize:elementSize,viewConstructor:ctor,readerType:"byob"};if(controller._pendingPullIntos.length>0)return controller._pendingPullIntos.push(pullIntoDescriptor),void ReadableStreamAddReadIntoRequest(stream,readIntoRequest);if("closed"!==stream._state){if(controller._queueTotalSize>0){if(ReadableByteStreamControllerFillPullIntoDescriptorFromQueue(controller,pullIntoDescriptor)){var filledView=ReadableByteStreamControllerConvertPullIntoDescriptor(pullIntoDescriptor);return ReadableByteStreamControllerHandleQueueDrain(controller),void readIntoRequest._chunkSteps(filledView)}if(controller._closeRequested){var e=new TypeError("Insufficient bytes to fill elements in the given buffer");return ReadableByteStreamControllerError(controller,e),void readIntoRequest._errorSteps(e)}}controller._pendingPullIntos.push(pullIntoDescriptor),ReadableStreamAddReadIntoRequest(stream,readIntoRequest),ReadableByteStreamControllerCallPullIfNeeded(controller)}else{var emptyView=new ctor(pullIntoDescriptor.buffer,pullIntoDescriptor.byteOffset,0);readIntoRequest._closeSteps(emptyView)}}(stream._readableStreamController,view,readIntoRequest)}function byobReaderBrandCheckException(name){return new TypeError("ReadableStreamBYOBReader.prototype."+name+" can only be used on a ReadableStreamBYOBReader")}function ExtractHighWaterMark(strategy,defaultHWM){var highWaterMark=strategy.highWaterMark;if(void 0===highWaterMark)return defaultHWM;if(NumberIsNaN(highWaterMark)||highWaterMark<0)throw new RangeError("Invalid highWaterMark");return highWaterMark}function ExtractSizeAlgorithm(strategy){var size=strategy.size;return size||function(){return 1}}function convertQueuingStrategy(init,context){assertDictionary(init,context);var highWaterMark=null==init?void 0:init.highWaterMark,size=null==init?void 0:init.size;return{highWaterMark:void 0===highWaterMark?void 0:convertUnrestrictedDouble(highWaterMark),size:void 0===size?void 0:convertQueuingStrategySize(size,context+" has member 'size' that")}}function convertQueuingStrategySize(fn,context){return assertFunction(fn,context),function(chunk){return convertUnrestrictedDouble(fn(chunk))}}function convertUnderlyingSinkAbortCallback(fn,original,context){return assertFunction(fn,context),function(reason){return promiseCall(fn,original,[reason])}}function convertUnderlyingSinkCloseCallback(fn,original,context){return assertFunction(fn,context),function(){return promiseCall(fn,original,[])}}function convertUnderlyingSinkStartCallback(fn,original,context){return assertFunction(fn,context),function(controller){return reflectCall(fn,original,[controller])}}function convertUnderlyingSinkWriteCallback(fn,original,context){return assertFunction(fn,context),function(chunk,controller){return promiseCall(fn,original,[chunk,controller])}}function assertWritableStream(x,context){if(!IsWritableStream(x))throw new TypeError(context+" is not a WritableStream.")}Object.defineProperties(ReadableStreamBYOBReader.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(ReadableStreamBYOBReader.prototype,SymbolPolyfill.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});var supportsAbortController="function"==typeof AbortController,WritableStream=function(){function WritableStream(rawUnderlyingSink,rawStrategy){void 0===rawUnderlyingSink&&(rawUnderlyingSink={}),void 0===rawStrategy&&(rawStrategy={}),void 0===rawUnderlyingSink?rawUnderlyingSink=null:assertObject(rawUnderlyingSink,"First parameter");var strategy=convertQueuingStrategy(rawStrategy,"Second parameter"),underlyingSink=function(original,context){assertDictionary(original,context);var abort=null==original?void 0:original.abort,close=null==original?void 0:original.close,start=null==original?void 0:original.start,type=null==original?void 0:original.type,write=null==original?void 0:original.write;return{abort:void 0===abort?void 0:convertUnderlyingSinkAbortCallback(abort,original,context+" has member 'abort' that"),close:void 0===close?void 0:convertUnderlyingSinkCloseCallback(close,original,context+" has member 'close' that"),start:void 0===start?void 0:convertUnderlyingSinkStartCallback(start,original,context+" has member 'start' that"),write:void 0===write?void 0:convertUnderlyingSinkWriteCallback(write,original,context+" has member 'write' that"),type:type}}(rawUnderlyingSink,"First parameter");if(InitializeWritableStream(this),void 0!==underlyingSink.type)throw new RangeError("Invalid type is specified");var sizeAlgorithm=ExtractSizeAlgorithm(strategy);!function(stream,underlyingSink,highWaterMark,sizeAlgorithm){var controller=Object.create(WritableStreamDefaultController.prototype),startAlgorithm=function(){},writeAlgorithm=function(){return promiseResolvedWith(void 0)},closeAlgorithm=function(){return promiseResolvedWith(void 0)},abortAlgorithm=function(){return promiseResolvedWith(void 0)};void 0!==underlyingSink.start&&(startAlgorithm=function(){return underlyingSink.start(controller)}),void 0!==underlyingSink.write&&(writeAlgorithm=function(chunk){return underlyingSink.write(chunk,controller)}),void 0!==underlyingSink.close&&(closeAlgorithm=function(){return underlyingSink.close()}),void 0!==underlyingSink.abort&&(abortAlgorithm=function(reason){return underlyingSink.abort(reason)}),SetUpWritableStreamDefaultController(stream,controller,startAlgorithm,writeAlgorithm,closeAlgorithm,abortAlgorithm,highWaterMark,sizeAlgorithm)}(this,underlyingSink,ExtractHighWaterMark(strategy,1),sizeAlgorithm)}return Object.defineProperty(WritableStream.prototype,"locked",{get:function(){if(!IsWritableStream(this))throw streamBrandCheckException$2("locked");return IsWritableStreamLocked(this)},enumerable:!1,configurable:!0}),WritableStream.prototype.abort=function(reason){return void 0===reason&&(reason=void 0),IsWritableStream(this)?IsWritableStreamLocked(this)?promiseRejectedWith(new TypeError("Cannot abort a stream that already has a writer")):WritableStreamAbort(this,reason):promiseRejectedWith(streamBrandCheckException$2("abort"))},WritableStream.prototype.close=function(){return IsWritableStream(this)?IsWritableStreamLocked(this)?promiseRejectedWith(new TypeError("Cannot close a stream that already has a writer")):WritableStreamCloseQueuedOrInFlight(this)?promiseRejectedWith(new TypeError("Cannot close an already-closing stream")):WritableStreamClose(this):promiseRejectedWith(streamBrandCheckException$2("close"))},WritableStream.prototype.getWriter=function(){if(!IsWritableStream(this))throw streamBrandCheckException$2("getWriter");return AcquireWritableStreamDefaultWriter(this)},WritableStream}();function AcquireWritableStreamDefaultWriter(stream){return new WritableStreamDefaultWriter(stream)}function InitializeWritableStream(stream){stream._state="writable",stream._storedError=void 0,stream._writer=void 0,stream._writableStreamController=void 0,stream._writeRequests=new SimpleQueue,stream._inFlightWriteRequest=void 0,stream._closeRequest=void 0,stream._inFlightCloseRequest=void 0,stream._pendingAbortRequest=void 0,stream._backpressure=!1}function IsWritableStream(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_writableStreamController")&&x instanceof WritableStream}function IsWritableStreamLocked(stream){return void 0!==stream._writer}function WritableStreamAbort(stream,reason){var _a;if("closed"===stream._state||"errored"===stream._state)return promiseResolvedWith(void 0);stream._writableStreamController._abortReason=reason,null===(_a=stream._writableStreamController._abortController)||void 0===_a||_a.abort();var state=stream._state;if("closed"===state||"errored"===state)return promiseResolvedWith(void 0);if(void 0!==stream._pendingAbortRequest)return stream._pendingAbortRequest._promise;var wasAlreadyErroring=!1;"erroring"===state&&(wasAlreadyErroring=!0,reason=void 0);var promise=newPromise((function(resolve,reject){stream._pendingAbortRequest={_promise:void 0,_resolve:resolve,_reject:reject,_reason:reason,_wasAlreadyErroring:wasAlreadyErroring}}));return stream._pendingAbortRequest._promise=promise,wasAlreadyErroring||WritableStreamStartErroring(stream,reason),promise}function WritableStreamClose(stream){var state=stream._state;if("closed"===state||"errored"===state)return promiseRejectedWith(new TypeError("The stream (in "+state+" state) is not in the writable state and cannot be closed"));var controller,promise=newPromise((function(resolve,reject){var closeRequest={_resolve:resolve,_reject:reject};stream._closeRequest=closeRequest})),writer=stream._writer;return void 0!==writer&&stream._backpressure&&"writable"===state&&defaultWriterReadyPromiseResolve(writer),EnqueueValueWithSize(controller=stream._writableStreamController,closeSentinel,0),WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller),promise}function WritableStreamDealWithRejection(stream,error){"writable"!==stream._state?WritableStreamFinishErroring(stream):WritableStreamStartErroring(stream,error)}function WritableStreamStartErroring(stream,reason){var controller=stream._writableStreamController;stream._state="erroring",stream._storedError=reason;var writer=stream._writer;void 0!==writer&&WritableStreamDefaultWriterEnsureReadyPromiseRejected(writer,reason),!function(stream){return void 0!==stream._inFlightWriteRequest||void 0!==stream._inFlightCloseRequest}(stream)&&controller._started&&WritableStreamFinishErroring(stream)}function WritableStreamFinishErroring(stream){stream._state="errored",stream._writableStreamController[ErrorSteps]();var storedError=stream._storedError;if(stream._writeRequests.forEach((function(writeRequest){writeRequest._reject(storedError)})),stream._writeRequests=new SimpleQueue,void 0!==stream._pendingAbortRequest){var abortRequest=stream._pendingAbortRequest;if(stream._pendingAbortRequest=void 0,abortRequest._wasAlreadyErroring)return abortRequest._reject(storedError),void WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream);uponPromise(stream._writableStreamController[AbortSteps](abortRequest._reason),(function(){abortRequest._resolve(),WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream)}),(function(reason){abortRequest._reject(reason),WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream)}))}else WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream)}function WritableStreamCloseQueuedOrInFlight(stream){return void 0!==stream._closeRequest||void 0!==stream._inFlightCloseRequest}function WritableStreamRejectCloseAndClosedPromiseIfNeeded(stream){void 0!==stream._closeRequest&&(stream._closeRequest._reject(stream._storedError),stream._closeRequest=void 0);var writer=stream._writer;void 0!==writer&&defaultWriterClosedPromiseReject(writer,stream._storedError)}function WritableStreamUpdateBackpressure(stream,backpressure){var writer=stream._writer;void 0!==writer&&backpressure!==stream._backpressure&&(backpressure?function(writer){defaultWriterReadyPromiseInitialize(writer)}(writer):defaultWriterReadyPromiseResolve(writer)),stream._backpressure=backpressure}Object.defineProperties(WritableStream.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(WritableStream.prototype,SymbolPolyfill.toStringTag,{value:"WritableStream",configurable:!0});var WritableStreamDefaultWriter=function(){function WritableStreamDefaultWriter(stream){if(assertRequiredArgument(stream,1,"WritableStreamDefaultWriter"),assertWritableStream(stream,"First parameter"),IsWritableStreamLocked(stream))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=stream,stream._writer=this;var writer,state=stream._state;if("writable"===state)!WritableStreamCloseQueuedOrInFlight(stream)&&stream._backpressure?defaultWriterReadyPromiseInitialize(this):defaultWriterReadyPromiseInitializeAsResolved(this),defaultWriterClosedPromiseInitialize(this);else if("erroring"===state)defaultWriterReadyPromiseInitializeAsRejected(this,stream._storedError),defaultWriterClosedPromiseInitialize(this);else if("closed"===state)defaultWriterReadyPromiseInitializeAsResolved(this),defaultWriterClosedPromiseInitialize(writer=this),defaultWriterClosedPromiseResolve(writer);else{var storedError=stream._storedError;defaultWriterReadyPromiseInitializeAsRejected(this,storedError),defaultWriterClosedPromiseInitializeAsRejected(this,storedError)}}return Object.defineProperty(WritableStreamDefaultWriter.prototype,"closed",{get:function(){return IsWritableStreamDefaultWriter(this)?this._closedPromise:promiseRejectedWith(defaultWriterBrandCheckException("closed"))},enumerable:!1,configurable:!0}),Object.defineProperty(WritableStreamDefaultWriter.prototype,"desiredSize",{get:function(){if(!IsWritableStreamDefaultWriter(this))throw defaultWriterBrandCheckException("desiredSize");if(void 0===this._ownerWritableStream)throw defaultWriterLockException("desiredSize");return stream=this._ownerWritableStream,"errored"===(state=stream._state)||"erroring"===state?null:"closed"===state?0:WritableStreamDefaultControllerGetDesiredSize(stream._writableStreamController);var stream,state},enumerable:!1,configurable:!0}),Object.defineProperty(WritableStreamDefaultWriter.prototype,"ready",{get:function(){return IsWritableStreamDefaultWriter(this)?this._readyPromise:promiseRejectedWith(defaultWriterBrandCheckException("ready"))},enumerable:!1,configurable:!0}),WritableStreamDefaultWriter.prototype.abort=function(reason){return void 0===reason&&(reason=void 0),IsWritableStreamDefaultWriter(this)?void 0===this._ownerWritableStream?promiseRejectedWith(defaultWriterLockException("abort")):function(writer,reason){return WritableStreamAbort(writer._ownerWritableStream,reason)}(this,reason):promiseRejectedWith(defaultWriterBrandCheckException("abort"))},WritableStreamDefaultWriter.prototype.close=function(){if(!IsWritableStreamDefaultWriter(this))return promiseRejectedWith(defaultWriterBrandCheckException("close"));var stream=this._ownerWritableStream;return void 0===stream?promiseRejectedWith(defaultWriterLockException("close")):WritableStreamCloseQueuedOrInFlight(stream)?promiseRejectedWith(new TypeError("Cannot close an already-closing stream")):WritableStreamDefaultWriterClose(this)},WritableStreamDefaultWriter.prototype.releaseLock=function(){if(!IsWritableStreamDefaultWriter(this))throw defaultWriterBrandCheckException("releaseLock");void 0!==this._ownerWritableStream&&WritableStreamDefaultWriterRelease(this)},WritableStreamDefaultWriter.prototype.write=function(chunk){return void 0===chunk&&(chunk=void 0),IsWritableStreamDefaultWriter(this)?void 0===this._ownerWritableStream?promiseRejectedWith(defaultWriterLockException("write to")):WritableStreamDefaultWriterWrite(this,chunk):promiseRejectedWith(defaultWriterBrandCheckException("write"))},WritableStreamDefaultWriter}();function IsWritableStreamDefaultWriter(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_ownerWritableStream")&&x instanceof WritableStreamDefaultWriter}function WritableStreamDefaultWriterClose(writer){return WritableStreamClose(writer._ownerWritableStream)}function WritableStreamDefaultWriterEnsureClosedPromiseRejected(writer,error){"pending"===writer._closedPromiseState?defaultWriterClosedPromiseReject(writer,error):function(writer,reason){defaultWriterClosedPromiseInitializeAsRejected(writer,reason)}(writer,error)}function WritableStreamDefaultWriterEnsureReadyPromiseRejected(writer,error){"pending"===writer._readyPromiseState?defaultWriterReadyPromiseReject(writer,error):function(writer,reason){defaultWriterReadyPromiseInitializeAsRejected(writer,reason)}(writer,error)}function WritableStreamDefaultWriterRelease(writer){var stream=writer._ownerWritableStream,releasedError=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");WritableStreamDefaultWriterEnsureReadyPromiseRejected(writer,releasedError),WritableStreamDefaultWriterEnsureClosedPromiseRejected(writer,releasedError),stream._writer=void 0,writer._ownerWritableStream=void 0}function WritableStreamDefaultWriterWrite(writer,chunk){var stream=writer._ownerWritableStream,controller=stream._writableStreamController,chunkSize=function(controller,chunk){try{return controller._strategySizeAlgorithm(chunk)}catch(chunkSizeE){return WritableStreamDefaultControllerErrorIfNeeded(controller,chunkSizeE),1}}(controller,chunk);if(stream!==writer._ownerWritableStream)return promiseRejectedWith(defaultWriterLockException("write to"));var state=stream._state;if("errored"===state)return promiseRejectedWith(stream._storedError);if(WritableStreamCloseQueuedOrInFlight(stream)||"closed"===state)return promiseRejectedWith(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===state)return promiseRejectedWith(stream._storedError);var promise=function(stream){return newPromise((function(resolve,reject){var writeRequest={_resolve:resolve,_reject:reject};stream._writeRequests.push(writeRequest)}))}(stream);return function(controller,chunk,chunkSize){try{EnqueueValueWithSize(controller,chunk,chunkSize)}catch(enqueueE){return void WritableStreamDefaultControllerErrorIfNeeded(controller,enqueueE)}var stream=controller._controlledWritableStream;WritableStreamCloseQueuedOrInFlight(stream)||"writable"!==stream._state||WritableStreamUpdateBackpressure(stream,WritableStreamDefaultControllerGetBackpressure(controller)),WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller)}(controller,chunk,chunkSize),promise}Object.defineProperties(WritableStreamDefaultWriter.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(WritableStreamDefaultWriter.prototype,SymbolPolyfill.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});var closeSentinel={},WritableStreamDefaultController=function(){function WritableStreamDefaultController(){throw new TypeError("Illegal constructor")}return Object.defineProperty(WritableStreamDefaultController.prototype,"abortReason",{get:function(){if(!IsWritableStreamDefaultController(this))throw defaultControllerBrandCheckException$2("abortReason");return this._abortReason},enumerable:!1,configurable:!0}),Object.defineProperty(WritableStreamDefaultController.prototype,"signal",{get:function(){if(!IsWritableStreamDefaultController(this))throw defaultControllerBrandCheckException$2("signal");if(void 0===this._abortController)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal},enumerable:!1,configurable:!0}),WritableStreamDefaultController.prototype.error=function(e){if(void 0===e&&(e=void 0),!IsWritableStreamDefaultController(this))throw defaultControllerBrandCheckException$2("error");"writable"===this._controlledWritableStream._state&&WritableStreamDefaultControllerError(this,e)},WritableStreamDefaultController.prototype[AbortSteps]=function(reason){var result=this._abortAlgorithm(reason);return WritableStreamDefaultControllerClearAlgorithms(this),result},WritableStreamDefaultController.prototype[ErrorSteps]=function(){ResetQueue(this)},WritableStreamDefaultController}();function IsWritableStreamDefaultController(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_controlledWritableStream")&&x instanceof WritableStreamDefaultController}function SetUpWritableStreamDefaultController(stream,controller,startAlgorithm,writeAlgorithm,closeAlgorithm,abortAlgorithm,highWaterMark,sizeAlgorithm){controller._controlledWritableStream=stream,stream._writableStreamController=controller,controller._queue=void 0,controller._queueTotalSize=void 0,ResetQueue(controller),controller._abortReason=void 0,controller._abortController=function(){if(supportsAbortController)return new AbortController}(),controller._started=!1,controller._strategySizeAlgorithm=sizeAlgorithm,controller._strategyHWM=highWaterMark,controller._writeAlgorithm=writeAlgorithm,controller._closeAlgorithm=closeAlgorithm,controller._abortAlgorithm=abortAlgorithm;var backpressure=WritableStreamDefaultControllerGetBackpressure(controller);WritableStreamUpdateBackpressure(stream,backpressure),uponPromise(promiseResolvedWith(startAlgorithm()),(function(){controller._started=!0,WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller)}),(function(r){controller._started=!0,WritableStreamDealWithRejection(stream,r)}))}function WritableStreamDefaultControllerClearAlgorithms(controller){controller._writeAlgorithm=void 0,controller._closeAlgorithm=void 0,controller._abortAlgorithm=void 0,controller._strategySizeAlgorithm=void 0}function WritableStreamDefaultControllerGetDesiredSize(controller){return controller._strategyHWM-controller._queueTotalSize}function WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller){var stream=controller._controlledWritableStream;if(controller._started&&void 0===stream._inFlightWriteRequest)if("erroring"!==stream._state){if(0!==controller._queue.length){var value=controller._queue.peek().value;value===closeSentinel?function(controller){var stream=controller._controlledWritableStream;(function(stream){stream._inFlightCloseRequest=stream._closeRequest,stream._closeRequest=void 0})(stream),DequeueValue(controller);var sinkClosePromise=controller._closeAlgorithm();WritableStreamDefaultControllerClearAlgorithms(controller),uponPromise(sinkClosePromise,(function(){!function(stream){stream._inFlightCloseRequest._resolve(void 0),stream._inFlightCloseRequest=void 0,"erroring"===stream._state&&(stream._storedError=void 0,void 0!==stream._pendingAbortRequest&&(stream._pendingAbortRequest._resolve(),stream._pendingAbortRequest=void 0)),stream._state="closed";var writer=stream._writer;void 0!==writer&&defaultWriterClosedPromiseResolve(writer)}(stream)}),(function(reason){!function(stream,error){stream._inFlightCloseRequest._reject(error),stream._inFlightCloseRequest=void 0,void 0!==stream._pendingAbortRequest&&(stream._pendingAbortRequest._reject(error),stream._pendingAbortRequest=void 0),WritableStreamDealWithRejection(stream,error)}(stream,reason)}))}(controller):function(controller,chunk){var stream=controller._controlledWritableStream;!function(stream){stream._inFlightWriteRequest=stream._writeRequests.shift()}(stream);var sinkWritePromise=controller._writeAlgorithm(chunk);uponPromise(sinkWritePromise,(function(){!function(stream){stream._inFlightWriteRequest._resolve(void 0),stream._inFlightWriteRequest=void 0}(stream);var state=stream._state;if(DequeueValue(controller),!WritableStreamCloseQueuedOrInFlight(stream)&&"writable"===state){var backpressure=WritableStreamDefaultControllerGetBackpressure(controller);WritableStreamUpdateBackpressure(stream,backpressure)}WritableStreamDefaultControllerAdvanceQueueIfNeeded(controller)}),(function(reason){"writable"===stream._state&&WritableStreamDefaultControllerClearAlgorithms(controller),function(stream,error){stream._inFlightWriteRequest._reject(error),stream._inFlightWriteRequest=void 0,WritableStreamDealWithRejection(stream,error)}(stream,reason)}))}(controller,value)}}else WritableStreamFinishErroring(stream)}function WritableStreamDefaultControllerErrorIfNeeded(controller,error){"writable"===controller._controlledWritableStream._state&&WritableStreamDefaultControllerError(controller,error)}function WritableStreamDefaultControllerGetBackpressure(controller){return WritableStreamDefaultControllerGetDesiredSize(controller)<=0}function WritableStreamDefaultControllerError(controller,error){var stream=controller._controlledWritableStream;WritableStreamDefaultControllerClearAlgorithms(controller),WritableStreamStartErroring(stream,error)}function streamBrandCheckException$2(name){return new TypeError("WritableStream.prototype."+name+" can only be used on a WritableStream")}function defaultControllerBrandCheckException$2(name){return new TypeError("WritableStreamDefaultController.prototype."+name+" can only be used on a WritableStreamDefaultController")}function defaultWriterBrandCheckException(name){return new TypeError("WritableStreamDefaultWriter.prototype."+name+" can only be used on a WritableStreamDefaultWriter")}function defaultWriterLockException(name){return new TypeError("Cannot "+name+" a stream using a released writer")}function defaultWriterClosedPromiseInitialize(writer){writer._closedPromise=newPromise((function(resolve,reject){writer._closedPromise_resolve=resolve,writer._closedPromise_reject=reject,writer._closedPromiseState="pending"}))}function defaultWriterClosedPromiseInitializeAsRejected(writer,reason){defaultWriterClosedPromiseInitialize(writer),defaultWriterClosedPromiseReject(writer,reason)}function defaultWriterClosedPromiseReject(writer,reason){void 0!==writer._closedPromise_reject&&(setPromiseIsHandledToTrue(writer._closedPromise),writer._closedPromise_reject(reason),writer._closedPromise_resolve=void 0,writer._closedPromise_reject=void 0,writer._closedPromiseState="rejected")}function defaultWriterClosedPromiseResolve(writer){void 0!==writer._closedPromise_resolve&&(writer._closedPromise_resolve(void 0),writer._closedPromise_resolve=void 0,writer._closedPromise_reject=void 0,writer._closedPromiseState="resolved")}function defaultWriterReadyPromiseInitialize(writer){writer._readyPromise=newPromise((function(resolve,reject){writer._readyPromise_resolve=resolve,writer._readyPromise_reject=reject})),writer._readyPromiseState="pending"}function defaultWriterReadyPromiseInitializeAsRejected(writer,reason){defaultWriterReadyPromiseInitialize(writer),defaultWriterReadyPromiseReject(writer,reason)}function defaultWriterReadyPromiseInitializeAsResolved(writer){defaultWriterReadyPromiseInitialize(writer),defaultWriterReadyPromiseResolve(writer)}function defaultWriterReadyPromiseReject(writer,reason){void 0!==writer._readyPromise_reject&&(setPromiseIsHandledToTrue(writer._readyPromise),writer._readyPromise_reject(reason),writer._readyPromise_resolve=void 0,writer._readyPromise_reject=void 0,writer._readyPromiseState="rejected")}function defaultWriterReadyPromiseResolve(writer){void 0!==writer._readyPromise_resolve&&(writer._readyPromise_resolve(void 0),writer._readyPromise_resolve=void 0,writer._readyPromise_reject=void 0,writer._readyPromiseState="fulfilled")}Object.defineProperties(WritableStreamDefaultController.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(WritableStreamDefaultController.prototype,SymbolPolyfill.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});var ctor,NativeDOMException="undefined"!=typeof DOMException?DOMException:void 0,DOMException$1=function(ctor){if("function"!=typeof ctor&&"object"!==_typeof(ctor))return!1;try{return new ctor,!0}catch(_a){return!1}}(NativeDOMException)?NativeDOMException:((ctor=function(message,name){this.message=message||"",this.name=name||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}).prototype=Object.create(Error.prototype),Object.defineProperty(ctor.prototype,"constructor",{value:ctor,writable:!0,configurable:!0}),ctor);function ReadableStreamPipeTo(source,dest,preventClose,preventAbort,preventCancel,signal){var reader=AcquireReadableStreamDefaultReader(source),writer=AcquireWritableStreamDefaultWriter(dest);source._disturbed=!0;var shuttingDown=!1,currentWrite=promiseResolvedWith(void 0);return newPromise((function(resolve,reject){var abortAlgorithm,stream,promise,action;if(void 0!==signal){if(abortAlgorithm=function(){var error=new DOMException$1("Aborted","AbortError"),actions=[];preventAbort||actions.push((function(){return"writable"===dest._state?WritableStreamAbort(dest,error):promiseResolvedWith(void 0)})),preventCancel||actions.push((function(){return"readable"===source._state?ReadableStreamCancel(source,error):promiseResolvedWith(void 0)})),shutdownWithAction((function(){return Promise.all(actions.map((function(action){return action()})))}),!0,error)},signal.aborted)return void abortAlgorithm();signal.addEventListener("abort",abortAlgorithm)}if(isOrBecomesErrored(source,reader._closedPromise,(function(storedError){preventAbort?shutdown(!0,storedError):shutdownWithAction((function(){return WritableStreamAbort(dest,storedError)}),!0,storedError)})),isOrBecomesErrored(dest,writer._closedPromise,(function(storedError){preventCancel?shutdown(!0,storedError):shutdownWithAction((function(){return ReadableStreamCancel(source,storedError)}),!0,storedError)})),stream=source,promise=reader._closedPromise,action=function(){preventClose?shutdown():shutdownWithAction((function(){return function(writer){var stream=writer._ownerWritableStream,state=stream._state;return WritableStreamCloseQueuedOrInFlight(stream)||"closed"===state?promiseResolvedWith(void 0):"errored"===state?promiseRejectedWith(stream._storedError):WritableStreamDefaultWriterClose(writer)}(writer)}))},"closed"===stream._state?action():uponFulfillment(promise,action),WritableStreamCloseQueuedOrInFlight(dest)||"closed"===dest._state){var destClosed_1=new TypeError("the destination writable stream closed before all data could be piped to it");preventCancel?shutdown(!0,destClosed_1):shutdownWithAction((function(){return ReadableStreamCancel(source,destClosed_1)}),!0,destClosed_1)}function waitForWritesToFinish(){var oldCurrentWrite=currentWrite;return PerformPromiseThen(currentWrite,(function(){return oldCurrentWrite!==currentWrite?waitForWritesToFinish():void 0}))}function isOrBecomesErrored(stream,promise,action){"errored"===stream._state?action(stream._storedError):uponRejection(promise,action)}function shutdownWithAction(action,originalIsError,originalError){function doTheRest(){uponPromise(action(),(function(){return finalize(originalIsError,originalError)}),(function(newError){return finalize(!0,newError)}))}shuttingDown||(shuttingDown=!0,"writable"!==dest._state||WritableStreamCloseQueuedOrInFlight(dest)?doTheRest():uponFulfillment(waitForWritesToFinish(),doTheRest))}function shutdown(isError,error){shuttingDown||(shuttingDown=!0,"writable"!==dest._state||WritableStreamCloseQueuedOrInFlight(dest)?finalize(isError,error):uponFulfillment(waitForWritesToFinish(),(function(){return finalize(isError,error)})))}function finalize(isError,error){WritableStreamDefaultWriterRelease(writer),ReadableStreamReaderGenericRelease(reader),void 0!==signal&&signal.removeEventListener("abort",abortAlgorithm),isError?reject(error):resolve(void 0)}setPromiseIsHandledToTrue(newPromise((function(resolveLoop,rejectLoop){!function next(done){done?resolveLoop():PerformPromiseThen(shuttingDown?promiseResolvedWith(!0):PerformPromiseThen(writer._readyPromise,(function(){return newPromise((function(resolveRead,rejectRead){ReadableStreamDefaultReaderRead(reader,{_chunkSteps:function(chunk){currentWrite=PerformPromiseThen(WritableStreamDefaultWriterWrite(writer,chunk),void 0,noop),resolveRead(!1)},_closeSteps:function(){return resolveRead(!0)},_errorSteps:rejectRead})}))})),next,rejectLoop)}(!1)})))}))}var ReadableStreamDefaultController=function(){function ReadableStreamDefaultController(){throw new TypeError("Illegal constructor")}return Object.defineProperty(ReadableStreamDefaultController.prototype,"desiredSize",{get:function(){if(!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("desiredSize");return ReadableStreamDefaultControllerGetDesiredSize(this)},enumerable:!1,configurable:!0}),ReadableStreamDefaultController.prototype.close=function(){if(!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("close");if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(this))throw new TypeError("The stream is not in a state that permits close");ReadableStreamDefaultControllerClose(this)},ReadableStreamDefaultController.prototype.enqueue=function(chunk){if(void 0===chunk&&(chunk=void 0),!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("enqueue");if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(this))throw new TypeError("The stream is not in a state that permits enqueue");return ReadableStreamDefaultControllerEnqueue(this,chunk)},ReadableStreamDefaultController.prototype.error=function(e){if(void 0===e&&(e=void 0),!IsReadableStreamDefaultController(this))throw defaultControllerBrandCheckException$1("error");ReadableStreamDefaultControllerError(this,e)},ReadableStreamDefaultController.prototype[CancelSteps]=function(reason){ResetQueue(this);var result=this._cancelAlgorithm(reason);return ReadableStreamDefaultControllerClearAlgorithms(this),result},ReadableStreamDefaultController.prototype[PullSteps]=function(readRequest){var stream=this._controlledReadableStream;if(this._queue.length>0){var chunk=DequeueValue(this);this._closeRequested&&0===this._queue.length?(ReadableStreamDefaultControllerClearAlgorithms(this),ReadableStreamClose(stream)):ReadableStreamDefaultControllerCallPullIfNeeded(this),readRequest._chunkSteps(chunk)}else ReadableStreamAddReadRequest(stream,readRequest),ReadableStreamDefaultControllerCallPullIfNeeded(this)},ReadableStreamDefaultController}();function IsReadableStreamDefaultController(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_controlledReadableStream")&&x instanceof ReadableStreamDefaultController}function ReadableStreamDefaultControllerCallPullIfNeeded(controller){ReadableStreamDefaultControllerShouldCallPull(controller)&&(controller._pulling?controller._pullAgain=!0:(controller._pulling=!0,uponPromise(controller._pullAlgorithm(),(function(){controller._pulling=!1,controller._pullAgain&&(controller._pullAgain=!1,ReadableStreamDefaultControllerCallPullIfNeeded(controller))}),(function(e){ReadableStreamDefaultControllerError(controller,e)}))))}function ReadableStreamDefaultControllerShouldCallPull(controller){var stream=controller._controlledReadableStream;return!!ReadableStreamDefaultControllerCanCloseOrEnqueue(controller)&&!!controller._started&&(!!(IsReadableStreamLocked(stream)&&ReadableStreamGetNumReadRequests(stream)>0)||ReadableStreamDefaultControllerGetDesiredSize(controller)>0)}function ReadableStreamDefaultControllerClearAlgorithms(controller){controller._pullAlgorithm=void 0,controller._cancelAlgorithm=void 0,controller._strategySizeAlgorithm=void 0}function ReadableStreamDefaultControllerClose(controller){if(ReadableStreamDefaultControllerCanCloseOrEnqueue(controller)){var stream=controller._controlledReadableStream;controller._closeRequested=!0,0===controller._queue.length&&(ReadableStreamDefaultControllerClearAlgorithms(controller),ReadableStreamClose(stream))}}function ReadableStreamDefaultControllerEnqueue(controller,chunk){if(ReadableStreamDefaultControllerCanCloseOrEnqueue(controller)){var stream=controller._controlledReadableStream;if(IsReadableStreamLocked(stream)&&ReadableStreamGetNumReadRequests(stream)>0)ReadableStreamFulfillReadRequest(stream,chunk,!1);else{var chunkSize=void 0;try{chunkSize=controller._strategySizeAlgorithm(chunk)}catch(chunkSizeE){throw ReadableStreamDefaultControllerError(controller,chunkSizeE),chunkSizeE}try{EnqueueValueWithSize(controller,chunk,chunkSize)}catch(enqueueE){throw ReadableStreamDefaultControllerError(controller,enqueueE),enqueueE}}ReadableStreamDefaultControllerCallPullIfNeeded(controller)}}function ReadableStreamDefaultControllerError(controller,e){var stream=controller._controlledReadableStream;"readable"===stream._state&&(ResetQueue(controller),ReadableStreamDefaultControllerClearAlgorithms(controller),ReadableStreamError(stream,e))}function ReadableStreamDefaultControllerGetDesiredSize(controller){var state=controller._controlledReadableStream._state;return"errored"===state?null:"closed"===state?0:controller._strategyHWM-controller._queueTotalSize}function ReadableStreamDefaultControllerCanCloseOrEnqueue(controller){var state=controller._controlledReadableStream._state;return!controller._closeRequested&&"readable"===state}function SetUpReadableStreamDefaultController(stream,controller,startAlgorithm,pullAlgorithm,cancelAlgorithm,highWaterMark,sizeAlgorithm){controller._controlledReadableStream=stream,controller._queue=void 0,controller._queueTotalSize=void 0,ResetQueue(controller),controller._started=!1,controller._closeRequested=!1,controller._pullAgain=!1,controller._pulling=!1,controller._strategySizeAlgorithm=sizeAlgorithm,controller._strategyHWM=highWaterMark,controller._pullAlgorithm=pullAlgorithm,controller._cancelAlgorithm=cancelAlgorithm,stream._readableStreamController=controller,uponPromise(promiseResolvedWith(startAlgorithm()),(function(){controller._started=!0,ReadableStreamDefaultControllerCallPullIfNeeded(controller)}),(function(r){ReadableStreamDefaultControllerError(controller,r)}))}function defaultControllerBrandCheckException$1(name){return new TypeError("ReadableStreamDefaultController.prototype."+name+" can only be used on a ReadableStreamDefaultController")}function ReadableStreamTee(stream,cloneForBranch2){return IsReadableByteStreamController(stream._readableStreamController)?function(stream){var reason1,reason2,branch1,branch2,resolveCancelPromise,reader=AcquireReadableStreamDefaultReader(stream),reading=!1,readAgainForBranch1=!1,readAgainForBranch2=!1,canceled1=!1,canceled2=!1,cancelPromise=newPromise((function(resolve){resolveCancelPromise=resolve}));function forwardReaderError(thisReader){uponRejection(thisReader._closedPromise,(function(r){thisReader===reader&&(ReadableByteStreamControllerError(branch1._readableStreamController,r),ReadableByteStreamControllerError(branch2._readableStreamController,r),canceled1&&canceled2||resolveCancelPromise(void 0))}))}function pullWithDefaultReader(){IsReadableStreamBYOBReader(reader)&&(ReadableStreamReaderGenericRelease(reader),forwardReaderError(reader=AcquireReadableStreamDefaultReader(stream))),ReadableStreamDefaultReaderRead(reader,{_chunkSteps:function(chunk){queueMicrotask((function(){readAgainForBranch1=!1,readAgainForBranch2=!1;var chunk1=chunk,chunk2=chunk;if(!canceled1&&!canceled2)try{chunk2=CloneAsUint8Array(chunk)}catch(cloneE){return ReadableByteStreamControllerError(branch1._readableStreamController,cloneE),ReadableByteStreamControllerError(branch2._readableStreamController,cloneE),void resolveCancelPromise(ReadableStreamCancel(stream,cloneE))}canceled1||ReadableByteStreamControllerEnqueue(branch1._readableStreamController,chunk1),canceled2||ReadableByteStreamControllerEnqueue(branch2._readableStreamController,chunk2),reading=!1,readAgainForBranch1?pull1Algorithm():readAgainForBranch2&&pull2Algorithm()}))},_closeSteps:function(){reading=!1,canceled1||ReadableByteStreamControllerClose(branch1._readableStreamController),canceled2||ReadableByteStreamControllerClose(branch2._readableStreamController),branch1._readableStreamController._pendingPullIntos.length>0&&ReadableByteStreamControllerRespond(branch1._readableStreamController,0),branch2._readableStreamController._pendingPullIntos.length>0&&ReadableByteStreamControllerRespond(branch2._readableStreamController,0),canceled1&&canceled2||resolveCancelPromise(void 0)},_errorSteps:function(){reading=!1}})}function pullWithBYOBReader(view,forBranch2){IsReadableStreamDefaultReader(reader)&&(ReadableStreamReaderGenericRelease(reader),forwardReaderError(reader=AcquireReadableStreamBYOBReader(stream)));var byobBranch=forBranch2?branch2:branch1,otherBranch=forBranch2?branch1:branch2;ReadableStreamBYOBReaderRead(reader,view,{_chunkSteps:function(chunk){queueMicrotask((function(){readAgainForBranch1=!1,readAgainForBranch2=!1;var byobCanceled=forBranch2?canceled2:canceled1;if(forBranch2?canceled1:canceled2)byobCanceled||ReadableByteStreamControllerRespondWithNewView(byobBranch._readableStreamController,chunk);else{var clonedChunk=void 0;try{clonedChunk=CloneAsUint8Array(chunk)}catch(cloneE){return ReadableByteStreamControllerError(byobBranch._readableStreamController,cloneE),ReadableByteStreamControllerError(otherBranch._readableStreamController,cloneE),void resolveCancelPromise(ReadableStreamCancel(stream,cloneE))}byobCanceled||ReadableByteStreamControllerRespondWithNewView(byobBranch._readableStreamController,chunk),ReadableByteStreamControllerEnqueue(otherBranch._readableStreamController,clonedChunk)}reading=!1,readAgainForBranch1?pull1Algorithm():readAgainForBranch2&&pull2Algorithm()}))},_closeSteps:function(chunk){reading=!1;var byobCanceled=forBranch2?canceled2:canceled1,otherCanceled=forBranch2?canceled1:canceled2;byobCanceled||ReadableByteStreamControllerClose(byobBranch._readableStreamController),otherCanceled||ReadableByteStreamControllerClose(otherBranch._readableStreamController),void 0!==chunk&&(byobCanceled||ReadableByteStreamControllerRespondWithNewView(byobBranch._readableStreamController,chunk),!otherCanceled&&otherBranch._readableStreamController._pendingPullIntos.length>0&&ReadableByteStreamControllerRespond(otherBranch._readableStreamController,0)),byobCanceled&&otherCanceled||resolveCancelPromise(void 0)},_errorSteps:function(){reading=!1}})}function pull1Algorithm(){if(reading)return readAgainForBranch1=!0,promiseResolvedWith(void 0);reading=!0;var byobRequest=ReadableByteStreamControllerGetBYOBRequest(branch1._readableStreamController);return null===byobRequest?pullWithDefaultReader():pullWithBYOBReader(byobRequest._view,!1),promiseResolvedWith(void 0)}function pull2Algorithm(){if(reading)return readAgainForBranch2=!0,promiseResolvedWith(void 0);reading=!0;var byobRequest=ReadableByteStreamControllerGetBYOBRequest(branch2._readableStreamController);return null===byobRequest?pullWithDefaultReader():pullWithBYOBReader(byobRequest._view,!0),promiseResolvedWith(void 0)}function cancel1Algorithm(reason){if(canceled1=!0,reason1=reason,canceled2){var compositeReason=CreateArrayFromList([reason1,reason2]),cancelResult=ReadableStreamCancel(stream,compositeReason);resolveCancelPromise(cancelResult)}return cancelPromise}function cancel2Algorithm(reason){if(canceled2=!0,reason2=reason,canceled1){var compositeReason=CreateArrayFromList([reason1,reason2]),cancelResult=ReadableStreamCancel(stream,compositeReason);resolveCancelPromise(cancelResult)}return cancelPromise}function startAlgorithm(){}return branch1=CreateReadableByteStream(startAlgorithm,pull1Algorithm,cancel1Algorithm),branch2=CreateReadableByteStream(startAlgorithm,pull2Algorithm,cancel2Algorithm),forwardReaderError(reader),[branch1,branch2]}(stream):function(stream,cloneForBranch2){var reason1,reason2,branch1,branch2,resolveCancelPromise,reader=AcquireReadableStreamDefaultReader(stream),reading=!1,readAgain=!1,canceled1=!1,canceled2=!1,cancelPromise=newPromise((function(resolve){resolveCancelPromise=resolve}));function pullAlgorithm(){return reading?(readAgain=!0,promiseResolvedWith(void 0)):(reading=!0,ReadableStreamDefaultReaderRead(reader,{_chunkSteps:function(chunk){queueMicrotask((function(){readAgain=!1;var chunk1=chunk,chunk2=chunk;canceled1||ReadableStreamDefaultControllerEnqueue(branch1._readableStreamController,chunk1),canceled2||ReadableStreamDefaultControllerEnqueue(branch2._readableStreamController,chunk2),reading=!1,readAgain&&pullAlgorithm()}))},_closeSteps:function(){reading=!1,canceled1||ReadableStreamDefaultControllerClose(branch1._readableStreamController),canceled2||ReadableStreamDefaultControllerClose(branch2._readableStreamController),canceled1&&canceled2||resolveCancelPromise(void 0)},_errorSteps:function(){reading=!1}}),promiseResolvedWith(void 0))}function cancel1Algorithm(reason){if(canceled1=!0,reason1=reason,canceled2){var compositeReason=CreateArrayFromList([reason1,reason2]),cancelResult=ReadableStreamCancel(stream,compositeReason);resolveCancelPromise(cancelResult)}return cancelPromise}function cancel2Algorithm(reason){if(canceled2=!0,reason2=reason,canceled1){var compositeReason=CreateArrayFromList([reason1,reason2]),cancelResult=ReadableStreamCancel(stream,compositeReason);resolveCancelPromise(cancelResult)}return cancelPromise}function startAlgorithm(){}return branch1=CreateReadableStream(startAlgorithm,pullAlgorithm,cancel1Algorithm),branch2=CreateReadableStream(startAlgorithm,pullAlgorithm,cancel2Algorithm),uponRejection(reader._closedPromise,(function(r){ReadableStreamDefaultControllerError(branch1._readableStreamController,r),ReadableStreamDefaultControllerError(branch2._readableStreamController,r),canceled1&&canceled2||resolveCancelPromise(void 0)})),[branch1,branch2]}(stream)}function convertUnderlyingSourceCancelCallback(fn,original,context){return assertFunction(fn,context),function(reason){return promiseCall(fn,original,[reason])}}function convertUnderlyingSourcePullCallback(fn,original,context){return assertFunction(fn,context),function(controller){return promiseCall(fn,original,[controller])}}function convertUnderlyingSourceStartCallback(fn,original,context){return assertFunction(fn,context),function(controller){return reflectCall(fn,original,[controller])}}function convertReadableStreamType(type,context){if("bytes"!=(type=""+type))throw new TypeError(context+" '"+type+"' is not a valid enumeration value for ReadableStreamType");return type}function convertReadableStreamReaderMode(mode,context){if("byob"!=(mode=""+mode))throw new TypeError(context+" '"+mode+"' is not a valid enumeration value for ReadableStreamReaderMode");return mode}function convertPipeOptions(options,context){assertDictionary(options,context);var preventAbort=null==options?void 0:options.preventAbort,preventCancel=null==options?void 0:options.preventCancel,preventClose=null==options?void 0:options.preventClose,signal=null==options?void 0:options.signal;return void 0!==signal&&function(signal,context){if(!function(value){if("object"!==_typeof(value)||null===value)return!1;try{return"boolean"==typeof value.aborted}catch(_a){return!1}}(signal))throw new TypeError(context+" is not an AbortSignal.")}(signal,context+" has member 'signal' that"),{preventAbort:Boolean(preventAbort),preventCancel:Boolean(preventCancel),preventClose:Boolean(preventClose),signal:signal}}Object.defineProperties(ReadableStreamDefaultController.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(ReadableStreamDefaultController.prototype,SymbolPolyfill.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});var ReadableStream=function(){function ReadableStream(rawUnderlyingSource,rawStrategy){void 0===rawUnderlyingSource&&(rawUnderlyingSource={}),void 0===rawStrategy&&(rawStrategy={}),void 0===rawUnderlyingSource?rawUnderlyingSource=null:assertObject(rawUnderlyingSource,"First parameter");var strategy=convertQueuingStrategy(rawStrategy,"Second parameter"),underlyingSource=function(source,context){assertDictionary(source,context);var original=source,autoAllocateChunkSize=null==original?void 0:original.autoAllocateChunkSize,cancel=null==original?void 0:original.cancel,pull=null==original?void 0:original.pull,start=null==original?void 0:original.start,type=null==original?void 0:original.type;return{autoAllocateChunkSize:void 0===autoAllocateChunkSize?void 0:convertUnsignedLongLongWithEnforceRange(autoAllocateChunkSize,context+" has member 'autoAllocateChunkSize' that"),cancel:void 0===cancel?void 0:convertUnderlyingSourceCancelCallback(cancel,original,context+" has member 'cancel' that"),pull:void 0===pull?void 0:convertUnderlyingSourcePullCallback(pull,original,context+" has member 'pull' that"),start:void 0===start?void 0:convertUnderlyingSourceStartCallback(start,original,context+" has member 'start' that"),type:void 0===type?void 0:convertReadableStreamType(type,context+" has member 'type' that")}}(rawUnderlyingSource,"First parameter");if(InitializeReadableStream(this),"bytes"===underlyingSource.type){if(void 0!==strategy.size)throw new RangeError("The strategy for a byte stream cannot have a size function");!function(stream,underlyingByteSource,highWaterMark){var controller=Object.create(ReadableByteStreamController.prototype),startAlgorithm=function(){},pullAlgorithm=function(){return promiseResolvedWith(void 0)},cancelAlgorithm=function(){return promiseResolvedWith(void 0)};void 0!==underlyingByteSource.start&&(startAlgorithm=function(){return underlyingByteSource.start(controller)}),void 0!==underlyingByteSource.pull&&(pullAlgorithm=function(){return underlyingByteSource.pull(controller)}),void 0!==underlyingByteSource.cancel&&(cancelAlgorithm=function(reason){return underlyingByteSource.cancel(reason)});var autoAllocateChunkSize=underlyingByteSource.autoAllocateChunkSize;if(0===autoAllocateChunkSize)throw new TypeError("autoAllocateChunkSize must be greater than 0");SetUpReadableByteStreamController(stream,controller,startAlgorithm,pullAlgorithm,cancelAlgorithm,highWaterMark,autoAllocateChunkSize)}(this,underlyingSource,ExtractHighWaterMark(strategy,0))}else{var sizeAlgorithm=ExtractSizeAlgorithm(strategy);!function(stream,underlyingSource,highWaterMark,sizeAlgorithm){var controller=Object.create(ReadableStreamDefaultController.prototype),startAlgorithm=function(){},pullAlgorithm=function(){return promiseResolvedWith(void 0)},cancelAlgorithm=function(){return promiseResolvedWith(void 0)};void 0!==underlyingSource.start&&(startAlgorithm=function(){return underlyingSource.start(controller)}),void 0!==underlyingSource.pull&&(pullAlgorithm=function(){return underlyingSource.pull(controller)}),void 0!==underlyingSource.cancel&&(cancelAlgorithm=function(reason){return underlyingSource.cancel(reason)}),SetUpReadableStreamDefaultController(stream,controller,startAlgorithm,pullAlgorithm,cancelAlgorithm,highWaterMark,sizeAlgorithm)}(this,underlyingSource,ExtractHighWaterMark(strategy,1),sizeAlgorithm)}}return Object.defineProperty(ReadableStream.prototype,"locked",{get:function(){if(!IsReadableStream(this))throw streamBrandCheckException$1("locked");return IsReadableStreamLocked(this)},enumerable:!1,configurable:!0}),ReadableStream.prototype.cancel=function(reason){return void 0===reason&&(reason=void 0),IsReadableStream(this)?IsReadableStreamLocked(this)?promiseRejectedWith(new TypeError("Cannot cancel a stream that already has a reader")):ReadableStreamCancel(this,reason):promiseRejectedWith(streamBrandCheckException$1("cancel"))},ReadableStream.prototype.getReader=function(rawOptions){if(void 0===rawOptions&&(rawOptions=void 0),!IsReadableStream(this))throw streamBrandCheckException$1("getReader");return void 0===function(options,context){assertDictionary(options,context);var mode=null==options?void 0:options.mode;return{mode:void 0===mode?void 0:convertReadableStreamReaderMode(mode,context+" has member 'mode' that")}}(rawOptions,"First parameter").mode?AcquireReadableStreamDefaultReader(this):AcquireReadableStreamBYOBReader(this)},ReadableStream.prototype.pipeThrough=function(rawTransform,rawOptions){if(void 0===rawOptions&&(rawOptions={}),!IsReadableStream(this))throw streamBrandCheckException$1("pipeThrough");assertRequiredArgument(rawTransform,1,"pipeThrough");var transform=function(pair,context){assertDictionary(pair,context);var readable=null==pair?void 0:pair.readable;assertRequiredField(readable,"readable","ReadableWritablePair"),assertReadableStream(readable,context+" has member 'readable' that");var writable=null==pair?void 0:pair.writable;return assertRequiredField(writable,"writable","ReadableWritablePair"),assertWritableStream(writable,context+" has member 'writable' that"),{readable:readable,writable:writable}}(rawTransform,"First parameter"),options=convertPipeOptions(rawOptions,"Second parameter");if(IsReadableStreamLocked(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(IsWritableStreamLocked(transform.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return setPromiseIsHandledToTrue(ReadableStreamPipeTo(this,transform.writable,options.preventClose,options.preventAbort,options.preventCancel,options.signal)),transform.readable},ReadableStream.prototype.pipeTo=function(destination,rawOptions){if(void 0===rawOptions&&(rawOptions={}),!IsReadableStream(this))return promiseRejectedWith(streamBrandCheckException$1("pipeTo"));if(void 0===destination)return promiseRejectedWith("Parameter 1 is required in 'pipeTo'.");if(!IsWritableStream(destination))return promiseRejectedWith(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));var options;try{options=convertPipeOptions(rawOptions,"Second parameter")}catch(e){return promiseRejectedWith(e)}return IsReadableStreamLocked(this)?promiseRejectedWith(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):IsWritableStreamLocked(destination)?promiseRejectedWith(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):ReadableStreamPipeTo(this,destination,options.preventClose,options.preventAbort,options.preventCancel,options.signal)},ReadableStream.prototype.tee=function(){if(!IsReadableStream(this))throw streamBrandCheckException$1("tee");return CreateArrayFromList(ReadableStreamTee(this))},ReadableStream.prototype.values=function(rawOptions){if(void 0===rawOptions&&(rawOptions=void 0),!IsReadableStream(this))throw streamBrandCheckException$1("values");var stream,preventCancel,reader,impl,iterator,options=function(options,context){assertDictionary(options,context);var preventCancel=null==options?void 0:options.preventCancel;return{preventCancel:Boolean(preventCancel)}}(rawOptions,"First parameter");return stream=this,preventCancel=options.preventCancel,reader=AcquireReadableStreamDefaultReader(stream),impl=new ReadableStreamAsyncIteratorImpl(reader,preventCancel),(iterator=Object.create(ReadableStreamAsyncIteratorPrototype))._asyncIteratorImpl=impl,iterator},ReadableStream}();function CreateReadableStream(startAlgorithm,pullAlgorithm,cancelAlgorithm,highWaterMark,sizeAlgorithm){void 0===highWaterMark&&(highWaterMark=1),void 0===sizeAlgorithm&&(sizeAlgorithm=function(){return 1});var stream=Object.create(ReadableStream.prototype);return InitializeReadableStream(stream),SetUpReadableStreamDefaultController(stream,Object.create(ReadableStreamDefaultController.prototype),startAlgorithm,pullAlgorithm,cancelAlgorithm,highWaterMark,sizeAlgorithm),stream}function CreateReadableByteStream(startAlgorithm,pullAlgorithm,cancelAlgorithm){var stream=Object.create(ReadableStream.prototype);return InitializeReadableStream(stream),SetUpReadableByteStreamController(stream,Object.create(ReadableByteStreamController.prototype),startAlgorithm,pullAlgorithm,cancelAlgorithm,0,void 0),stream}function InitializeReadableStream(stream){stream._state="readable",stream._reader=void 0,stream._storedError=void 0,stream._disturbed=!1}function IsReadableStream(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_readableStreamController")&&x instanceof ReadableStream}function IsReadableStreamLocked(stream){return void 0!==stream._reader}function ReadableStreamCancel(stream,reason){if(stream._disturbed=!0,"closed"===stream._state)return promiseResolvedWith(void 0);if("errored"===stream._state)return promiseRejectedWith(stream._storedError);ReadableStreamClose(stream);var reader=stream._reader;return void 0!==reader&&IsReadableStreamBYOBReader(reader)&&(reader._readIntoRequests.forEach((function(readIntoRequest){readIntoRequest._closeSteps(void 0)})),reader._readIntoRequests=new SimpleQueue),transformPromiseWith(stream._readableStreamController[CancelSteps](reason),noop)}function ReadableStreamClose(stream){stream._state="closed";var reader=stream._reader;void 0!==reader&&(defaultReaderClosedPromiseResolve(reader),IsReadableStreamDefaultReader(reader)&&(reader._readRequests.forEach((function(readRequest){readRequest._closeSteps()})),reader._readRequests=new SimpleQueue))}function ReadableStreamError(stream,e){stream._state="errored",stream._storedError=e;var reader=stream._reader;void 0!==reader&&(defaultReaderClosedPromiseReject(reader,e),IsReadableStreamDefaultReader(reader)?(reader._readRequests.forEach((function(readRequest){readRequest._errorSteps(e)})),reader._readRequests=new SimpleQueue):(reader._readIntoRequests.forEach((function(readIntoRequest){readIntoRequest._errorSteps(e)})),reader._readIntoRequests=new SimpleQueue))}function streamBrandCheckException$1(name){return new TypeError("ReadableStream.prototype."+name+" can only be used on a ReadableStream")}function convertQueuingStrategyInit(init,context){assertDictionary(init,context);var highWaterMark=null==init?void 0:init.highWaterMark;return assertRequiredField(highWaterMark,"highWaterMark","QueuingStrategyInit"),{highWaterMark:convertUnrestrictedDouble(highWaterMark)}}Object.defineProperties(ReadableStream.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(ReadableStream.prototype,SymbolPolyfill.toStringTag,{value:"ReadableStream",configurable:!0}),"symbol"===_typeof(SymbolPolyfill.asyncIterator)&&Object.defineProperty(ReadableStream.prototype,SymbolPolyfill.asyncIterator,{value:ReadableStream.prototype.values,writable:!0,configurable:!0});var byteLengthSizeFunction=function(chunk){return chunk.byteLength};try{Object.defineProperty(byteLengthSizeFunction,"name",{value:"size",configurable:!0})}catch(_a){}var ByteLengthQueuingStrategy=function(){function ByteLengthQueuingStrategy(options){assertRequiredArgument(options,1,"ByteLengthQueuingStrategy"),options=convertQueuingStrategyInit(options,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=options.highWaterMark}return Object.defineProperty(ByteLengthQueuingStrategy.prototype,"highWaterMark",{get:function(){if(!IsByteLengthQueuingStrategy(this))throw byteLengthBrandCheckException("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark},enumerable:!1,configurable:!0}),Object.defineProperty(ByteLengthQueuingStrategy.prototype,"size",{get:function(){if(!IsByteLengthQueuingStrategy(this))throw byteLengthBrandCheckException("size");return byteLengthSizeFunction},enumerable:!1,configurable:!0}),ByteLengthQueuingStrategy}();function byteLengthBrandCheckException(name){return new TypeError("ByteLengthQueuingStrategy.prototype."+name+" can only be used on a ByteLengthQueuingStrategy")}function IsByteLengthQueuingStrategy(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_byteLengthQueuingStrategyHighWaterMark")&&x instanceof ByteLengthQueuingStrategy}Object.defineProperties(ByteLengthQueuingStrategy.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(ByteLengthQueuingStrategy.prototype,SymbolPolyfill.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});var countSizeFunction=function(){return 1};try{Object.defineProperty(countSizeFunction,"name",{value:"size",configurable:!0})}catch(_a){}var CountQueuingStrategy=function(){function CountQueuingStrategy(options){assertRequiredArgument(options,1,"CountQueuingStrategy"),options=convertQueuingStrategyInit(options,"First parameter"),this._countQueuingStrategyHighWaterMark=options.highWaterMark}return Object.defineProperty(CountQueuingStrategy.prototype,"highWaterMark",{get:function(){if(!IsCountQueuingStrategy(this))throw countBrandCheckException("highWaterMark");return this._countQueuingStrategyHighWaterMark},enumerable:!1,configurable:!0}),Object.defineProperty(CountQueuingStrategy.prototype,"size",{get:function(){if(!IsCountQueuingStrategy(this))throw countBrandCheckException("size");return countSizeFunction},enumerable:!1,configurable:!0}),CountQueuingStrategy}();function countBrandCheckException(name){return new TypeError("CountQueuingStrategy.prototype."+name+" can only be used on a CountQueuingStrategy")}function IsCountQueuingStrategy(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_countQueuingStrategyHighWaterMark")&&x instanceof CountQueuingStrategy}function convertTransformerFlushCallback(fn,original,context){return assertFunction(fn,context),function(controller){return promiseCall(fn,original,[controller])}}function convertTransformerStartCallback(fn,original,context){return assertFunction(fn,context),function(controller){return reflectCall(fn,original,[controller])}}function convertTransformerTransformCallback(fn,original,context){return assertFunction(fn,context),function(chunk,controller){return promiseCall(fn,original,[chunk,controller])}}Object.defineProperties(CountQueuingStrategy.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(CountQueuingStrategy.prototype,SymbolPolyfill.toStringTag,{value:"CountQueuingStrategy",configurable:!0});var TransformStream=function(){function TransformStream(rawTransformer,rawWritableStrategy,rawReadableStrategy){void 0===rawTransformer&&(rawTransformer={}),void 0===rawWritableStrategy&&(rawWritableStrategy={}),void 0===rawReadableStrategy&&(rawReadableStrategy={}),void 0===rawTransformer&&(rawTransformer=null);var writableStrategy=convertQueuingStrategy(rawWritableStrategy,"Second parameter"),readableStrategy=convertQueuingStrategy(rawReadableStrategy,"Third parameter"),transformer=function(original,context){assertDictionary(original,context);var flush=null==original?void 0:original.flush,readableType=null==original?void 0:original.readableType,start=null==original?void 0:original.start,transform=null==original?void 0:original.transform,writableType=null==original?void 0:original.writableType;return{flush:void 0===flush?void 0:convertTransformerFlushCallback(flush,original,context+" has member 'flush' that"),readableType:readableType,start:void 0===start?void 0:convertTransformerStartCallback(start,original,context+" has member 'start' that"),transform:void 0===transform?void 0:convertTransformerTransformCallback(transform,original,context+" has member 'transform' that"),writableType:writableType}}(rawTransformer,"First parameter");if(void 0!==transformer.readableType)throw new RangeError("Invalid readableType specified");if(void 0!==transformer.writableType)throw new RangeError("Invalid writableType specified");var startPromise_resolve,readableHighWaterMark=ExtractHighWaterMark(readableStrategy,0),readableSizeAlgorithm=ExtractSizeAlgorithm(readableStrategy),writableHighWaterMark=ExtractHighWaterMark(writableStrategy,1),writableSizeAlgorithm=ExtractSizeAlgorithm(writableStrategy);!function(stream,startPromise,writableHighWaterMark,writableSizeAlgorithm,readableHighWaterMark,readableSizeAlgorithm){function startAlgorithm(){return startPromise}function writeAlgorithm(chunk){return function(stream,chunk){var controller=stream._transformStreamController;return stream._backpressure?transformPromiseWith(stream._backpressureChangePromise,(function(){var writable=stream._writable;if("erroring"===writable._state)throw writable._storedError;return TransformStreamDefaultControllerPerformTransform(controller,chunk)})):TransformStreamDefaultControllerPerformTransform(controller,chunk)}(stream,chunk)}function abortAlgorithm(reason){return function(stream,reason){return TransformStreamError(stream,reason),promiseResolvedWith(void 0)}(stream,reason)}function closeAlgorithm(){return function(stream){var readable=stream._readable,controller=stream._transformStreamController,flushPromise=controller._flushAlgorithm();return TransformStreamDefaultControllerClearAlgorithms(controller),transformPromiseWith(flushPromise,(function(){if("errored"===readable._state)throw readable._storedError;ReadableStreamDefaultControllerClose(readable._readableStreamController)}),(function(r){throw TransformStreamError(stream,r),readable._storedError}))}(stream)}function pullAlgorithm(){return function(stream){return TransformStreamSetBackpressure(stream,!1),stream._backpressureChangePromise}(stream)}function cancelAlgorithm(reason){return TransformStreamErrorWritableAndUnblockWrite(stream,reason),promiseResolvedWith(void 0)}stream._writable=function(startAlgorithm,writeAlgorithm,closeAlgorithm,abortAlgorithm,highWaterMark,sizeAlgorithm){void 0===highWaterMark&&(highWaterMark=1),void 0===sizeAlgorithm&&(sizeAlgorithm=function(){return 1});var stream=Object.create(WritableStream.prototype);return InitializeWritableStream(stream),SetUpWritableStreamDefaultController(stream,Object.create(WritableStreamDefaultController.prototype),startAlgorithm,writeAlgorithm,closeAlgorithm,abortAlgorithm,highWaterMark,sizeAlgorithm),stream}(startAlgorithm,writeAlgorithm,closeAlgorithm,abortAlgorithm,writableHighWaterMark,writableSizeAlgorithm),stream._readable=CreateReadableStream(startAlgorithm,pullAlgorithm,cancelAlgorithm,readableHighWaterMark,readableSizeAlgorithm),stream._backpressure=void 0,stream._backpressureChangePromise=void 0,stream._backpressureChangePromise_resolve=void 0,TransformStreamSetBackpressure(stream,!0),stream._transformStreamController=void 0}(this,newPromise((function(resolve){startPromise_resolve=resolve})),writableHighWaterMark,writableSizeAlgorithm,readableHighWaterMark,readableSizeAlgorithm),function(stream,transformer){var controller=Object.create(TransformStreamDefaultController.prototype),transformAlgorithm=function(chunk){try{return TransformStreamDefaultControllerEnqueue(controller,chunk),promiseResolvedWith(void 0)}catch(transformResultE){return promiseRejectedWith(transformResultE)}},flushAlgorithm=function(){return promiseResolvedWith(void 0)};void 0!==transformer.transform&&(transformAlgorithm=function(chunk){return transformer.transform(chunk,controller)}),void 0!==transformer.flush&&(flushAlgorithm=function(){return transformer.flush(controller)}),function(stream,controller,transformAlgorithm,flushAlgorithm){controller._controlledTransformStream=stream,stream._transformStreamController=controller,controller._transformAlgorithm=transformAlgorithm,controller._flushAlgorithm=flushAlgorithm}(stream,controller,transformAlgorithm,flushAlgorithm)}(this,transformer),void 0!==transformer.start?startPromise_resolve(transformer.start(this._transformStreamController)):startPromise_resolve(void 0)}return Object.defineProperty(TransformStream.prototype,"readable",{get:function(){if(!IsTransformStream(this))throw streamBrandCheckException("readable");return this._readable},enumerable:!1,configurable:!0}),Object.defineProperty(TransformStream.prototype,"writable",{get:function(){if(!IsTransformStream(this))throw streamBrandCheckException("writable");return this._writable},enumerable:!1,configurable:!0}),TransformStream}();function IsTransformStream(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_transformStreamController")&&x instanceof TransformStream}function TransformStreamError(stream,e){ReadableStreamDefaultControllerError(stream._readable._readableStreamController,e),TransformStreamErrorWritableAndUnblockWrite(stream,e)}function TransformStreamErrorWritableAndUnblockWrite(stream,e){TransformStreamDefaultControllerClearAlgorithms(stream._transformStreamController),WritableStreamDefaultControllerErrorIfNeeded(stream._writable._writableStreamController,e),stream._backpressure&&TransformStreamSetBackpressure(stream,!1)}function TransformStreamSetBackpressure(stream,backpressure){void 0!==stream._backpressureChangePromise&&stream._backpressureChangePromise_resolve(),stream._backpressureChangePromise=newPromise((function(resolve){stream._backpressureChangePromise_resolve=resolve})),stream._backpressure=backpressure}Object.defineProperties(TransformStream.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(TransformStream.prototype,SymbolPolyfill.toStringTag,{value:"TransformStream",configurable:!0});var TransformStreamDefaultController=function(){function TransformStreamDefaultController(){throw new TypeError("Illegal constructor")}return Object.defineProperty(TransformStreamDefaultController.prototype,"desiredSize",{get:function(){if(!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("desiredSize");return ReadableStreamDefaultControllerGetDesiredSize(this._controlledTransformStream._readable._readableStreamController)},enumerable:!1,configurable:!0}),TransformStreamDefaultController.prototype.enqueue=function(chunk){if(void 0===chunk&&(chunk=void 0),!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("enqueue");TransformStreamDefaultControllerEnqueue(this,chunk)},TransformStreamDefaultController.prototype.error=function(reason){if(void 0===reason&&(reason=void 0),!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("error");var e;e=reason,TransformStreamError(this._controlledTransformStream,e)},TransformStreamDefaultController.prototype.terminate=function(){if(!IsTransformStreamDefaultController(this))throw defaultControllerBrandCheckException("terminate");!function(controller){var stream=controller._controlledTransformStream;ReadableStreamDefaultControllerClose(stream._readable._readableStreamController);var error=new TypeError("TransformStream terminated");TransformStreamErrorWritableAndUnblockWrite(stream,error)}(this)},TransformStreamDefaultController}();function IsTransformStreamDefaultController(x){return!!typeIsObject(x)&&!!Object.prototype.hasOwnProperty.call(x,"_controlledTransformStream")&&x instanceof TransformStreamDefaultController}function TransformStreamDefaultControllerClearAlgorithms(controller){controller._transformAlgorithm=void 0,controller._flushAlgorithm=void 0}function TransformStreamDefaultControllerEnqueue(controller,chunk){var stream=controller._controlledTransformStream,readableController=stream._readable._readableStreamController;if(!ReadableStreamDefaultControllerCanCloseOrEnqueue(readableController))throw new TypeError("Readable side is not in a state that permits enqueue");try{ReadableStreamDefaultControllerEnqueue(readableController,chunk)}catch(e){throw TransformStreamErrorWritableAndUnblockWrite(stream,e),stream._readable._storedError}var backpressure=function(controller){return!ReadableStreamDefaultControllerShouldCallPull(controller)}(readableController);backpressure!==stream._backpressure&&TransformStreamSetBackpressure(stream,!0)}function TransformStreamDefaultControllerPerformTransform(controller,chunk){return transformPromiseWith(controller._transformAlgorithm(chunk),void 0,(function(r){throw TransformStreamError(controller._controlledTransformStream,r),r}))}function defaultControllerBrandCheckException(name){return new TypeError("TransformStreamDefaultController.prototype."+name+" can only be used on a TransformStreamDefaultController")}function streamBrandCheckException(name){return new TypeError("TransformStream.prototype."+name+" can only be used on a TransformStream")}Object.defineProperties(TransformStreamDefaultController.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),"symbol"===_typeof(SymbolPolyfill.toStringTag)&&Object.defineProperty(TransformStreamDefaultController.prototype,SymbolPolyfill.toStringTag,{value:"TransformStreamDefaultController",configurable:!0}),exports.ByteLengthQueuingStrategy=ByteLengthQueuingStrategy,exports.CountQueuingStrategy=CountQueuingStrategy,exports.ReadableByteStreamController=ReadableByteStreamController,exports.ReadableStream=ReadableStream,exports.ReadableStreamBYOBReader=ReadableStreamBYOBReader,exports.ReadableStreamBYOBRequest=ReadableStreamBYOBRequest,exports.ReadableStreamDefaultController=ReadableStreamDefaultController,exports.ReadableStreamDefaultReader=ReadableStreamDefaultReader,exports.TransformStream=TransformStream,exports.TransformStreamDefaultController=TransformStreamDefaultController,exports.WritableStream=WritableStream,exports.WritableStreamDefaultController=WritableStreamDefaultController,exports.WritableStreamDefaultWriter=WritableStreamDefaultWriter,Object.defineProperty(exports,"__esModule",{value:!0})},"object"===_typeof(exports)?factory(exports):(__WEBPACK_AMD_DEFINE_ARRAY__=[exports],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},601:function(){},767:function(){},251:function(){},677:function(){},543:function(){},324:function(){}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={id:moduleId,loaded:!1,exports:{}};return __webpack_modules__[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,{a:getter}),getter},__webpack_require__.d=function(exports,definition){for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)},__webpack_require__.nmd=function(module){return module.paths=[],module.children||(module.children=[]),module},function(){var scriptUrl;__webpack_require__.g.importScripts&&(scriptUrl=__webpack_require__.g.location+"");var document=__webpack_require__.g.document;if(!scriptUrl&&document&&(document.currentScript&&(scriptUrl=document.currentScript.src),!scriptUrl)){var scripts=document.getElementsByTagName("script");if(scripts.length)for(var i=scripts.length-1;i>-1&&!scriptUrl;)scriptUrl=scripts[i--].src}if(!scriptUrl)throw new Error("Automatic publicPath is not supported in this browser");scriptUrl=scriptUrl.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=scriptUrl}();var __webpack_exports__={};!function(){"use strict";var urls,external_kolibriCoreAppGlobal_namespaceObject=kolibriCoreAppGlobal,external_kolibriCoreAppGlobal_default=__webpack_require__.n(external_kolibriCoreAppGlobal_namespaceObject),external_kolibriCoreAppGlobal_urls_namespaceObject=kolibriCoreAppGlobal.urls;function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,_toPropertyKey(descriptor.key),descriptor)}}function _toPropertyKey(t){var i=function(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==_typeof(i)?i:String(i)}urls=__webpack_require__.n(external_kolibriCoreAppGlobal_urls_namespaceObject)(),__webpack_require__.p=urls.static("".concat("kolibri.plugins.pdf_viewer.main","/"));var KolibriModule=function(){function KolibriModule(options){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,KolibriModule),this.name="kolibri.plugins.pdf_viewer.main";var safeOptions={};this.kolibriModuleOptions.forEach((function(option){options[option]&&(safeOptions[option]=options[option])})),Object.assign(this,safeOptions);for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];this.initialize.apply(this,[options].concat(args)),this._registerKolibriModule()}var Constructor,protoProps,staticProps;return Constructor=KolibriModule,protoProps=[{key:"kolibriModuleOptions",get:function(){return[]}},{key:"_registerKolibriModule",value:function(){external_kolibriCoreAppGlobal_default().registerKolibriModuleSync(this)}},{key:"initialize",value:function(){}},{key:"ready",value:function(){}},{key:"stopListening",value:function(event,method){external_kolibriCoreAppGlobal_default().stopListening(event,this,method)}},{key:"emit",value:function(){external_kolibriCoreAppGlobal_default().emit.apply(external_kolibriCoreAppGlobal_default(),arguments)}},{key:"Kolibri",get:function(){return external_kolibriCoreAppGlobal_default()}}],protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),KolibriModule}();function content_renderer_module_typeof(o){return content_renderer_module_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},content_renderer_module_typeof(o)}function content_renderer_module_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,content_renderer_module_toPropertyKey(descriptor.key),descriptor)}}function content_renderer_module_toPropertyKey(t){var i=function(t,r){if("object"!=content_renderer_module_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=content_renderer_module_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==content_renderer_module_typeof(i)?i:String(i)}function _callSuper(_this,derived,args){return derived=_getPrototypeOf(derived),function(self,call){if(call&&("object"===content_renderer_module_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(_this,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(derived,args||[],_getPrototypeOf(_this).constructor):derived.apply(_this,args))}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}var ContentRenderer=function(_KolibriModule){function ContentRenderer(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,ContentRenderer),_callSuper(this,ContentRenderer,arguments)}var Constructor,protoProps,staticProps;return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(ContentRenderer,_KolibriModule),Constructor=ContentRenderer,(protoProps=[{key:"rendererComponent",get:function(){return null}},{key:"loadDirectionalCSS",value:function(direction){return this.Kolibri.loadDirectionalCSS(this,direction)}}])&&content_renderer_module_defineProperties(Constructor.prototype,protoProps),staticProps&&content_renderer_module_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),ContentRenderer}(KolibriModule),render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("CoreFullscreen",{ref:"pdfRenderer",staticClass:"pdf-renderer",class:{"pdf-controls-open":_vm.showControls,"pdf-full-screen":_vm.isInFullscreen},style:{backgroundColor:_vm.$themeTokens.text},on:{changeFullscreen:function($event){_vm.isInFullscreen=$event}}},[_vm.documentLoading||null===_vm.firstPageHeight?_c("KLinearLoader",{staticClass:"progress-bar",attrs:{delay:!1,type:_vm.progress>0?"determinate":"indeterminate",progress:100*_vm.progress}}):[_c("transition",{attrs:{name:"slide"}},[_c("div",{staticClass:"fullscreen-header pdf-controls-container",style:{backgroundColor:this.$themePalette.grey.v_100}},[_c("div",[_vm.outline&&_vm.outline.length>0?_c("KIconButton",{staticClass:"controls",attrs:{ariaLabel:_vm.coreString("bookmarksLabel"),tooltip:_vm.coreString("bookmarksLabel"),"aria-controls":"sidebar-container",icon:"menu"},on:{click:_vm.toggleSideBar}}):_vm._e()],1),_c("div",[_c("KIconButton",{staticClass:"button-zoom-in controls",attrs:{ariaLabel:_vm.coreString("zoomIn"),"aria-controls":"pdf-container",icon:"add"},on:{click:_vm.zoomIn}}),_c("KIconButton",{staticClass:"button-zoom-out controls",attrs:{ariaLabel:_vm.coreString("zoomOut"),"aria-controls":"pdf-container",icon:"remove"},on:{click:_vm.zoomOut}}),_c("KButton",{staticClass:"fullscreen-button",attrs:{primary:!1,appearance:"flat-button",icon:_vm.isInFullscreen?"fullscreen_exit":"fullscreen"},on:{click:function($event){return _vm.$refs.pdfRenderer.toggleFullscreen()}}},[_vm._v("\n            "+_vm._s(_vm.fullscreenText)+"\n          ")])],1)])]),_c("KGrid",{staticClass:"full-height-container",attrs:{gutter:"0"}},[_vm.showSideBar?_c("KGridItem",{staticClass:"full-height-container",attrs:{layout8:{span:2},layout12:{span:3}}},[_c("SideBar",{staticClass:"scroller-height",style:{position:"sticky",top:0},attrs:{id:"sidebar-container",outline:_vm.outline||[],goToDestination:_vm.goToDestination,focusDestPage:_vm.focusDestPage}})],1):_vm._e(),_c("KGridItem",{ref:"pdfContainer",staticClass:"full-height-container",attrs:{layout8:{span:_vm.showSideBar?6:8},layout12:{span:_vm.showSideBar?9:12}}},[_c("RecycleList",{ref:"recycleList",staticClass:"pdf-container scroller-height",attrs:{id:"pdf-container",items:_vm.pdfPages,itemHeight:_vm.itemHeight,emitUpdate:!0,keyField:"index"},on:{update:_vm.handleUpdate},scopedSlots:_vm._u([{key:"default",fn:function(ref){var item=ref.item;return[_c("PdfPage",{key:item.index,attrs:{pageNum:item.index+1,pdfPage:_vm.pdfPages[item.index].page,pageReady:_vm.pdfPages[item.index].resolved,firstPageHeight:_vm.firstPageHeight||0,firstPageWidth:_vm.firstPageWidth||0,scale:_vm.scale||1,totalPages:_vm.pdfPages.length,eventBus:_vm.eventBus}})]}}])})],1)],1)]],2)};render._withStripped=!0;var pdf=__webpack_require__(784),hammerjs_hammer=__webpack_require__(101),hammer_default=__webpack_require__.n(hammerjs_hammer),throttle=__webpack_require__(876),throttle_default=__webpack_require__.n(throttle),debounce=__webpack_require__(310),debounce_default=__webpack_require__.n(debounce),external_kolibriCoreAppGlobal_lib_logging_namespaceObject=kolibriCoreAppGlobal.lib.logging,external_kolibriCoreAppGlobal_lib_logging_default=__webpack_require__.n(external_kolibriCoreAppGlobal_lib_logging_namespaceObject),config={itemsLimit:1e3};var isIE=void 0;function initCompat(){initCompat.init||(initCompat.init=!0,isIE=-1!==function(){var ua=window.navigator.userAgent,msie=ua.indexOf("MSIE ");if(msie>0)return parseInt(ua.substring(msie+5,ua.indexOf(".",msie)),10);if(ua.indexOf("Trident/")>0){var rv=ua.indexOf("rv:");return parseInt(ua.substring(rv+3,ua.indexOf(".",rv)),10)}var edge=ua.indexOf("Edge/");return edge>0?parseInt(ua.substring(edge+5,ua.indexOf(".",edge)),10):-1}())}var ResizeObserver={render:function(){var _h=this.$createElement;return(this._self._c||_h)("div",{staticClass:"resize-observer",attrs:{tabindex:"-1"}})},staticRenderFns:[],_scopeId:"data-v-b329ee4c",name:"resize-observer",methods:{notify:function(){this.$emit("notify")},addResizeHandlers:function(){this._resizeObject.contentDocument.defaultView.addEventListener("resize",this.notify),this._w===this.$el.offsetWidth&&this._h===this.$el.offsetHeight||this.notify()},removeResizeHandlers:function(){this._resizeObject&&this._resizeObject.onload&&(!isIE&&this._resizeObject.contentDocument&&this._resizeObject.contentDocument.defaultView.removeEventListener("resize",this.notify),delete this._resizeObject.onload)}},mounted:function(){var _this=this;initCompat(),this.$nextTick((function(){_this._w=_this.$el.offsetWidth,_this._h=_this.$el.offsetHeight}));var object=document.createElement("object");this._resizeObject=object,object.setAttribute("style","display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; pointer-events: none; z-index: -1;"),object.setAttribute("aria-hidden","true"),object.setAttribute("tabindex",-1),object.onload=this.addResizeHandlers,object.type="text/html",isIE&&this.$el.appendChild(object),object.data="about:blank",isIE||this.$el.appendChild(object)},beforeDestroy:function(){this.removeResizeHandlers()}};var vue_virtual_scroller_esm_plugin={version:"0.4.4",install:function(Vue){Vue.component("resize-observer",ResizeObserver)}},GlobalVue=null;"undefined"!=typeof window?GlobalVue=window.Vue:void 0!==__webpack_require__.g&&(GlobalVue=__webpack_require__.g.Vue),GlobalVue&&GlobalVue.use(vue_virtual_scroller_esm_plugin);var createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,descriptor.key,descriptor)}}return function(Constructor,protoProps,staticProps){return protoProps&&defineProperties(Constructor.prototype,protoProps),staticProps&&defineProperties(Constructor,staticProps),Constructor}}();function vue_virtual_scroller_esm_throttle(callback,delay){var timeout=void 0,lastState=void 0,currentArgs=void 0,throttled=function(state){for(var _len=arguments.length,args=Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];currentArgs=args,timeout&&state===lastState||(lastState=state,clearTimeout(timeout),timeout=setTimeout((function(){callback.apply(void 0,[state].concat(function(arr){if(Array.isArray(arr)){for(var i=0,arr2=Array(arr.length);i<arr.length;i++)arr2[i]=arr[i];return arr2}return Array.from(arr)}(currentArgs))),timeout=0}),delay))};return throttled._clear=function(){clearTimeout(timeout)},throttled}var VisibilityState=function(){function VisibilityState(el,options,vnode){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,VisibilityState),this.el=el,this.observer=null,this.createObserver(options,vnode)}return createClass(VisibilityState,[{key:"createObserver",value:function(options,vnode){var value,_this=this;this.observer&&this.destroyObserver(),this.options="function"==typeof(value=options)?{callback:value}:value,this.callback=this.options.callback,this.callback&&this.options.throttle&&(this.callback=vue_virtual_scroller_esm_throttle(this.callback,this.options.throttle)),this.observer=new IntersectionObserver((function(entries){var entry=entries[0];_this.callback&&_this.callback(entry.isIntersecting&&entry.intersectionRatio>=_this.threshold,entry)}),this.options.intersection),vnode.context.$nextTick((function(){_this.observer.observe(_this.el)}))}},{key:"destroyObserver",value:function(){this.observer&&this.observer.disconnect(),this.callback&&this.callback._clear&&this.callback._clear()}},{key:"threshold",get:function(){return this.options.intersection&&this.options.intersection.threshold||0}}]),VisibilityState}(),ObserveVisibility={bind:function(el,_ref,vnode){var value=_ref.value;if("undefined"==typeof IntersectionObserver)console.warn("[vue-observe-visibility] IntersectionObserver API is not available in your browser. Please install this polyfill: https://github.com/w3c/IntersectionObserver/tree/master/polyfill");else{var state=new VisibilityState(el,value,vnode);el._vue_visibilityState=state}},update:function(el,_ref2,vnode){var value=_ref2.value,state=el._vue_visibilityState;state?state.createObserver(value,vnode):this.bind(el,{value:value},vnode)},unbind:function(el){var state=el._vue_visibilityState;state&&(state.destroyObserver(),delete el._vue_visibilityState)}};var plugin$1={version:"0.4.1",install:function(Vue){Vue.directive("observe-visibility",ObserveVisibility)}},GlobalVue$1=null;"undefined"!=typeof window?GlobalVue$1=window.Vue:void 0!==__webpack_require__.g&&(GlobalVue$1=__webpack_require__.g.Vue),GlobalVue$1&&GlobalVue$1.use(plugin$1);var commonjsGlobal="undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:"undefined"!=typeof self?self:{};var fn,module,scrollparent=(fn=function(module){var root,factory;root=commonjsGlobal,factory=function(){var regex=/(auto|scroll)/,parents=function parents(node,ps){return null===node.parentNode?ps:parents(node.parentNode,ps.concat([node]))},style=function(node,prop){return getComputedStyle(node,null).getPropertyValue(prop)},scroll=function(node){return regex.test(function(node){return style(node,"overflow")+style(node,"overflow-y")+style(node,"overflow-x")}(node))};return function(node){if(node instanceof HTMLElement||node instanceof SVGElement){for(var ps=parents(node.parentNode,[]),i=0;i<ps.length;i+=1)if(scroll(ps[i]))return ps[i];return document.scrollingElement||document.documentElement}}},module.exports?module.exports=factory():root.Scrollparent=factory()},fn(module={exports:{}},module.exports),module.exports),supportsPassive=!1;if("undefined"!=typeof window){supportsPassive=!1;try{var opts=Object.defineProperty({},"passive",{get:function(){supportsPassive=!0}});window.addEventListener("test",null,opts)}catch(e){}}var Scroller={components:{ResizeObserver:ResizeObserver},directives:{ObserveVisibility:ObserveVisibility},props:{items:{type:Array,required:!0},itemHeight:{type:[Number,String],default:null},minItemHeight:{type:[Number,String],default:null},heightField:{type:String,default:"height"},typeField:{type:String,default:"type"},buffer:{type:[Number,String],default:200},pageMode:{type:Boolean,default:!1},prerender:{type:[Number,String],default:0},emitUpdate:{type:Boolean,default:!1}},computed:{cssClass:function(){return{"page-mode":this.pageMode}},heights:function(){if(null===this.itemHeight){for(var heights={"-1":{accumulator:0}},items=this.items,field=this.heightField,minItemHeight=this.minItemHeight,accumulator=0,current=void 0,i=0,l=items.length;i<l;i++)accumulator+=current=items[i][field]||minItemHeight,heights[i]={accumulator:accumulator,height:current};return heights}}},beforeDestroy:function(){this.removeListeners()},methods:{getListenerTarget:function(){var target=scrollparent(this.$el);return target===window.document.documentElement&&(target=window),target},getScroll:function(){var el=this.$el,scrollState=void 0;if(this.pageMode){var rect=el.getBoundingClientRect(),top=-rect.top,height=window.innerHeight;top<0&&(height+=top,top=0),top+height>rect.height&&(height=rect.height-top),scrollState={top:top,bottom:top+height}}else scrollState={top:el.scrollTop,bottom:el.scrollTop+el.clientHeight};return scrollState},applyPageMode:function(){this.pageMode?this.addListeners():this.removeListeners()},addListeners:function(){this.listenerTarget=this.getListenerTarget(),this.listenerTarget.addEventListener("scroll",this.handleScroll,!!supportsPassive&&{passive:!0}),this.listenerTarget.addEventListener("resize",this.handleResize)},removeListeners:function(){this.listenerTarget&&(this.listenerTarget.removeEventListener("scroll",this.handleScroll),this.listenerTarget.removeEventListener("resize",this.handleResize),this.listenerTarget=null)},scrollToItem:function(index){var scrollTop=void 0;scrollTop=null===this.itemHeight?index>0?this.heights[index-1].accumulator:0:index*this.itemHeight,this.scrollToPosition(scrollTop)},scrollToPosition:function(position){this.$el.scrollTop=position},itemsLimitError:function(){var _this=this;throw setTimeout((function(){console.log("It seems the scroller element isn't scrolling, so it tries to render all the items at once.","Scroller:",_this.$el),console.log("Make sure the scroller has a fixed height and 'overflow-y' set to 'auto' so it can scroll correctly and only render the items visible in the scroll viewport.")})),new Error("Rendered items limit reached")}}},script={name:"VirtualScroller",mixins:[Scroller],props:{renderers:{type:Object,default:null},keyField:{type:String,default:"id"},mainTag:{type:String,default:"div"},containerTag:{type:String,default:"div"},containerClass:{type:[String,Array,Object],default:null},contentTag:{type:String,default:"div"},contentClass:{type:[String,Array,Object],default:null},poolSize:{type:[Number,String],default:2e3},delayPreviousItems:{type:Boolean,default:!1}},data:function(){return{visibleItems:[],itemContainerStyle:null,itemsStyle:null,keysEnabled:!0}},watch:{items:{handler:function(){this.updateVisibleItems(!0)},deep:!0},pageMode:function(){this.applyPageMode(),this.updateVisibleItems(!0)},itemHeight:"setDirty"},created:function(){this.$_ready=!1,this.$_startIndex=0,this.$_oldScrollTop=null,this.$_oldScrollBottom=null,this.$_offsetTop=0,this.$_height=0,this.$_scrollDirty=!1,this.$_updateDirty=!1;var prerender=parseInt(this.prerender);prerender>0?(this.visibleItems=this.items.slice(0,prerender),this.$_length=this.visibleItems.length,this.$_endIndex=this.$_length-1,this.$_skip=!0):(this.$_endIndex=0,this.$_length=0,this.$_skip=!1)},mounted:function(){var _this=this;this.applyPageMode(),this.$nextTick((function(){_this.updateVisibleItems(!0),_this.$_ready=!0}))},methods:{updateVisibleItems:function(){var _this2=this,force=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.$_updateDirty||(this.$_updateDirty=!0,this.$nextTick((function(){_this2.$_updateDirty=!1;var l=_this2.items.length,scroll=_this2.getScroll(),items=_this2.items,itemHeight=_this2.itemHeight,containerHeight=void 0,offsetTop=void 0;if(scroll){var startIndex=-1,endIndex=-1,buffer=parseInt(_this2.buffer),poolSize=parseInt(_this2.poolSize),scrollTop=~~(scroll.top/poolSize)*poolSize-buffer,scrollBottom=Math.ceil(scroll.bottom/poolSize)*poolSize+buffer;if(!force&&(scrollTop===_this2.$_oldScrollTop&&scrollBottom===_this2.$_oldScrollBottom||_this2.$_skip))return void(_this2.$_skip=!1);if(_this2.$_oldScrollTop=scrollTop,_this2.$_oldScrollBottom=scrollBottom,null===itemHeight){var heights=_this2.heights,a=0,b=l-1,i=~~(l/2),oldI=void 0;do{oldI=i,heights[i].accumulator<scrollTop?a=i:i<l-1&&heights[i+1].accumulator>scrollTop&&(b=i),i=~~((a+b)/2)}while(i!==oldI);for(i<0&&(i=0),startIndex=i,offsetTop=i>0?heights[i-1].accumulator:0,containerHeight=heights[l-1].accumulator,endIndex=i;endIndex<l&&heights[endIndex].accumulator<scrollBottom;endIndex++);-1===endIndex?endIndex=items.length-1:++endIndex>l&&(endIndex=l)}else startIndex=~~(scrollTop/itemHeight),endIndex=Math.ceil(scrollBottom/itemHeight),startIndex<0&&(startIndex=0),endIndex>l&&(endIndex=l),offsetTop=startIndex*itemHeight,containerHeight=l*itemHeight;endIndex-startIndex>config.itemsLimit&&_this2.itemsLimitError(),(force||_this2.$_startIndex!==startIndex||_this2.$_endIndex!==endIndex||_this2.$_offsetTop!==offsetTop||_this2.$_height!==containerHeight||_this2.$_length!==l)&&(_this2.keysEnabled=!(startIndex>_this2.$_endIndex||endIndex<_this2.$_startIndex),_this2.itemContainerStyle={height:containerHeight+"px"},_this2.itemsStyle={marginTop:offsetTop+"px"},_this2.delayPreviousItems?(_this2.visibleItems=items.slice(_this2.$_startIndex,endIndex),_this2.$nextTick((function(){_this2.visibleItems=items.slice(startIndex,endIndex)}))):_this2.visibleItems=items.slice(startIndex,endIndex),_this2.emitUpdate&&_this2.$emit("update",startIndex,endIndex),_this2.$_startIndex=startIndex,_this2.$_endIndex=endIndex,_this2.$_length=l,_this2.$_offsetTop=offsetTop,_this2.$_height=containerHeight)}})))},setDirty:function(){this.$_oldScrollTop=null,this.$_oldScrollBottom=null},handleScroll:function(){var _this3=this;this.$_scrollDirty||(this.$_scrollDirty=!0,requestAnimationFrame((function(){_this3.$_scrollDirty=!1,_this3.updateVisibleItems()})))},handleResize:function(){this.$emit("resize"),this.$_ready&&this.updateVisibleItems()},handleVisibilityChange:function(isVisible,entry){var _this4=this;this.$_ready&&(isVisible||0!==entry.boundingClientRect.width||0!==entry.boundingClientRect.height)&&(this.$emit("visible"),this.$nextTick((function(){_this4.updateVisibleItems()})))}}},__vue_script__=script,__vue_render__=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c(_vm.mainTag,{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:_vm.handleVisibilityChange,expression:"handleVisibilityChange"}],tag:"component",staticClass:"virtual-scroller",class:_vm.cssClass,on:{"&scroll":function($event){return _vm.handleScroll($event)}}},[_vm._t("before-container"),_vm._v(" "),_c(_vm.containerTag,{ref:"itemContainer",tag:"component",staticClass:"item-container",class:_vm.containerClass,style:_vm.itemContainerStyle},[_vm._t("before-content"),_vm._v(" "),_c(_vm.contentTag,{ref:"items",tag:"component",staticClass:"items",class:_vm.contentClass,style:_vm.itemsStyle},[_vm.renderers?_vm._l(_vm.visibleItems,(function(item,index){return _c(_vm.renderers[item[_vm.typeField]],{key:_vm.keysEnabled&&item[_vm.keyField]||void 0,tag:"component",staticClass:"item",attrs:{item:item,"item-index":_vm.$_startIndex+index}})})):[_vm._l(_vm.visibleItems,(function(item,index){return _vm._t("default",null,{item:item,itemIndex:_vm.$_startIndex+index,itemKey:_vm.keysEnabled&&item[_vm.keyField]||void 0})}))]],2),_vm._v(" "),_vm._t("after-content")],2),_vm._v(" "),_vm._t("after-container"),_vm._v(" "),_c("resize-observer",{on:{notify:_vm.handleResize}})],2)};__vue_render__._withStripped=!0;function __vue_create_injector__(){var head=document.head||document.getElementsByTagName("head")[0],styles=__vue_create_injector__.styles||(__vue_create_injector__.styles={}),isOldIE="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(id,css){if(!document.querySelector('style[data-vue-ssr-id~="'+id+'"]')){var group=isOldIE?css.media||"default":id,style=styles[group]||(styles[group]={ids:[],parts:[],element:void 0});if(!style.ids.includes(id)){var code=css.source,index=style.ids.length;if(style.ids.push(id),isOldIE&&(style.element=style.element||document.querySelector("style[data-group="+group+"]")),!style.element){var el=style.element=document.createElement("style");el.type="text/css",css.media&&el.setAttribute("media",css.media),isOldIE&&(el.setAttribute("data-group",group),el.setAttribute("data-next-index","0")),head.appendChild(el)}if(isOldIE&&(index=parseInt(style.element.getAttribute("data-next-index")),style.element.setAttribute("data-next-index",index+1)),style.element.styleSheet)style.parts.push(code),style.element.styleSheet.cssText=style.parts.filter(Boolean).join("\n");else{var textNode=document.createTextNode(code),nodes=style.element.childNodes;nodes[index]&&style.element.removeChild(nodes[index]),nodes.length?style.element.insertBefore(textNode,nodes[index]):style.element.appendChild(textNode)}}}}}var VirtualScroller=function(template,style,script$$1,scope,functional,moduleIdentifier,createInjector,createInjectorSSR){var component=("function"==typeof script$$1?script$$1.options:script$$1)||{};component.__file="/home/akryum/Projets/vue-virtual-scroller/src/components/VirtualScroller.vue",component.render||(component.render=template.render,component.staticRenderFns=template.staticRenderFns,component._compiled=!0,functional&&(component.functional=!0)),component._scopeId=scope;var hook=void 0;if(style&&(hook=function(context){style.call(this,createInjector(context))}),void 0!==hook)if(component.functional){var originalRender=component.render;component.render=function(h,context){return hook.call(context),originalRender(h,context)}}else{var existing=component.beforeCreate;component.beforeCreate=existing?[].concat(existing,hook):[hook]}return component}({render:__vue_render__,staticRenderFns:[]},(function(inject){inject&&inject("data-v-caa2d078_0",{source:"\n.virtual-scroller[data-v-caa2d078]:not(.page-mode) {\n  overflow-y: auto;\n}\n.item-container[data-v-caa2d078] {\n  box-sizing: border-box;\n  width: 100%;\n  overflow: hidden;\n}\n.items[data-v-caa2d078] {\n  width: 100%;\n}\n",map:void 0,media:void 0})}),void 0===__vue_script__?{}:__vue_script__,"data-v-caa2d078",!1,0,__vue_create_injector__,"undefined"!=typeof __vue_create_injector_ssr__&&__vue_create_injector_ssr__),uid=0,script$1={name:"RecycleList",mixins:[Scroller],props:{itemHeight:{type:Number,default:null},keyField:{type:String,default:null}},data:function(){return{pool:[],totalHeight:0}},watch:{items:function(){this.updateVisibleItems(!0)},pageMode:function(){this.applyPageMode(),this.updateVisibleItems(!1)},heights:{handler:function(){this.updateVisibleItems(!1)},deep:!0}},created:function(){this.$_ready=!1,this.$_startIndex=0,this.$_endIndex=0,this.$_views=new Map,this.$_unusedViews=new Map,this.$_scrollDirty=!1},mounted:function(){var _this=this;this.applyPageMode(),this.$nextTick((function(){_this.updateVisibleItems(!0),_this.$_ready=!0}))},methods:{addView:function(pool,index,item,key,type){var view={item:item,top:0},nonReactive={id:uid++,index:index,used:!0,key:key,type:type};return Object.defineProperty(view,"nr",{configurable:!1,value:nonReactive}),pool.push(view),view},unuseView:function(view){var fake=arguments.length>1&&void 0!==arguments[1]&&arguments[1],unusedViews=this.$_unusedViews,type=view.nr.type,unusedPool=unusedViews.get(type);unusedPool||(unusedPool=[],unusedViews.set(type,unusedPool)),unusedPool.push(view),fake||(view.nr.used=!1,view.top=-9999,this.$_views.delete(view.nr.key))},handleResize:function(){this.$emit("resize"),this.$_ready&&this.updateVisibleItems(!1)},handleScroll:function(event){var _this2=this;this.$_scrollDirty||(this.$_scrollDirty=!0,requestAnimationFrame((function(){_this2.$_scrollDirty=!1,_this2.updateVisibleItems(!1).continuous||(clearTimeout(_this2.$_refreshTimout),_this2.$_refreshTimout=setTimeout(_this2.handleScroll,100))})))},handleVisibilityChange:function(isVisible,entry){var _this3=this;this.$_ready&&(isVisible||0!==entry.boundingClientRect.width||0!==entry.boundingClientRect.height)&&(this.$emit("visible"),requestAnimationFrame((function(){_this3.updateVisibleItems(!1)})))},updateVisibleItems:function(checkItem){var scroll=this.getScroll(),buffer=parseInt(this.buffer);scroll.top-=buffer,scroll.bottom+=buffer;var itemHeight=this.itemHeight,typeField=this.typeField,keyField=this.keyField,items=this.items,count=items.length,heights=this.heights,views=this.$_views,unusedViews=this.$_unusedViews,pool=this.pool,startIndex=void 0,endIndex=void 0,totalHeight=void 0;if(count)if(null===itemHeight){var a=0,b=count-1,i=~~(count/2),oldI=void 0;do{oldI=i,heights[i].accumulator<scroll.top?a=i:i<count-1&&heights[i+1].accumulator>scroll.top&&(b=i),i=~~((a+b)/2)}while(i!==oldI);for(i<0&&(i=0),startIndex=i,totalHeight=heights[count-1].accumulator,endIndex=i;endIndex<count&&heights[endIndex].accumulator<scroll.bottom;endIndex++);-1===endIndex?endIndex=items.length-1:++endIndex>count&&(endIndex=count)}else(startIndex=~~(scroll.top/itemHeight))<0&&(startIndex=0),(endIndex=Math.ceil(scroll.bottom/itemHeight))>count&&(endIndex=count),totalHeight=count*itemHeight;else startIndex=endIndex=totalHeight=0;endIndex-startIndex>config.itemsLimit&&this.itemsLimitError(),this.totalHeight=totalHeight;var view=void 0,continuous=startIndex<=this.$_endIndex&&endIndex>=this.$_startIndex,unusedIndex=void 0;if(this.$_continuous!==continuous){if(continuous){views.clear(),unusedViews.clear();for(var _i=0,l=pool.length;_i<l;_i++)view=pool[_i],this.unuseView(view)}this.$_continuous=continuous}else if(continuous)for(var _i2=0,_l=pool.length;_i2<_l;_i2++)(view=pool[_i2]).nr.used&&(checkItem&&(view.nr.index=items.findIndex((function(item){return keyField?item[keyField]===view.item[keyField]:item===view.item}))),(-1===view.nr.index||view.nr.index<startIndex||view.nr.index>endIndex)&&this.unuseView(view));continuous||(unusedIndex=new Map);for(var item=void 0,type=void 0,unusedPool=void 0,v=void 0,_i3=startIndex;_i3<endIndex;_i3++){item=items[_i3];var key=keyField?item[keyField]:item;view=views.get(key),itemHeight||heights[_i3].height?(view?view.nr.used=!0:(type=item[typeField],continuous?(unusedPool=unusedViews.get(type))&&unusedPool.length?((view=unusedPool.pop()).item=item,view.nr.used=!0,view.nr.index=_i3,view.nr.key=key,view.nr.type=type):view=this.addView(pool,_i3,item,key,type):(unusedPool=unusedViews.get(type),v=unusedIndex.get(type)||0,unusedPool&&v<unusedPool.length?((view=unusedPool[v]).item=item,view.nr.used=!0,view.nr.index=_i3,view.nr.key=key,view.nr.type=type,unusedIndex.set(type,v+1)):(view=this.addView(pool,_i3,item,key,type),this.unuseView(view,!0)),v++),views.set(key,view)),view.top=null===itemHeight?heights[_i3-1].accumulator:_i3*itemHeight):view&&this.unuseView(view)}return this.$_startIndex=startIndex,this.$_endIndex=endIndex,this.emitUpdate&&this.$emit("update",startIndex,endIndex),{continuous:continuous}}}},__vue_script__$1=script$1,__vue_render__$1=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{directives:[{name:"observe-visibility",rawName:"v-observe-visibility",value:_vm.handleVisibilityChange,expression:"handleVisibilityChange"}],staticClass:"recycle-list",class:_vm.cssClass,on:{"&scroll":function($event){return _vm.handleScroll($event)}}},[_c("div",{ref:"wrapper",staticClass:"item-wrapper",style:{height:_vm.totalHeight+"px"}},_vm._l(_vm.pool,(function(view){return _c("div",{key:view.nr.id,staticClass:"item-view",style:{transform:"translateY("+view.top+"px)"}},[_vm._t("default",null,{item:view.item,index:view.nr.index,active:view.nr.used})],2)}))),_vm._v(" "),_vm._t("after-container"),_vm._v(" "),_c("resize-observer",{on:{notify:_vm.handleResize}})],2)};__vue_render__$1._withStripped=!0;function __vue_create_injector__$1(){var head=document.head||document.getElementsByTagName("head")[0],styles=__vue_create_injector__$1.styles||(__vue_create_injector__$1.styles={}),isOldIE="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(id,css){if(!document.querySelector('style[data-vue-ssr-id~="'+id+'"]')){var group=isOldIE?css.media||"default":id,style=styles[group]||(styles[group]={ids:[],parts:[],element:void 0});if(!style.ids.includes(id)){var code=css.source,index=style.ids.length;if(style.ids.push(id),isOldIE&&(style.element=style.element||document.querySelector("style[data-group="+group+"]")),!style.element){var el=style.element=document.createElement("style");el.type="text/css",css.media&&el.setAttribute("media",css.media),isOldIE&&(el.setAttribute("data-group",group),el.setAttribute("data-next-index","0")),head.appendChild(el)}if(isOldIE&&(index=parseInt(style.element.getAttribute("data-next-index")),style.element.setAttribute("data-next-index",index+1)),style.element.styleSheet)style.parts.push(code),style.element.styleSheet.cssText=style.parts.filter(Boolean).join("\n");else{var textNode=document.createTextNode(code),nodes=style.element.childNodes;nodes[index]&&style.element.removeChild(nodes[index]),nodes.length?style.element.insertBefore(textNode,nodes[index]):style.element.appendChild(textNode)}}}}}var RecycleList=function(template,style,script,scope,functional,moduleIdentifier,createInjector,createInjectorSSR){var component=("function"==typeof script?script.options:script)||{};component.__file="/home/akryum/Projets/vue-virtual-scroller/src/components/RecycleList.vue",component.render||(component.render=template.render,component.staticRenderFns=template.staticRenderFns,component._compiled=!0,functional&&(component.functional=!0)),component._scopeId=scope;var hook=void 0;if(style&&(hook=function(context){style.call(this,createInjector(context))}),void 0!==hook)if(component.functional){var originalRender=component.render;component.render=function(h,context){return hook.call(context),originalRender(h,context)}}else{var existing=component.beforeCreate;component.beforeCreate=existing?[].concat(existing,hook):[hook]}return component}({render:__vue_render__$1,staticRenderFns:[]},(function(inject){inject&&inject("data-v-0ff19954_0",{source:"\n.recycle-list[data-v-0ff19954]:not(.page-mode) {\n  overflow-y: auto;\n}\n.item-wrapper[data-v-0ff19954] {\n  box-sizing: border-box;\n  width: 100%;\n  overflow: hidden;\n  position: relative;\n}\n.item-view[data-v-0ff19954] {\n  width: 100%;\n  position: absolute;\n  top: 0;\n  left: 0;\n  will-change: transform;\n}\n",map:void 0,media:void 0})}),void 0===__vue_script__$1?{}:__vue_script__$1,"data-v-0ff19954",!1,0,__vue_create_injector__$1,"undefined"!=typeof __vue_create_injector_ssr__&&__vue_create_injector_ssr__);var plugin$2={version:"0.12.0",install:function(Vue,options){var finalOptions=Object.assign({},{installComponents:!0,componentsPrefix:""},options);for(var key in finalOptions)void 0!==finalOptions[key]&&(config[key]=finalOptions[key]);finalOptions.installComponents&&function(Vue,prefix){Vue.component(prefix+"virtual-scroller",VirtualScroller),Vue.component(prefix+"recycle-list",RecycleList)}(Vue,finalOptions.componentsPrefix)}},GlobalVue$2=null;"undefined"!=typeof window?GlobalVue$2=window.Vue:void 0!==__webpack_require__.g&&(GlobalVue$2=__webpack_require__.g.Vue),GlobalVue$2&&GlobalVue$2.use(plugin$2);__webpack_require__(965);var external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_namespaceObject=kolibriCoreAppGlobal.coreVue.mixins.commonCoreStrings,external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_namespaceObject),external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_namespaceObject=kolibriCoreAppGlobal.coreVue.mixins.responsiveWindowMixin,external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_CoreFullscreen_namespaceObject=kolibriCoreAppGlobal.coreVue.components.CoreFullscreen,external_kolibriCoreAppGlobal_coreVue_components_CoreFullscreen_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_CoreFullscreen_namespaceObject),external_kolibriCoreAppGlobal_lib_vue_namespaceObject=(__webpack_require__(393),kolibriCoreAppGlobal.lib.vue),external_kolibriCoreAppGlobal_lib_vue_default=__webpack_require__.n(external_kolibriCoreAppGlobal_lib_vue_namespaceObject);function event_utils_typeof(o){return event_utils_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},event_utils_typeof(o)}function event_utils_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,event_utils_toPropertyKey(descriptor.key),descriptor)}}function event_utils_toPropertyKey(t){var i=function(t,r){if("object"!=event_utils_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=event_utils_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==event_utils_typeof(i)?i:String(i)}var EventBus=function(){function EventBus(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,EventBus),this._eventDispatcher=new(external_kolibriCoreAppGlobal_lib_vue_default())}var Constructor,protoProps,staticProps;return Constructor=EventBus,protoProps=[{key:"emit",value:function(eventName){for(var _this$_eventDispatche,_len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];(_this$_eventDispatche=this._eventDispatcher).$emit.apply(_this$_eventDispatche,[eventName].concat(args))}},{key:"on",value:function(event,callback){this._eventDispatcher.$on(event,callback)}},{key:"once",value:function(event,callback){this._eventDispatcher.$once(event,callback)}},{key:"off",value:function(event,callback){this._eventDispatcher.$off(event,callback)}}],protoProps&&event_utils_defineProperties(Constructor.prototype,protoProps),staticProps&&event_utils_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),EventBus}(),PdfPagevue_type_template_id_3e85f96f_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",{ref:"pageContainer",staticClass:"pdf-page",style:{height:_vm.scaledHeight+"px",width:_vm.scaledWidth+"px",background:_vm.$themeTokens.surface},attrs:{id:"pdf-page-"+_vm.pageNum,role:"region","aria-label":_vm.$tr("numPage",{number:_vm.pageNum,total:_vm.totalPages})}},[_c("span",{staticClass:"loading",attrs:{"aria-hidden":"true"}},[_vm._v(_vm._s(_vm.$formatNumber(_vm.pageNum)))]),_c("canvas",{directives:[{name:"show",rawName:"v-show",value:_vm.rendered,expression:"rendered"}],ref:"canvas",staticClass:"canvas",attrs:{dir:"ltr",height:_vm.scaledHeight,width:_vm.scaledWidth}}),_c("div",{ref:"textLayer",staticClass:"text-layer",style:{height:_vm.scaledHeight+"px",width:_vm.scaledWidth+"px"}})])};PdfPagevue_type_template_id_3e85f96f_scoped_true_render._withStripped=!0;function text_layer_builder_typeof(o){return text_layer_builder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},text_layer_builder_typeof(o)}function text_layer_builder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,text_layer_builder_toPropertyKey(descriptor.key),descriptor)}}function text_layer_builder_toPropertyKey(t){var i=function(t,r){if("object"!=text_layer_builder_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=text_layer_builder_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==text_layer_builder_typeof(i)?i:String(i)}var logging=external_kolibriCoreAppGlobal_lib_logging_default().getLogger("kolibri/plugins/pdf_viewer/assets/src/utils/text_layer_builder.js"),TextLayerBuilder=function(){function TextLayerBuilder(_ref){var textLayerDiv=_ref.textLayerDiv,eventBus=_ref.eventBus,pageIndex=_ref.pageIndex,viewport=_ref.viewport,_ref$highlighter=_ref.highlighter,highlighter=void 0===_ref$highlighter?null:_ref$highlighter,_ref$enhanceTextSelec=_ref.enhanceTextSelection,enhanceTextSelection=void 0!==_ref$enhanceTextSelec&&_ref$enhanceTextSelec;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,TextLayerBuilder),this.textLayerDiv=textLayerDiv,this.eventBus=eventBus,this.textContent=null,this.textContentItemsStr=[],this.textContentStream=null,this.renderingDone=!1,this.pageNumber=pageIndex+1,this.viewport=viewport,this.textDivs=[],this.textLayerRenderTask=null,this.highlighter=highlighter,this.enhanceTextSelection=enhanceTextSelection,this._bindMouse()}var Constructor,protoProps,staticProps;return Constructor=TextLayerBuilder,protoProps=[{key:"_finishRendering",value:function(){if(this.renderingDone=!0,!this.enhanceTextSelection){var endOfContent=document.createElement("div");endOfContent.className="endOfContent",this.textLayerDiv.append(endOfContent)}this.eventBus&&this.eventBus.emit("textlayerrendered",{source:this,pageNumber:this.pageNumber,numTextDivs:this.textDivs.length})}},{key:"render",value:function(){var _this=this,timeout=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if((this.textContent||this.textContentStream)&&!this.renderingDone){this.cancel(),this.textDivs.length=0,this.highlighter&&this.highlighter.setTextMapping(this.textDivs,this.textContentItemsStr);var textLayerFrag=document.createDocumentFragment();this.textLayerRenderTask=(0,pdf.renderTextLayer)({textContent:this.textContent,textContentStream:this.textContentStream,container:textLayerFrag,viewport:this.viewport,textDivs:this.textDivs,textContentItemsStr:this.textContentItemsStr,timeout:timeout,enhanceTextSelection:this.enhanceTextSelection}),this.textLayerRenderTask.promise.then((function(){for(var childsToRemove=[],i=0;i<textLayerFrag.children.length;i++){var child=textLayerFrag.children[i];child.className.includes("markedContent")&&void 0!==child.id&&""===child.innerHTML&&childsToRemove.push(child)}for(var _i=0;_i<childsToRemove.length;_i++)textLayerFrag.removeChild(childsToRemove[_i]);_this.textLayerDiv.append(textLayerFrag),_this._finishRendering(),_this.highlighter&&_this.highlighter.enable()}),(function(err){logging.error("Error rendering text layer: ",err)}))}}},{key:"cancel",value:function(){this.textLayerRenderTask&&(this.textLayerRenderTask.cancel(),this.textLayerRenderTask=null,this.textLayerDiv.textContent=""),this.highlighter&&this.highlighter.disable()}},{key:"setTextContentStream",value:function(readableStream){this.cancel(),this.textContentStream=readableStream}},{key:"setTextContent",value:function(textContent){this.cancel(),this.textContent=textContent}},{key:"_bindMouse",value:function(){var _this2=this,div=this.textLayerDiv,expandDivsTimer=null;div.addEventListener("mousedown",(function(evt){if(_this2.enhanceTextSelection&&_this2.textLayerRenderTask)return _this2.textLayerRenderTask.expandTextDivs(!0),void(expandDivsTimer&&(clearTimeout(expandDivsTimer),expandDivsTimer=null));var end=div.querySelector(".endOfContent");if(end){if(evt.target!==div&&"none"!==window.getComputedStyle(end).getPropertyValue("-moz-user-select")){var divBounds=div.getBoundingClientRect(),r=Math.max(0,(evt.pageY-divBounds.top)/divBounds.height);end.style.top=(100*r).toFixed(2)+"%"}end.classList.add("active")}})),div.addEventListener("mouseup",(function(){if(_this2.enhanceTextSelection&&_this2.textLayerRenderTask)expandDivsTimer=setTimeout((function(){_this2.textLayerRenderTask&&_this2.textLayerRenderTask.expandTextDivs(!1),expandDivsTimer=null}),300);else{var end=div.querySelector(".endOfContent");end&&(end.style.top="",end.classList.remove("active"))}}))}}],protoProps&&text_layer_builder_defineProperties(Constructor.prototype,protoProps),staticProps&&text_layer_builder_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),TextLayerBuilder}(),text_layer_builder=TextLayerBuilder;function struct_tree_layer_builder_typeof(o){return struct_tree_layer_builder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},struct_tree_layer_builder_typeof(o)}function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function struct_tree_layer_builder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,struct_tree_layer_builder_toPropertyKey(descriptor.key),descriptor)}}function struct_tree_layer_builder_toPropertyKey(t){var i=function(t,r){if("object"!=struct_tree_layer_builder_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=struct_tree_layer_builder_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==struct_tree_layer_builder_typeof(i)?i:String(i)}var PDF_ROLE_TO_HTML_ROLE={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"img",Formula:null,Artifact:null},HEADING_PATTERN=/^H(\d+)$/,struct_tree_layer_builder=function(){function StructTreeLayerBuilder(textLayer){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,StructTreeLayerBuilder),this.textLayer=textLayer}var Constructor,protoProps,staticProps;return Constructor=StructTreeLayerBuilder,(protoProps=[{key:"render",value:function(structTree){for(var availableNodes=[],i=0;i<this.textLayer.children.length;i++){var node=this.textLayer.children[i];void 0!==node.id&&availableNodes.push(node.id)}return this.availableNodes=availableNodes,this._walk(structTree)}},{key:"_setAttributes",value:function(structElement,htmlElement){void 0!==structElement.alt&&htmlElement.setAttribute("aria-label",structElement.alt),void 0!==structElement.id&&htmlElement.setAttribute("aria-owns",structElement.id),void 0!==structElement.lang&&htmlElement.setAttribute("lang",structElement.lang)}},{key:"_isNodeNotAvailable",value:function(node){return void 0!==node.id&&node.id.startsWith("page")&&!this.availableNodes.includes(node.id)}},{key:"_walk",value:function(node){if(!node||this._isNodeNotAvailable(node))return null;var element=document.createElement("span");if("role"in node){var role=node.role,match=role.match(HEADING_PATTERN);match?(element.setAttribute("role","heading"),element.setAttribute("aria-level",match[1])):PDF_ROLE_TO_HTML_ROLE[role]&&element.setAttribute("role",PDF_ROLE_TO_HTML_ROLE[role])}if(this._setAttributes(node,element),node.children)if(1===node.children.length&&"id"in node.children[0])this._isNodeNotAvailable(node.children[0])||this._setAttributes(node.children[0],element);else{var _step,_iterator=_createForOfIteratorHelper(node.children);try{for(_iterator.s();!(_step=_iterator.n()).done;){var kid=_step.value,_node=this._walk(kid);_node&&element.appendChild(_node)}}catch(err){_iterator.e(err)}finally{_iterator.f()}}return""===element.innerHTML&&null==element.getAttribute("aria-owns")&&null==element.getAttribute("role")?null:element}}])&&struct_tree_layer_builder_defineProperties(Constructor.prototype,protoProps),staticProps&&struct_tree_layer_builder_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),StructTreeLayerBuilder}();function annotation_layer_builder_typeof(o){return annotation_layer_builder_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},annotation_layer_builder_typeof(o)}function _slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(arr,i)||function(o,minLen){if(!o)return;if("string"==typeof o)return annotation_layer_builder_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return annotation_layer_builder_arrayLikeToArray(o,minLen)}(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function annotation_layer_builder_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function annotation_layer_builder_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,annotation_layer_builder_toPropertyKey(descriptor.key),descriptor)}}function annotation_layer_builder_toPropertyKey(t){var i=function(t,r){if("object"!=annotation_layer_builder_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=annotation_layer_builder_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==annotation_layer_builder_typeof(i)?i:String(i)}var NullL10n={getLanguage:function(){return"en-us"},getDirection:function(){return"ltr"},get:function(key){var args=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,fallback=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(key,args){switch(key){case"find_match_count":key="find_match_count[".concat(1===args.total?"one":"other","]");break;case"find_match_count_limit":key="find_match_count_limit[".concat(1===args.limit?"one":"other","]")}return DEFAULT_L10N_STRINGS[key]||""}(key,args);return function(text,args){return args?text.replace(/\{\{\s*(\w+)\s*\}\}/g,(function(all,name){return name in args?args[name]:"{{"+name+"}}"})):text}(fallback,args)},translate:function(element){}},AnnotationLayerBuilder=function(){function AnnotationLayerBuilder(_ref){var pageDiv=_ref.pageDiv,pdfPage=_ref.pdfPage,linkService=_ref.linkService,downloadManager=_ref.downloadManager,_ref$annotationStorag=_ref.annotationStorage,annotationStorage=void 0===_ref$annotationStorag?null:_ref$annotationStorag,_ref$imageResourcesPa=_ref.imageResourcesPath,imageResourcesPath=void 0===_ref$imageResourcesPa?"":_ref$imageResourcesPa,_ref$renderForms=_ref.renderForms,renderForms=void 0===_ref$renderForms||_ref$renderForms,_ref$l10n=_ref.l10n,l10n=void 0===_ref$l10n?NullL10n:_ref$l10n,_ref$enableScripting=_ref.enableScripting,enableScripting=void 0!==_ref$enableScripting&&_ref$enableScripting,_ref$hasJSActionsProm=_ref.hasJSActionsPromise,hasJSActionsPromise=void 0===_ref$hasJSActionsProm?null:_ref$hasJSActionsProm,_ref$fieldObjectsProm=_ref.fieldObjectsPromise,fieldObjectsPromise=void 0===_ref$fieldObjectsProm?null:_ref$fieldObjectsProm,_ref$mouseState=_ref.mouseState,mouseState=void 0===_ref$mouseState?null:_ref$mouseState,_ref$annotationCanvas=_ref.annotationCanvasMap,annotationCanvasMap=void 0===_ref$annotationCanvas?null:_ref$annotationCanvas;!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,AnnotationLayerBuilder),this.pageDiv=pageDiv,this.pdfPage=pdfPage,this.linkService=linkService,this.downloadManager=downloadManager,this.imageResourcesPath=imageResourcesPath,this.renderForms=renderForms,this.l10n=l10n,this.annotationStorage=annotationStorage,this.enableScripting=enableScripting,this._hasJSActionsPromise=hasJSActionsPromise,this._fieldObjectsPromise=fieldObjectsPromise,this._mouseState=mouseState,this._annotationCanvasMap=annotationCanvasMap,this.div=null,this._cancelled=!1}var Constructor,protoProps,staticProps;return Constructor=AnnotationLayerBuilder,protoProps=[{key:"render",value:function(viewport){var _this=this,intent=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"display";Promise.all([this.pdfPage.getAnnotations({intent:intent}),this._hasJSActionsPromise,this._fieldObjectsPromise]).then((function(_ref2){var _ref3=_slicedToArray(_ref2,3),annotations=_ref3[0],hasJSActions=_ref3[1],fieldObjects=_ref3[2];if(!_this._cancelled&&0!==annotations.length){var parameters={viewport:viewport.clone({dontFlip:!0}),div:_this.div,annotations:annotations,page:_this.pdfPage,imageResourcesPath:_this.imageResourcesPath,renderForms:_this.renderForms,linkService:_this.linkService,downloadManager:_this.downloadManager,annotationStorage:_this.annotationStorage,enableScripting:_this.enableScripting,hasJSActions:hasJSActions,fieldObjects:fieldObjects,mouseState:_this._mouseState,annotationCanvasMap:_this._annotationCanvasMap};_this.div?pdf.AnnotationLayer.update(parameters):(_this.div=document.createElement("div"),_this.div.className="annotationLayer",_this.pageDiv.appendChild(_this.div),parameters.div=_this.div,pdf.AnnotationLayer.render(parameters),_this.l10n.translate(_this.div))}}))}},{key:"cancel",value:function(){this._cancelled=!0}},{key:"hide",value:function(){this.div&&(this.div.hidden=!0)}}],protoProps&&annotation_layer_builder_defineProperties(Constructor.prototype,protoProps),staticProps&&annotation_layer_builder_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),AnnotationLayerBuilder}();function pdf_link_service_typeof(o){return pdf_link_service_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},pdf_link_service_typeof(o)}function pdf_link_service_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,pdf_link_service_toPropertyKey(descriptor.key),descriptor)}}function pdf_link_service_toPropertyKey(t){var i=function(t,r){if("object"!=pdf_link_service_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=pdf_link_service_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==pdf_link_service_typeof(i)?i:String(i)}var LinkTarget_NONE=0,LinkTarget_SELF=1,LinkTarget_BLANK=2,LinkTarget_PARENT=3,LinkTarget_TOP=4,NullCharactersRegExp=/\x00/g,InvisibleCharactersRegExp=/[\x01-\x1F]/g;function _addLinkAttributes(link){var _ref=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},url=_ref.url,target=_ref.target,rel=_ref.rel,_ref$enabled=_ref.enabled,enabled=void 0===_ref$enabled||_ref$enabled;if(!url||"string"!=typeof url)throw new Error('A valid "url" parameter must provided.');var urlNullRemoved=function(str){var replaceInvisible=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return"string"!=typeof str?(console.error("The argument must be a string."),str):(replaceInvisible&&(str=str.replace(InvisibleCharactersRegExp," ")),str.replace(NullCharactersRegExp,""))}(url);enabled?link.href=link.title=urlNullRemoved:(link.href="",link.title="Disabled: ".concat(urlNullRemoved),link.onclick=function(){return!1});var targetStr="";switch(target){case LinkTarget_NONE:targetStr="_blank";break;case LinkTarget_SELF:targetStr="_self";break;case LinkTarget_BLANK:targetStr="_blank";break;case LinkTarget_PARENT:targetStr="_parent";break;case LinkTarget_TOP:targetStr="_top";break;default:targetStr="_blank"}link.target=targetStr,link.rel="string"==typeof rel?rel:"noopener noreferrer nofollow"}var SimpleLinkService=function(){function SimpleLinkService(){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,SimpleLinkService),this.externalLinkEnabled=!0}var Constructor,protoProps,staticProps;return Constructor=SimpleLinkService,(protoProps=[{key:"pagesCount",get:function(){return 0}},{key:"page",get:function(){return 0},set:function(value){}},{key:"rotation",get:function(){return 0},set:function(value){}},{key:"goToDestination",value:function(dest){}},{key:"goToPage",value:function(val){}},{key:"addLinkAttributes",value:function(link,url){_addLinkAttributes(link,{url:url,enabled:this.externalLinkEnabled})}},{key:"getDestinationHash",value:function(dest){return"#"}},{key:"getAnchorUrl",value:function(hash){return"#"}},{key:"setHash",value:function(hash){}},{key:"executeNamedAction",value:function(action){}},{key:"cachePageRef",value:function(pageNum,pageRef){}},{key:"isPageVisible",value:function(pageNumber){return!0}},{key:"isPageCached",value:function(pageNumber){return!0}}])&&pdf_link_service_defineProperties(Constructor.prototype,protoProps),staticProps&&pdf_link_service_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),SimpleLinkService}();function normalizeComponent(scriptExports,render,staticRenderFns,functionalTemplate,injectStyles,scopeId,moduleIdentifier,shadowMode){var hook,options="function"==typeof scriptExports?scriptExports.options:scriptExports;if(render&&(options.render=render,options.staticRenderFns=staticRenderFns,options._compiled=!0),functionalTemplate&&(options.functional=!0),scopeId&&(options._scopeId="data-v-"+scopeId),moduleIdentifier?(hook=function(context){(context=context||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(context=__VUE_SSR_CONTEXT__),injectStyles&&injectStyles.call(this,context),context&&context._registeredComponents&&context._registeredComponents.add(moduleIdentifier)},options._ssrRegister=hook):injectStyles&&(hook=shadowMode?function(){injectStyles.call(this,(options.functional?this.parent:this).$root.$options.shadowRoot)}:injectStyles),hook)if(options.functional){options._injectStyles=hook;var originalRender=options.render;options.render=function(h,context){return hook.call(context),originalRender(h,context)}}else{var existing=options.beforeCreate;options.beforeCreate=existing?[].concat(existing,hook):[hook]}return{exports:scriptExports,options:options}}var PdfPage=normalizeComponent({name:"PdfPage",props:{pageNum:{type:Number,required:!0},totalPages:{type:Number,required:!0},pdfPage:{type:[Object,Promise],default:null},pageReady:{type:Boolean,required:!0},scale:{type:Number,required:!0},firstPageHeight:{type:Number,required:!0},firstPageWidth:{type:Number,required:!0},eventBus:{type:Object,required:!0}},data:function(){return{rendered:!1}},computed:{scaledHeight:function(){return this.pdfPage?this.getViewport().height:this.firstPageHeight*this.scale},scaledWidth:function(){return this.pdfPage?this.getViewport().width:this.firstPageWidth*this.scale}},watch:{scale:function(newVal,oldVal){this.renderPage(newVal,oldVal)},pdfPage:function(newVal,oldVal){this.renderPage(newVal,oldVal)},pageReady:function(newVal,oldVal){this.renderPage(newVal,oldVal)}},mounted:function(){this.renderPage()},methods:{getViewport:function(){return this.pdfPage.getViewport({scale:this.scale||1})},renderPage:function(newVal,oldVal){var _this=this;if("number"==typeof newVal&&"number"==typeof oldVal&&newVal!==oldVal&&this.cancelRender(),this.pdfPage&&this.pageReady&&!this.renderTask&&!this.rendered){this.createTextLayerBuilder(),this.createStructTreeLayerBuilder(),this.createAnnotationLayerBuilder();var canvasContext=this.$refs.canvas.getContext("2d"),viewport=this.getViewport();this.renderTask=this.pdfPage.render({canvasContext:canvasContext,viewport:viewport,annotationMode:pdf.AnnotationMode.ENABLE_FORMS,annotationCanvasMap:this.annotationCanvasMap}),this.renderTask.promise.then((function(){if(delete _this.renderTask,_this.textLayer){var readableStream=_this.pdfPage.streamTextContent({includeMarkedContent:!0});_this.textLayer.setTextContentStream(readableStream),_this.textLayer.render()}_this.annotationLayer&&_this.annotationLayer.render(viewport,"display"),_this.rendered=!0,_this.eventBus.emit("pageRendered",{pageNumber:_this.pageNum})}),(function(){delete _this.renderTask,_this.rendered=!1})),this.eventBus.on("textlayerrendered",this.onTextLayerRendered)}else this.pdfPage||(this.cancelRender(),this.clearPage())},cancelRender:function(){this.textLayer&&(this.textLayer.cancel(),this.textLayer=null),this.renderTask&&this.renderTask.cancel(),this.eventBus.off("textlayerrendered",this.onTextLayerRendered),delete this.renderTask,this.rendered=!1},clearPage:function(){this.$refs.canvas.getContext("2d").clearRect(0,0,this.scaledHeight,this.scaledWidth),this.rendered=!1},createTextLayerBuilder:function(){this.textLayer=new text_layer_builder({textLayerDiv:this.$refs.textLayer,viewport:this.getViewport(),pageIndex:this.pageNum-1,enhanceTextSelection:!0,eventBus:this.eventBus})},createStructTreeLayerBuilder:function(){this.structTreeLayer=new struct_tree_layer_builder(this.$refs.textLayer)},createAnnotationLayerBuilder:function(){this.annotationLayer||(this.annotationCanvasMap=new Map,this.annotationLayer=new AnnotationLayerBuilder({pageDiv:this.$refs.pageContainer,pdfPage:this.pdfPage,annotationCanvasMap:this.annotationCanvasMap,linkService:new SimpleLinkService}))},onTextLayerRendered:function(event){var _this2=this;event.pageNumber===this.pageNum&&(this.eventBus.off("textlayerrendered",this.onTextLayerRendered),this.$refs.canvas&&this.pdfPage.getStructTree().then((function(tree){if(tree&&_this2.$refs.canvas){var treeDom=_this2.structTreeLayer.render(tree);treeDom.classList.add("structTree"),_this2.$refs.canvas.appendChild(treeDom)}})))}},$trs:{numPage:"Page {number} of {total}"}},PdfPagevue_type_template_id_3e85f96f_scoped_true_render,[],!1,null,"3e85f96f",null).exports,SideBarvue_type_template_id_3b97f594_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("aside",{staticClass:"pdf-sidebar",style:{background:_vm.$themeTokens.surface}},[_c("nav",[_vm.tabs.filter((function(t){return!t.disabled})).length>1?_c("div",{style:{display:"flex"}},_vm._l(_vm.tabs,(function(tab){return _c("div",{key:tab.name,ref:tab.name,refInFor:!0,style:{background:_vm.selectedTab===tab.name?_vm.$themeTokens.annotation:_vm.$themeTokens.transparent,cursor:"pointer",borderRadius:"2px",opacity:tab.disabled?.5:1,pointerEvents:tab.disabled?"none":"auto",height:"48px",display:"flex",alignItems:"center",justifyContent:"center",width:"100%"}},[_c("div",{staticClass:"tab",attrs:{tabindex:tab.disabled?-1:0,"aria-label":tab.label,role:"button"},on:{click:function($event){return _vm.selectTab(tab.name)},keydown:[function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.selectTab(tab.name)},function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"space",32,$event.key,[" ","Spacebar"])?null:_vm.selectTab(tab.name)}]}},[_c("KIcon",{style:{fill:_vm.selectedTab===tab.name?_vm.$themeTokens.textInverted:_vm.$themeTokens.text,height:"24px",width:"24px"},attrs:{icon:tab.icon}}),_c("KTooltip",{attrs:{reference:tab.name,refs:_vm.$refs}},[_vm._v("\n            "+_vm._s(tab.label)+"\n          ")])],1)])})),0):_vm._e(),_c("div",{staticClass:"sidebar-content"},["bookmarks"===_vm.selectedTab?[_c("Bookmarks",{attrs:{outline:_vm.outline,goToDestination:_vm.goToDestination,focusDestPage:_vm.focusDestPage}})]:_vm._e(),"preview"===_vm.selectedTab?[_c("span")]:_vm._e(),"annotations"===_vm.selectedTab?[_c("span")]:_vm._e()],2)])])};SideBarvue_type_template_id_3b97f594_scoped_true_render._withStripped=!0;var Bookmarksvue_type_template_id_c40b1210_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("ul",{staticClass:"bookmarks-wrapper",attrs:{"aria-label":_vm.$tr("bookmarksSection")}},_vm._l(_vm.outline,(function(item,index){return _c("BookmarkItem",{key:index,attrs:{item:item,goToDestination:_vm.goToDestination,focusDestPage:_vm.focusDestPage}})})),1)};Bookmarksvue_type_template_id_c40b1210_scoped_true_render._withStripped=!0;var BookmarkItemvue_type_template_id_0875d373_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("li",{staticClass:"bookmark-item"},[_c("div",{staticClass:"bookmark-item-title-container"},[_vm.item.items&&_vm.item.items.length>0?_c("span",{staticClass:"dropdown-icon-container",attrs:{tabindex:"0",role:"button","aria-label":_vm.$tr("expand"),"aria-controls":"pdf-container"},on:{click:_vm.toggleExpanded,keydown:[function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.toggleExpanded.apply(null,arguments)},function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"space",32,$event.key,[" ","Spacebar"])?null:_vm.toggleExpanded.apply(null,arguments)}]}},[_c("KIcon",{staticClass:"dropdown-icon",class:{expanded:_vm.expanded},attrs:{icon:"chevronRight"}})],1):_vm._e(),_c("span",{staticClass:"bookmark-item-title",attrs:{tabindex:"0",role:"button"},on:{click:function($event){return _vm.goToDestination(_vm.item.dest)},keydown:[function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:$event.shiftKey?_vm.focusDestPage(_vm.item.dest,$event):null},function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")||$event.ctrlKey||$event.shiftKey||$event.altKey||$event.metaKey?null:_vm.goToDestination(_vm.item.dest)},function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"space",32,$event.key,[" ","Spacebar"])?null:_vm.goToDestination(_vm.item.dest)}]}},[_vm._v("\n      "+_vm._s(_vm.item.title)+"\n    ")])]),_vm.expanded?_c("ul",{staticClass:"bookmark-children"},_vm._l(_vm.item.items,(function(child,index){return _c("BookmarkItem",{key:index,attrs:{item:child,goToDestination:_vm.goToDestination,focusDestPage:_vm.focusDestPage}})})),1):_vm._e()])};BookmarkItemvue_type_template_id_0875d373_scoped_true_render._withStripped=!0;var BookmarkItem_component=normalizeComponent({name:"BookmarkItem",props:{item:{type:Object,required:!0},goToDestination:{type:Function,required:!0},focusDestPage:{type:Function,required:!0}},data:function(){return{expanded:!1}},methods:{toggleExpanded:function(){this.expanded=!this.expanded}},$trs:{expand:"Expand bookmark"}},BookmarkItemvue_type_template_id_0875d373_scoped_true_render,[],!1,null,"0875d373",null),Bookmarks_component=normalizeComponent({name:"Bookmarks",components:{BookmarkItem:BookmarkItem_component.exports},props:{outline:{type:Array,required:!0},goToDestination:{type:Function,required:!0},focusDestPage:{type:Function,required:!0}},$trs:{bookmarksSection:"Bookmarks section. You can switch between the pdf document and bookmarks section pressing shift + enter."}},Bookmarksvue_type_template_id_c40b1210_scoped_true_render,[],!1,null,"c40b1210",null),SideBar=normalizeComponent({name:"SideBar",components:{Bookmarks:Bookmarks_component.exports},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default()],props:{outline:{type:Array,required:!0},goToDestination:{type:Function,required:!0},focusDestPage:{type:Function,required:!0}},data:function(){return{selectedTab:"bookmarks",tabs:[{name:"bookmarks",label:this.coreString("bookmarksLabel"),icon:"list",disabled:!1},{name:"preview",label:"",icon:"channel",disabled:!0},{name:"annotations",label:"",icon:"edit",disabled:!0}]}},watch:{outline:function(){this.tabs[0].disabled=!this.outline||!this.outline.length,this.selectedTab=this.outline&&this.outline.length?"bookmarks":"preview"}},methods:{selectTab:function(tabName){this.selectedTab=tabName}}},SideBarvue_type_template_id_3b97f594_scoped_true_render,[],!1,null,"3b97f594",null).exports;function PdfRendererIndexvue_type_script_lang_js_typeof(o){return PdfRendererIndexvue_type_script_lang_js_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},PdfRendererIndexvue_type_script_lang_js_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function _defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=PdfRendererIndexvue_type_script_lang_js_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=PdfRendererIndexvue_type_script_lang_js_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==PdfRendererIndexvue_type_script_lang_js_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var PdfRendererIndexvue_type_script_lang_js_logging=external_kolibriCoreAppGlobal_lib_logging_default().getLogger("kolibri/plugins/pdf_viewer/assets/src/views/PdfRendererIndex.vue?vue&type=script&lang=js"),PdfRendererIndex=normalizeComponent({name:"PdfRendererIndex",components:{SideBar:SideBar,PdfPage:PdfPage,RecycleList:RecycleList,CoreFullscreen:external_kolibriCoreAppGlobal_coreVue_components_CoreFullscreen_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_default(),external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default()],data:function(){return{progress:null,scale:null,timeout:null,totalPages:null,firstPageHeight:null,firstPageWidth:null,pdfPages:[],recycleListIsMounted:!1,isInFullscreen:!1,currentLocation:0,updateContentStateInterval:null,showControls:!0,showSideBar:!1,visitedPages:{},eventBus:null,outline:null}},computed:{iOS:function(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)},documentLoading:function(){return this.progress<1},itemHeight:function(){return this.firstPageHeight*this.scale+16},savedLocation:function(){return this.extraFields&&this.extraFields.contentState?this.extraFields.contentState.savedLocation:0},savedVisitedPages:{get:function(){return this.extraFields&&this.extraFields.contentState&&this.extraFields.contentState.savedVisitedPages||{}},set:function(value){this.visitedPages=value}},fullscreenText:function(){return this.isInFullscreen?this.$tr("exitFullscreen"):this.$tr("enterFullscreen")},defaultDuration:function(){return 30*this.totalPages},debouncedShowVisiblePages:function(){return debounce_default()(this.showVisiblePages,300)},screenSizeMultiplier:function(){return this.windowIsLarge?1.25:this.windowIsSmall?1:1.125}},watch:{recycleListIsMounted:function(newVal){if(!0===newVal&&!this.iOS){var hammer=hammer_default()(this.$refs.recycleList.$el);hammer.get("pinch").set({enable:!0}),hammer.on("pinchin",throttle_default()(this.zoomOut,1e3)),hammer.on("pinchout",throttle_default()(this.zoomIn,1e3))}},scale:function(newScale,oldScale){var _this=this;newScale===oldScale||null===oldScale||this.$nextTick((function(){_this.forceUpdateRecycleList()}))},showSideBar:function(){var _this2=this;this.$nextTick((function(){if(_this2.$refs.pdfContainer&&_this2.$refs.pdfContainer.$el){var containerWidth=_this2.$refs.pdfContainer.$el.clientWidth;_this2.scale=containerWidth/(_this2.firstPageWidth*_this2.screenSizeMultiplier)}}))}},beforeCreate:function(){pdf.GlobalWorkerOptions.workerSrc=__webpack_require__.p+"pdfJSWorker-".concat("0.16.0",".js")},created:function(){var _this3=this;this.worker=new pdf.PDFWorker,this.worker.promise.catch((function(error){_this3.reportLoadingError(error.toString?error.toString():error.message)})),this.currentLocation=this.savedLocation;var loadingPdf=pdf.getDocument({url:this.defaultFile.storage_url,worker:this.worker});loadingPdf.onProgress=function(loadingProgress){_this3.progress=loadingProgress.loaded/loadingProgress.total},this.eventBus=new EventBus,this.prepComponentData=loadingPdf.promise.then((function(pdfDocument){_this3.pdfDocument=pdfDocument,_this3.totalPages=_this3.pdfDocument.numPages;for(var i=0;i<_this3.totalPages;i++)_this3.pdfPages.push({page:null,resolved:!1,index:i});var firstPageToRender=parseInt(_this3.getSavedPosition()*_this3.totalPages);return _this3.getPage(firstPageToRender+1).then((function(firstPage){var viewPort=firstPage.getViewport({scale:1});_this3.firstPageHeight=viewPort.height,_this3.firstPageWidth=viewPort.width,_this3.scale=_this3.$el.clientWidth/(_this3.firstPageWidth*_this3.screenSizeMultiplier),_this3.pdfPages.splice(firstPageToRender,1,_objectSpread(_objectSpread({},_this3.pdfPages[firstPageToRender]),{},{page:firstPage,resolved:!0})),pdfDocument.getOutline().then((function(outline){_this3.outline=outline,_this3.showSideBar=outline&&outline.length>0&&_this3.windowIsLarge,_this3.scale=_this3.showSideBar?.75*_this3.scale:_this3.scale}))}))})).catch((function(error){return _this3.reportLoadingError(error),Promise.reject(error)}))},mounted:function(){var _this4=this;this.prepComponentData.then((function(){isNaN(_this4.progress)&&(_this4.progress=1),_this4.$emit("startTracking"),_this4.updateContentStateInterval=setInterval(_this4.updateProgress,3e4),_this4.storeVisitedPage(1)})).catch((function(){}))},beforeDestroy:function(){this.updateProgress(),this.updateContentState(),this.timeout&&clearTimeout(this.timeout),this.pdfDocument&&(this.pdfDocument.cleanup(),this.pdfDocument.destroy()),this.$emit("stopTracking"),clearInterval(this.updateContentStateInterval)},methods:{getPage:function(pageNum){return this.pdfDocument.getPage(pageNum)},showPage:function(pageNum){var _this5=this;if(pageNum>0&&pageNum<=this.totalPages&&!this.pdfPages[pageNum-1].resolved){var pageIndex=pageNum-1;this.getPage(pageNum).then((function(pdfPage){_this5.pdfPages.splice(pageIndex,1,_objectSpread(_objectSpread({},_this5.pdfPages[pageIndex]),{},{page:pdfPage,resolved:!0}))}))}},storeVisitedPage:function(currentPageNum){var visited=this.savedVisitedPages;visited[currentPageNum]=!0,this.savedVisitedPages=visited},handleUpdate:function(start,end){if(this.$refs.recycleList&&this.$refs.recycleList.$el){if(!this.recycleListIsMounted)return this.recycleListIsMounted=!0,this.recycleListHeight=this.calculateRecycleListHeight(),void this.scrollTo(this.getSavedPosition());var currentRecycleListHeight=this.calculateRecycleListHeight();if(this.recycleListHeight!==currentRecycleListHeight)this.recycleListHeight=currentRecycleListHeight,this.scrollTo(this.getSavedPosition());else{this.savePosition(this.calculatePosition());var currentPage=parseInt(this.currentLocation*this.totalPages)+1;currentPage===this.totalPages-1&&this.scrolledToEnd()&&this.storeVisitedPage(currentPage+1),this.storeVisitedPage(currentPage),this.updateProgress(),this.updateContentState(),this.scrolledToEnd()&&this.$emit("finished")}this.debouncedShowVisiblePages(start,end)}},showVisiblePages:function(start,end){for(var startIndex=Math.floor(start)+1,endIndex=Math.ceil(end)+1,i=startIndex;i<=endIndex;i++)this.showPage(i)},zoomIn:function(){this.setScale(Math.min(5,this.scale+.25))},zoomOut:function(){this.setScale(Math.max(.125,this.scale-.25))},setScale:throttle_default()((function(scaleValue){this.scale=scaleValue}),500),toggleSideBar:function(){this.showSideBar=!this.showSideBar},calculatePosition:function(){return this.$refs.recycleList.$el.scrollTop/this.$refs.recycleList.$el.scrollHeight},scrolledToEnd:function(){return this.$refs.recycleList.$el.scrollTop+this.$refs.recycleList.$el.clientHeight===this.$refs.recycleList.$el.scrollHeight},savePosition:function(val){this.currentLocation=val},getSavedPosition:function(){return this.currentLocation},scrollTo:function(relativePosition){this.$refs.recycleList.$el.scrollTop=this.$refs.recycleList.$el.scrollHeight*relativePosition},calculateRecycleListHeight:function(){return this.$refs.recycleList.$el.scrollHeight},forceUpdateRecycleList:function(){this.$refs.recycleList&&this.$refs.recycleList.updateVisibleItems(!1)},updateProgress:function(){this.forceDurationBasedProgress?this.$emit("updateProgress",this.durationBasedProgress):this.$emit("updateProgress",Object.keys(this.savedVisitedPages).length/this.totalPages)},updateContentState:function(){var contentState;contentState=this.extraFields?_objectSpread(_objectSpread({},this.extraFields.contentState),{},{savedLocation:this.currentLocation||this.savedLocation,savedVisitedPages:this.visitedPages||this.savedVisitedPages}):{savedLocation:this.currentLocation||this.savedLocation,savedVisitedPages:this.visitedPages||this.savedVisitedPages},this.$emit("updateContentState",contentState)},goToDestination:function(dest){var _this6=this;this.pdfDocument&&Promise.resolve("string"===dest?this.pdfDocument.getDestination(dest):dest).then((function(explicitDest){Array.isArray(explicitDest)?_this6.getDestinationPageNumber(explicitDest).then((function(pageNumber){if(!pageNumber||pageNumber<1||pageNumber>_this6.pagesCount)PdfRendererIndexvue_type_script_lang_js_logging.error("Invalid destination page");else{var position=(pageNumber-1)/_this6.totalPages;if("XYZ"===explicitDest[1].name)position+=(_this6.firstPageHeight-explicitDest[3])/_this6.firstPageHeight*(1/_this6.totalPages);_this6.scrollTo(position),_this6.windowIsSmall&&(_this6.showSideBar=!1)}})):PdfRendererIndexvue_type_script_lang_js_logging.error("Error getting destination")}))},focusDestPage:function(dest,event){var _this7=this;this.pdfDocument&&Promise.resolve("string"===dest?this.pdfDocument.getDestination(dest):dest).then((function(explicitDest){Array.isArray(explicitDest)?_this7.getDestinationPageNumber(explicitDest).then((function(pageNumber){if(!pageNumber||pageNumber<1||pageNumber>_this7.pagesCount)PdfRendererIndexvue_type_script_lang_js_logging.error("Invalid destination page");else{if(!_this7.focusPage(pageNumber,event.target)){var position=(pageNumber-1)/_this7.totalPages;_this7.scrollTo(position);_this7.eventBus.on("pageRendered",(function onPageRendered(e){e.pageNumber===pageNumber&&(_this7.focusPage(pageNumber,event.target),_this7.eventBus.off("pageRendered",onPageRendered))}))}_this7.windowIsSmall&&(_this7.showSideBar=!1)}})):PdfRendererIndexvue_type_script_lang_js_logging.error("Error getting destination")}))},focusPage:function(pageNumber,bookmark){var page=document.querySelector("#pdf-page-"+pageNumber);if(page){page.setAttribute("tabindex",0),page.focus({preventScroll:!0});var backToBookmark=function backToBookmark(e){"Enter"===e.key&&e.shiftKey&&(page.removeAttribute("tabindex"),window.removeEventListener("keydown",backToBookmark),bookmark.focus())};return setTimeout((function(){window.addEventListener("keydown",backToBookmark)}),0),!0}return!1},getDestinationPageNumber:function(explicitDest){var _this8=this;return new Promise((function(resolve){var destRef=explicitDest[0];return"object"===PdfRendererIndexvue_type_script_lang_js_typeof(destRef)&&null!==destRef?_this8.pdfDocument.getPageIndex(destRef).then((function(pageIndex){resolve(pageIndex+1)})).catch((function(e){PdfRendererIndexvue_type_script_lang_js_logging.error("Error getting destination page number",e),resolve()})):Number.isInteger(destRef)?resolve(destRef+1):(PdfRendererIndexvue_type_script_lang_js_logging.error("Invalid destination reference"),void resolve())}))}},$trs:{exitFullscreen:{message:"Exit fullscreen",context:"Learners can use the Esc key or the 'exit fullscreen' button to close the fullscreen view on the PDF Viewer."},enterFullscreen:{message:"Enter fullscreen",context:"Learners can use the full screen button in the upper right corner to open a PDF in fullscreen view."}}},render,[],!1,null,"4ae59970",null).exports;function module_typeof(o){return module_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},module_typeof(o)}function module_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,module_toPropertyKey(descriptor.key),descriptor)}}function module_toPropertyKey(t){var i=function(t,r){if("object"!=module_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=module_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==module_typeof(i)?i:String(i)}function module_callSuper(_this,derived,args){return derived=module_getPrototypeOf(derived),function(self,call){if(call&&("object"===module_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(_this,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(derived,args||[],module_getPrototypeOf(_this).constructor):derived.apply(_this,args))}function module_getPrototypeOf(o){return module_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},module_getPrototypeOf(o)}function module_setPrototypeOf(o,p){return module_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},module_setPrototypeOf(o,p)}var DocumentPDFModule=function(_ContentRendererModul){function DocumentPDFModule(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,DocumentPDFModule),module_callSuper(this,DocumentPDFModule,arguments)}var Constructor,protoProps,staticProps;return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&module_setPrototypeOf(subClass,superClass)}(DocumentPDFModule,_ContentRendererModul),Constructor=DocumentPDFModule,(protoProps=[{key:"rendererComponent",get:function(){return PdfRendererIndex}}])&&module_defineProperties(Constructor.prototype,protoProps),staticProps&&module_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),DocumentPDFModule}(ContentRenderer);new DocumentPDFModule}()})();
//# sourceMappingURL=kolibri.plugins.pdf_viewer.main-0.16.0.js.map