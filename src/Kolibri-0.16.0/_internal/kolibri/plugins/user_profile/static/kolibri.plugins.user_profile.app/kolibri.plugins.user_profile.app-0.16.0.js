/*! For license information please see kolibri.plugins.user_profile.app-0.16.0.js.LICENSE.txt */
!function(){var __webpack_modules__={8669:function(module,__unused_webpack_exports,__webpack_require__){var DataView=__webpack_require__(3141)(__webpack_require__(8864),"DataView");module.exports=DataView},9313:function(module,__unused_webpack_exports,__webpack_require__){var hashClear=__webpack_require__(8679),hashDelete=__webpack_require__(4262),hashGet=__webpack_require__(6924),hashHas=__webpack_require__(1514),hashSet=__webpack_require__(4378);function Hash(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet,module.exports=Hash},8717:function(module,__unused_webpack_exports,__webpack_require__){var listCacheClear=__webpack_require__(905),listCacheDelete=__webpack_require__(8345),listCacheGet=__webpack_require__(2103),listCacheHas=__webpack_require__(8239),listCacheSet=__webpack_require__(2812);function ListCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet,module.exports=ListCache},8637:function(module,__unused_webpack_exports,__webpack_require__){var Map=__webpack_require__(3141)(__webpack_require__(8864),"Map");module.exports=Map},7738:function(module,__unused_webpack_exports,__webpack_require__){var mapCacheClear=__webpack_require__(5733),mapCacheDelete=__webpack_require__(8275),mapCacheGet=__webpack_require__(9821),mapCacheHas=__webpack_require__(6885),mapCacheSet=__webpack_require__(9725);function MapCache(entries){var index=-1,length=null==entries?0:entries.length;for(this.clear();++index<length;){var entry=entries[index];this.set(entry[0],entry[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet,module.exports=MapCache},4813:function(module,__unused_webpack_exports,__webpack_require__){var Promise=__webpack_require__(3141)(__webpack_require__(8864),"Promise");module.exports=Promise},4644:function(module,__unused_webpack_exports,__webpack_require__){var Set=__webpack_require__(3141)(__webpack_require__(8864),"Set");module.exports=Set},7347:function(module,__unused_webpack_exports,__webpack_require__){var MapCache=__webpack_require__(7738),setCacheAdd=__webpack_require__(8397),setCacheHas=__webpack_require__(1470);function SetCache(values){var index=-1,length=null==values?0:values.length;for(this.__data__=new MapCache;++index<length;)this.add(values[index])}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas,module.exports=SetCache},342:function(module,__unused_webpack_exports,__webpack_require__){var ListCache=__webpack_require__(8717),stackClear=__webpack_require__(9931),stackDelete=__webpack_require__(6498),stackGet=__webpack_require__(4734),stackHas=__webpack_require__(4685),stackSet=__webpack_require__(2492);function Stack(entries){var data=this.__data__=new ListCache(entries);this.size=data.size}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet,module.exports=Stack},3789:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(8864).Symbol;module.exports=_Symbol},45:function(module,__unused_webpack_exports,__webpack_require__){var Uint8Array=__webpack_require__(8864).Uint8Array;module.exports=Uint8Array},5783:function(module,__unused_webpack_exports,__webpack_require__){var WeakMap=__webpack_require__(3141)(__webpack_require__(8864),"WeakMap");module.exports=WeakMap},7303:function(module){module.exports=function(array,iteratee){for(var index=-1,length=null==array?0:array.length;++index<length&&!1!==iteratee(array[index],index,array););return array}},6703:function(module){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}},2310:function(module){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length,resIndex=0,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[resIndex++]=value)}return result}},1032:function(module,__unused_webpack_exports,__webpack_require__){var baseTimes=__webpack_require__(968),isArguments=__webpack_require__(5210),isArray=__webpack_require__(6677),isBuffer=__webpack_require__(8910),isIndex=__webpack_require__(8174),isTypedArray=__webpack_require__(4447),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(value,inherited){var isArr=isArray(value),isArg=!isArr&&isArguments(value),isBuff=!isArr&&!isArg&&isBuffer(value),isType=!isArr&&!isArg&&!isBuff&&isTypedArray(value),skipIndexes=isArr||isArg||isBuff||isType,result=skipIndexes?baseTimes(value.length,String):[],length=result.length;for(var key in value)!inherited&&!hasOwnProperty.call(value,key)||skipIndexes&&("length"==key||isBuff&&("offset"==key||"parent"==key)||isType&&("buffer"==key||"byteLength"==key||"byteOffset"==key)||isIndex(key,length))||result.push(key);return result}},354:function(module){module.exports=function(array,iteratee){for(var index=-1,length=null==array?0:array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}},8179:function(module){module.exports=function(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}},556:function(module){module.exports=function(array,predicate){for(var index=-1,length=null==array?0:array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}},2290:function(module,__unused_webpack_exports,__webpack_require__){var baseAssignValue=__webpack_require__(934),eq=__webpack_require__(2805),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,key,value){var objValue=object[key];hasOwnProperty.call(object,key)&&eq(objValue,value)&&(void 0!==value||key in object)||baseAssignValue(object,key,value)}},6511:function(module,__unused_webpack_exports,__webpack_require__){var eq=__webpack_require__(2805);module.exports=function(array,key){for(var length=array.length;length--;)if(eq(array[length][0],key))return length;return-1}},934:function(module,__unused_webpack_exports,__webpack_require__){var defineProperty=__webpack_require__(7775);module.exports=function(object,key,value){"__proto__"==key&&defineProperty?defineProperty(object,key,{configurable:!0,enumerable:!0,value:value,writable:!0}):object[key]=value}},120:function(module,__unused_webpack_exports,__webpack_require__){var baseForOwn=__webpack_require__(3082),baseEach=__webpack_require__(733)(baseForOwn);module.exports=baseEach},2831:function(module,__unused_webpack_exports,__webpack_require__){var baseEach=__webpack_require__(120);module.exports=function(collection,predicate){var result=!0;return baseEach(collection,(function(value,index,collection){return result=!!predicate(value,index,collection)})),result}},3616:function(module){module.exports=function(array,predicate,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?1:-1);fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}},3670:function(module,__unused_webpack_exports,__webpack_require__){var baseFor=__webpack_require__(6088)();module.exports=baseFor},3082:function(module,__unused_webpack_exports,__webpack_require__){var baseFor=__webpack_require__(3670),keys=__webpack_require__(5738);module.exports=function(object,iteratee){return object&&baseFor(object,iteratee,keys)}},3611:function(module,__unused_webpack_exports,__webpack_require__){var castPath=__webpack_require__(2066),toKey=__webpack_require__(3110);module.exports=function(object,path){for(var index=0,length=(path=castPath(path,object)).length;null!=object&&index<length;)object=object[toKey(path[index++])];return index&&index==length?object:void 0}},3634:function(module,__unused_webpack_exports,__webpack_require__){var arrayPush=__webpack_require__(8179),isArray=__webpack_require__(6677);module.exports=function(object,keysFunc,symbolsFunc){var result=keysFunc(object);return isArray(object)?result:arrayPush(result,symbolsFunc(object))}},5385:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(3789),getRawTag=__webpack_require__(3540),objectToString=__webpack_require__(9937),symToStringTag=_Symbol?_Symbol.toStringTag:void 0;module.exports=function(value){return null==value?void 0===value?"[object Undefined]":"[object Null]":symToStringTag&&symToStringTag in Object(value)?getRawTag(value):objectToString(value)}},1992:function(module){module.exports=function(object,key){return null!=object&&key in Object(object)}},1139:function(module,__unused_webpack_exports,__webpack_require__){var baseGetTag=__webpack_require__(5385),isObjectLike=__webpack_require__(5044);module.exports=function(value){return isObjectLike(value)&&"[object Arguments]"==baseGetTag(value)}},4830:function(module,__unused_webpack_exports,__webpack_require__){var baseIsEqualDeep=__webpack_require__(6831),isObjectLike=__webpack_require__(5044);module.exports=function baseIsEqual(value,other,bitmask,customizer,stack){return value===other||(null==value||null==other||!isObjectLike(value)&&!isObjectLike(other)?value!=value&&other!=other:baseIsEqualDeep(value,other,bitmask,customizer,baseIsEqual,stack))}},6831:function(module,__unused_webpack_exports,__webpack_require__){var Stack=__webpack_require__(342),equalArrays=__webpack_require__(6045),equalByTag=__webpack_require__(4709),equalObjects=__webpack_require__(5404),getTag=__webpack_require__(7258),isArray=__webpack_require__(6677),isBuffer=__webpack_require__(8910),isTypedArray=__webpack_require__(4447),objectTag="[object Object]",hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=objIsArr?"[object Array]":getTag(object),othTag=othIsArr?"[object Array]":getTag(other),objIsObj=(objTag="[object Arguments]"==objTag?objectTag:objTag)==objectTag,othIsObj=(othTag="[object Arguments]"==othTag?objectTag:othTag)==objectTag,isSameTag=objTag==othTag;if(isSameTag&&isBuffer(object)){if(!isBuffer(other))return!1;objIsArr=!0,objIsObj=!1}if(isSameTag&&!objIsObj)return stack||(stack=new Stack),objIsArr||isTypedArray(object)?equalArrays(object,other,bitmask,customizer,equalFunc,stack):equalByTag(object,other,objTag,bitmask,customizer,equalFunc,stack);if(!(1&bitmask)){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped){var objUnwrapped=objIsWrapped?object.value():object,othUnwrapped=othIsWrapped?other.value():other;return stack||(stack=new Stack),equalFunc(objUnwrapped,othUnwrapped,bitmask,customizer,stack)}}return!!isSameTag&&(stack||(stack=new Stack),equalObjects(object,other,bitmask,customizer,equalFunc,stack))}},8626:function(module,__unused_webpack_exports,__webpack_require__){var Stack=__webpack_require__(342),baseIsEqual=__webpack_require__(4830);module.exports=function(object,source,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=Object(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){var key=(data=matchData[index])[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(void 0===objValue&&!(key in object))return!1}else{var stack=new Stack;if(customizer)var result=customizer(objValue,srcValue,key,object,source,stack);if(!(void 0===result?baseIsEqual(srcValue,objValue,3,customizer,stack):result))return!1}}return!0}},5121:function(module,__unused_webpack_exports,__webpack_require__){var isFunction=__webpack_require__(8188),isMasked=__webpack_require__(8068),isObject=__webpack_require__(8338),toSource=__webpack_require__(8815),reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,reIsNative=RegExp("^"+funcToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");module.exports=function(value){return!(!isObject(value)||isMasked(value))&&(isFunction(value)?reIsNative:reIsHostCtor).test(toSource(value))}},4590:function(module,__unused_webpack_exports,__webpack_require__){var baseGetTag=__webpack_require__(5385),isLength=__webpack_require__(3228),isObjectLike=__webpack_require__(5044),typedArrayTags={};typedArrayTags["[object Float32Array]"]=typedArrayTags["[object Float64Array]"]=typedArrayTags["[object Int8Array]"]=typedArrayTags["[object Int16Array]"]=typedArrayTags["[object Int32Array]"]=typedArrayTags["[object Uint8Array]"]=typedArrayTags["[object Uint8ClampedArray]"]=typedArrayTags["[object Uint16Array]"]=typedArrayTags["[object Uint32Array]"]=!0,typedArrayTags["[object Arguments]"]=typedArrayTags["[object Array]"]=typedArrayTags["[object ArrayBuffer]"]=typedArrayTags["[object Boolean]"]=typedArrayTags["[object DataView]"]=typedArrayTags["[object Date]"]=typedArrayTags["[object Error]"]=typedArrayTags["[object Function]"]=typedArrayTags["[object Map]"]=typedArrayTags["[object Number]"]=typedArrayTags["[object Object]"]=typedArrayTags["[object RegExp]"]=typedArrayTags["[object Set]"]=typedArrayTags["[object String]"]=typedArrayTags["[object WeakMap]"]=!1,module.exports=function(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[baseGetTag(value)]}},6273:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var baseMatches=__webpack_require__(2333),baseMatchesProperty=__webpack_require__(9305),identity=__webpack_require__(7019),isArray=__webpack_require__(6677),property=__webpack_require__(8386);module.exports=function(value){return"function"==typeof value?value:null==value?identity:"object"==_typeof(value)?isArray(value)?baseMatchesProperty(value[0],value[1]):baseMatches(value):property(value)}},9755:function(module,__unused_webpack_exports,__webpack_require__){var isPrototype=__webpack_require__(3354),nativeKeys=__webpack_require__(6377),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object){if(!isPrototype(object))return nativeKeys(object);var result=[];for(var key in Object(object))hasOwnProperty.call(object,key)&&"constructor"!=key&&result.push(key);return result}},3762:function(module,__unused_webpack_exports,__webpack_require__){var isObject=__webpack_require__(8338),isPrototype=__webpack_require__(3354),nativeKeysIn=__webpack_require__(3675),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object){if(!isObject(object))return nativeKeysIn(object);var isProto=isPrototype(object),result=[];for(var key in object)("constructor"!=key||!isProto&&hasOwnProperty.call(object,key))&&result.push(key);return result}},2333:function(module,__unused_webpack_exports,__webpack_require__){var baseIsMatch=__webpack_require__(8626),getMatchData=__webpack_require__(8622),matchesStrictComparable=__webpack_require__(5232);module.exports=function(source){var matchData=getMatchData(source);return 1==matchData.length&&matchData[0][2]?matchesStrictComparable(matchData[0][0],matchData[0][1]):function(object){return object===source||baseIsMatch(object,source,matchData)}}},9305:function(module,__unused_webpack_exports,__webpack_require__){var baseIsEqual=__webpack_require__(4830),get=__webpack_require__(1441),hasIn=__webpack_require__(8956),isKey=__webpack_require__(1354),isStrictComparable=__webpack_require__(835),matchesStrictComparable=__webpack_require__(5232),toKey=__webpack_require__(3110);module.exports=function(path,srcValue){return isKey(path)&&isStrictComparable(srcValue)?matchesStrictComparable(toKey(path),srcValue):function(object){var objValue=get(object,path);return void 0===objValue&&objValue===srcValue?hasIn(object,path):baseIsEqual(srcValue,objValue,3)}}},4725:function(module,__unused_webpack_exports,__webpack_require__){var baseGet=__webpack_require__(3611),baseSet=__webpack_require__(279),castPath=__webpack_require__(2066);module.exports=function(object,paths,predicate){for(var index=-1,length=paths.length,result={};++index<length;){var path=paths[index],value=baseGet(object,path);predicate(value,path)&&baseSet(result,castPath(path,object),value)}return result}},7292:function(module){module.exports=function(key){return function(object){return null==object?void 0:object[key]}}},4562:function(module,__unused_webpack_exports,__webpack_require__){var baseGet=__webpack_require__(3611);module.exports=function(path){return function(object){return baseGet(object,path)}}},279:function(module,__unused_webpack_exports,__webpack_require__){var assignValue=__webpack_require__(2290),castPath=__webpack_require__(2066),isIndex=__webpack_require__(8174),isObject=__webpack_require__(8338),toKey=__webpack_require__(3110);module.exports=function(object,path,value,customizer){if(!isObject(object))return object;for(var index=-1,length=(path=castPath(path,object)).length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=toKey(path[index]),newValue=value;if("__proto__"===key||"constructor"===key||"prototype"===key)return object;if(index!=lastIndex){var objValue=nested[key];void 0===(newValue=customizer?customizer(objValue,key,nested):void 0)&&(newValue=isObject(objValue)?objValue:isIndex(path[index+1])?[]:{})}assignValue(nested,key,newValue),nested=nested[key]}return object}},968:function(module){module.exports=function(n,iteratee){for(var index=-1,result=Array(n);++index<n;)result[index]=iteratee(index);return result}},8675:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(3789),arrayMap=__webpack_require__(354),isArray=__webpack_require__(6677),isSymbol=__webpack_require__(6500),symbolProto=_Symbol?_Symbol.prototype:void 0,symbolToString=symbolProto?symbolProto.toString:void 0;module.exports=function baseToString(value){if("string"==typeof value)return value;if(isArray(value))return arrayMap(value,baseToString)+"";if(isSymbol(value))return symbolToString?symbolToString.call(value):"";var result=value+"";return"0"==result&&1/value==-Infinity?"-0":result}},4542:function(module,__unused_webpack_exports,__webpack_require__){var trimmedEndIndex=__webpack_require__(1729),reTrimStart=/^\s+/;module.exports=function(string){return string?string.slice(0,trimmedEndIndex(string)+1).replace(reTrimStart,""):string}},7451:function(module){module.exports=function(func){return function(value){return func(value)}}},4639:function(module){module.exports=function(cache,key){return cache.has(key)}},6218:function(module,__unused_webpack_exports,__webpack_require__){var identity=__webpack_require__(7019);module.exports=function(value){return"function"==typeof value?value:identity}},2066:function(module,__unused_webpack_exports,__webpack_require__){var isArray=__webpack_require__(6677),isKey=__webpack_require__(1354),stringToPath=__webpack_require__(8530),toString=__webpack_require__(5078);module.exports=function(value,object){return isArray(value)?value:isKey(value,object)?[value]:stringToPath(toString(value))}},6096:function(module,__unused_webpack_exports,__webpack_require__){var coreJsData=__webpack_require__(8864)["__core-js_shared__"];module.exports=coreJsData},733:function(module,__unused_webpack_exports,__webpack_require__){var isArrayLike=__webpack_require__(7707);module.exports=function(eachFunc,fromRight){return function(collection,iteratee){if(null==collection)return collection;if(!isArrayLike(collection))return eachFunc(collection,iteratee);for(var length=collection.length,index=fromRight?length:-1,iterable=Object(collection);(fromRight?index--:++index<length)&&!1!==iteratee(iterable[index],index,iterable););return collection}}},6088:function(module){module.exports=function(fromRight){return function(object,iteratee,keysFunc){for(var index=-1,iterable=Object(object),props=keysFunc(object),length=props.length;length--;){var key=props[fromRight?length:++index];if(!1===iteratee(iterable[key],key,iterable))break}return object}}},9042:function(module,__unused_webpack_exports,__webpack_require__){var baseIteratee=__webpack_require__(6273),isArrayLike=__webpack_require__(7707),keys=__webpack_require__(5738);module.exports=function(findIndexFunc){return function(collection,predicate,fromIndex){var iterable=Object(collection);if(!isArrayLike(collection)){var iteratee=baseIteratee(predicate,3);collection=keys(collection),predicate=function(key){return iteratee(iterable[key],key,iterable)}}var index=findIndexFunc(collection,predicate,fromIndex);return index>-1?iterable[iteratee?collection[index]:index]:void 0}}},7775:function(module,__unused_webpack_exports,__webpack_require__){var getNative=__webpack_require__(3141),defineProperty=function(){try{var func=getNative(Object,"defineProperty");return func({},"",{}),func}catch(e){}}();module.exports=defineProperty},6045:function(module,__unused_webpack_exports,__webpack_require__){var SetCache=__webpack_require__(7347),arraySome=__webpack_require__(556),cacheHas=__webpack_require__(4639);module.exports=function(array,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isPartial&&othLength>arrLength))return!1;var arrStacked=stack.get(array),othStacked=stack.get(other);if(arrStacked&&othStacked)return arrStacked==other&&othStacked==array;var index=-1,result=!0,seen=2&bitmask?new SetCache:void 0;for(stack.set(array,other),stack.set(other,array);++index<arrLength;){var arrValue=array[index],othValue=other[index];if(customizer)var compared=isPartial?customizer(othValue,arrValue,index,other,array,stack):customizer(arrValue,othValue,index,array,other,stack);if(void 0!==compared){if(compared)continue;result=!1;break}if(seen){if(!arraySome(other,(function(othValue,othIndex){if(!cacheHas(seen,othIndex)&&(arrValue===othValue||equalFunc(arrValue,othValue,bitmask,customizer,stack)))return seen.push(othIndex)}))){result=!1;break}}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,bitmask,customizer,stack)){result=!1;break}}return stack.delete(array),stack.delete(other),result}},4709:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(3789),Uint8Array=__webpack_require__(45),eq=__webpack_require__(2805),equalArrays=__webpack_require__(6045),mapToArray=__webpack_require__(1829),setToArray=__webpack_require__(4688),symbolProto=_Symbol?_Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;module.exports=function(object,other,tag,bitmask,customizer,equalFunc,stack){switch(tag){case"[object DataView]":if(object.byteLength!=other.byteLength||object.byteOffset!=other.byteOffset)return!1;object=object.buffer,other=other.buffer;case"[object ArrayBuffer]":return!(object.byteLength!=other.byteLength||!equalFunc(new Uint8Array(object),new Uint8Array(other)));case"[object Boolean]":case"[object Date]":case"[object Number]":return eq(+object,+other);case"[object Error]":return object.name==other.name&&object.message==other.message;case"[object RegExp]":case"[object String]":return object==other+"";case"[object Map]":var convert=mapToArray;case"[object Set]":var isPartial=1&bitmask;if(convert||(convert=setToArray),object.size!=other.size&&!isPartial)return!1;var stacked=stack.get(object);if(stacked)return stacked==other;bitmask|=2,stack.set(object,other);var result=equalArrays(convert(object),convert(other),bitmask,customizer,equalFunc,stack);return stack.delete(object),result;case"[object Symbol]":if(symbolValueOf)return symbolValueOf.call(object)==symbolValueOf.call(other)}return!1}},5404:function(module,__unused_webpack_exports,__webpack_require__){var getAllKeys=__webpack_require__(9776),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(object,other,bitmask,customizer,equalFunc,stack){var isPartial=1&bitmask,objProps=getAllKeys(object),objLength=objProps.length;if(objLength!=getAllKeys(other).length&&!isPartial)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isPartial?key in other:hasOwnProperty.call(other,key)))return!1}var objStacked=stack.get(object),othStacked=stack.get(other);if(objStacked&&othStacked)return objStacked==other&&othStacked==object;var result=!0;stack.set(object,other),stack.set(other,object);for(var skipCtor=isPartial;++index<objLength;){var objValue=object[key=objProps[index]],othValue=other[key];if(customizer)var compared=isPartial?customizer(othValue,objValue,key,other,object,stack):customizer(objValue,othValue,key,object,other,stack);if(!(void 0===compared?objValue===othValue||equalFunc(objValue,othValue,bitmask,customizer,stack):compared)){result=!1;break}skipCtor||(skipCtor="constructor"==key)}if(result&&!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;objCtor==othCtor||!("constructor"in object)||!("constructor"in other)||"function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor||(result=!1)}return stack.delete(object),stack.delete(other),result}},546:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var freeGlobal="object"==(void 0===__webpack_require__.g?"undefined":_typeof(__webpack_require__.g))&&__webpack_require__.g&&__webpack_require__.g.Object===Object&&__webpack_require__.g;module.exports=freeGlobal},9776:function(module,__unused_webpack_exports,__webpack_require__){var baseGetAllKeys=__webpack_require__(3634),getSymbols=__webpack_require__(5634),keys=__webpack_require__(5738);module.exports=function(object){return baseGetAllKeys(object,keys,getSymbols)}},8559:function(module,__unused_webpack_exports,__webpack_require__){var baseGetAllKeys=__webpack_require__(3634),getSymbolsIn=__webpack_require__(1946),keysIn=__webpack_require__(6788);module.exports=function(object){return baseGetAllKeys(object,keysIn,getSymbolsIn)}},9872:function(module,__unused_webpack_exports,__webpack_require__){var isKeyable=__webpack_require__(9008);module.exports=function(map,key){var data=map.__data__;return isKeyable(key)?data["string"==typeof key?"string":"hash"]:data.map}},8622:function(module,__unused_webpack_exports,__webpack_require__){var isStrictComparable=__webpack_require__(835),keys=__webpack_require__(5738);module.exports=function(object){for(var result=keys(object),length=result.length;length--;){var key=result[length],value=object[key];result[length]=[key,value,isStrictComparable(value)]}return result}},3141:function(module,__unused_webpack_exports,__webpack_require__){var baseIsNative=__webpack_require__(5121),getValue=__webpack_require__(994);module.exports=function(object,key){var value=getValue(object,key);return baseIsNative(value)?value:void 0}},4789:function(module,__unused_webpack_exports,__webpack_require__){var getPrototype=__webpack_require__(7750)(Object.getPrototypeOf,Object);module.exports=getPrototype},3540:function(module,__unused_webpack_exports,__webpack_require__){var _Symbol=__webpack_require__(3789),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=_Symbol?_Symbol.toStringTag:void 0;module.exports=function(value){var isOwn=hasOwnProperty.call(value,symToStringTag),tag=value[symToStringTag];try{value[symToStringTag]=void 0;var unmasked=!0}catch(e){}var result=nativeObjectToString.call(value);return unmasked&&(isOwn?value[symToStringTag]=tag:delete value[symToStringTag]),result}},5634:function(module,__unused_webpack_exports,__webpack_require__){var arrayFilter=__webpack_require__(2310),stubArray=__webpack_require__(5822),propertyIsEnumerable=Object.prototype.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(object){return null==object?[]:(object=Object(object),arrayFilter(nativeGetSymbols(object),(function(symbol){return propertyIsEnumerable.call(object,symbol)})))}:stubArray;module.exports=getSymbols},1946:function(module,__unused_webpack_exports,__webpack_require__){var arrayPush=__webpack_require__(8179),getPrototype=__webpack_require__(4789),getSymbols=__webpack_require__(5634),stubArray=__webpack_require__(5822),getSymbolsIn=Object.getOwnPropertySymbols?function(object){for(var result=[];object;)arrayPush(result,getSymbols(object)),object=getPrototype(object);return result}:stubArray;module.exports=getSymbolsIn},7258:function(module,__unused_webpack_exports,__webpack_require__){var DataView=__webpack_require__(8669),Map=__webpack_require__(8637),Promise=__webpack_require__(4813),Set=__webpack_require__(4644),WeakMap=__webpack_require__(5783),baseGetTag=__webpack_require__(5385),toSource=__webpack_require__(8815),dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),getTag=baseGetTag;(DataView&&"[object DataView]"!=getTag(new DataView(new ArrayBuffer(1)))||Map&&"[object Map]"!=getTag(new Map)||Promise&&"[object Promise]"!=getTag(Promise.resolve())||Set&&"[object Set]"!=getTag(new Set)||WeakMap&&"[object WeakMap]"!=getTag(new WeakMap))&&(getTag=function(value){var result=baseGetTag(value),Ctor="[object Object]"==result?value.constructor:void 0,ctorString=Ctor?toSource(Ctor):"";if(ctorString)switch(ctorString){case dataViewCtorString:return"[object DataView]";case mapCtorString:return"[object Map]";case promiseCtorString:return"[object Promise]";case setCtorString:return"[object Set]";case weakMapCtorString:return"[object WeakMap]"}return result}),module.exports=getTag},994:function(module){module.exports=function(object,key){return null==object?void 0:object[key]}},4300:function(module,__unused_webpack_exports,__webpack_require__){var castPath=__webpack_require__(2066),isArguments=__webpack_require__(5210),isArray=__webpack_require__(6677),isIndex=__webpack_require__(8174),isLength=__webpack_require__(3228),toKey=__webpack_require__(3110);module.exports=function(object,path,hasFunc){for(var index=-1,length=(path=castPath(path,object)).length,result=!1;++index<length;){var key=toKey(path[index]);if(!(result=null!=object&&hasFunc(object,key)))break;object=object[key]}return result||++index!=length?result:!!(length=null==object?0:object.length)&&isLength(length)&&isIndex(key,length)&&(isArray(object)||isArguments(object))}},8679:function(module,__unused_webpack_exports,__webpack_require__){var nativeCreate=__webpack_require__(3437);module.exports=function(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}},4262:function(module){module.exports=function(key){var result=this.has(key)&&delete this.__data__[key];return this.size-=result?1:0,result}},6924:function(module,__unused_webpack_exports,__webpack_require__){var nativeCreate=__webpack_require__(3437),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;if(nativeCreate){var result=data[key];return"__lodash_hash_undefined__"===result?void 0:result}return hasOwnProperty.call(data,key)?data[key]:void 0}},1514:function(module,__unused_webpack_exports,__webpack_require__){var nativeCreate=__webpack_require__(3437),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(key){var data=this.__data__;return nativeCreate?void 0!==data[key]:hasOwnProperty.call(data,key)}},4378:function(module,__unused_webpack_exports,__webpack_require__){var nativeCreate=__webpack_require__(3437);module.exports=function(key,value){var data=this.__data__;return this.size+=this.has(key)?0:1,data[key]=nativeCreate&&void 0===value?"__lodash_hash_undefined__":value,this}},8174:function(module){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var reIsUint=/^(?:0|[1-9]\d*)$/;module.exports=function(value,length){var type=_typeof(value);return!!(length=null==length?9007199254740991:length)&&("number"==type||"symbol"!=type&&reIsUint.test(value))&&value>-1&&value%1==0&&value<length}},5445:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var eq=__webpack_require__(2805),isArrayLike=__webpack_require__(7707),isIndex=__webpack_require__(8174),isObject=__webpack_require__(8338);module.exports=function(value,index,object){if(!isObject(object))return!1;var type=_typeof(index);return!!("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object)&&eq(object[index],value)}},1354:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var isArray=__webpack_require__(6677),isSymbol=__webpack_require__(6500),reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/;module.exports=function(value,object){if(isArray(value))return!1;var type=_typeof(value);return!("number"!=type&&"symbol"!=type&&"boolean"!=type&&null!=value&&!isSymbol(value))||(reIsPlainProp.test(value)||!reIsDeepProp.test(value)||null!=object&&value in Object(object))}},9008:function(module){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module.exports=function(value){var type=_typeof(value);return"string"==type||"number"==type||"symbol"==type||"boolean"==type?"__proto__"!==value:null===value}},8068:function(module,__unused_webpack_exports,__webpack_require__){var uid,coreJsData=__webpack_require__(6096),maskSrcKey=(uid=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||""))?"Symbol(src)_1."+uid:"";module.exports=function(func){return!!maskSrcKey&&maskSrcKey in func}},3354:function(module){var objectProto=Object.prototype;module.exports=function(value){var Ctor=value&&value.constructor;return value===("function"==typeof Ctor&&Ctor.prototype||objectProto)}},835:function(module,__unused_webpack_exports,__webpack_require__){var isObject=__webpack_require__(8338);module.exports=function(value){return value==value&&!isObject(value)}},905:function(module){module.exports=function(){this.__data__=[],this.size=0}},8345:function(module,__unused_webpack_exports,__webpack_require__){var assocIndexOf=__webpack_require__(6511),splice=Array.prototype.splice;module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return!(index<0)&&(index==data.length-1?data.pop():splice.call(data,index,1),--this.size,!0)}},2103:function(module,__unused_webpack_exports,__webpack_require__){var assocIndexOf=__webpack_require__(6511);module.exports=function(key){var data=this.__data__,index=assocIndexOf(data,key);return index<0?void 0:data[index][1]}},8239:function(module,__unused_webpack_exports,__webpack_require__){var assocIndexOf=__webpack_require__(6511);module.exports=function(key){return assocIndexOf(this.__data__,key)>-1}},2812:function(module,__unused_webpack_exports,__webpack_require__){var assocIndexOf=__webpack_require__(6511);module.exports=function(key,value){var data=this.__data__,index=assocIndexOf(data,key);return index<0?(++this.size,data.push([key,value])):data[index][1]=value,this}},5733:function(module,__unused_webpack_exports,__webpack_require__){var Hash=__webpack_require__(9313),ListCache=__webpack_require__(8717),Map=__webpack_require__(8637);module.exports=function(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}},8275:function(module,__unused_webpack_exports,__webpack_require__){var getMapData=__webpack_require__(9872);module.exports=function(key){var result=getMapData(this,key).delete(key);return this.size-=result?1:0,result}},9821:function(module,__unused_webpack_exports,__webpack_require__){var getMapData=__webpack_require__(9872);module.exports=function(key){return getMapData(this,key).get(key)}},6885:function(module,__unused_webpack_exports,__webpack_require__){var getMapData=__webpack_require__(9872);module.exports=function(key){return getMapData(this,key).has(key)}},9725:function(module,__unused_webpack_exports,__webpack_require__){var getMapData=__webpack_require__(9872);module.exports=function(key,value){var data=getMapData(this,key),size=data.size;return data.set(key,value),this.size+=data.size==size?0:1,this}},1829:function(module){module.exports=function(map){var index=-1,result=Array(map.size);return map.forEach((function(value,key){result[++index]=[key,value]})),result}},5232:function(module){module.exports=function(key,srcValue){return function(object){return null!=object&&(object[key]===srcValue&&(void 0!==srcValue||key in Object(object)))}}},7939:function(module,__unused_webpack_exports,__webpack_require__){var memoize=__webpack_require__(5681);module.exports=function(func){var result=memoize(func,(function(key){return 500===cache.size&&cache.clear(),key})),cache=result.cache;return result}},3437:function(module,__unused_webpack_exports,__webpack_require__){var nativeCreate=__webpack_require__(3141)(Object,"create");module.exports=nativeCreate},6377:function(module,__unused_webpack_exports,__webpack_require__){var nativeKeys=__webpack_require__(7750)(Object.keys,Object);module.exports=nativeKeys},3675:function(module){module.exports=function(object){var result=[];if(null!=object)for(var key in Object(object))result.push(key);return result}},5785:function(module,exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module=__webpack_require__.nmd(module);var freeGlobal=__webpack_require__(546),freeExports="object"==_typeof(exports)&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==_typeof(module)&&module&&!module.nodeType&&module,freeProcess=freeModule&&freeModule.exports===freeExports&&freeGlobal.process,nodeUtil=function(){try{var types=freeModule&&freeModule.require&&freeModule.require("util").types;return types||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}();module.exports=nodeUtil},9937:function(module){var nativeObjectToString=Object.prototype.toString;module.exports=function(value){return nativeObjectToString.call(value)}},7750:function(module){module.exports=function(func,transform){return function(arg){return func(transform(arg))}}},8864:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var freeGlobal=__webpack_require__(546),freeSelf="object"==("undefined"==typeof self?"undefined":_typeof(self))&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")();module.exports=root},8397:function(module){module.exports=function(value){return this.__data__.set(value,"__lodash_hash_undefined__"),this}},1470:function(module){module.exports=function(value){return this.__data__.has(value)}},4688:function(module){module.exports=function(set){var index=-1,result=Array(set.size);return set.forEach((function(value){result[++index]=value})),result}},9931:function(module,__unused_webpack_exports,__webpack_require__){var ListCache=__webpack_require__(8717);module.exports=function(){this.__data__=new ListCache,this.size=0}},6498:function(module){module.exports=function(key){var data=this.__data__,result=data.delete(key);return this.size=data.size,result}},4734:function(module){module.exports=function(key){return this.__data__.get(key)}},4685:function(module){module.exports=function(key){return this.__data__.has(key)}},2492:function(module,__unused_webpack_exports,__webpack_require__){var ListCache=__webpack_require__(8717),Map=__webpack_require__(8637),MapCache=__webpack_require__(7738);module.exports=function(key,value){var data=this.__data__;if(data instanceof ListCache){var pairs=data.__data__;if(!Map||pairs.length<199)return pairs.push([key,value]),this.size=++data.size,this;data=this.__data__=new MapCache(pairs)}return data.set(key,value),this.size=data.size,this}},8530:function(module,__unused_webpack_exports,__webpack_require__){var memoizeCapped=__webpack_require__(7939),rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,reEscapeChar=/\\(\\)?/g,stringToPath=memoizeCapped((function(string){var result=[];return 46===string.charCodeAt(0)&&result.push(""),string.replace(rePropName,(function(match,number,quote,subString){result.push(quote?subString.replace(reEscapeChar,"$1"):number||match)})),result}));module.exports=stringToPath},3110:function(module,__unused_webpack_exports,__webpack_require__){var isSymbol=__webpack_require__(6500);module.exports=function(value){if("string"==typeof value||isSymbol(value))return value;var result=value+"";return"0"==result&&1/value==-Infinity?"-0":result}},8815:function(module){var funcToString=Function.prototype.toString;module.exports=function(func){if(null!=func){try{return funcToString.call(func)}catch(e){}try{return func+""}catch(e){}}return""}},1729:function(module){var reWhitespace=/\s/;module.exports=function(string){for(var index=string.length;index--&&reWhitespace.test(string.charAt(index)););return index}},2805:function(module){module.exports=function(value,other){return value===other||value!=value&&other!=other}},2278:function(module,__unused_webpack_exports,__webpack_require__){var arrayEvery=__webpack_require__(6703),baseEvery=__webpack_require__(2831),baseIteratee=__webpack_require__(6273),isArray=__webpack_require__(6677),isIterateeCall=__webpack_require__(5445);module.exports=function(collection,predicate,guard){var func=isArray(collection)?arrayEvery:baseEvery;return guard&&isIterateeCall(collection,predicate,guard)&&(predicate=void 0),func(collection,baseIteratee(predicate,3))}},3621:function(module,__unused_webpack_exports,__webpack_require__){var find=__webpack_require__(9042)(__webpack_require__(2244));module.exports=find},2244:function(module,__unused_webpack_exports,__webpack_require__){var baseFindIndex=__webpack_require__(3616),baseIteratee=__webpack_require__(6273),toInteger=__webpack_require__(6194),nativeMax=Math.max;module.exports=function(array,predicate,fromIndex){var length=null==array?0:array.length;if(!length)return-1;var index=null==fromIndex?0:toInteger(fromIndex);return index<0&&(index=nativeMax(length+index,0)),baseFindIndex(array,baseIteratee(predicate,3),index)}},265:function(module,__unused_webpack_exports,__webpack_require__){var arrayEach=__webpack_require__(7303),baseEach=__webpack_require__(120),castFunction=__webpack_require__(6218),isArray=__webpack_require__(6677);module.exports=function(collection,iteratee){return(isArray(collection)?arrayEach:baseEach)(collection,castFunction(iteratee))}},1441:function(module,__unused_webpack_exports,__webpack_require__){var baseGet=__webpack_require__(3611);module.exports=function(object,path,defaultValue){var result=null==object?void 0:baseGet(object,path);return void 0===result?defaultValue:result}},8956:function(module,__unused_webpack_exports,__webpack_require__){var baseHasIn=__webpack_require__(1992),hasPath=__webpack_require__(4300);module.exports=function(object,path){return null!=object&&hasPath(object,path,baseHasIn)}},7019:function(module){module.exports=function(value){return value}},5210:function(module,__unused_webpack_exports,__webpack_require__){var baseIsArguments=__webpack_require__(1139),isObjectLike=__webpack_require__(5044),objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,propertyIsEnumerable=objectProto.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(value){return isObjectLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")};module.exports=isArguments},6677:function(module){var isArray=Array.isArray;module.exports=isArray},7707:function(module,__unused_webpack_exports,__webpack_require__){var isFunction=__webpack_require__(8188),isLength=__webpack_require__(3228);module.exports=function(value){return null!=value&&isLength(value.length)&&!isFunction(value)}},8910:function(module,exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module=__webpack_require__.nmd(module);var root=__webpack_require__(8864),stubFalse=__webpack_require__(3913),freeExports="object"==_typeof(exports)&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==_typeof(module)&&module&&!module.nodeType&&module,Buffer=freeModule&&freeModule.exports===freeExports?root.Buffer:void 0,isBuffer=(Buffer?Buffer.isBuffer:void 0)||stubFalse;module.exports=isBuffer},9328:function(module,__unused_webpack_exports,__webpack_require__){var baseKeys=__webpack_require__(9755),getTag=__webpack_require__(7258),isArguments=__webpack_require__(5210),isArray=__webpack_require__(6677),isArrayLike=__webpack_require__(7707),isBuffer=__webpack_require__(8910),isPrototype=__webpack_require__(3354),isTypedArray=__webpack_require__(4447),hasOwnProperty=Object.prototype.hasOwnProperty;module.exports=function(value){if(null==value)return!0;if(isArrayLike(value)&&(isArray(value)||"string"==typeof value||"function"==typeof value.splice||isBuffer(value)||isTypedArray(value)||isArguments(value)))return!value.length;var tag=getTag(value);if("[object Map]"==tag||"[object Set]"==tag)return!value.size;if(isPrototype(value))return!baseKeys(value).length;for(var key in value)if(hasOwnProperty.call(value,key))return!1;return!0}},8188:function(module,__unused_webpack_exports,__webpack_require__){var baseGetTag=__webpack_require__(5385),isObject=__webpack_require__(8338);module.exports=function(value){if(!isObject(value))return!1;var tag=baseGetTag(value);return"[object Function]"==tag||"[object GeneratorFunction]"==tag||"[object AsyncFunction]"==tag||"[object Proxy]"==tag}},3228:function(module){module.exports=function(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=9007199254740991}},8338:function(module){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module.exports=function(value){var type=_typeof(value);return null!=value&&("object"==type||"function"==type)}},5044:function(module){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}module.exports=function(value){return null!=value&&"object"==_typeof(value)}},6500:function(module,__unused_webpack_exports,__webpack_require__){function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}var baseGetTag=__webpack_require__(5385),isObjectLike=__webpack_require__(5044);module.exports=function(value){return"symbol"==_typeof(value)||isObjectLike(value)&&"[object Symbol]"==baseGetTag(value)}},4447:function(module,__unused_webpack_exports,__webpack_require__){var baseIsTypedArray=__webpack_require__(4590),baseUnary=__webpack_require__(7451),nodeUtil=__webpack_require__(5785),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray;module.exports=isTypedArray},5738:function(module,__unused_webpack_exports,__webpack_require__){var arrayLikeKeys=__webpack_require__(1032),baseKeys=__webpack_require__(9755),isArrayLike=__webpack_require__(7707);module.exports=function(object){return isArrayLike(object)?arrayLikeKeys(object):baseKeys(object)}},6788:function(module,__unused_webpack_exports,__webpack_require__){var arrayLikeKeys=__webpack_require__(1032),baseKeysIn=__webpack_require__(3762),isArrayLike=__webpack_require__(7707);module.exports=function(object){return isArrayLike(object)?arrayLikeKeys(object,!0):baseKeysIn(object)}},5681:function(module,__unused_webpack_exports,__webpack_require__){var MapCache=__webpack_require__(7738);function memoize(func,resolver){if("function"!=typeof func||null!=resolver&&"function"!=typeof resolver)throw new TypeError("Expected a function");var memoized=function memoized(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result)||cache,result};return memoized.cache=new(memoize.Cache||MapCache),memoized}memoize.Cache=MapCache,module.exports=memoize},572:function(module,__unused_webpack_exports,__webpack_require__){var arrayMap=__webpack_require__(354),baseIteratee=__webpack_require__(6273),basePickBy=__webpack_require__(4725),getAllKeysIn=__webpack_require__(8559);module.exports=function(object,predicate){if(null==object)return{};var props=arrayMap(getAllKeysIn(object),(function(prop){return[prop]}));return predicate=baseIteratee(predicate),basePickBy(object,props,(function(value,path){return predicate(value,path[0])}))}},8386:function(module,__unused_webpack_exports,__webpack_require__){var baseProperty=__webpack_require__(7292),basePropertyDeep=__webpack_require__(4562),isKey=__webpack_require__(1354),toKey=__webpack_require__(3110);module.exports=function(path){return isKey(path)?baseProperty(toKey(path)):basePropertyDeep(path)}},5822:function(module){module.exports=function(){return[]}},3913:function(module){module.exports=function(){return!1}},5147:function(module,__unused_webpack_exports,__webpack_require__){var toNumber=__webpack_require__(7504);module.exports=function(value){return value?Infinity===(value=toNumber(value))||-Infinity===value?17976931348623157e292*(value<0?-1:1):value==value?value:0:0===value?value:0}},6194:function(module,__unused_webpack_exports,__webpack_require__){var toFinite=__webpack_require__(5147);module.exports=function(value){var result=toFinite(value),remainder=result%1;return result==result?remainder?result-remainder:result:0}},7504:function(module,__unused_webpack_exports,__webpack_require__){var baseTrim=__webpack_require__(4542),isObject=__webpack_require__(8338),isSymbol=__webpack_require__(6500),reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;module.exports=function(value){if("number"==typeof value)return value;if(isSymbol(value))return NaN;if(isObject(value)){var other="function"==typeof value.valueOf?value.valueOf():value;value=isObject(other)?other+"":other}if("string"!=typeof value)return 0===value?value:+value;value=baseTrim(value);var isBinary=reIsBinary.test(value);return isBinary||reIsOctal.test(value)?freeParseInt(value.slice(2),isBinary?2:8):reIsBadHex.test(value)?NaN:+value}},5078:function(module,__unused_webpack_exports,__webpack_require__){var baseToString=__webpack_require__(8675);module.exports=function(value){return null==value?"":baseToString(value)}},3226:function(__unused_webpack_module,exports){function cloneRoute(to,from){var clone={name:to.name,path:to.path,hash:to.hash,query:to.query,params:to.params,fullPath:to.fullPath,meta:to.meta};return from&&(clone.from=cloneRoute(from)),Object.freeze(clone)}exports.Z=function(store,router,options){var moduleName=(options||{}).moduleName||"route";store.registerModule(moduleName,{namespaced:!0,state:cloneRoute(router.currentRoute),mutations:{ROUTE_CHANGED:function(state,transition){store.state[moduleName]=cloneRoute(transition.to,transition.from)}}});var currentPath,isTimeTraveling=!1,storeUnwatch=store.watch((function(state){return state[moduleName]}),(function(route){var fullPath=route.fullPath;fullPath!==currentPath&&(null!=currentPath&&(isTimeTraveling=!0,router.push(route)),currentPath=fullPath)}),{sync:!0}),afterEachUnHook=router.afterEach((function(to,from){isTimeTraveling?isTimeTraveling=!1:(currentPath=to.fullPath,store.commit(moduleName+"/ROUTE_CHANGED",{to:to,from:from}))}));return function(){null!=afterEachUnHook&&afterEachUnHook(),null!=storeUnwatch&&storeUnwatch(),store.unregisterModule(moduleName)}}}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={id:moduleId,loaded:!1,exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.loaded=!0,module.exports}__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,{a:getter}),getter},__webpack_require__.d=function(exports,definition){for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)},__webpack_require__.r=function(exports){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(exports,"__esModule",{value:!0})},__webpack_require__.nmd=function(module){return module.paths=[],module.children||(module.children=[]),module},function(){var scriptUrl;__webpack_require__.g.importScripts&&(scriptUrl=__webpack_require__.g.location+"");var document=__webpack_require__.g.document;if(!scriptUrl&&document&&(document.currentScript&&(scriptUrl=document.currentScript.src),!scriptUrl)){var scripts=document.getElementsByTagName("script");if(scripts.length)for(var i=scripts.length-1;i>-1&&!scriptUrl;)scriptUrl=scripts[i--].src}if(!scriptUrl)throw new Error("Automatic publicPath is not supported in this browser");scriptUrl=scriptUrl.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=scriptUrl}(),function(){"use strict";var profile_actions_namespaceObject={};__webpack_require__.r(profile_actions_namespaceObject),__webpack_require__.d(profile_actions_namespaceObject,{updateUserProfile:function(){return updateUserProfile},updateUserProfilePassword:function(){return updateUserProfilePassword}});var external_kolibriCoreAppGlobal_coreVue_router_namespaceObject=kolibriCoreAppGlobal.coreVue.router,external_kolibriCoreAppGlobal_coreVue_router_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_router_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_PageRoot_namespaceObject=kolibriCoreAppGlobal.coreVue.components.PageRoot,external_kolibriCoreAppGlobal_coreVue_components_PageRoot_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_PageRoot_namespaceObject),external_kolibriCoreAppGlobal_coreVue_vuex_store_namespaceObject=kolibriCoreAppGlobal.coreVue.vuex.store,external_kolibriCoreAppGlobal_coreVue_vuex_store_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_vuex_store_namespaceObject),external_kolibriCoreAppGlobal_utils_redirectBrowser_namespaceObject=kolibriCoreAppGlobal.utils.redirectBrowser,external_kolibriCoreAppGlobal_utils_redirectBrowser_default=__webpack_require__.n(external_kolibriCoreAppGlobal_utils_redirectBrowser_namespaceObject),render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("NotificationsRoot",[_c("AppBarPage",{attrs:{title:_vm.coreString("profileLabel")}},[_c("KPageContainer",[_c("KGrid",[_c("KGridItem",{attrs:{layout8:{span:4},layout12:{span:6}}},[_c("h1",[_vm._v(_vm._s(_vm.coreString("profileLabel")))])]),_vm.isLearnerOnlyImport?_vm._e():_c("KGridItem",{attrs:{layout8:{span:4,alignment:"right"},layout12:{span:6,alignment:"right"}}},[_c("h1",[_c("KRouterLink",{attrs:{text:_vm.coreString("editAction"),appearance:"raised-button",primary:!0,to:_vm.profileEditRoute}})],1)])],1),_c("table",[_c("tr",[_c("th",[_vm._v(_vm._s(_vm.$tr("points")))]),_c("td",{staticClass:"points-cell"},[_c("PointsIcon",{staticClass:"points-icon"}),_c("span",{style:{color:_vm.$themeTokens.correct}},[_vm._v("\n              "+_vm._s(_vm.$formatNumber(_vm.totalPoints))+"\n            ")])],1)]),_c("tr",[_c("th",[_vm._v(_vm._s(_vm.coreString("userTypeLabel")))]),_c("td",[_c("UserTypeDisplay",{attrs:{distinguishCoachTypes:!1,userType:_vm.getUserKind}})],1)]),_vm.facilityName?_c("tr",[_c("th",[_vm._v(_vm._s(_vm.coreString("facilityLabel")))]),_c("td",[_vm._v(_vm._s(_vm.facilityName))])]):_vm._e(),_vm.userHasPermissions?_c("tr",[_c("th",{staticStyle:{"vertical-align":"top"}},[_vm._v("\n            "+_vm._s(_vm.coreString("devicePermissionsLabel"))+"\n          ")]),_c("td",[_c("KLabeledIcon",{scopedSlots:_vm._u([{key:"icon",fn:function(){return[_c("PermissionsIcon",{staticClass:"permissions-icon",attrs:{permissionType:_vm.permissionType}})]},proxy:!0}],null,!1,4037438658)},[_vm._v("\n              "+_vm._s(_vm.permissionTypeText)+"\n            ")]),_c("p",[_vm._v("\n              "+_vm._s(_vm.$tr("youCan"))+"\n              "),_c("ul",{staticClass:"permissions-list"},[_vm.isSuperuser?_c("li",[_vm._v("\n                  "+_vm._s(_vm.$tr("manageDevicePermissions"))+"\n                ")]):_vm._e(),_vm._l(_vm.userPermissions,(function(value,key){return _c("li",{key:key},[_vm._v("\n                  "+_vm._s(_vm.getPermissionString(key))+"\n                ")])}))],2)])],1)]):_vm._e(),_c("tr",[_c("th",[_vm._v(_vm._s(_vm.coreString("fullNameLabel")))]),_c("td",[_vm._v(_vm._s(_vm.currentUser.full_name))])]),_c("tr",[_c("th",[_vm._v(_vm._s(_vm.coreString("usernameLabel")))]),_c("td",[_vm._v(_vm._s(_vm.currentUser.username))])]),_c("tr",[_c("th",[_vm._v(_vm._s(_vm.coreString("genderLabel")))]),_c("td",[_c("GenderDisplayText",{attrs:{gender:_vm.currentUser.gender}})],1)]),_c("tr",[_c("th",[_vm._v(_vm._s(_vm.coreString("birthYearLabel")))]),_c("td",[_c("BirthYearDisplayText",{attrs:{birthYear:_vm.currentUser.birth_year}})],1)]),!_vm.isLearnerOnlyImport&&_vm.canEditPassword?_c("tr",[_c("th",[_vm._v(_vm._s(_vm.coreString("passwordLabel")))]),_c("td",[_c("KButton",{staticClass:"change-password",attrs:{appearance:"basic-link",text:_vm.$tr("changePasswordPrompt")},on:{click:function($event){_vm.showPasswordModal=!0}}})],1)]):_vm._e()]),_vm.onMyOwnSetup?_c("KGrid",{style:{marginTop:"34px",paddingTop:"10px",borderTop:"1px solid "+_vm.$themePalette.grey.v_300}},[_c("KGridItem",{attrs:{layout8:{span:4},layout12:{span:6}}},[_c("h2",[_vm._v(_vm._s(_vm.coreString("changeLearningFacility")))])]),_c("KGridItem",{attrs:{layout8:{span:4,alignment:"right"},layout12:{span:6,alignment:"right"}}},[_c("h2",[_c("KRouterLink",{attrs:{text:_vm.$tr("changeAction"),appearance:"raised-button",primary:!1,to:_vm.$router.getRoute("CHANGE_FACILITY")}})],1)]),_c("KGridItem",[_c("span",[_vm._v(_vm._s(_vm.$tr("changeLearningFacilityDescription")))]),_c("span",[_c("KButton",{staticClass:"learn",attrs:{appearance:"basic-link",text:_vm.$tr("learnMore")},on:{click:function($event){_vm.showLearnModal=!0}}})],1)])],1):_vm._e(),!_vm.isLearnerOnlyImport&&_vm.showPasswordModal?_c("ChangeUserPasswordModal",{on:{cancel:function($event){_vm.showPasswordModal=!1}}}):_vm._e(),_vm.showLearnModal?_c("KModal",{attrs:{title:_vm.coreString("changeLearningFacility"),size:"medium",cancelText:_vm.coreString("closeAction")},on:{cancel:function($event){_vm.showLearnModal=!1}}},[_c("p",[_vm._v(_vm._s(_vm.$tr("learnModalLine1")))]),_c("p",[_vm._v(_vm._s(_vm.$tr("learnModalLine2")))])]):_vm._e()],1)],1)],1)};render._withStripped=!0;var external_kolibriCoreAppGlobal_coreVue_components_NotificationsRoot_namespaceObject=kolibriCoreAppGlobal.coreVue.components.NotificationsRoot,external_kolibriCoreAppGlobal_coreVue_components_NotificationsRoot_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_NotificationsRoot_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_AppBarPage_namespaceObject=kolibriCoreAppGlobal.coreVue.components.AppBarPage,external_kolibriCoreAppGlobal_coreVue_components_AppBarPage_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_AppBarPage_namespaceObject),external_kolibriCoreAppGlobal_lib_vuex_namespaceObject=kolibriCoreAppGlobal.lib.vuex,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject=kolibriCoreAppGlobal.lib.vueCompositionApi,external_kolibriCoreAppGlobal_lib_vueCompositionApi_default=__webpack_require__.n(external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject),find=__webpack_require__(3621),find_default=__webpack_require__.n(find),pickBy=__webpack_require__(572),pickBy_default=__webpack_require__.n(pickBy),external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_namespaceObject=kolibriCoreAppGlobal.coreVue.mixins.responsiveWindowMixin,external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_namespaceObject),external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_namespaceObject=kolibriCoreAppGlobal.coreVue.mixins.commonCoreStrings,external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_PointsIcon_namespaceObject=kolibriCoreAppGlobal.coreVue.components.PointsIcon,external_kolibriCoreAppGlobal_coreVue_components_PointsIcon_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_PointsIcon_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_PermissionsIcon_namespaceObject=kolibriCoreAppGlobal.coreVue.components.PermissionsIcon,external_kolibriCoreAppGlobal_coreVue_components_PermissionsIcon_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_PermissionsIcon_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_UserTypeDisplay_namespaceObject=kolibriCoreAppGlobal.coreVue.components.UserTypeDisplay,external_kolibriCoreAppGlobal_coreVue_components_UserTypeDisplay_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_UserTypeDisplay_namespaceObject),external_kolibriCoreAppGlobal_coreVue_vuex_constants_namespaceObject=kolibriCoreAppGlobal.coreVue.vuex.constants,external_kolibriCoreAppGlobal_coreVue_composables_useUser_namespaceObject=kolibriCoreAppGlobal.coreVue.composables.useUser,external_kolibriCoreAppGlobal_coreVue_composables_useUser_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_composables_useUser_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_GenderDisplayText_namespaceObject=kolibriCoreAppGlobal.coreVue.components.GenderDisplayText,external_kolibriCoreAppGlobal_coreVue_components_GenderDisplayText_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_GenderDisplayText_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_BirthYearDisplayText_namespaceObject=kolibriCoreAppGlobal.coreVue.components.BirthYearDisplayText,external_kolibriCoreAppGlobal_coreVue_components_BirthYearDisplayText_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_BirthYearDisplayText_namespaceObject),RoutesMap_PROFILE="PROFILE",RoutesMap_PROFILE_EDIT="PROFILE_EDIT",external_kolibriCoreAppGlobal_resources_namespaceObject=kolibriCoreAppGlobal.resources;function _typeof(o){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},_typeof(o)}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function useCurrentUser(){var $store=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.getCurrentInstance)().proxy.$store,currentUser=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)({}),isLoading=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1);return(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.onMounted)((function(){return isLoading.value=!0,external_kolibriCoreAppGlobal_resources_namespaceObject.FacilityUserResource.fetchModel({id:$store.state.core.session.user_id}).then((function(userModel){currentUser.value=function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({},userModel),isLoading.value=!1}))})),{currentUser:currentUser,isLoading:isLoading}}var _vue,external_kolibriCoreAppGlobal_lib_vue_namespaceObject=kolibriCoreAppGlobal.lib.vue,external_kolibriCoreAppGlobal_lib_vue_default=__webpack_require__.n(external_kolibriCoreAppGlobal_lib_vue_namespaceObject);(_vue=(_vue=external_kolibriCoreAppGlobal_lib_vue_default())||external_kolibriCoreAppGlobal_lib_vue_default())&&!_vue.__composition_api_installed__&&external_kolibriCoreAppGlobal_lib_vue_default().use(external_kolibriCoreAppGlobal_lib_vueCompositionApi_default());external_kolibriCoreAppGlobal_lib_vue_default().version;function _createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function _unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(o,minLen):void 0}}function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}var _a;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var shared_isClient="undefined"!=typeof window,shared_isFunction=(Object.prototype.toString,function(val){return"function"==typeof val}),shared_isString=function(val){return"string"==typeof val},shared_noop=function(){};shared_isClient&&(null==(_a=null==window?void 0:window.navigator)?void 0:_a.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function shared_resolveUnref(r){return"function"==typeof r?r():(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.unref)(r)}function shared_createFilterWrapper(filter,fn){return function(){for(var _this=this,_len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];return new Promise((function(resolve,reject){Promise.resolve(filter((function(){return fn.apply(_this,args)}),{fn:fn,thisArg:_this,args:args})).then(resolve).catch(reject)}))}}var shared_bypassFilter=function(invoke){return invoke()};function shared_tryOnScopeDispose(fn){return!!(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.getCurrentScope)()&&((0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.onScopeDispose)(fn),!0)}function get(obj,key){return null==key?(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.unref)(obj):(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.unref)(obj)[key]}Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var __getOwnPropSymbols$6=Object.getOwnPropertySymbols,__hasOwnProp$6=Object.prototype.hasOwnProperty,__propIsEnum$6=Object.prototype.propertyIsEnumerable,__objRest$5=function(source,exclude){var target={};for(var prop in source)__hasOwnProp$6.call(source,prop)&&exclude.indexOf(prop)<0&&(target[prop]=source[prop]);if(null!=source&&__getOwnPropSymbols$6){var _step7,_iterator7=_createForOfIteratorHelper(__getOwnPropSymbols$6(source));try{for(_iterator7.s();!(_step7=_iterator7.n()).done;){prop=_step7.value;exclude.indexOf(prop)<0&&__propIsEnum$6.call(source,prop)&&(target[prop]=source[prop])}}catch(err){_iterator7.e(err)}finally{_iterator7.f()}}return target};function shared_watchWithFilter(source,cb){var _a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_a$eventFilter=_a.eventFilter,eventFilter=void 0===_a$eventFilter?shared_bypassFilter:_a$eventFilter,watchOptions=__objRest$5(_a,["eventFilter"]);return(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.watch)(source,shared_createFilterWrapper(eventFilter,cb),watchOptions)}Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var __defProp$2=Object.defineProperty,__defProps$2=Object.defineProperties,__getOwnPropDescs$2=Object.getOwnPropertyDescriptors,__getOwnPropSymbols$2=Object.getOwnPropertySymbols,__hasOwnProp$2=Object.prototype.hasOwnProperty,__propIsEnum$2=Object.prototype.propertyIsEnumerable,__defNormalProp$2=function(obj,key,value){return key in obj?__defProp$2(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value},__spreadValues$2=function(a,b){for(var prop in b||(b={}))__hasOwnProp$2.call(b,prop)&&__defNormalProp$2(a,prop,b[prop]);if(__getOwnPropSymbols$2){var _step13,_iterator13=_createForOfIteratorHelper(__getOwnPropSymbols$2(b));try{for(_iterator13.s();!(_step13=_iterator13.n()).done;){prop=_step13.value;__propIsEnum$2.call(b,prop)&&__defNormalProp$2(a,prop,b[prop])}}catch(err){_iterator13.e(err)}finally{_iterator13.f()}}return a},__spreadProps$2=function(a,b){return __defProps$2(a,__getOwnPropDescs$2(b))},__objRest$1=function(source,exclude){var target={};for(var prop in source)__hasOwnProp$2.call(source,prop)&&exclude.indexOf(prop)<0&&(target[prop]=source[prop]);if(null!=source&&__getOwnPropSymbols$2){var _step14,_iterator14=_createForOfIteratorHelper(__getOwnPropSymbols$2(source));try{for(_iterator14.s();!(_step14=_iterator14.n()).done;){prop=_step14.value;exclude.indexOf(prop)<0&&__propIsEnum$2.call(source,prop)&&(target[prop]=source[prop])}}catch(err){_iterator14.e(err)}finally{_iterator14.f()}}return target};function watchPausable(source,cb){var _a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},filter=_a.eventFilter,watchOptions=__objRest$1(_a,["eventFilter"]),_pausableFilter=function(){var extendFilter=arguments.length>0&&void 0!==arguments[0]?arguments[0]:shared_bypassFilter,isActive=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!0);return{isActive:(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.readonly)(isActive),pause:function(){isActive.value=!1},resume:function(){isActive.value=!0},eventFilter:function(){isActive.value&&extendFilter.apply(void 0,arguments)}}}(filter),eventFilter=_pausableFilter.eventFilter,pause=_pausableFilter.pause,resume=_pausableFilter.resume,isActive=_pausableFilter.isActive;return{stop:shared_watchWithFilter(source,cb,__spreadProps$2(__spreadValues$2({},watchOptions),{eventFilter:eventFilter})),pause:pause,resume:resume,isActive:isActive}}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var external_kolibriCoreAppGlobal_client_namespaceObject=kolibriCoreAppGlobal.client,external_kolibriCoreAppGlobal_client_default=__webpack_require__.n(external_kolibriCoreAppGlobal_client_namespaceObject),external_kolibriCoreAppGlobal_urls_namespaceObject=kolibriCoreAppGlobal.urls,external_kolibriCoreAppGlobal_urls_default=__webpack_require__.n(external_kolibriCoreAppGlobal_urls_namespaceObject);var ChangeUserPasswordModalvue_type_template_id_3f4e9594_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("KModal",{attrs:{title:_vm.$tr("passwordChangeFormHeader"),size:"medium",submitText:_vm.coreString("updateAction"),cancelText:_vm.coreString("cancelAction"),submitDisabled:_vm.busy,cancelDisabled:_vm.busy},on:{submit:_vm.submitForm,cancel:function($event){return _vm.$emit("cancel")}}},[_c("PasswordTextbox",{ref:"passwordTextbox",attrs:{autofocus:!0,disabled:_vm.busy,value:_vm.password,isValid:_vm.passwordValid,shouldValidate:_vm.formSubmitted},on:{"update:value":function($event){_vm.password=$event},"update:isValid":function($event){_vm.passwordValid=$event},"update:is-valid":function($event){_vm.passwordValid=$event}}})],1)};ChangeUserPasswordModalvue_type_template_id_3f4e9594_scoped_true_render._withStripped=!0;var external_kolibriCoreAppGlobal_coreVue_components_PasswordTextbox_namespaceObject=kolibriCoreAppGlobal.coreVue.components.PasswordTextbox,external_kolibriCoreAppGlobal_coreVue_components_PasswordTextbox_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_PasswordTextbox_namespaceObject);function normalizeComponent(scriptExports,render,staticRenderFns,functionalTemplate,injectStyles,scopeId,moduleIdentifier,shadowMode){var hook,options="function"==typeof scriptExports?scriptExports.options:scriptExports;if(render&&(options.render=render,options.staticRenderFns=staticRenderFns,options._compiled=!0),functionalTemplate&&(options.functional=!0),scopeId&&(options._scopeId="data-v-"+scopeId),moduleIdentifier?(hook=function(context){(context=context||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(context=__VUE_SSR_CONTEXT__),injectStyles&&injectStyles.call(this,context),context&&context._registeredComponents&&context._registeredComponents.add(moduleIdentifier)},options._ssrRegister=hook):injectStyles&&(hook=shadowMode?function(){injectStyles.call(this,(options.functional?this.parent:this).$root.$options.shadowRoot)}:injectStyles),hook)if(options.functional){options._injectStyles=hook;var originalRender=options.render;options.render=function(h,context){return hook.call(context),originalRender(h,context)}}else{var existing=options.beforeCreate;options.beforeCreate=existing?[].concat(existing,hook):[hook]}return{exports:scriptExports,options:options}}var ChangeUserPasswordModal=normalizeComponent({name:"ChangeUserPasswordModal",components:{PasswordTextbox:external_kolibriCoreAppGlobal_coreVue_components_PasswordTextbox_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default()],data:function(){return{password:"",passwordValid:!0,formSubmitted:!1,busy:!1}},methods:{submitForm:function(){var _this=this;if(this.formSubmitted=!0,!this.passwordValid)return this.focusOnInvalidField();this.busy=!0,this.$store.dispatch("profile/updateUserProfilePassword",this.password).then((function(){_this.busy=!1,_this.$emit("cancel"),_this.$store.dispatch("createSnackbar",_this.$tr("passwordChangedNotification"))})).catch((function(error){_this.$store.dispatch("handleApiError",{error:error})}))},focusOnInvalidField:function(){var _this2=this;this.$nextTick().then((function(){_this2.passwordValid||_this2.$refs.passwordTextbox.focus()}))}},$trs:{passwordChangeFormHeader:{message:"Change Password",context:"Users have the option to change their password if, for example, they have forgotten it.\n\nThis is the text that appears on the change password header."},passwordChangedNotification:{message:"Your password has been changed.",context:"Notification indicating a user has changed their password."}}},ChangeUserPasswordModalvue_type_template_id_3f4e9594_scoped_true_render,[],!1,null,"3f4e9594",null).exports;function ProfilePagevue_type_script_lang_js_typeof(o){return ProfilePagevue_type_script_lang_js_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},ProfilePagevue_type_script_lang_js_typeof(o)}function ProfilePagevue_type_script_lang_js_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function ProfilePagevue_type_script_lang_js_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ProfilePagevue_type_script_lang_js_ownKeys(Object(t),!0).forEach((function(r){ProfilePagevue_type_script_lang_js_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ProfilePagevue_type_script_lang_js_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function ProfilePagevue_type_script_lang_js_defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=ProfilePagevue_type_script_lang_js_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=ProfilePagevue_type_script_lang_js_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==ProfilePagevue_type_script_lang_js_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var ProfilePage=normalizeComponent({name:"ProfilePage",metaInfo:function(){return{title:this.$tr("documentTitle")}},components:{AppBarPage:external_kolibriCoreAppGlobal_coreVue_components_AppBarPage_default(),BirthYearDisplayText:external_kolibriCoreAppGlobal_coreVue_components_BirthYearDisplayText_default(),ChangeUserPasswordModal:ChangeUserPasswordModal,NotificationsRoot:external_kolibriCoreAppGlobal_coreVue_components_NotificationsRoot_default(),GenderDisplayText:external_kolibriCoreAppGlobal_coreVue_components_GenderDisplayText_default(),PermissionsIcon:external_kolibriCoreAppGlobal_coreVue_components_PermissionsIcon_default(),PointsIcon:external_kolibriCoreAppGlobal_coreVue_components_PointsIcon_default(),UserTypeDisplay:external_kolibriCoreAppGlobal_coreVue_components_UserTypeDisplay_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_default(),external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default()],setup:function(){var showPasswordModal=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),showLearnModal=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),currentUser=useCurrentUser().currentUser,isLearnerOnlyImport=external_kolibriCoreAppGlobal_coreVue_composables_useUser_default()().isLearnerOnlyImport,_useOnMyOwnSetup=function(){var onMyOwnSetup=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),isLearnerOnlyImport=external_kolibriCoreAppGlobal_coreVue_composables_useUser_default()().isLearnerOnlyImport;return(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.onMounted)((function(){external_kolibriCoreAppGlobal_client_default()({url:external_kolibriCoreAppGlobal_urls_default()["kolibri:kolibri.plugins.user_profile:onmyownsetup"]()}).then((function(response){onMyOwnSetup.value=response.data.on_my_own_setup&&!get(isLearnerOnlyImport)}))})),{onMyOwnSetup:onMyOwnSetup}}();return{currentUser:currentUser,onMyOwnSetup:_useOnMyOwnSetup.onMyOwnSetup,isLearnerOnlyImport:isLearnerOnlyImport,showLearnModal:showLearnModal,showPasswordModal:showPasswordModal}},computed:ProfilePagevue_type_script_lang_js_objectSpread(ProfilePagevue_type_script_lang_js_objectSpread({},(0,external_kolibriCoreAppGlobal_lib_vuex_namespaceObject.mapGetters)(["facilityConfig","getUserKind","getUserPermissions","isCoach","isSuperuser","totalPoints","userHasPermissions"])),{},{profileEditRoute:function(){return this.$router.getRoute(RoutesMap_PROFILE_EDIT)},userPermissions:function(){return pickBy_default()(this.getUserPermissions)},facilityName:function(){var match=find_default()(this.$store.getters.facilities,{id:this.$store.getters.userFacilityId});return match?match.name:""},permissionType:function(){return this.isSuperuser?external_kolibriCoreAppGlobal_coreVue_vuex_constants_namespaceObject.PermissionTypes.SUPERUSER:this.userHasPermissions?external_kolibriCoreAppGlobal_coreVue_vuex_constants_namespaceObject.PermissionTypes.LIMITED_PERMISSIONS:null},permissionTypeText:function(){return this.isSuperuser?this.$tr("isSuperuser"):this.userHasPermissions?this.$tr("limitedPermissions"):""},canEditPassword:function(){var learner_can_edit=this.facilityConfig.learner_can_edit_password&&!this.facilityConfig.learner_can_login_with_no_password;return this.isSuperuser||this.isCoach||learner_can_edit}}),created:function(){this.$store.dispatch("fetchPoints")},methods:{getPermissionString:function(permission){return"can_manage_content"===permission?this.$tr("manageContent"):permission}},$trs:{changeAction:{message:"Change",context:"Button which allows the user to change to a different facility."},changeLearningFacilityDescription:{message:"Move your account and progress data to another learning facility.",context:"Explanation of what change a learning facility means"},learnMore:{message:"Learn more",context:"Link to open a modal window explaining what changing to another learning facility represents."},isSuperuser:{message:"Super admin permissions ",context:"A super admin is an account type that can manage the device. Super admin accounts also have permission to do everything that admins, coaches, and learners can do."},manageContent:{message:"Manage channels and resources",context:"A type of device permission."},manageDevicePermissions:{message:"Manage device permissions",context:"A type of device permission."},points:{message:"Points",context:"Points are an abstract reward given to learners as they make progress through resources."},limitedPermissions:{message:"Limited permissions",context:"A type of device permission that indicates that the user has permissions to manage content, but not other users or facility settings."},youCan:{message:"You can:",context:"Descriptive text on user profile page. Indicates the permissions a user has."},changePasswordPrompt:{message:"Change password",context:"Users have the option to change their password if, for example, they have forgotten it.\n\nThis is the text that appears on the change password prompt."},documentTitle:{message:"User Profile",context:"Title of the user profile page."},learnModalLine1:{message:"Learning facility represents the location where you are using Kolibri, such as a school, training center, or a home.",context:"First line of text in the modal explaining what changing to another learning facility means."},learnModalLine2:{message:"Moving your account to another learning facility means administrators of that facility will be able to access your data.",context:"Second line of text in the modal explaining what changing to another learning facility means."}}},render,[],!1,null,"573ca727",null).exports,ProfileEditPagevue_type_template_id_530105f8_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _vm.isLearnerOnlyImport?_vm._e():_c("ImmersivePage",{attrs:{icon:"close",appBarTitle:_vm.$tr("editProfileHeader"),route:_vm.profileRoute}},[_c("KPageContainer",{staticClass:"narrow-container",attrs:{topMargin:100}},[_c("form",{staticClass:"form",on:{submit:function($event){return $event.preventDefault(),_vm.handleSubmit.apply(null,arguments)}}},[_c("h1",[_vm._v(_vm._s(_vm.$tr("editProfileHeader")))]),_c("FullNameTextbox",{ref:"fullNameTextbox",attrs:{autofocus:!0,disabled:!_vm.canEditName||_vm.formDisabled,value:_vm.fullName,isValid:_vm.fullNameValid,shouldValidate:_vm.formSubmitted},on:{"update:value":function($event){_vm.fullName=$event},"update:isValid":function($event){_vm.fullNameValid=$event},"update:is-valid":function($event){_vm.fullNameValid=$event}}}),_c("UsernameTextbox",{ref:"usernameTextbox",attrs:{disabled:!_vm.canEditUsername||_vm.formDisabled,value:_vm.username,isValid:_vm.usernameValid,shouldValidate:_vm.formSubmitted,errors:_vm.caughtErrors},on:{"update:value":function($event){_vm.username=$event},"update:isValid":function($event){_vm.usernameValid=$event},"update:is-valid":function($event){_vm.usernameValid=$event},"update:errors":function($event){_vm.caughtErrors=$event}}}),_c("GenderSelect",{staticClass:"select",attrs:{value:_vm.gender,disabled:_vm.formDisabled},on:{"update:value":function($event){_vm.gender=$event}}}),_c("BirthYearSelect",{staticClass:"select",attrs:{value:_vm.birthYear,disabled:_vm.formDisabled},on:{"update:value":function($event){_vm.birthYear=$event}}}),_c("KButtonGroup",{staticClass:"buttons"},[_c("KButton",{attrs:{text:_vm.coreString("saveAction"),disabled:_vm.formDisabled,type:"submit",primary:""}}),_c("KButton",{attrs:{text:_vm.cancelButtonText,disabled:_vm.formDisabled,appearance:"raised-button",primary:!1},on:{click:_vm.handleCancel}})],1)],1)])],1)};ProfileEditPagevue_type_template_id_530105f8_scoped_true_render._withStripped=!0;var every=__webpack_require__(2278),every_default=__webpack_require__.n(every),external_kolibriCoreAppGlobal_utils_CatchErrors_namespaceObject=kolibriCoreAppGlobal.utils.CatchErrors,external_kolibriCoreAppGlobal_utils_CatchErrors_default=__webpack_require__.n(external_kolibriCoreAppGlobal_utils_CatchErrors_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_GenderSelect_namespaceObject=kolibriCoreAppGlobal.coreVue.components.GenderSelect,external_kolibriCoreAppGlobal_coreVue_components_GenderSelect_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_GenderSelect_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_BirthYearSelect_namespaceObject=kolibriCoreAppGlobal.coreVue.components.BirthYearSelect,external_kolibriCoreAppGlobal_coreVue_components_BirthYearSelect_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_BirthYearSelect_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_FullNameTextbox_namespaceObject=kolibriCoreAppGlobal.coreVue.components.FullNameTextbox,external_kolibriCoreAppGlobal_coreVue_components_FullNameTextbox_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_FullNameTextbox_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_ImmersivePage_namespaceObject=kolibriCoreAppGlobal.coreVue.components.ImmersivePage,external_kolibriCoreAppGlobal_coreVue_components_ImmersivePage_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_ImmersivePage_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_UsernameTextbox_namespaceObject=kolibriCoreAppGlobal.coreVue.components.UsernameTextbox,external_kolibriCoreAppGlobal_coreVue_components_UsernameTextbox_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_UsernameTextbox_namespaceObject);function ProfileEditPagevue_type_script_lang_js_typeof(o){return ProfileEditPagevue_type_script_lang_js_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},ProfileEditPagevue_type_script_lang_js_typeof(o)}function ProfileEditPagevue_type_script_lang_js_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function ProfileEditPagevue_type_script_lang_js_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ProfileEditPagevue_type_script_lang_js_ownKeys(Object(t),!0).forEach((function(r){ProfileEditPagevue_type_script_lang_js_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ProfileEditPagevue_type_script_lang_js_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function ProfileEditPagevue_type_script_lang_js_defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=ProfileEditPagevue_type_script_lang_js_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=ProfileEditPagevue_type_script_lang_js_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==ProfileEditPagevue_type_script_lang_js_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var ProfileEditPage=normalizeComponent({name:"ProfileEditPage",metaInfo:function(){return{title:this.$tr("editProfileHeader")}},components:{GenderSelect:external_kolibriCoreAppGlobal_coreVue_components_GenderSelect_default(),BirthYearSelect:external_kolibriCoreAppGlobal_coreVue_components_BirthYearSelect_default(),FullNameTextbox:external_kolibriCoreAppGlobal_coreVue_components_FullNameTextbox_default(),UsernameTextbox:external_kolibriCoreAppGlobal_coreVue_components_UsernameTextbox_default(),ImmersivePage:external_kolibriCoreAppGlobal_coreVue_components_ImmersivePage_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default()],setup:function(){return{isLearnerOnlyImport:external_kolibriCoreAppGlobal_coreVue_composables_useUser_default()().isLearnerOnlyImport}},data:function(){return{fullName:"",fullNameValid:!1,username:"",usernameValid:!1,birthYear:"",gender:"",caughtErrors:[],formSubmitted:!1,status:"",userCopy:{}}},computed:ProfileEditPagevue_type_script_lang_js_objectSpread(ProfileEditPagevue_type_script_lang_js_objectSpread({},(0,external_kolibriCoreAppGlobal_lib_vuex_namespaceObject.mapGetters)(["facilityConfig","isLearner"])),{},{formDisabled:function(){return"BUSY"===this.status},canEditName:function(){return!this.isLearner||this.facilityConfig.learner_can_edit_name},canEditUsername:function(){return!this.isLearner||this.facilityConfig.learner_can_edit_username},cancelButtonText:function(){return this.coreString("cancelAction")},formIsValid:function(){return every_default()([this.fullNameValid,this.usernameValid])},profileRoute:function(){return this.$router.getRoute(RoutesMap_PROFILE)}}),mounted:function(){this.setFacilityUser()},created:function(){this.isLearnerOnlyImport&&external_kolibriCoreAppGlobal_utils_redirectBrowser_default()()},methods:{setFacilityUser:function(){var _this=this;external_kolibriCoreAppGlobal_resources_namespaceObject.FacilityUserResource.fetchModel({id:this.$store.state.core.session.user_id}).then((function(facilityUser){_this.birthYear=facilityUser.birth_year,_this.gender=facilityUser.gender,_this.fullName=facilityUser.full_name,_this.username=facilityUser.username,_this.userCopy=ProfileEditPagevue_type_script_lang_js_objectSpread({},facilityUser)}))},getUpdates:function(){var _this2=this;return pickBy_default()({birth_year:this.birthYear,full_name:this.fullName,gender:this.gender,username:this.username},(function(value,key){return value!==_this2.userCopy[key]}))},handleCancel:function(){this.$router.push(this.profileRoute)},handleSubmit:function(){var _this3=this;this.formSubmitted=!0,this.formIsValid?(this.status="BUSY",this.$store.dispatch("profile/updateUserProfile",{updates:this.getUpdates()}).then((function(){_this3.showSnackbarNotification("changesSaved"),_this3.$router.push(_this3.profileRoute)})).catch((function(error){_this3.status="FAILURE",_this3.caughtErrors=external_kolibriCoreAppGlobal_utils_CatchErrors_default()(error,[external_kolibriCoreAppGlobal_coreVue_vuex_constants_namespaceObject.ERROR_CONSTANTS.USERNAME_ALREADY_EXISTS]),_this3.caughtErrors.length>0?_this3.focusOnInvalidField():_this3.$store.dispatch("handleApiError",{error:error})}))):this.focusOnInvalidField()},focusOnInvalidField:function(){var _this4=this;this.$nextTick().then((function(){_this4.fullNameValid?_this4.usernameValid||_this4.$refs.usernameTextbox.focus():_this4.$refs.fullNameTextbox.focus()}))}},$trs:{editProfileHeader:{message:"Edit profile",context:"Title of the 'Edit profile' page."}}},ProfileEditPagevue_type_template_id_530105f8_scoped_true_render,[],!1,null,"530105f8",null).exports,ChangeFacilityvue_type_template_id_0c2bd7d8_scoped_true_render=function(){var _h=this.$createElement,_c=this._self._c||_h;return _c("NotificationsRoot",[_c("ImmersivePage",{attrs:{appBarTitle:this.coreString("changeLearningFacility"),route:this.$router.getRoute("PROFILE"),appearanceOverrides:this.wrapperStyles}},[_c("KPageContainer",[_c("router-view")],1)],1)],1)};ChangeFacilityvue_type_template_id_0c2bd7d8_scoped_true_render._withStripped=!0;var types_ActionTypes,types_SpecialTargets,_assign=function(){return _assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t},_assign.apply(this,arguments)};function __rest(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t}function _tslib_values(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function _tslib_read(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar}function _tslib_spreadArray(to,from,pack){if(pack||2===arguments.length)for(var ar,i=0,l=from.length;i<l;i++)!ar&&i in from||(ar||(ar=Array.prototype.slice.call(from,0,i)),ar[i]=from[i]);return to.concat(ar||Array.prototype.slice.call(from))}!function(ActionTypes){ActionTypes.Start="xstate.start",ActionTypes.Stop="xstate.stop",ActionTypes.Raise="xstate.raise",ActionTypes.Send="xstate.send",ActionTypes.Cancel="xstate.cancel",ActionTypes.NullEvent="",ActionTypes.Assign="xstate.assign",ActionTypes.After="xstate.after",ActionTypes.DoneState="done.state",ActionTypes.DoneInvoke="done.invoke",ActionTypes.Log="xstate.log",ActionTypes.Init="xstate.init",ActionTypes.Invoke="xstate.invoke",ActionTypes.ErrorExecution="error.execution",ActionTypes.ErrorCommunication="error.communication",ActionTypes.ErrorPlatform="error.platform",ActionTypes.ErrorCustom="xstate.error",ActionTypes.Update="xstate.update",ActionTypes.Pure="xstate.pure",ActionTypes.Choose="xstate.choose"}(types_ActionTypes||(types_ActionTypes={})),function(SpecialTargets){SpecialTargets.Parent="#_parent",SpecialTargets.Internal="#_internal"}(types_SpecialTargets||(types_SpecialTargets={}));var utils_a,EMPTY_ACTIVITY_MAP={},DEFAULT_GUARD_TYPE="xstate.guard",start=types_ActionTypes.Start,stop=types_ActionTypes.Stop,raise=types_ActionTypes.Raise,send=types_ActionTypes.Send,actionTypes_cancel=types_ActionTypes.Cancel,nullEvent=types_ActionTypes.NullEvent,actionTypes_assign=types_ActionTypes.Assign,log=(types_ActionTypes.After,types_ActionTypes.DoneState,types_ActionTypes.Log),init=types_ActionTypes.Init,actionTypes_invoke=types_ActionTypes.Invoke,errorPlatform=(types_ActionTypes.ErrorExecution,types_ActionTypes.ErrorPlatform),actionTypes_error=types_ActionTypes.ErrorCustom,actionTypes_update=types_ActionTypes.Update,choose=types_ActionTypes.Choose,pure=types_ActionTypes.Pure,environment_IS_PRODUCTION=!0;function utils_typeof(o){return utils_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},utils_typeof(o)}function matchesState(parentStateId,childStateId,delimiter){void 0===delimiter&&(delimiter=".");var parentStateValue=toStateValue(parentStateId,delimiter),childStateValue=toStateValue(childStateId,delimiter);return utils_isString(childStateValue)?!!utils_isString(parentStateValue)&&childStateValue===parentStateValue:utils_isString(parentStateValue)?parentStateValue in childStateValue:Object.keys(parentStateValue).every((function(key){return key in childStateValue&&matchesState(parentStateValue[key],childStateValue[key])}))}function getEventType(event){try{return utils_isString(event)||"number"==typeof event?"".concat(event):event.type}catch(e){throw new Error("Events must be strings or objects with a string event.type property.")}}function toStatePath(stateId,delimiter){try{return isArray(stateId)?stateId:stateId.toString().split(delimiter)}catch(e){throw new Error("'".concat(stateId,"' is not a valid state path."))}}function toStateValue(stateValue,delimiter){return"object"===utils_typeof(state=stateValue)&&"value"in state&&"context"in state&&"event"in state&&"_event"in state?stateValue.value:isArray(stateValue)?pathToStateValue(stateValue):"string"!=typeof stateValue?stateValue:pathToStateValue(toStatePath(stateValue,delimiter));var state}function pathToStateValue(statePath){if(1===statePath.length)return statePath[0];for(var value={},marker=value,i=0;i<statePath.length-1;i++)i===statePath.length-2?marker[statePath[i]]=statePath[i+1]:(marker[statePath[i]]={},marker=marker[statePath[i]]);return value}function mapValues(collection,iteratee){for(var result={},collectionKeys=Object.keys(collection),i=0;i<collectionKeys.length;i++){var key=collectionKeys[i];result[key]=iteratee(collection[key],key,collection,i)}return result}function mapFilterValues(collection,iteratee,predicate){var e_1,_a,result={};try{for(var _b=_tslib_values(Object.keys(collection)),_c=_b.next();!_c.done;_c=_b.next()){var key=_c.value,item=collection[key];predicate(item)&&(result[key]=iteratee(item,key,collection))}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}return result}var path=function(props){return function(object){var e_2,_a,result=object;try{for(var props_1=_tslib_values(props),props_1_1=props_1.next();!props_1_1.done;props_1_1=props_1.next()){result=result[props_1_1.value]}}catch(e_2_1){e_2={error:e_2_1}}finally{try{props_1_1&&!props_1_1.done&&(_a=props_1.return)&&_a.call(props_1)}finally{if(e_2)throw e_2.error}}return result}};function toStatePaths(stateValue){return stateValue?utils_isString(stateValue)?[[stateValue]]:flatten(Object.keys(stateValue).map((function(key){var subStateValue=stateValue[key];return"string"==typeof subStateValue||subStateValue&&Object.keys(subStateValue).length?toStatePaths(stateValue[key]).map((function(subPath){return[key].concat(subPath)})):[[key]]}))):[[]]}function flatten(array){var _a;return(_a=[]).concat.apply(_a,_tslib_spreadArray([],_tslib_read(array),!1))}function toArrayStrict(value){return isArray(value)?value:[value]}function toArray(value){return void 0===value?[]:toArrayStrict(value)}function mapContext(mapper,context,_event){var e_5,_a;if(utils_isFunction(mapper))return mapper(context,_event.data);var result={};try{for(var _b=_tslib_values(Object.keys(mapper)),_c=_b.next();!_c.done;_c=_b.next()){var key=_c.value,subMapper=mapper[key];utils_isFunction(subMapper)?result[key]=subMapper(context,_event.data):result[key]=subMapper}}catch(e_5_1){e_5={error:e_5_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_5)throw e_5.error}}return result}function isPromiseLike(value){return value instanceof Promise||!(null===value||!utils_isFunction(value)&&"object"!==utils_typeof(value)||!utils_isFunction(value.then))}function updateHistoryStates(hist,stateValue){return mapValues(hist.states,(function(subHist,key){if(subHist){var subStateValue=(utils_isString(stateValue)?void 0:stateValue[key])||(subHist?subHist.current:void 0);if(subStateValue)return{current:subStateValue,states:updateHistoryStates(subHist,subStateValue)}}}))}function updateContext(context,_event,assignActions,state){environment_IS_PRODUCTION||utils_warn(!!context,"Attempting to update undefined context");var updatedContext=context?assignActions.reduce((function(acc,assignAction){var e_7,_a,assignment=assignAction.assignment,meta={state:state,action:assignAction,_event:_event},partialUpdate={};if(utils_isFunction(assignment))partialUpdate=assignment(acc,_event.data,meta);else try{for(var _b=_tslib_values(Object.keys(assignment)),_c=_b.next();!_c.done;_c=_b.next()){var key=_c.value,propAssignment=assignment[key];partialUpdate[key]=utils_isFunction(propAssignment)?propAssignment(acc,_event.data,meta):propAssignment}}catch(e_7_1){e_7={error:e_7_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_7)throw e_7.error}}return Object.assign({},acc,partialUpdate)}),context):context;return updatedContext}var utils_warn=function(){};function isArray(value){return Array.isArray(value)}function utils_isFunction(value){return"function"==typeof value}function utils_isString(value){return"string"==typeof value}function toGuard(condition,guardMap){if(condition)return utils_isString(condition)?{type:DEFAULT_GUARD_TYPE,name:condition,predicate:guardMap?guardMap[condition]:void 0}:utils_isFunction(condition)?{type:DEFAULT_GUARD_TYPE,name:condition.name,predicate:condition}:condition}environment_IS_PRODUCTION||(utils_warn=function(condition,message){var error=condition instanceof Error?condition:void 0;if((error||!condition)&&void 0!==console){var args=["Warning: ".concat(message)];error&&args.push(error),console.warn.apply(console,args)}});var symbolObservable=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();(utils_a={})[symbolObservable]=function(){return this},utils_a[Symbol.observable]=function(){return this};function utils_isMachine(value){return!!value&&"__xstatenode"in value}function toEventObject(event,payload){return utils_isString(event)||"number"==typeof event?_assign({type:event},payload):event}function toSCXMLEvent(event,scxmlEvent){if(!utils_isString(event)&&"$$type"in event&&"scxml"===event.$$type)return event;var eventObject=toEventObject(event);return _assign({name:eventObject.type,data:eventObject,$$type:"scxml",type:"external"},scxmlEvent)}function toTransitionConfigArray(event,configLike){return toArrayStrict(configLike).map((function(transitionLike){return void 0===transitionLike||"string"==typeof transitionLike||utils_isMachine(transitionLike)?{target:transitionLike,event:event}:_assign(_assign({},transitionLike),{event:event})}))}function evaluateGuard(machine,guard,context,_event,state){var guards=machine.options.guards,guardMeta={state:state,cond:guard,_event:_event};if(guard.type===DEFAULT_GUARD_TYPE)return((null==guards?void 0:guards[guard.name])||guard.predicate)(context,_event.data,guardMeta);var condFn=null==guards?void 0:guards[guard.type];if(!condFn)throw new Error("Guard '".concat(guard.type,"' is not implemented on machine '").concat(machine.id,"'."));return condFn(context,_event.data,guardMeta)}function toInvokeSource(src){return"string"==typeof src?{type:src}:src}function toObserver(nextHandler,errorHandler,completionHandler){var noop=function(){},isObserver="object"===utils_typeof(nextHandler),self=isObserver?nextHandler:null;return{next:((isObserver?nextHandler.next:nextHandler)||noop).bind(self),error:((isObserver?nextHandler.error:errorHandler)||noop).bind(self),complete:((isObserver?nextHandler.complete:completionHandler)||noop).bind(self)}}function createInvokeId(stateNodeId,index){return"".concat(stateNodeId,":invocation[").concat(index,"]")}function isRaisableAction(action){return(action.type===raise||action.type===send&&action.to===types_SpecialTargets.Internal)&&"number"!=typeof action.delay}var isLeafNode=function(stateNode){return"atomic"===stateNode.type||"final"===stateNode.type};function getAllChildren(stateNode){return Object.keys(stateNode.states).map((function(key){return stateNode.states[key]}))}function getChildren(stateNode){return getAllChildren(stateNode).filter((function(sn){return"history"!==sn.type}))}function getAllStateNodes(stateNode){var stateNodes=[stateNode];return isLeafNode(stateNode)?stateNodes:stateNodes.concat(flatten(getChildren(stateNode).map(getAllStateNodes)))}function getConfiguration(prevStateNodes,stateNodes){var e_1,_a,e_2,_b,e_3,_c,e_4,_d,prevAdjList=getAdjList(new Set(prevStateNodes)),configuration=new Set(stateNodes);try{for(var configuration_1=_tslib_values(configuration),configuration_1_1=configuration_1.next();!configuration_1_1.done;configuration_1_1=configuration_1.next())for(var m=(s=configuration_1_1.value).parent;m&&!configuration.has(m);)configuration.add(m),m=m.parent}catch(e_1_1){e_1={error:e_1_1}}finally{try{configuration_1_1&&!configuration_1_1.done&&(_a=configuration_1.return)&&_a.call(configuration_1)}finally{if(e_1)throw e_1.error}}var adjList=getAdjList(configuration);try{for(var configuration_2=_tslib_values(configuration),configuration_2_1=configuration_2.next();!configuration_2_1.done;configuration_2_1=configuration_2.next()){if("compound"!==(s=configuration_2_1.value).type||adjList.get(s)&&adjList.get(s).length){if("parallel"===s.type)try{for(var _e=(e_3=void 0,_tslib_values(getChildren(s))),_f=_e.next();!_f.done;_f=_e.next()){var child=_f.value;configuration.has(child)||(configuration.add(child),prevAdjList.get(child)?prevAdjList.get(child).forEach((function(sn){return configuration.add(sn)})):child.initialStateNodes.forEach((function(sn){return configuration.add(sn)})))}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_f&&!_f.done&&(_c=_e.return)&&_c.call(_e)}finally{if(e_3)throw e_3.error}}}else prevAdjList.get(s)?prevAdjList.get(s).forEach((function(sn){return configuration.add(sn)})):s.initialStateNodes.forEach((function(sn){return configuration.add(sn)}))}}catch(e_2_1){e_2={error:e_2_1}}finally{try{configuration_2_1&&!configuration_2_1.done&&(_b=configuration_2.return)&&_b.call(configuration_2)}finally{if(e_2)throw e_2.error}}try{for(var configuration_3=_tslib_values(configuration),configuration_3_1=configuration_3.next();!configuration_3_1.done;configuration_3_1=configuration_3.next()){var s;for(m=(s=configuration_3_1.value).parent;m&&!configuration.has(m);)configuration.add(m),m=m.parent}}catch(e_4_1){e_4={error:e_4_1}}finally{try{configuration_3_1&&!configuration_3_1.done&&(_d=configuration_3.return)&&_d.call(configuration_3)}finally{if(e_4)throw e_4.error}}return configuration}function getValueFromAdj(baseNode,adjList){var childStateNodes=adjList.get(baseNode);if(!childStateNodes)return{};if("compound"===baseNode.type){var childStateNode=childStateNodes[0];if(!childStateNode)return{};if(isLeafNode(childStateNode))return childStateNode.key}var stateValue={};return childStateNodes.forEach((function(csn){stateValue[csn.key]=getValueFromAdj(csn,adjList)})),stateValue}function getAdjList(configuration){var e_5,_a,adjList=new Map;try{for(var configuration_4=_tslib_values(configuration),configuration_4_1=configuration_4.next();!configuration_4_1.done;configuration_4_1=configuration_4.next()){var s=configuration_4_1.value;adjList.has(s)||adjList.set(s,[]),s.parent&&(adjList.has(s.parent)||adjList.set(s.parent,[]),adjList.get(s.parent).push(s))}}catch(e_5_1){e_5={error:e_5_1}}finally{try{configuration_4_1&&!configuration_4_1.done&&(_a=configuration_4.return)&&_a.call(configuration_4)}finally{if(e_5)throw e_5.error}}return adjList}function getValue(rootNode,configuration){return getValueFromAdj(rootNode,getAdjList(getConfiguration([rootNode],configuration)))}function has(iterable,item){return Array.isArray(iterable)?iterable.some((function(member){return member===item})):iterable instanceof Set&&iterable.has(item)}function isInFinalState(configuration,stateNode){return"compound"===stateNode.type?getChildren(stateNode).some((function(s){return"final"===s.type&&has(configuration,s)})):"parallel"===stateNode.type&&getChildren(stateNode).every((function(sn){return isInFinalState(configuration,sn)}))}function getTagsFromConfiguration(configuration){return new Set(flatten(configuration.map((function(sn){return sn.tags}))))}var initEvent=toSCXMLEvent({type:init});function getActionFunction(actionType,actionFunctionMap){return actionFunctionMap&&actionFunctionMap[actionType]||void 0}function toActionObject(action,actionFunctionMap){var actionObject;if(utils_isString(action)||"number"==typeof action)actionObject=utils_isFunction(exec=getActionFunction(action,actionFunctionMap))?{type:action,exec:exec}:exec||{type:action,exec:void 0};else if(utils_isFunction(action))actionObject={type:action.name||action.toString(),exec:action};else{var exec;if(utils_isFunction(exec=getActionFunction(action.type,actionFunctionMap)))actionObject=_assign(_assign({},action),{exec:exec});else if(exec){var actionType=exec.type||action.type;actionObject=_assign(_assign(_assign({},exec),action),{type:actionType})}else actionObject=action}return actionObject}var toActionObjects=function(action,actionFunctionMap){return action?(isArray(action)?action:[action]).map((function(subAction){return toActionObject(subAction,actionFunctionMap)})):[]};function toActivityDefinition(action){var actionObject=toActionObject(action);return _assign(_assign({id:utils_isString(action)?action:actionObject.id},actionObject),{type:actionObject.type})}function actions_send(event,options){return{to:options?options.to:void 0,type:send,event:utils_isFunction(event)?event:toEventObject(event),delay:options?options.delay:void 0,id:options&&void 0!==options.id?options.id:utils_isFunction(event)?event.name:getEventType(event)}}function done(id,data){var type="".concat(types_ActionTypes.DoneState,".").concat(id),eventObject={type:type,data:data,toString:function(){return type}};return eventObject}function actions_doneInvoke(id,data){var type="".concat(types_ActionTypes.DoneInvoke,".").concat(id),eventObject={type:type,data:data,toString:function(){return type}};return eventObject}function actions_error(id,data){var type="".concat(types_ActionTypes.ErrorPlatform,".").concat(id),eventObject={type:type,data:data,toString:function(){return type}};return eventObject}function resolveActions(machine,currentState,currentContext,_event,actionBlocks,predictableExec,preserveActionOrder){void 0===preserveActionOrder&&(preserveActionOrder=!1);var assignActions=preserveActionOrder?[]:function(actionBlocks){var e_1,_a,assignActions=[];try{for(var actionBlocks_1=_tslib_values(actionBlocks),actionBlocks_1_1=actionBlocks_1.next();!actionBlocks_1_1.done;actionBlocks_1_1=actionBlocks_1.next())for(var block=actionBlocks_1_1.value,i=0;i<block.actions.length;)block.actions[i].type!==actionTypes_assign?i++:(assignActions.push(block.actions[i]),block.actions.splice(i,1))}catch(e_1_1){e_1={error:e_1_1}}finally{try{actionBlocks_1_1&&!actionBlocks_1_1.done&&(_a=actionBlocks_1.return)&&_a.call(actionBlocks_1)}finally{if(e_1)throw e_1.error}}return assignActions}(actionBlocks),updatedContext=assignActions.length?updateContext(currentContext,_event,assignActions,currentState):currentContext,preservedContexts=preserveActionOrder?[currentContext]:void 0,deferredToBlockEnd=[];function handleAction(blockType,actionObject){var _a;switch(actionObject.type){case raise:var raisedAction=function(action,ctx,_event,delaysMap){var resolvedDelay,meta={_event:_event},resolvedEvent=toSCXMLEvent(utils_isFunction(action.event)?action.event(ctx,_event.data,meta):action.event);if(utils_isString(action.delay)){var configDelay=delaysMap&&delaysMap[action.delay];resolvedDelay=utils_isFunction(configDelay)?configDelay(ctx,_event.data,meta):configDelay}else resolvedDelay=utils_isFunction(action.delay)?action.delay(ctx,_event.data,meta):action.delay;return _assign(_assign({},action),{type:raise,_event:resolvedEvent,delay:resolvedDelay})}(actionObject,updatedContext,_event,machine.options.delays);return predictableExec&&"number"==typeof raisedAction.delay&&predictableExec(raisedAction,updatedContext,_event),raisedAction;case send:var sendAction=function(action,ctx,_event,delaysMap){var resolvedDelay,meta={_event:_event},resolvedEvent=toSCXMLEvent(utils_isFunction(action.event)?action.event(ctx,_event.data,meta):action.event);if(utils_isString(action.delay)){var configDelay=delaysMap&&delaysMap[action.delay];resolvedDelay=utils_isFunction(configDelay)?configDelay(ctx,_event.data,meta):configDelay}else resolvedDelay=utils_isFunction(action.delay)?action.delay(ctx,_event.data,meta):action.delay;var resolvedTarget=utils_isFunction(action.to)?action.to(ctx,_event.data,meta):action.to;return _assign(_assign({},action),{to:resolvedTarget,_event:resolvedEvent,event:resolvedEvent.data,delay:resolvedDelay})}(actionObject,updatedContext,_event,machine.options.delays);if(!environment_IS_PRODUCTION){var configuredDelay=actionObject.delay;utils_warn(!utils_isString(configuredDelay)||"number"==typeof sendAction.delay,"No delay reference for delay expression '".concat(configuredDelay,"' was found on machine '").concat(machine.id,"'"))}return predictableExec&&sendAction.to!==types_SpecialTargets.Internal&&("entry"===blockType?deferredToBlockEnd.push(sendAction):predictableExec(sendAction,updatedContext,_event)),sendAction;case log:var resolved=function(action,ctx,_event){return _assign(_assign({},action),{value:utils_isString(action.expr)?action.expr:action.expr(ctx,_event.data,{_event:_event})})}(actionObject,updatedContext,_event);return null==predictableExec||predictableExec(resolved,updatedContext,_event),resolved;case choose:if(!(matchedActions=null===(_a=actionObject.conds.find((function(condition){var guard=toGuard(condition.cond,machine.options.guards);return!guard||evaluateGuard(machine,guard,updatedContext,_event,predictableExec?void 0:currentState)})))||void 0===_a?void 0:_a.actions))return[];var _b=_tslib_read(resolveActions(machine,currentState,updatedContext,_event,[{type:blockType,actions:toActionObjects(toArray(matchedActions),machine.options.actions)}],predictableExec,preserveActionOrder),2),resolvedActionsFromChoose=_b[0],resolvedContextFromChoose=_b[1];return updatedContext=resolvedContextFromChoose,null==preservedContexts||preservedContexts.push(updatedContext),resolvedActionsFromChoose;case pure:var matchedActions;if(!(matchedActions=actionObject.get(updatedContext,_event.data)))return[];var _c=_tslib_read(resolveActions(machine,currentState,updatedContext,_event,[{type:blockType,actions:toActionObjects(toArray(matchedActions),machine.options.actions)}],predictableExec,preserveActionOrder),2),resolvedActionsFromPure=_c[0],resolvedContext=_c[1];return updatedContext=resolvedContext,null==preservedContexts||preservedContexts.push(updatedContext),resolvedActionsFromPure;case stop:resolved=function(action,context,_event){var actorRefOrString=utils_isFunction(action.activity)?action.activity(context,_event.data):action.activity,resolvedActorRef="string"==typeof actorRefOrString?{id:actorRefOrString}:actorRefOrString;return{type:types_ActionTypes.Stop,activity:resolvedActorRef}}(actionObject,updatedContext,_event);return null==predictableExec||predictableExec(resolved,currentContext,_event),resolved;case actionTypes_assign:updatedContext=updateContext(updatedContext,_event,[actionObject],predictableExec?void 0:currentState),null==preservedContexts||preservedContexts.push(updatedContext);break;default:var resolvedActionObject=toActionObject(actionObject,machine.options.actions),exec_1=resolvedActionObject.exec;if(predictableExec)predictableExec(resolvedActionObject,updatedContext,_event);else if(exec_1&&preservedContexts){var contextIndex_1=preservedContexts.length-1,wrapped=_assign(_assign({},resolvedActionObject),{exec:function(_ctx){for(var args=[],_i=1;_i<arguments.length;_i++)args[_i-1]=arguments[_i];exec_1.apply(void 0,_tslib_spreadArray([preservedContexts[contextIndex_1]],_tslib_read(args),!1))}});resolvedActionObject=wrapped}return resolvedActionObject}}var resolvedActions=flatten(actionBlocks.map((function(block){var e_2,_a,resolvedActions=[];try{for(var _b=_tslib_values(block.actions),_c=_b.next();!_c.done;_c=_b.next()){var action=_c.value,resolved=handleAction(block.type,action);resolved&&(resolvedActions=resolvedActions.concat(resolved))}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_2)throw e_2.error}}return deferredToBlockEnd.forEach((function(action){predictableExec(action,updatedContext,_event)})),deferredToBlockEnd.length=0,resolvedActions})));return[resolvedActions,updatedContext]}function State_typeof(o){return State_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},State_typeof(o)}function stateValuesEqual(a,b){if(a===b)return!0;if(void 0===a||void 0===b)return!1;if(utils_isString(a)||utils_isString(b))return a===b;var aKeys=Object.keys(a),bKeys=Object.keys(b);return aKeys.length===bKeys.length&&aKeys.every((function(key){return stateValuesEqual(a[key],b[key])}))}function isStateConfig(state){return"object"===State_typeof(state)&&null!==state&&("value"in state&&"_event"in state)}var State=function(){function State(config){var _a,configuration,_this=this;this.actions=[],this.activities=EMPTY_ACTIVITY_MAP,this.meta={},this.events=[],this.value=config.value,this.context=config.context,this._event=config._event,this._sessionid=config._sessionid,this.event=this._event.data,this.historyValue=config.historyValue,this.history=config.history,this.actions=config.actions||[],this.activities=config.activities||EMPTY_ACTIVITY_MAP,this.meta=(void 0===(configuration=config.configuration)&&(configuration=[]),configuration.reduce((function(acc,stateNode){return void 0!==stateNode.meta&&(acc[stateNode.id]=stateNode.meta),acc}),{})),this.events=config.events||[],this.matches=this.matches.bind(this),this.toStrings=this.toStrings.bind(this),this.configuration=config.configuration,this.transitions=config.transitions,this.children=config.children,this.done=!!config.done,this.tags=null!==(_a=Array.isArray(config.tags)?new Set(config.tags):config.tags)&&void 0!==_a?_a:new Set,this.machine=config.machine,Object.defineProperty(this,"nextEvents",{get:function(){return function(configuration){return _tslib_spreadArray([],_tslib_read(new Set(flatten(_tslib_spreadArray([],_tslib_read(configuration.map((function(sn){return sn.ownEvents}))),!1)))),!1)}(_this.configuration)}})}return State.from=function(stateValue,context){return stateValue instanceof State?stateValue.context!==context?new State({value:stateValue.value,context:context,_event:stateValue._event,_sessionid:null,historyValue:stateValue.historyValue,history:stateValue.history,actions:[],activities:stateValue.activities,meta:{},events:[],configuration:[],transitions:[],children:{}}):stateValue:new State({value:stateValue,context:context,_event:initEvent,_sessionid:null,historyValue:void 0,history:void 0,actions:[],activities:void 0,meta:void 0,events:[],configuration:[],transitions:[],children:{}})},State.create=function(config){return new State(config)},State.inert=function(stateValue,context){if(stateValue instanceof State){if(!stateValue.actions.length)return stateValue;var _event=initEvent;return new State({value:stateValue.value,context:context,_event:_event,_sessionid:null,historyValue:stateValue.historyValue,history:stateValue.history,activities:stateValue.activities,configuration:stateValue.configuration,transitions:[],children:{}})}return State.from(stateValue,context)},State.prototype.toStrings=function(stateValue,delimiter){var _this=this;if(void 0===stateValue&&(stateValue=this.value),void 0===delimiter&&(delimiter="."),utils_isString(stateValue))return[stateValue];var valueKeys=Object.keys(stateValue);return valueKeys.concat.apply(valueKeys,_tslib_spreadArray([],_tslib_read(valueKeys.map((function(key){return _this.toStrings(stateValue[key],delimiter).map((function(s){return key+delimiter+s}))}))),!1))},State.prototype.toJSON=function(){var _a=this;_a.configuration,_a.transitions;var tags=_a.tags;_a.machine;var jsonValues=__rest(_a,["configuration","transitions","tags","machine"]);return _assign(_assign({},jsonValues),{tags:Array.from(tags)})},State.prototype.matches=function(parentStateValue){return matchesState(parentStateValue,this.value)},State.prototype.hasTag=function(tag){return this.tags.has(tag)},State.prototype.can=function(event){var _a;environment_IS_PRODUCTION&&utils_warn(!!this.machine,"state.can(...) used outside of a machine-created State object; this will always return false.");var transitionData=null===(_a=this.machine)||void 0===_a?void 0:_a.getTransitionData(this,event);return!!(null==transitionData?void 0:transitionData.transitions.length)&&transitionData.transitions.some((function(t){return void 0!==t.target||t.actions.length}))},State}(),defaultOptions={deferEvents:!1},Scheduler=function(){function Scheduler(options){this.processingEvent=!1,this.queue=[],this.initialized=!1,this.options=_assign(_assign({},defaultOptions),options)}return Scheduler.prototype.initialize=function(callback){if(this.initialized=!0,callback){if(!this.options.deferEvents)return void this.schedule(callback);this.process(callback)}this.flushEvents()},Scheduler.prototype.schedule=function(task){if(this.initialized&&!this.processingEvent){if(0!==this.queue.length)throw new Error("Event queue should be empty when it is not processing events");this.process(task),this.flushEvents()}else this.queue.push(task)},Scheduler.prototype.clear=function(){this.queue=[]},Scheduler.prototype.flushEvents=function(){for(var nextCallback=this.queue.shift();nextCallback;)this.process(nextCallback),nextCallback=this.queue.shift()},Scheduler.prototype.process=function(callback){this.processingEvent=!0;try{callback()}catch(e){throw this.clear(),e}finally{this.processingEvent=!1}},Scheduler}(),serviceStack=[],serviceScope_provide=function(service,fn){serviceStack.push(service);var result=fn(service);return serviceStack.pop(),result};function createNullActor(id){var _a;return(_a={id:id,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},getSnapshot:function(){},toJSON:function(){return{id:id}}})[symbolObservable]=function(){return this},_a}function Actor_createDeferredActor(entity,id,data){var tempActor=createNullActor(id);if(tempActor.deferred=!0,utils_isMachine(entity)){var initialState_1=tempActor.state=serviceScope_provide(void 0,(function(){return(data?entity.withContext(data):entity).initialState}));tempActor.getSnapshot=function(){return initialState_1}}return tempActor}var children=new Map,sessionIdIndex=0,registry_bookId=function(){return"x:".concat(sessionIdIndex++)},registry_register=function(id,actor){return children.set(id,actor),id},registry_get=function(id){return children.get(id)},registry_free=function(id){children.delete(id)};function getGlobal(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==__webpack_require__.g?__webpack_require__.g:void(environment_IS_PRODUCTION||console.warn("XState could not find a global object in this environment. Please let the maintainers know and raise an issue here: https://github.com/statelyai/xstate/issues"))}function registerService(service){if(getGlobal()){var devTools=function(){var global=getGlobal();if(global&&"__xstate__"in global)return global.__xstate__}();devTools&&devTools.register(service)}}function spawnBehavior(behavior,options){void 0===options&&(options={});var state=behavior.initialState,observers=new Set,mailbox=[],flushing=!1,actor=function(actorRefLike){var _a;return _assign(((_a={subscribe:function(){return{unsubscribe:function(){}}},id:"anonymous",getSnapshot:function(){}})[symbolObservable]=function(){return this},_a),actorRefLike)}({id:options.id,send:function(event){mailbox.push(event),function(){if(!flushing){for(flushing=!0;mailbox.length>0;){var event_1=mailbox.shift();state=behavior.transition(state,event_1,actorCtx),observers.forEach((function(observer){return observer.next(state)}))}flushing=!1}}()},getSnapshot:function(){return state},subscribe:function(next,handleError,complete){var observer=toObserver(next,handleError,complete);return observers.add(observer),observer.next(state),{unsubscribe:function(){observers.delete(observer)}}}}),actorCtx={parent:options.parent,self:actor,id:options.id||"anonymous",observers:observers};return state=behavior.start?behavior.start(actorCtx):state,actor}function interpreter_typeof(o){return interpreter_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},interpreter_typeof(o)}var InterpreterStatus,DEFAULT_SPAWN_OPTIONS={sync:!1,autoForward:!1};!function(InterpreterStatus){InterpreterStatus[InterpreterStatus.NotStarted=0]="NotStarted",InterpreterStatus[InterpreterStatus.Running=1]="Running",InterpreterStatus[InterpreterStatus.Stopped=2]="Stopped"}(InterpreterStatus||(InterpreterStatus={}));var Interpreter=function(){function Interpreter(machine,options){void 0===options&&(options=Interpreter.defaultOptions);var _this=this;this.machine=machine,this.delayedEventsMap={},this.listeners=new Set,this.contextListeners=new Set,this.stopListeners=new Set,this.doneListeners=new Set,this.eventListeners=new Set,this.sendListeners=new Set,this.initialized=!1,this.status=InterpreterStatus.NotStarted,this.children=new Map,this.forwardTo=new Set,this._outgoingQueue=[],this.init=this.start,this.send=function(event,payload){if(isArray(event))return _this.batch(event),_this.state;var _event=toSCXMLEvent(toEventObject(event,payload));if(_this.status===InterpreterStatus.Stopped)return environment_IS_PRODUCTION||utils_warn(!1,'Event "'.concat(_event.name,'" was sent to stopped service "').concat(_this.machine.id,'". This service has already reached its final state, and will not transition.\nEvent: ').concat(JSON.stringify(_event.data))),_this.state;if(_this.status!==InterpreterStatus.Running&&!_this.options.deferEvents)throw new Error('Event "'.concat(_event.name,'" was sent to uninitialized service "').concat(_this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.\nEvent: ').concat(JSON.stringify(_event.data)));return _this.scheduler.schedule((function(){_this.forward(_event);var nextState=_this._nextState(_event);_this.update(nextState,_event)})),_this._state},this.sendTo=function(event,to,immediate){var value,isParent=_this.parent&&(to===types_SpecialTargets.Parent||_this.parent.id===to),target=isParent?_this.parent:utils_isString(to)?to===types_SpecialTargets.Internal?_this:_this.children.get(to)||registry_get(to):(value=to)&&"function"==typeof value.send?to:void 0;if(target)if("machine"in target){if(_this.status!==InterpreterStatus.Stopped||_this.parent!==target||_this.state.done){var scxmlEvent=_assign(_assign({},event),{name:event.name===actionTypes_error?"".concat(actions_error(_this.id)):event.name,origin:_this.sessionId});!immediate&&_this.machine.config.predictableActionArguments?_this._outgoingQueue.push([target,scxmlEvent]):target.send(scxmlEvent)}}else!immediate&&_this.machine.config.predictableActionArguments?_this._outgoingQueue.push([target,event.data]):target.send(event.data);else{if(!isParent)throw new Error("Unable to send event to child '".concat(to,"' from service '").concat(_this.id,"'."));environment_IS_PRODUCTION||utils_warn(!1,"Service '".concat(_this.id,"' has no parent: unable to send event ").concat(event.type))}},this._exec=function(action,context,_event,actionFunctionMap){void 0===actionFunctionMap&&(actionFunctionMap=_this.machine.options.actions);var actionOrExec=action.exec||getActionFunction(action.type,actionFunctionMap),exec=utils_isFunction(actionOrExec)?actionOrExec:actionOrExec?actionOrExec.exec:action.exec;if(exec)try{return exec(context,_event.data,_this.machine.config.predictableActionArguments?{action:action,_event:_event}:{action:action,state:_this.state,_event:_event})}catch(err){throw _this.parent&&_this.parent.send({type:"xstate.error",data:err}),err}switch(action.type){case raise:var sendAction_1=action;_this.defer(sendAction_1);break;case send:var sendAction=action;if("number"==typeof sendAction.delay)return void _this.defer(sendAction);sendAction.to?_this.sendTo(sendAction._event,sendAction.to,_event===initEvent):_this.send(sendAction._event);break;case actionTypes_cancel:_this.cancel(action.sendId);break;case start:if(_this.status!==InterpreterStatus.Running)return;var activity=action.activity;if(!_this.machine.config.predictableActionArguments&&!_this.state.activities[activity.id||activity.type])break;if(activity.type===types_ActionTypes.Invoke){var invokeSource=toInvokeSource(activity.src),serviceCreator=_this.machine.options.services?_this.machine.options.services[invokeSource.type]:void 0,id=activity.id,data=activity.data;environment_IS_PRODUCTION||utils_warn(!("forward"in activity),"`forward` property is deprecated (found in invocation of '".concat(activity.src,"' in in machine '").concat(_this.machine.id,"'). ")+"Please use `autoForward` instead.");var autoForward="autoForward"in activity?activity.autoForward:!!activity.forward;if(!serviceCreator)return void(environment_IS_PRODUCTION||utils_warn(!1,"No service found for invocation '".concat(activity.src,"' in machine '").concat(_this.machine.id,"'.")));var resolvedData=data?mapContext(data,context,_event):void 0;if("string"==typeof serviceCreator)return;var source=utils_isFunction(serviceCreator)?serviceCreator(context,_event.data,{data:resolvedData,src:invokeSource,meta:activity.meta}):serviceCreator;if(!source)return;var options=void 0;utils_isMachine(source)&&(source=resolvedData?source.withContext(resolvedData):source,options={autoForward:autoForward}),_this.spawn(source,id,options)}else _this.spawnActivity(activity);break;case stop:_this.stopChild(action.activity.id);break;case log:var _a=action,label=_a.label,value=_a.value;label?_this.logger(label,value):_this.logger(value);break;default:environment_IS_PRODUCTION||utils_warn(!1,"No implementation found for action type '".concat(action.type,"'"))}};var resolvedOptions=_assign(_assign({},Interpreter.defaultOptions),options),clock=resolvedOptions.clock,logger=resolvedOptions.logger,parent=resolvedOptions.parent,id=resolvedOptions.id,resolvedId=void 0!==id?id:machine.id;this.id=resolvedId,this.logger=logger,this.clock=clock,this.parent=parent,this.options=resolvedOptions,this.scheduler=new Scheduler({deferEvents:this.options.deferEvents}),this.sessionId=registry_bookId()}return Object.defineProperty(Interpreter.prototype,"initialState",{get:function(){var _this=this;return this._initialState?this._initialState:serviceScope_provide(this,(function(){return _this._initialState=_this.machine.initialState,_this._initialState}))},enumerable:!1,configurable:!0}),Object.defineProperty(Interpreter.prototype,"state",{get:function(){return environment_IS_PRODUCTION||utils_warn(this.status!==InterpreterStatus.NotStarted,"Attempted to read state from uninitialized service '".concat(this.id,"'. Make sure the service is started first.")),this._state},enumerable:!1,configurable:!0}),Interpreter.prototype.execute=function(state,actionsConfig){var e_1,_a;try{for(var _b=_tslib_values(state.actions),_c=_b.next();!_c.done;_c=_b.next()){var action=_c.value;this.exec(action,state,actionsConfig)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}},Interpreter.prototype.update=function(state,_event){var e_2,_a,e_3,_b,e_4,_c,e_5,_d,_this=this;if(state._sessionid=this.sessionId,this._state=state,this.machine.config.predictableActionArguments&&_event!==initEvent||!this.options.execute)for(var item=void 0;item=this._outgoingQueue.shift();)item[0].send(item[1]);else this.execute(this.state);if(this.children.forEach((function(child){_this.state.children[child.id]=child})),this.devTools&&this.devTools.send(_event.data,state),state.event)try{for(var _e=_tslib_values(this.eventListeners),_f=_e.next();!_f.done;_f=_e.next()){(0,_f.value)(state.event)}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_f&&!_f.done&&(_a=_e.return)&&_a.call(_e)}finally{if(e_2)throw e_2.error}}try{for(var _g=_tslib_values(this.listeners),_h=_g.next();!_h.done;_h=_g.next()){(0,_h.value)(state,state.event)}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_h&&!_h.done&&(_b=_g.return)&&_b.call(_g)}finally{if(e_3)throw e_3.error}}try{for(var _j=_tslib_values(this.contextListeners),_k=_j.next();!_k.done;_k=_j.next()){(0,_k.value)(this.state.context,this.state.history?this.state.history.context:void 0)}}catch(e_4_1){e_4={error:e_4_1}}finally{try{_k&&!_k.done&&(_c=_j.return)&&_c.call(_j)}finally{if(e_4)throw e_4.error}}if(this.state.done){var finalChildStateNode=state.configuration.find((function(sn){return"final"===sn.type&&sn.parent===_this.machine})),doneData=finalChildStateNode&&finalChildStateNode.doneData?mapContext(finalChildStateNode.doneData,state.context,_event):void 0;this._doneEvent=actions_doneInvoke(this.id,doneData);try{for(var _l=_tslib_values(this.doneListeners),_m=_l.next();!_m.done;_m=_l.next()){(0,_m.value)(this._doneEvent)}}catch(e_5_1){e_5={error:e_5_1}}finally{try{_m&&!_m.done&&(_d=_l.return)&&_d.call(_l)}finally{if(e_5)throw e_5.error}}this._stop(),this._stopChildren(),registry_free(this.sessionId)}},Interpreter.prototype.onTransition=function(listener){return this.listeners.add(listener),this.status===InterpreterStatus.Running&&listener(this.state,this.state.event),this},Interpreter.prototype.subscribe=function(nextListenerOrObserver,_,completeListener){var _this=this,observer=toObserver(nextListenerOrObserver,_,completeListener);this.listeners.add(observer.next),this.status!==InterpreterStatus.NotStarted&&observer.next(this.state);var completeOnce=function completeOnce(){_this.doneListeners.delete(completeOnce),_this.stopListeners.delete(completeOnce),observer.complete()};return this.status===InterpreterStatus.Stopped?observer.complete():(this.onDone(completeOnce),this.onStop(completeOnce)),{unsubscribe:function(){_this.listeners.delete(observer.next),_this.doneListeners.delete(completeOnce),_this.stopListeners.delete(completeOnce)}}},Interpreter.prototype.onEvent=function(listener){return this.eventListeners.add(listener),this},Interpreter.prototype.onSend=function(listener){return this.sendListeners.add(listener),this},Interpreter.prototype.onChange=function(listener){return this.contextListeners.add(listener),this},Interpreter.prototype.onStop=function(listener){return this.stopListeners.add(listener),this},Interpreter.prototype.onDone=function(listener){return this.status===InterpreterStatus.Stopped&&this._doneEvent?listener(this._doneEvent):this.doneListeners.add(listener),this},Interpreter.prototype.off=function(listener){return this.listeners.delete(listener),this.eventListeners.delete(listener),this.sendListeners.delete(listener),this.stopListeners.delete(listener),this.doneListeners.delete(listener),this.contextListeners.delete(listener),this},Interpreter.prototype.start=function(initialState){var _this=this;if(this.status===InterpreterStatus.Running)return this;this.machine._init(),registry_register(this.sessionId,this),this.initialized=!0,this.status=InterpreterStatus.Running;var resolvedState=void 0===initialState?this.initialState:serviceScope_provide(this,(function(){return isStateConfig(initialState)?_this.machine.resolveState(initialState):_this.machine.resolveState(State.from(initialState,_this.machine.context))}));return this.options.devTools&&this.attachDev(),this.scheduler.initialize((function(){_this.update(resolvedState,initEvent)})),this},Interpreter.prototype._stopChildren=function(){this.children.forEach((function(child){utils_isFunction(child.stop)&&child.stop()})),this.children.clear()},Interpreter.prototype._stop=function(){var e_6,_a,e_7,_b,e_8,_c,e_9,_d,e_10,_e;try{for(var _f=_tslib_values(this.listeners),_g=_f.next();!_g.done;_g=_f.next()){var listener=_g.value;this.listeners.delete(listener)}}catch(e_6_1){e_6={error:e_6_1}}finally{try{_g&&!_g.done&&(_a=_f.return)&&_a.call(_f)}finally{if(e_6)throw e_6.error}}try{for(var _h=_tslib_values(this.stopListeners),_j=_h.next();!_j.done;_j=_h.next()){(listener=_j.value)(),this.stopListeners.delete(listener)}}catch(e_7_1){e_7={error:e_7_1}}finally{try{_j&&!_j.done&&(_b=_h.return)&&_b.call(_h)}finally{if(e_7)throw e_7.error}}try{for(var _k=_tslib_values(this.contextListeners),_l=_k.next();!_l.done;_l=_k.next()){listener=_l.value;this.contextListeners.delete(listener)}}catch(e_8_1){e_8={error:e_8_1}}finally{try{_l&&!_l.done&&(_c=_k.return)&&_c.call(_k)}finally{if(e_8)throw e_8.error}}try{for(var _m=_tslib_values(this.doneListeners),_o=_m.next();!_o.done;_o=_m.next()){listener=_o.value;this.doneListeners.delete(listener)}}catch(e_9_1){e_9={error:e_9_1}}finally{try{_o&&!_o.done&&(_d=_m.return)&&_d.call(_m)}finally{if(e_9)throw e_9.error}}if(!this.initialized)return this;this.initialized=!1,this.status=InterpreterStatus.Stopped,this._initialState=void 0;try{for(var _p=_tslib_values(Object.keys(this.delayedEventsMap)),_q=_p.next();!_q.done;_q=_p.next()){var key=_q.value;this.clock.clearTimeout(this.delayedEventsMap[key])}}catch(e_10_1){e_10={error:e_10_1}}finally{try{_q&&!_q.done&&(_e=_p.return)&&_e.call(_p)}finally{if(e_10)throw e_10.error}}this.scheduler.clear(),this.scheduler=new Scheduler({deferEvents:this.options.deferEvents})},Interpreter.prototype.stop=function(){var _this=this,scheduler=this.scheduler;return this._stop(),scheduler.schedule((function(){var _a;if(!(null===(_a=_this._state)||void 0===_a?void 0:_a.done)){var _event=toSCXMLEvent({type:"xstate.stop"}),nextState=serviceScope_provide(_this,(function(){var exitActions=flatten(_tslib_spreadArray([],_tslib_read(_this.state.configuration),!1).sort((function(a,b){return b.order-a.order})).map((function(stateNode){return toActionObjects(stateNode.onExit,_this.machine.options.actions)}))),_a=_tslib_read(resolveActions(_this.machine,_this.state,_this.state.context,_event,[{type:"exit",actions:exitActions}],_this.machine.config.predictableActionArguments?_this._exec:void 0,_this.machine.config.predictableActionArguments||_this.machine.config.preserveActionOrder),2),resolvedActions=_a[0],updatedContext=_a[1],newState=new State({value:_this.state.value,context:updatedContext,_event:_event,_sessionid:_this.sessionId,historyValue:void 0,history:_this.state,actions:resolvedActions.filter((function(action){return!isRaisableAction(action)})),activities:{},events:[],configuration:[],transitions:[],children:{},done:_this.state.done,tags:_this.state.tags,machine:_this.machine});return newState.changed=!0,newState}));_this.update(nextState,_event),_this._stopChildren(),registry_free(_this.sessionId)}})),this},Interpreter.prototype.batch=function(events){var _this=this;if(this.status===InterpreterStatus.NotStarted&&this.options.deferEvents)environment_IS_PRODUCTION||utils_warn(!1,"".concat(events.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'" and are deferred. Make sure .start() is called for this service.\nEvent: ').concat(JSON.stringify(event)));else if(this.status!==InterpreterStatus.Running)throw new Error("".concat(events.length,' event(s) were sent to uninitialized service "').concat(this.machine.id,'". Make sure .start() is called for this service, or set { deferEvents: true } in the service options.'));if(events.length){var exec=!!this.machine.config.predictableActionArguments&&this._exec;this.scheduler.schedule((function(){var e_11,_a,nextState=_this.state,batchChanged=!1,batchedActions=[],_loop_1=function(event_1){var _event=toSCXMLEvent(event_1);_this.forward(_event),nextState=serviceScope_provide(_this,(function(){return _this.machine.transition(nextState,_event,void 0,exec||void 0)})),batchedActions.push.apply(batchedActions,_tslib_spreadArray([],_tslib_read(_this.machine.config.predictableActionArguments?nextState.actions:nextState.actions.map((function(a){return function(action,state){var exec=action.exec;return _assign(_assign({},action),{exec:void 0!==exec?function(){return exec(state.context,state.event,{action:action,state:state,_event:state._event})}:void 0})}(a,nextState)}))),!1)),batchChanged=batchChanged||!!nextState.changed};try{for(var events_1=_tslib_values(events),events_1_1=events_1.next();!events_1_1.done;events_1_1=events_1.next()){_loop_1(events_1_1.value)}}catch(e_11_1){e_11={error:e_11_1}}finally{try{events_1_1&&!events_1_1.done&&(_a=events_1.return)&&_a.call(events_1)}finally{if(e_11)throw e_11.error}}nextState.changed=batchChanged,nextState.actions=batchedActions,_this.update(nextState,toSCXMLEvent(events[events.length-1]))}))}},Interpreter.prototype.sender=function(event){return this.send.bind(this,event)},Interpreter.prototype._nextState=function(event,exec){var _this=this;void 0===exec&&(exec=!!this.machine.config.predictableActionArguments&&this._exec);var _event=toSCXMLEvent(event);if(0===_event.name.indexOf(errorPlatform)&&!this.state.nextEvents.some((function(nextEvent){return 0===nextEvent.indexOf(errorPlatform)})))throw _event.data.data;return serviceScope_provide(this,(function(){return _this.machine.transition(_this.state,_event,void 0,exec||void 0)}))},Interpreter.prototype.nextState=function(event){return this._nextState(event,!1)},Interpreter.prototype.forward=function(event){var e_12,_a;try{for(var _b=_tslib_values(this.forwardTo),_c=_b.next();!_c.done;_c=_b.next()){var id=_c.value,child=this.children.get(id);if(!child)throw new Error("Unable to forward event '".concat(event,"' from interpreter '").concat(this.id,"' to nonexistant child '").concat(id,"'."));child.send(event)}}catch(e_12_1){e_12={error:e_12_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_12)throw e_12.error}}},Interpreter.prototype.defer=function(sendAction){var _this=this,timerId=this.clock.setTimeout((function(){"to"in sendAction&&sendAction.to?_this.sendTo(sendAction._event,sendAction.to,!0):_this.send(sendAction._event)}),sendAction.delay);sendAction.id&&(this.delayedEventsMap[sendAction.id]=timerId)},Interpreter.prototype.cancel=function(sendId){this.clock.clearTimeout(this.delayedEventsMap[sendId]),delete this.delayedEventsMap[sendId]},Interpreter.prototype.exec=function(action,state,actionFunctionMap){void 0===actionFunctionMap&&(actionFunctionMap=this.machine.options.actions),this._exec(action,state.context,state._event,actionFunctionMap)},Interpreter.prototype.removeChild=function(childId){var _a;this.children.delete(childId),this.forwardTo.delete(childId),null===(_a=this.state)||void 0===_a||delete _a.children[childId]},Interpreter.prototype.stopChild=function(childId){var child=this.children.get(childId);child&&(this.removeChild(childId),utils_isFunction(child.stop)&&child.stop())},Interpreter.prototype.spawn=function(entity,name,options){if(this.status!==InterpreterStatus.Running)return Actor_createDeferredActor(entity,name);if(isPromiseLike(entity))return this.spawnPromise(Promise.resolve(entity),name);if(utils_isFunction(entity))return this.spawnCallback(entity,name);if(function(item){try{return"function"==typeof item.send}catch(e){return!1}}(item=entity)&&"id"in item)return this.spawnActor(entity,name);if(function(value){try{return"subscribe"in value&&utils_isFunction(value.subscribe)}catch(e){return!1}}(entity))return this.spawnObservable(entity,name);if(utils_isMachine(entity))return this.spawnMachine(entity,_assign(_assign({},options),{id:name}));if(null!==(value=entity)&&"object"===utils_typeof(value)&&"transition"in value&&"function"==typeof value.transition)return this.spawnBehavior(entity,name);throw new Error('Unable to spawn entity "'.concat(name,'" of type "').concat(interpreter_typeof(entity),'".'));var value,item},Interpreter.prototype.spawnMachine=function(machine,options){var _this=this;void 0===options&&(options={});var childService=new Interpreter(machine,_assign(_assign({},this.options),{parent:this,id:options.id||machine.id})),resolvedOptions=_assign(_assign({},DEFAULT_SPAWN_OPTIONS),options);resolvedOptions.sync&&childService.onTransition((function(state){_this.send(actionTypes_update,{state:state,id:childService.id})}));var actor=childService;return this.children.set(childService.id,actor),resolvedOptions.autoForward&&this.forwardTo.add(childService.id),childService.onDone((function(doneEvent){_this.removeChild(childService.id),_this.send(toSCXMLEvent(doneEvent,{origin:childService.id}))})).start(),actor},Interpreter.prototype.spawnBehavior=function(behavior,id){var actorRef=spawnBehavior(behavior,{id:id,parent:this});return this.children.set(id,actorRef),actorRef},Interpreter.prototype.spawnPromise=function(promise,id){var _a,resolvedData,_this=this,canceled=!1;promise.then((function(response){canceled||(resolvedData=response,_this.removeChild(id),_this.send(toSCXMLEvent(actions_doneInvoke(id,response),{origin:id})))}),(function(errorData){if(!canceled){_this.removeChild(id);var errorEvent=actions_error(id,errorData);try{_this.send(toSCXMLEvent(errorEvent,{origin:id}))}catch(error){!function(originalError,currentError,id){if(!environment_IS_PRODUCTION){var originalStackTrace=originalError.stack?" Stacktrace was '".concat(originalError.stack,"'"):"";if(originalError===currentError)console.error("Missing onError handler for invocation '".concat(id,"', error was '").concat(originalError,"'.").concat(originalStackTrace));else{var stackTrace=currentError.stack?" Stacktrace was '".concat(currentError.stack,"'"):"";console.error("Missing onError handler and/or unhandled exception/promise rejection for invocation '".concat(id,"'. ")+"Original error: '".concat(originalError,"'. ").concat(originalStackTrace," Current error is '").concat(currentError,"'.").concat(stackTrace))}}}(errorData,error,id),_this.devTools&&_this.devTools.send(errorEvent,_this.state),_this.machine.strict&&_this.stop()}}}));var actor=((_a={id:id,send:function(){},subscribe:function(next,handleError,complete){var observer=toObserver(next,handleError,complete),unsubscribed=!1;return promise.then((function(response){unsubscribed||(observer.next(response),unsubscribed||observer.complete())}),(function(err){unsubscribed||observer.error(err)})),{unsubscribe:function(){return unsubscribed=!0}}},stop:function(){canceled=!0},toJSON:function(){return{id:id}},getSnapshot:function(){return resolvedData}})[symbolObservable]=function(){return this},_a);return this.children.set(id,actor),actor},Interpreter.prototype.spawnCallback=function(callback,id){var _a,emitted,callbackStop,_this=this,canceled=!1,receivers=new Set,listeners=new Set;try{callbackStop=callback((function(e){emitted=e,listeners.forEach((function(listener){return listener(e)})),canceled||_this.send(toSCXMLEvent(e,{origin:id}))}),(function(newListener){receivers.add(newListener)}))}catch(err){this.send(actions_error(id,err))}if(isPromiseLike(callbackStop))return this.spawnPromise(callbackStop,id);var actor=((_a={id:id,send:function(event){return receivers.forEach((function(receiver){return receiver(event)}))},subscribe:function(next){var observer=toObserver(next);return listeners.add(observer.next),{unsubscribe:function(){listeners.delete(observer.next)}}},stop:function(){canceled=!0,utils_isFunction(callbackStop)&&callbackStop()},toJSON:function(){return{id:id}},getSnapshot:function(){return emitted}})[symbolObservable]=function(){return this},_a);return this.children.set(id,actor),actor},Interpreter.prototype.spawnObservable=function(source,id){var _a,emitted,_this=this,subscription=source.subscribe((function(value){emitted=value,_this.send(toSCXMLEvent(value,{origin:id}))}),(function(err){_this.removeChild(id),_this.send(toSCXMLEvent(actions_error(id,err),{origin:id}))}),(function(){_this.removeChild(id),_this.send(toSCXMLEvent(actions_doneInvoke(id),{origin:id}))})),actor=((_a={id:id,send:function(){},subscribe:function(next,handleError,complete){return source.subscribe(next,handleError,complete)},stop:function(){return subscription.unsubscribe()},getSnapshot:function(){return emitted},toJSON:function(){return{id:id}}})[symbolObservable]=function(){return this},_a);return this.children.set(id,actor),actor},Interpreter.prototype.spawnActor=function(actor,name){return this.children.set(name,actor),actor},Interpreter.prototype.spawnActivity=function(activity){var implementation=this.machine.options&&this.machine.options.activities?this.machine.options.activities[activity.type]:void 0;if(implementation){var dispose=implementation(this.state.context,activity);this.spawnEffect(activity.id,dispose)}else environment_IS_PRODUCTION||utils_warn(!1,"No implementation found for activity '".concat(activity.type,"'"))},Interpreter.prototype.spawnEffect=function(id,dispose){var _a;this.children.set(id,((_a={id:id,send:function(){},subscribe:function(){return{unsubscribe:function(){}}},stop:dispose||void 0,getSnapshot:function(){},toJSON:function(){return{id:id}}})[symbolObservable]=function(){return this},_a))},Interpreter.prototype.attachDev=function(){var global=getGlobal();if(this.options.devTools&&global){if(global.__REDUX_DEVTOOLS_EXTENSION__){var devToolsOptions="object"===interpreter_typeof(this.options.devTools)?this.options.devTools:void 0;this.devTools=global.__REDUX_DEVTOOLS_EXTENSION__.connect(_assign(_assign({name:this.id,autoPause:!0,stateSanitizer:function(state){return{value:state.value,context:state.context,actions:state.actions}}},devToolsOptions),{features:_assign({jump:!1,skip:!1},devToolsOptions?devToolsOptions.features:void 0)}),this.machine),this.devTools.init(this.state)}registerService(this)}},Interpreter.prototype.toJSON=function(){return{id:this.id}},Interpreter.prototype[symbolObservable]=function(){return this},Interpreter.prototype.getSnapshot=function(){return this.status===InterpreterStatus.NotStarted?this.initialState:this._state},Interpreter.defaultOptions={execute:!0,deferEvents:!0,clock:{setTimeout:function(_setTimeout){function setTimeout(_x,_x2){return _setTimeout.apply(this,arguments)}return setTimeout.toString=function(){return _setTimeout.toString()},setTimeout}((function(fn,ms){return setTimeout(fn,ms)})),clearTimeout:function(_clearTimeout){function clearTimeout(_x3){return _clearTimeout.apply(this,arguments)}return clearTimeout.toString=function(){return _clearTimeout.toString()},clearTimeout}((function(id){return clearTimeout(id)}))},logger:console.log.bind(console),devTools:!1},Interpreter.interpret=interpret,Interpreter}();function interpret(machine,options){return new Interpreter(machine,options)}var es_assign=function(assignment){return{type:actionTypes_assign,assignment:assignment}},es_send=actions_send;function invokeUtils_toInvokeSource(src){if("string"==typeof src){var simpleSrc={type:src,toString:function(){return src}};return simpleSrc}return src}function toInvokeDefinition(invokeConfig){return _assign(_assign({type:actionTypes_invoke},invokeConfig),{toJSON:function(){invokeConfig.onDone,invokeConfig.onError;var invokeDef=__rest(invokeConfig,["onDone","onError"]);return _assign(_assign({},invokeDef),{type:actionTypes_invoke,src:invokeUtils_toInvokeSource(invokeConfig.src)})}})}function StateNode_typeof(o){return StateNode_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},StateNode_typeof(o)}var EMPTY_OBJECT={},isStateId=function(str){return"#"===str[0]},StateNode_StateNode=function(){function StateNode(config,options,_context,_stateInfo){void 0===_context&&(_context="context"in config?config.context:void 0);var _a,_this=this;this.config=config,this._context=_context,this.order=-1,this.__xstatenode=!0,this.__cache={events:void 0,relativeValue:new Map,initialStateValue:void 0,initialState:void 0,on:void 0,transitions:void 0,candidates:{},delayedTransitions:void 0},this.idMap={},this.tags=[],this.options=Object.assign({actions:{},guards:{},services:{},activities:{},delays:{}},options),this.parent=null==_stateInfo?void 0:_stateInfo.parent,this.key=this.config.key||(null==_stateInfo?void 0:_stateInfo.key)||this.config.id||"(machine)",this.machine=this.parent?this.parent.machine:this,this.path=this.parent?this.parent.path.concat(this.key):[],this.delimiter=this.config.delimiter||(this.parent?this.parent.delimiter:"."),this.id=this.config.id||_tslib_spreadArray([this.machine.key],_tslib_read(this.path),!1).join(this.delimiter),this.version=this.parent?this.parent.version:this.config.version,this.type=this.config.type||(this.config.parallel?"parallel":this.config.states&&Object.keys(this.config.states).length?"compound":this.config.history?"history":"atomic"),this.schema=this.parent?this.machine.schema:null!==(_a=this.config.schema)&&void 0!==_a?_a:{},this.description=this.config.description,environment_IS_PRODUCTION||utils_warn(!("parallel"in this.config),'The "parallel" property is deprecated and will be removed in version 4.1. '.concat(this.config.parallel?"Replace with `type: 'parallel'`":"Use `type: '".concat(this.type,"'`")," in the config for state node '").concat(this.id,"' instead.")),this.initial=this.config.initial,this.states=this.config.states?mapValues(this.config.states,(function(stateConfig,key){var _a,stateNode=new StateNode(stateConfig,{},void 0,{parent:_this,key:key});return Object.assign(_this.idMap,_assign(((_a={})[stateNode.id]=stateNode,_a),stateNode.idMap)),stateNode})):EMPTY_OBJECT;var order=0;!function dfs(stateNode){var e_1,_a;stateNode.order=order++;try{for(var _b=_tslib_values(getAllChildren(stateNode)),_c=_b.next();!_c.done;_c=_b.next()){dfs(_c.value)}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}}(this),this.history=!0===this.config.history?"shallow":this.config.history||!1,this._transient=!!this.config.always||!!this.config.on&&(Array.isArray(this.config.on)?this.config.on.some((function(_a){return""===_a.event})):""in this.config.on),this.strict=!!this.config.strict,this.onEntry=toArray(this.config.entry||this.config.onEntry).map((function(action){return toActionObject(action)})),this.onExit=toArray(this.config.exit||this.config.onExit).map((function(action){return toActionObject(action)})),this.meta=this.config.meta,this.doneData="final"===this.type?this.config.data:void 0,this.invoke=toArray(this.config.invoke).map((function(invokeConfig,i){var _a,_b;if(utils_isMachine(invokeConfig)){var invokeId=createInvokeId(_this.id,i);return _this.machine.options.services=_assign(((_a={})[invokeId]=invokeConfig,_a),_this.machine.options.services),toInvokeDefinition({src:invokeId,id:invokeId})}if(utils_isString(invokeConfig.src)){invokeId=invokeConfig.id||createInvokeId(_this.id,i);return toInvokeDefinition(_assign(_assign({},invokeConfig),{id:invokeId,src:invokeConfig.src}))}if(utils_isMachine(invokeConfig.src)||utils_isFunction(invokeConfig.src)){invokeId=invokeConfig.id||createInvokeId(_this.id,i);return _this.machine.options.services=_assign(((_b={})[invokeId]=invokeConfig.src,_b),_this.machine.options.services),toInvokeDefinition(_assign(_assign({id:invokeId},invokeConfig),{src:invokeId}))}var invokeSource=invokeConfig.src;return toInvokeDefinition(_assign(_assign({id:createInvokeId(_this.id,i)},invokeConfig),{src:invokeSource}))})),this.activities=toArray(this.config.activities).concat(this.invoke).map((function(activity){return toActivityDefinition(activity)})),this.transition=this.transition.bind(this),this.tags=toArray(this.config.tags)}return StateNode.prototype._init=function(){this.__cache.transitions||getAllStateNodes(this).forEach((function(stateNode){return stateNode.on}))},StateNode.prototype.withConfig=function(options,context){var _a=this.options,actions=_a.actions,activities=_a.activities,guards=_a.guards,services=_a.services,delays=_a.delays;return new StateNode(this.config,{actions:_assign(_assign({},actions),options.actions),activities:_assign(_assign({},activities),options.activities),guards:_assign(_assign({},guards),options.guards),services:_assign(_assign({},services),options.services),delays:_assign(_assign({},delays),options.delays)},null!=context?context:this.context)},StateNode.prototype.withContext=function(context){return new StateNode(this.config,this.options,context)},Object.defineProperty(StateNode.prototype,"context",{get:function(){return utils_isFunction(this._context)?this._context():this._context},enumerable:!1,configurable:!0}),Object.defineProperty(StateNode.prototype,"definition",{get:function(){return{id:this.id,key:this.key,version:this.version,context:this.context,type:this.type,initial:this.initial,history:this.history,states:mapValues(this.states,(function(state){return state.definition})),on:this.on,transitions:this.transitions,entry:this.onEntry,exit:this.onExit,activities:this.activities||[],meta:this.meta,order:this.order||-1,data:this.doneData,invoke:this.invoke,description:this.description,tags:this.tags}},enumerable:!1,configurable:!0}),StateNode.prototype.toJSON=function(){return this.definition},Object.defineProperty(StateNode.prototype,"on",{get:function(){if(this.__cache.on)return this.__cache.on;var transitions=this.transitions;return this.__cache.on=transitions.reduce((function(map,transition){return map[transition.eventType]=map[transition.eventType]||[],map[transition.eventType].push(transition),map}),{})},enumerable:!1,configurable:!0}),Object.defineProperty(StateNode.prototype,"after",{get:function(){return this.__cache.delayedTransitions||(this.__cache.delayedTransitions=this.getDelayedTransitions(),this.__cache.delayedTransitions)},enumerable:!1,configurable:!0}),Object.defineProperty(StateNode.prototype,"transitions",{get:function(){return this.__cache.transitions||(this.__cache.transitions=this.formatTransitions(),this.__cache.transitions)},enumerable:!1,configurable:!0}),StateNode.prototype.getCandidates=function(eventName){if(this.__cache.candidates[eventName])return this.__cache.candidates[eventName];var transient=""===eventName,candidates=this.transitions.filter((function(transition){var sameEventType=transition.eventType===eventName;return transient?sameEventType:sameEventType||"*"===transition.eventType}));return this.__cache.candidates[eventName]=candidates,candidates},StateNode.prototype.getDelayedTransitions=function(){var _this=this,afterConfig=this.config.after;if(!afterConfig)return[];var mutateEntryExit=function(delay,i){var eventType=function(delayRef,id){var idSuffix=id?"#".concat(id):"";return"".concat(types_ActionTypes.After,"(").concat(delayRef,")").concat(idSuffix)}(utils_isFunction(delay)?"".concat(_this.id,":delay[").concat(i,"]"):delay,_this.id);return _this.onEntry.push(actions_send(eventType,{delay:delay})),_this.onExit.push({type:actionTypes_cancel,sendId:eventType}),eventType};return(isArray(afterConfig)?afterConfig.map((function(transition,i){var eventType=mutateEntryExit(transition.delay,i);return _assign(_assign({},transition),{event:eventType})})):flatten(Object.keys(afterConfig).map((function(delay,i){var configTransition=afterConfig[delay],resolvedTransition=utils_isString(configTransition)?{target:configTransition}:configTransition,resolvedDelay=isNaN(+delay)?delay:+delay,eventType=mutateEntryExit(resolvedDelay,i);return toArray(resolvedTransition).map((function(transition){return _assign(_assign({},transition),{event:eventType,delay:resolvedDelay})}))})))).map((function(delayedTransition){var delay=delayedTransition.delay;return _assign(_assign({},_this.formatTransition(delayedTransition)),{delay:delay})}))},StateNode.prototype.getStateNodes=function(state){var _a,_this=this;if(!state)return[];var stateValue=state instanceof State?state.value:toStateValue(state,this.delimiter);if(utils_isString(stateValue)){var initialStateValue=this.getStateNode(stateValue).initial;return void 0!==initialStateValue?this.getStateNodes(((_a={})[stateValue]=initialStateValue,_a)):[this,this.states[stateValue]]}var subStateKeys=Object.keys(stateValue),subStateNodes=[this];return subStateNodes.push.apply(subStateNodes,_tslib_spreadArray([],_tslib_read(flatten(subStateKeys.map((function(subStateKey){return _this.getStateNode(subStateKey).getStateNodes(stateValue[subStateKey])})))),!1)),subStateNodes},StateNode.prototype.handles=function(event){var eventType=getEventType(event);return this.events.includes(eventType)},StateNode.prototype.resolveState=function(state){var stateFromConfig=state instanceof State?state:State.create(state),configuration=Array.from(getConfiguration([],this.getStateNodes(stateFromConfig.value)));return new State(_assign(_assign({},stateFromConfig),{value:this.resolve(stateFromConfig.value),configuration:configuration,done:isInFinalState(configuration,this),tags:getTagsFromConfiguration(configuration),machine:this.machine}))},StateNode.prototype.transitionLeafNode=function(stateValue,state,_event){var next=this.getStateNode(stateValue).next(state,_event);return next&&next.transitions.length?next:this.next(state,_event)},StateNode.prototype.transitionCompoundNode=function(stateValue,state,_event){var subStateKeys=Object.keys(stateValue),next=this.getStateNode(subStateKeys[0])._transition(stateValue[subStateKeys[0]],state,_event);return next&&next.transitions.length?next:this.next(state,_event)},StateNode.prototype.transitionParallelNode=function(stateValue,state,_event){var e_2,_a,transitionMap={};try{for(var _b=_tslib_values(Object.keys(stateValue)),_c=_b.next();!_c.done;_c=_b.next()){var subStateKey=_c.value,subStateValue=stateValue[subStateKey];if(subStateValue){var next=this.getStateNode(subStateKey)._transition(subStateValue,state,_event);next&&(transitionMap[subStateKey]=next)}}}catch(e_2_1){e_2={error:e_2_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_2)throw e_2.error}}var stateTransitions=Object.keys(transitionMap).map((function(key){return transitionMap[key]})),enabledTransitions=flatten(stateTransitions.map((function(st){return st.transitions})));if(!stateTransitions.some((function(st){return st.transitions.length>0})))return this.next(state,_event);var configuration=flatten(Object.keys(transitionMap).map((function(key){return transitionMap[key].configuration})));return{transitions:enabledTransitions,exitSet:flatten(stateTransitions.map((function(t){return t.exitSet}))),configuration:configuration,source:state,actions:flatten(Object.keys(transitionMap).map((function(key){return transitionMap[key].actions})))}},StateNode.prototype._transition=function(stateValue,state,_event){return utils_isString(stateValue)?this.transitionLeafNode(stateValue,state,_event):1===Object.keys(stateValue).length?this.transitionCompoundNode(stateValue,state,_event):this.transitionParallelNode(stateValue,state,_event)},StateNode.prototype.getTransitionData=function(state,event){return this._transition(state.value,state,toSCXMLEvent(event))},StateNode.prototype.next=function(state,_event){var e_3,_a,selectedTransition,_this=this,eventName=_event.name,actions=[],nextStateNodes=[];try{for(var _b=_tslib_values(this.getCandidates(eventName)),_c=_b.next();!_c.done;_c=_b.next()){var candidate=_c.value,cond=candidate.cond,stateIn=candidate.in,resolvedContext=state.context,isInState=!stateIn||(utils_isString(stateIn)&&isStateId(stateIn)?state.matches(toStateValue(this.getStateNodeById(stateIn).path,this.delimiter)):matchesState(toStateValue(stateIn,this.delimiter),path(this.path.slice(0,-2))(state.value))),guardPassed=!1;try{guardPassed=!cond||evaluateGuard(this.machine,cond,resolvedContext,_event,state)}catch(err){throw new Error("Unable to evaluate guard '".concat(cond.name||cond.type,"' in transition for event '").concat(eventName,"' in state node '").concat(this.id,"':\n").concat(err.message))}if(guardPassed&&isInState){void 0!==candidate.target&&(nextStateNodes=candidate.target),actions.push.apply(actions,_tslib_spreadArray([],_tslib_read(candidate.actions),!1)),selectedTransition=candidate;break}}}catch(e_3_1){e_3={error:e_3_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_3)throw e_3.error}}if(selectedTransition){if(!nextStateNodes.length)return{transitions:[selectedTransition],exitSet:[],configuration:state.value?[this]:[],source:state,actions:actions};var allNextStateNodes=flatten(nextStateNodes.map((function(stateNode){return _this.getRelativeStateNodes(stateNode,state.historyValue)})));return{transitions:[selectedTransition],exitSet:!!selectedTransition.internal?[]:flatten(nextStateNodes.map((function(targetNode){return _this.getPotentiallyReenteringNodes(targetNode)}))),configuration:allNextStateNodes,source:state,actions:actions}}},StateNode.prototype.getPotentiallyReenteringNodes=function(targetNode){if(this.order<targetNode.order)return[this];for(var nodes=[],marker=this,possibleAncestor=targetNode;marker&&marker!==possibleAncestor;)nodes.push(marker),marker=marker.parent;return marker!==possibleAncestor?[]:(nodes.push(possibleAncestor),nodes)},StateNode.prototype.getActions=function(resolvedConfig,isDone,transition,currentContext,_event,prevState,predictableExec){var e_4,_a,e_5,_b,_this=this,prevConfig=prevState?getConfiguration([],this.getStateNodes(prevState.value)):[],entrySet=new Set;try{for(var _c=_tslib_values(Array.from(resolvedConfig).sort((function(a,b){return a.order-b.order}))),_d=_c.next();!_d.done;_d=_c.next()){(!has(prevConfig,sn=_d.value)||has(transition.exitSet,sn)||sn.parent&&entrySet.has(sn.parent))&&entrySet.add(sn)}}catch(e_4_1){e_4={error:e_4_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_4)throw e_4.error}}try{for(var prevConfig_1=_tslib_values(prevConfig),prevConfig_1_1=prevConfig_1.next();!prevConfig_1_1.done;prevConfig_1_1=prevConfig_1.next()){var sn;has(resolvedConfig,sn=prevConfig_1_1.value)&&!has(transition.exitSet,sn.parent)||transition.exitSet.push(sn)}}catch(e_5_1){e_5={error:e_5_1}}finally{try{prevConfig_1_1&&!prevConfig_1_1.done&&(_b=prevConfig_1.return)&&_b.call(prevConfig_1)}finally{if(e_5)throw e_5.error}}transition.exitSet.sort((function(a,b){return b.order-a.order}));var entryStates=Array.from(entrySet).sort((function(a,b){return a.order-b.order})),exitStates=new Set(transition.exitSet),doneEvents=flatten(entryStates.map((function(sn){var events=[];if("final"!==sn.type)return events;var parent=sn.parent;if(!parent.parent)return events;events.push(done(sn.id,sn.doneData),done(parent.id,sn.doneData?mapContext(sn.doneData,currentContext,_event):void 0));var grandparent=parent.parent;return"parallel"===grandparent.type&&getChildren(grandparent).every((function(parentNode){return isInFinalState(transition.configuration,parentNode)}))&&events.push(done(grandparent.id)),events}))),entryActions=entryStates.map((function(stateNode){var entryActions=stateNode.onEntry,invokeActions=stateNode.activities.map((function(activity){return function(activity){var activityDef=toActivityDefinition(activity);return{type:types_ActionTypes.Start,activity:activityDef,exec:void 0}}(activity)}));return{type:"entry",actions:toActionObjects(predictableExec?_tslib_spreadArray(_tslib_spreadArray([],_tslib_read(entryActions),!1),_tslib_read(invokeActions),!1):_tslib_spreadArray(_tslib_spreadArray([],_tslib_read(invokeActions),!1),_tslib_read(entryActions),!1),_this.machine.options.actions)}})).concat({type:"state_done",actions:doneEvents.map((function(event){return function(event,options){return{type:raise,event:"function"==typeof event?event:toEventObject(event),delay:options?options.delay:void 0,id:null==options?void 0:options.id}}(event)}))}),actions=Array.from(exitStates).map((function(stateNode){return{type:"exit",actions:toActionObjects(_tslib_spreadArray(_tslib_spreadArray([],_tslib_read(stateNode.onExit),!1),_tslib_read(stateNode.activities.map((function(activity){return function(actorRef){var activity=utils_isFunction(actorRef)?actorRef:toActivityDefinition(actorRef);return{type:types_ActionTypes.Stop,activity:activity,exec:void 0}}(activity)}))),!1),_this.machine.options.actions)}})).concat({type:"transition",actions:toActionObjects(transition.actions,this.machine.options.actions)}).concat(entryActions);if(isDone){var stopActions=toActionObjects(flatten(_tslib_spreadArray([],_tslib_read(resolvedConfig),!1).sort((function(a,b){return b.order-a.order})).map((function(stateNode){return stateNode.onExit}))),this.machine.options.actions).filter((function(action){return!isRaisableAction(action)}));return actions.concat({type:"stop",actions:stopActions})}return actions},StateNode.prototype.transition=function(state,event,context,exec){void 0===state&&(state=this.initialState);var currentState,eventType,_event=toSCXMLEvent(event);if(state instanceof State)currentState=void 0===context?state:this.resolveState(State.from(state,context));else{var resolvedStateValue=utils_isString(state)?this.resolve(pathToStateValue(this.getResolvedPath(state))):this.resolve(state),resolvedContext=null!=context?context:this.machine.context;currentState=this.resolveState(State.from(resolvedStateValue,resolvedContext))}if(!environment_IS_PRODUCTION&&"*"===_event.name)throw new Error("An event cannot have the wildcard type ('".concat("*","')"));if(this.strict&&!this.events.includes(_event.name)&&(eventType=_event.name,!/^(done|error)\./.test(eventType)))throw new Error("Machine '".concat(this.id,"' does not accept event '").concat(_event.name,"'"));var stateTransition=this._transition(currentState.value,currentState,_event)||{transitions:[],configuration:[],exitSet:[],source:currentState,actions:[]},prevConfig=getConfiguration([],this.getStateNodes(currentState.value)),resolvedConfig=stateTransition.configuration.length?getConfiguration(prevConfig,stateTransition.configuration):prevConfig;return stateTransition.configuration=_tslib_spreadArray([],_tslib_read(resolvedConfig),!1),this.resolveTransition(stateTransition,currentState,currentState.context,exec,_event)},StateNode.prototype.resolveRaisedTransition=function(state,_event,originalEvent,predictableExec){var _a,currentActions=state.actions;return(state=this.transition(state,_event,void 0,predictableExec))._event=originalEvent,state.event=originalEvent.data,(_a=state.actions).unshift.apply(_a,_tslib_spreadArray([],_tslib_read(currentActions),!1)),state},StateNode.prototype.resolveTransition=function(stateTransition,currentState,context,predictableExec,_event){var e_6,_a,e_7,_b,_this=this;void 0===_event&&(_event=initEvent);var configuration=stateTransition.configuration,willTransition=!currentState||stateTransition.transitions.length>0,resolvedConfiguration=willTransition?stateTransition.configuration:currentState?currentState.configuration:[],isDone=isInFinalState(resolvedConfiguration,this),resolvedStateValue=willTransition?getValue(this.machine,configuration):void 0,historyValue=currentState?currentState.historyValue?currentState.historyValue:stateTransition.source?this.machine.historyValue(currentState.value):void 0:void 0,actionBlocks=this.getActions(new Set(resolvedConfiguration),isDone,stateTransition,context,_event,currentState,predictableExec),activities=currentState?_assign({},currentState.activities):{};try{for(var actionBlocks_1=_tslib_values(actionBlocks),actionBlocks_1_1=actionBlocks_1.next();!actionBlocks_1_1.done;actionBlocks_1_1=actionBlocks_1.next()){var block=actionBlocks_1_1.value;try{for(var _c=(e_7=void 0,_tslib_values(block.actions)),_d=_c.next();!_d.done;_d=_c.next()){var action=_d.value;action.type===start?activities[action.activity.id||action.activity.type]=action:action.type===stop&&(activities[action.activity.id||action.activity.type]=!1)}}catch(e_7_1){e_7={error:e_7_1}}finally{try{_d&&!_d.done&&(_b=_c.return)&&_b.call(_c)}finally{if(e_7)throw e_7.error}}}}catch(e_6_1){e_6={error:e_6_1}}finally{try{actionBlocks_1_1&&!actionBlocks_1_1.done&&(_a=actionBlocks_1.return)&&_a.call(actionBlocks_1)}finally{if(e_6)throw e_6.error}}var hist,stateValue,_e=_tslib_read(resolveActions(this,currentState,context,_event,actionBlocks,predictableExec,this.machine.config.predictableActionArguments||this.machine.config.preserveActionOrder),2),resolvedActions=_e[0],updatedContext=_e[1],_f=_tslib_read(function(items,predicate){var e_6,_a,_b=_tslib_read([[],[]],2),truthy=_b[0],falsy=_b[1];try{for(var items_1=_tslib_values(items),items_1_1=items_1.next();!items_1_1.done;items_1_1=items_1.next()){var item=items_1_1.value;predicate(item)?truthy.push(item):falsy.push(item)}}catch(e_6_1){e_6={error:e_6_1}}finally{try{items_1_1&&!items_1_1.done&&(_a=items_1.return)&&_a.call(items_1)}finally{if(e_6)throw e_6.error}}return[truthy,falsy]}(resolvedActions,isRaisableAction),2),raisedEvents=_f[0],nonRaisedActions=_f[1],invokeActions=resolvedActions.filter((function(action){var _a;return action.type===start&&(null===(_a=action.activity)||void 0===_a?void 0:_a.type)===actionTypes_invoke})),children=invokeActions.reduce((function(acc,action){return acc[action.activity.id]=function(invokeDefinition,machine,context,_event){var _a,invokeSrc=toInvokeSource(invokeDefinition.src),serviceCreator=null===(_a=null==machine?void 0:machine.options.services)||void 0===_a?void 0:_a[invokeSrc.type],resolvedData=invokeDefinition.data?mapContext(invokeDefinition.data,context,_event):void 0,tempActor=serviceCreator?Actor_createDeferredActor(serviceCreator,invokeDefinition.id,resolvedData):createNullActor(invokeDefinition.id);return tempActor.meta=invokeDefinition,tempActor}(action.activity,_this.machine,updatedContext,_event),acc}),currentState?_assign({},currentState.children):{}),nextState=new State({value:resolvedStateValue||currentState.value,context:updatedContext,_event:_event,_sessionid:currentState?currentState._sessionid:null,historyValue:resolvedStateValue?historyValue?(hist=historyValue,stateValue=resolvedStateValue,{current:stateValue,states:updateHistoryStates(hist,stateValue)}):void 0:currentState?currentState.historyValue:void 0,history:!resolvedStateValue||stateTransition.source?currentState:void 0,actions:resolvedStateValue?nonRaisedActions:[],activities:resolvedStateValue?activities:currentState?currentState.activities:{},events:[],configuration:resolvedConfiguration,transitions:stateTransition.transitions,children:children,done:isDone,tags:getTagsFromConfiguration(resolvedConfiguration),machine:this}),didUpdateContext=context!==updatedContext;nextState.changed=_event.name===actionTypes_update||didUpdateContext;var history=nextState.history;history&&delete history.history;var hasAlwaysTransitions=!isDone&&(this._transient||configuration.some((function(stateNode){return stateNode._transient})));if(!(willTransition||hasAlwaysTransitions&&""!==_event.name))return nextState;var maybeNextState=nextState;if(!isDone)for(hasAlwaysTransitions&&(maybeNextState=this.resolveRaisedTransition(maybeNextState,{type:nullEvent},_event,predictableExec));raisedEvents.length;){var raisedEvent=raisedEvents.shift();maybeNextState=this.resolveRaisedTransition(maybeNextState,raisedEvent._event,_event,predictableExec)}var changed=maybeNextState.changed||(history?!!maybeNextState.actions.length||didUpdateContext||StateNode_typeof(history.value)!==StateNode_typeof(maybeNextState.value)||!stateValuesEqual(maybeNextState.value,history.value):void 0);return maybeNextState.changed=changed,maybeNextState.history=history,maybeNextState},StateNode.prototype.getStateNode=function(stateKey){if(isStateId(stateKey))return this.machine.getStateNodeById(stateKey);if(!this.states)throw new Error("Unable to retrieve child state '".concat(stateKey,"' from '").concat(this.id,"'; no child states exist."));var result=this.states[stateKey];if(!result)throw new Error("Child state '".concat(stateKey,"' does not exist on '").concat(this.id,"'"));return result},StateNode.prototype.getStateNodeById=function(stateId){var resolvedStateId=isStateId(stateId)?stateId.slice(1):stateId;if(resolvedStateId===this.id)return this;var stateNode=this.machine.idMap[resolvedStateId];if(!stateNode)throw new Error("Child state node '#".concat(resolvedStateId,"' does not exist on machine '").concat(this.id,"'"));return stateNode},StateNode.prototype.getStateNodeByPath=function(statePath){if("string"==typeof statePath&&isStateId(statePath))try{return this.getStateNodeById(statePath.slice(1))}catch(e){}for(var arrayStatePath=toStatePath(statePath,this.delimiter).slice(),currentStateNode=this;arrayStatePath.length;){var key=arrayStatePath.shift();if(!key.length)break;currentStateNode=currentStateNode.getStateNode(key)}return currentStateNode},StateNode.prototype.resolve=function(stateValue){var _a,_this=this;if(!stateValue)return this.initialStateValue||EMPTY_OBJECT;switch(this.type){case"parallel":return mapValues(this.initialStateValue,(function(subStateValue,subStateKey){return subStateValue?_this.getStateNode(subStateKey).resolve(stateValue[subStateKey]||subStateValue):EMPTY_OBJECT}));case"compound":if(utils_isString(stateValue)){var subStateNode=this.getStateNode(stateValue);return"parallel"===subStateNode.type||"compound"===subStateNode.type?((_a={})[stateValue]=subStateNode.initialStateValue,_a):stateValue}return Object.keys(stateValue).length?mapValues(stateValue,(function(subStateValue,subStateKey){return subStateValue?_this.getStateNode(subStateKey).resolve(subStateValue):EMPTY_OBJECT})):this.initialStateValue||{};default:return stateValue||EMPTY_OBJECT}},StateNode.prototype.getResolvedPath=function(stateIdentifier){if(isStateId(stateIdentifier)){var stateNode=this.machine.idMap[stateIdentifier.slice(1)];if(!stateNode)throw new Error("Unable to find state node '".concat(stateIdentifier,"'"));return stateNode.path}return toStatePath(stateIdentifier,this.delimiter)},Object.defineProperty(StateNode.prototype,"initialStateValue",{get:function(){var _a,initialStateValue;if(this.__cache.initialStateValue)return this.__cache.initialStateValue;if("parallel"===this.type)initialStateValue=mapFilterValues(this.states,(function(state){return state.initialStateValue||EMPTY_OBJECT}),(function(stateNode){return!("history"===stateNode.type)}));else if(void 0!==this.initial){if(!this.states[this.initial])throw new Error("Initial state '".concat(this.initial,"' not found on '").concat(this.key,"'"));initialStateValue=isLeafNode(this.states[this.initial])?this.initial:((_a={})[this.initial]=this.states[this.initial].initialStateValue,_a)}else initialStateValue={};return this.__cache.initialStateValue=initialStateValue,this.__cache.initialStateValue},enumerable:!1,configurable:!0}),StateNode.prototype.getInitialState=function(stateValue,context){this._init();var configuration=this.getStateNodes(stateValue);return this.resolveTransition({configuration:configuration,exitSet:[],transitions:[],source:void 0,actions:[]},void 0,null!=context?context:this.machine.context,void 0)},Object.defineProperty(StateNode.prototype,"initialState",{get:function(){var initialStateValue=this.initialStateValue;if(!initialStateValue)throw new Error("Cannot retrieve initial state from simple state '".concat(this.id,"'."));return this.getInitialState(initialStateValue)},enumerable:!1,configurable:!0}),Object.defineProperty(StateNode.prototype,"target",{get:function(){var target;if("history"===this.type){var historyConfig=this.config;target=utils_isString(historyConfig.target)&&isStateId(historyConfig.target)?pathToStateValue(this.machine.getStateNodeById(historyConfig.target).path.slice(this.path.length-1)):historyConfig.target}return target},enumerable:!1,configurable:!0}),StateNode.prototype.getRelativeStateNodes=function(relativeStateId,historyValue,resolve){return void 0===resolve&&(resolve=!0),resolve?"history"===relativeStateId.type?relativeStateId.resolveHistory(historyValue):relativeStateId.initialStateNodes:[relativeStateId]},Object.defineProperty(StateNode.prototype,"initialStateNodes",{get:function(){var _this=this;return isLeafNode(this)?[this]:"compound"!==this.type||this.initial?flatten(toStatePaths(this.initialStateValue).map((function(initialPath){return _this.getFromRelativePath(initialPath)}))):(environment_IS_PRODUCTION||utils_warn(!1,"Compound state node '".concat(this.id,"' has no initial state.")),[this])},enumerable:!1,configurable:!0}),StateNode.prototype.getFromRelativePath=function(relativePath){if(!relativePath.length)return[this];var _a=_tslib_read(relativePath),stateKey=_a[0],childStatePath=_a.slice(1);if(!this.states)throw new Error("Cannot retrieve subPath '".concat(stateKey,"' from node with no states"));var childStateNode=this.getStateNode(stateKey);if("history"===childStateNode.type)return childStateNode.resolveHistory();if(!this.states[stateKey])throw new Error("Child state '".concat(stateKey,"' does not exist on '").concat(this.id,"'"));return this.states[stateKey].getFromRelativePath(childStatePath)},StateNode.prototype.historyValue=function(relativeStateValue){if(Object.keys(this.states).length)return{current:relativeStateValue||this.initialStateValue,states:mapFilterValues(this.states,(function(stateNode,key){if(!relativeStateValue)return stateNode.historyValue();var subStateValue=utils_isString(relativeStateValue)?void 0:relativeStateValue[key];return stateNode.historyValue(subStateValue||stateNode.initialStateValue)}),(function(stateNode){return!stateNode.history}))}},StateNode.prototype.resolveHistory=function(historyValue){var _this=this;if("history"!==this.type)return[this];var parent=this.parent;if(!historyValue){var historyTarget=this.target;return historyTarget?flatten(toStatePaths(historyTarget).map((function(relativeChildPath){return parent.getFromRelativePath(relativeChildPath)}))):parent.initialStateNodes}var props,accessorProp,subHistoryValue=(props=parent.path,accessorProp="states",function(object){var e_3,_a,result=object;try{for(var props_2=_tslib_values(props),props_2_1=props_2.next();!props_2_1.done;props_2_1=props_2.next()){var prop=props_2_1.value;result=result[accessorProp][prop]}}catch(e_3_1){e_3={error:e_3_1}}finally{try{props_2_1&&!props_2_1.done&&(_a=props_2.return)&&_a.call(props_2)}finally{if(e_3)throw e_3.error}}return result})(historyValue).current;return utils_isString(subHistoryValue)?[parent.getStateNode(subHistoryValue)]:flatten(toStatePaths(subHistoryValue).map((function(subStatePath){return"deep"===_this.history?parent.getFromRelativePath(subStatePath):[parent.states[subStatePath[0]]]})))},Object.defineProperty(StateNode.prototype,"stateIds",{get:function(){var _this=this,childStateIds=flatten(Object.keys(this.states).map((function(stateKey){return _this.states[stateKey].stateIds})));return[this.id].concat(childStateIds)},enumerable:!1,configurable:!0}),Object.defineProperty(StateNode.prototype,"events",{get:function(){var e_8,_a,e_9,_b;if(this.__cache.events)return this.__cache.events;var states=this.states,events=new Set(this.ownEvents);if(states)try{for(var _c=_tslib_values(Object.keys(states)),_d=_c.next();!_d.done;_d=_c.next()){var state=states[_d.value];if(state.states)try{for(var _e=(e_9=void 0,_tslib_values(state.events)),_f=_e.next();!_f.done;_f=_e.next()){var event_1=_f.value;events.add("".concat(event_1))}}catch(e_9_1){e_9={error:e_9_1}}finally{try{_f&&!_f.done&&(_b=_e.return)&&_b.call(_e)}finally{if(e_9)throw e_9.error}}}}catch(e_8_1){e_8={error:e_8_1}}finally{try{_d&&!_d.done&&(_a=_c.return)&&_a.call(_c)}finally{if(e_8)throw e_8.error}}return this.__cache.events=Array.from(events)},enumerable:!1,configurable:!0}),Object.defineProperty(StateNode.prototype,"ownEvents",{get:function(){var events=new Set(this.transitions.filter((function(transition){return!(!transition.target&&!transition.actions.length&&transition.internal)})).map((function(transition){return transition.eventType})));return Array.from(events)},enumerable:!1,configurable:!0}),StateNode.prototype.resolveTarget=function(_target){var _this=this;if(void 0!==_target)return _target.map((function(target){if(!utils_isString(target))return target;var isInternalTarget=target[0]===_this.delimiter;if(isInternalTarget&&!_this.parent)return _this.getStateNodeByPath(target.slice(1));var resolvedTarget=isInternalTarget?_this.key+target:target;if(!_this.parent)return _this.getStateNodeByPath(resolvedTarget);try{return _this.parent.getStateNodeByPath(resolvedTarget)}catch(err){throw new Error("Invalid transition definition for state node '".concat(_this.id,"':\n").concat(err.message))}}))},StateNode.prototype.formatTransition=function(transitionConfig){var _this=this,normalizedTarget=function(target){if(void 0!==target&&""!==target)return toArray(target)}(transitionConfig.target),internal="internal"in transitionConfig?transitionConfig.internal:!normalizedTarget||normalizedTarget.some((function(_target){return utils_isString(_target)&&_target[0]===_this.delimiter})),guards=this.machine.options.guards,target=this.resolveTarget(normalizedTarget),transition=_assign(_assign({},transitionConfig),{actions:toActionObjects(toArray(transitionConfig.actions)),cond:toGuard(transitionConfig.cond,guards),target:target,source:this,internal:internal,eventType:transitionConfig.event,toJSON:function(){return _assign(_assign({},transition),{target:transition.target?transition.target.map((function(t){return"#".concat(t.id)})):void 0,source:"#".concat(_this.id)})}});return transition},StateNode.prototype.formatTransitions=function(){var e_10,_a,onConfig,_this=this;if(this.config.on)if(Array.isArray(this.config.on))onConfig=this.config.on;else{var _b=this.config.on,_d=_b["*"],wildcardConfigs=void 0===_d?[]:_d,strictTransitionConfigs_1=__rest(_b,[(StateNode_typeof("*"),"*")]);onConfig=flatten(Object.keys(strictTransitionConfigs_1).map((function(key){environment_IS_PRODUCTION||""!==key||utils_warn(!1,"Empty string transition configs (e.g., `{ on: { '': ... }}`) for transient transitions are deprecated. Specify the transition in the `{ always: ... }` property instead. "+'Please check the `on` configuration for "#'.concat(_this.id,'".'));var transitionConfigArray=toTransitionConfigArray(key,strictTransitionConfigs_1[key]);return environment_IS_PRODUCTION||function(stateNode,event,transitions){var hasNonLastUnguardedTarget=transitions.slice(0,-1).some((function(transition){return!("cond"in transition)&&!("in"in transition)&&(utils_isString(transition.target)||utils_isMachine(transition.target))})),eventText=""===event?"the transient event":"event '".concat(event,"'");utils_warn(!hasNonLastUnguardedTarget,"One or more transitions for ".concat(eventText," on state '").concat(stateNode.id,"' are unreachable. ")+"Make sure that the default transition is the last one defined.")}(_this,key,transitionConfigArray),transitionConfigArray})).concat(toTransitionConfigArray("*",wildcardConfigs)))}else onConfig=[];var eventlessConfig=this.config.always?toTransitionConfigArray("",this.config.always):[],doneConfig=this.config.onDone?toTransitionConfigArray(String(done(this.id)),this.config.onDone):[];environment_IS_PRODUCTION||utils_warn(!(this.config.onDone&&!this.parent),'Root nodes cannot have an ".onDone" transition. Please check the config of "'.concat(this.id,'".'));var invokeConfig=flatten(this.invoke.map((function(invokeDef){var settleTransitions=[];return invokeDef.onDone&&settleTransitions.push.apply(settleTransitions,_tslib_spreadArray([],_tslib_read(toTransitionConfigArray(String(actions_doneInvoke(invokeDef.id)),invokeDef.onDone)),!1)),invokeDef.onError&&settleTransitions.push.apply(settleTransitions,_tslib_spreadArray([],_tslib_read(toTransitionConfigArray(String(actions_error(invokeDef.id)),invokeDef.onError)),!1)),settleTransitions}))),delayedTransitions=this.after,formattedTransitions=flatten(_tslib_spreadArray(_tslib_spreadArray(_tslib_spreadArray(_tslib_spreadArray([],_tslib_read(doneConfig),!1),_tslib_read(invokeConfig),!1),_tslib_read(onConfig),!1),_tslib_read(eventlessConfig),!1).map((function(transitionConfig){return toArray(transitionConfig).map((function(transition){return _this.formatTransition(transition)}))})));try{for(var delayedTransitions_1=_tslib_values(delayedTransitions),delayedTransitions_1_1=delayedTransitions_1.next();!delayedTransitions_1_1.done;delayedTransitions_1_1=delayedTransitions_1.next()){var delayedTransition=delayedTransitions_1_1.value;formattedTransitions.push(delayedTransition)}}catch(e_10_1){e_10={error:e_10_1}}finally{try{delayedTransitions_1_1&&!delayedTransitions_1_1.done&&(_a=delayedTransitions_1.return)&&_a.call(delayedTransitions_1)}finally{if(e_10)throw e_10.error}}return formattedTransitions},StateNode}(),warned=!1;var remoteFacilityUsers=function(baseurl,facility_id,username){var params={baseurl:baseurl,facility:facility_id,username:username};return external_kolibriCoreAppGlobal_client_default()({url:external_kolibriCoreAppGlobal_urls_default()["kolibri:kolibri.plugins.user_profile:remotefacilityuser"](),params:params}).then((function(response){var users=response.data;return 0===Object.keys(response.data).length&&(users=[]),{users:users}}))},useRemoteFacility=function(baseurl,facility_id,username,password){var userAdmin=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,params={baseurl:baseurl,facility:facility_id,username:null===userAdmin?username:userAdmin,password:password};return external_kolibriCoreAppGlobal_client_default()({url:external_kolibriCoreAppGlobal_urls_default()["kolibri:kolibri.plugins.user_profile:remotefacilityauthenticateduserinfo"](),method:"POST",data:params}).then((function(response){return response.data.error?"error":response.data.find((function(element){return element.username===username}))}))};function changeFacilityMachine_typeof(o){return changeFacilityMachine_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},changeFacilityMachine_typeof(o)}function changeFacilityMachine_toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return changeFacilityMachine_arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return changeFacilityMachine_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return changeFacilityMachine_arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function changeFacilityMachine_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function changeFacilityMachine_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function changeFacilityMachine_defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=changeFacilityMachine_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=changeFacilityMachine_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==changeFacilityMachine_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var config,options,setInitialContext=es_assign((function(_,event){return{sourceFacility:event.value.facility,username:event.value.username,fullname:event.value.fullname,userId:event.value.userId,role:event.value.role,targetAccount:{username:event.value.username,password:""}}})),connectToTargetKolibri=function(context,event){var facility=event.value;return remoteFacilityUsers(facility.url,facility.id,context.username).then((function(users){return function(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?changeFacilityMachine_ownKeys(Object(t),!0).forEach((function(r){changeFacilityMachine_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):changeFacilityMachine_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}({facility:facility},users)}))},checkExists=es_assign((function(context,event){var filtered=event.data.users.filter((function(user){return user.username===context.username}));return filtered.length>0?{accountExists:!0,targetFacility:event.data.facility,targetAccount:filtered[0]}:{accountExists:!1}})),setCurrentUserAsSuperAdmin=es_assign({setAsSuperAdmin:function(){return!0}}),setNewSuperAdminId=es_assign({newSuperAdminId:function(_,event){return event.value}}),setTargetAccount=es_assign({targetAccount:function(_,event){return event.value}}),setTargetAccountPassword=es_assign({targetAccount:function(_,event){return event.value}}),setMerging=es_assign({isMerging:function(){return!0}}),setSourceFacilityUsers=es_assign({sourceFacilityUsers:function(_,event){return event.data}}),clearSourceFacilityUsers=es_assign({sourceFacilityUsers:[]}),setTaskId=es_assign({taskId:function(_,event){return event.value.task_id}}),resetTaskId=es_assign({taskId:function(){return null}}),resetMachineContext=es_assign((function(){return generateMachineContext()})),pushHistoryItem=es_assign({history:function(context,event){return[].concat(changeFacilityMachine_toConsumableArray(context.history),[event.value])}}),removeLastHistoryItem=es_assign({history:function(context){return context.history.length?context.history.slice(0,-1):[]}}),generateMachineContext=function(){return{role:"learner",username:"",userId:"",targetAccount:{username:"",password:""},sourceFacility:"",sourceFacilityUsers:[],targetFacility:{},newSuperAdminId:"",taskPolling:!1,accountExists:!1,isMerging:!1,taskId:null,setAsSuperAdmin:!1,history:[]}},states={error:{on:{RESET:{target:"selectFacility",actions:[resetMachineContext]}}},profile:{meta:{route:"PROFILE",path:"/"},on:{CONTINUE:{target:"selectFacility",cond:function(context){return!!context.sourceFacility&&!!context.username},actions:[es_send({type:"PUSH_HISTORY",value:"profile"})]},SETCONTEXT:{actions:setInitialContext}}},selectFacility:{meta:{route:"SELECT_FACILITY",path:"/change_facility"},on:{CONTINUE:{target:"changeFacility",cond:function(context){return Object.keys(context.targetFacility).length>0},actions:[es_send({type:"PUSH_HISTORY",value:"selectFacility"})]},SETCONTEXT:{actions:setInitialContext},SELECTFACILITY:{actions:es_assign({targetFacility:function(_,event){return event.value}}),target:"getFacilityUsernames"}}},getFacilityUsernames:{invoke:{id:"getUserNames",src:function(context,event){return connectToTargetKolibri(context,event)},onDone:{target:"selectFacility",actions:checkExists},onError:{target:"selectFacility"}}},changeFacility:{meta:{route:"CONFIRM_CHANGE_FACILITY",path:"/change_facility"},on:{MERGE:{target:"checkUsernameExists",actions:[setMerging,es_send({type:"PUSH_HISTORY",value:"changeFacility"})]},CONTINUE:{target:"checkUsernameExists",actions:[es_send({type:"PUSH_HISTORY",value:"changeFacility"})]}}},checkUsernameExists:{always:[{cond:function(context){return!!context.accountExists},target:"usernameExists"},{cond:function(context){return context.isMerging},target:"mergeAccounts"},{target:"confirmAccountUsername"}]},confirmAccountUsername:{meta:{route:"CONFIRM_ACCOUNT_USERNAME",path:"/change_facility"},on:{NEW:{cond:function(context){return context.targetFacility&&context.targetFacility.learner_can_sign_up},target:"createAccount",actions:[es_send({type:"PUSH_HISTORY",value:"confirmAccountUsername"})]},CONTINUE:{target:"doesTargetRequirePassword",actions:[es_send({type:"PUSH_HISTORY",value:"confirmAccountUsername"})]}}},doesTargetRequirePassword:{always:[{cond:function(context){return!1===context.targetFacility.learner_can_login_with_no_password},target:"provideTargetAccountPassword"},{target:"isAdmin"}]},provideTargetAccountPassword:{meta:{route:"TARGET_PASSWORD",path:"/change_facility"},on:{CONTINUE:{target:"isAdmin",actions:[setTargetAccountPassword,es_send({type:"PUSH_HISTORY",value:"provideTargetAccountPassword"})]}}},isAdmin:{always:[{cond:function(context){return"superuser"===context.role},target:"fetchSourceFacilityUsers"},{target:"checkIsMerging"}]},fetchSourceFacilityUsers:{invoke:{src:function(context){return external_kolibriCoreAppGlobal_resources_namespaceObject.FacilityUserResource.fetchCollection({getParams:{member_of:context.sourceFacility},force:!0}).then((function(users){return users}))},onDone:{target:"checkFacilityHasNoMoreUsers",actions:[setSourceFacilityUsers]},onError:{target:"error"}}},checkFacilityHasNoMoreUsers:{always:[{cond:function(context){return 1==context.sourceFacilityUsers.length},target:"setCurrentUserToSuperAdmin"},{target:"checkNeedsNewSuperAdmin"}]},setCurrentUserToSuperAdmin:{always:[{target:"checkIsMerging",actions:[setCurrentUserAsSuperAdmin,clearSourceFacilityUsers]}]},checkNeedsNewSuperAdmin:{always:[{cond:function(context){var facilityHasAnotherSuperUser=context.sourceFacilityUsers.length>0&&context.sourceFacilityUsers.find((function(u){return u.id!==context.userId&&u.is_superuser}));return"superuser"===context.role&&!facilityHasAnotherSuperUser},target:"chooseAdmin"},{target:"checkIsMerging"}]},chooseAdmin:{meta:{route:"CHOOSE_ADMIN",path:"/change_facility"},on:{CONTINUE:{target:"checkIsMerging",cond:function(context){return!!context.newSuperAdminId},actions:[clearSourceFacilityUsers,es_send({type:"PUSH_HISTORY",value:"chooseAdmin"})]},SELECTNEWSUPERADMIN:{actions:setNewSuperAdminId}}},checkIsMerging:{always:[{cond:function(context){return context.isMerging},target:"confirmMerge"},{target:"syncChangeFacility"}]},confirmMerge:{meta:{route:"CONFIRM_MERGE",path:"/change_facility"},on:{CONTINUE:{target:"syncChangeFacility",actions:[es_send({type:"PUSH_HISTORY",value:"confirmMerge"})]}}},syncChangeFacility:{meta:{route:"SYNCING_CHANGE_FACILITY",path:"/change_facility"},on:{SETTASKID:{actions:setTaskId},FINISH:"syncFinished",TASKERROR:{target:"changeFacility",actions:[resetTaskId]}}},syncFinished:{type:"final"},createAccount:{meta:{route:"CREATE_ACCOUNT",path:"/change_facility"},on:{CONTINUE:{target:"isAdmin",actions:[setTargetAccount,es_send({type:"PUSH_HISTORY",value:"createAccount"})]}}},usernameExists:{meta:{route:"USERNAME_EXISTS",path:"/change_facility"},on:{MERGE:[{cond:function(context){return context.accountExists&&!context.targetFacility.learner_can_login_with_no_password},target:"requireAccountCreds",actions:[es_send({type:"PUSH_HISTORY",value:"usernameExists"})]},{cond:function(context){return context.accountExists&&context.targetFacility.learner_can_login_with_no_password},target:"getUserWithoutPasswordInfo",actions:[es_send({type:"PUSH_HISTORY",value:"usernameExists"})]}],NEW:{target:"createAccount",actions:[es_send({type:"PUSH_HISTORY",value:"usernameExists"})]}}},requireAccountCreds:{meta:{route:"REQUIRE_ACCOUNT_CREDENTIALS",path:"/change_facility"},on:{CONTINUE:{target:"confirmAccountDetails",actions:[setTargetAccount,es_send({type:"PUSH_HISTORY",value:"requireAccountCreds"})]},USEADMIN:{target:"useAdminPassword",actions:[es_send({type:"PUSH_HISTORY",value:"requireAccountCreds"})]}}},useAdminPassword:{meta:{route:"ADMIN_PASSWORD",path:"/change_facility"},on:{CONTINUE:{target:"confirmAccountDetails",actions:[setTargetAccount,es_send({type:"PUSH_HISTORY",value:"useAdminPassword"})]}}},confirmAccountDetails:{meta:{route:"CONFIRM_DETAILS",path:"/change_facility"},on:{CONTINUE:{target:"isAdmin",actions:[es_send({type:"PUSH_HISTORY",value:"confirmAccountDetails"})]}}},mergeAccounts:{meta:{route:"MERGE_ACCOUNTS",path:"/change_facility"},on:{CONTINUE:{target:"requireAccountCreds",actions:[setTargetAccount,es_send({type:"PUSH_HISTORY",value:"mergeAccounts"})]}}},getUserWithoutPasswordInfo:{invoke:{id:"getPasswordlessUserInfo",src:function(context,event){return function(context){var facility=context.targetFacility;return useRemoteFacility(facility.url,facility.id,context.username,null).then((function(user){return user}))}(context)},onDone:{target:"confirmAccountDetails",actions:es_assign({targetAccount:function(_,event){return event.data}})},onError:{target:"mergeAccounts"}}}},changeFacilityMachine=(config={id:"machine",initial:"selectFacility",predictableActionArguments:!0,context:generateMachineContext(),on:{PUSH_HISTORY:{actions:[pushHistoryItem]},BACK:Object.keys(states).map((function(state){return{target:state,cond:function(context){return context.history.length&&context.history[context.history.length-1]===state},actions:[removeLastHistoryItem]}}))},states:states},environment_IS_PRODUCTION||"predictableActionArguments"in config||warned||(warned=!0,console.warn("It is highly recommended to set `predictableActionArguments` to `true` when using `createMachine`. https://xstate.js.org/docs/guides/actions.html")),new StateNode_StateNode(config,options));function ChangeFacilityvue_type_script_lang_js_typeof(o){return ChangeFacilityvue_type_script_lang_js_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},ChangeFacilityvue_type_script_lang_js_typeof(o)}function ChangeFacilityvue_type_script_lang_js_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function ChangeFacilityvue_type_script_lang_js_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ChangeFacilityvue_type_script_lang_js_ownKeys(Object(t),!0).forEach((function(r){ChangeFacilityvue_type_script_lang_js_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ChangeFacilityvue_type_script_lang_js_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function ChangeFacilityvue_type_script_lang_js_defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=ChangeFacilityvue_type_script_lang_js_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=ChangeFacilityvue_type_script_lang_js_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==ChangeFacilityvue_type_script_lang_js_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var ChangeFacility=normalizeComponent({name:"ChangeFacility",metaInfo:function(){return{title:this.coreString("changeLearningFacility")}},components:{NotificationsRoot:external_kolibriCoreAppGlobal_coreVue_components_NotificationsRoot_default(),ImmersivePage:external_kolibriCoreAppGlobal_coreVue_components_ImmersivePage_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default()],data:function(){return{service:interpret(changeFacilityMachine),previousMachineStateName:"",state:changeFacilityMachine.initialState,currentRoute:this.$router.currentRoute.name,appBarHeight:0,internalNavigation:!1}},provide:function(){var _this=this;return{changeFacilityService:this.service,state:(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return _this.state.context}))}},computed:ChangeFacilityvue_type_script_lang_js_objectSpread(ChangeFacilityvue_type_script_lang_js_objectSpread({},(0,external_kolibriCoreAppGlobal_lib_vuex_namespaceObject.mapGetters)(["session","getUserKind"])),{},{wrapperStyles:function(){return{maxWidth:"1064px",margin:"0px auto auto",padding:"96px 32px 72px",backgroundColor:this.$themePalette.grey.v_100}}}),beforeRouteUpdate:function(to,from,next){this.internalNavigation||this.service.send("BACK"),next()},created:function(){var _this2=this;this.service.start(),this.service.onTransition((function(state){if("error"!==state.value){var stateID=Object.keys(state.meta)[0];if(void 0!==state.meta[stateID]){var newRoute=state.meta[stateID].route;newRoute!=_this2.$router.currentRoute.name&&("path"in state.meta[stateID]?(_this2.internalNavigation=!0,_this2.$router.push({name:newRoute,path:state.meta[stateID].path},function(){this.internalNavigation=!1}.bind(_this2))):_this2.$router.push(newRoute)),_this2.currentRoute=newRoute}_this2.state=state}else _this2.onMachineError(state)}))},destroyed:function(){this.service.stop()},mounted:function(){var _this3=this;this.$nextTick((function(){_this3.$refs.appBar&&(_this3.appBarHeight=_this3.$refs.appBar.$el.clientHeight)})),""===this.service.state.context.username&&this.service.send({type:"SETCONTEXT",value:{facility:this.session.facility_id,username:this.session.username,fullname:this.session.full_name,userId:this.session.user_id,role:this.getUserKind}})},methods:{onMachineError:function(machineState){this.$store.commit("CORE_SET_ERROR","An error occured in the '".concat(this.previousMachineStateName,"' state of the change facility machine")),this.service.send("RESET"),this.previousMachineStateName=machineState.value}}},ChangeFacilityvue_type_template_id_0c2bd7d8_scoped_true_render,[],!1,null,"0c2bd7d8",null).exports,ConfirmMergevue_type_template_id_87f13aba_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.profileString("mergeAccounts")))]),_c("p",[_vm._v(_vm._s(_vm.$tr("confirmMergeInfoLine")))]),_c("div",{staticClass:"confirm"},[_c("KCheckbox",{ref:"kCheckbox",attrs:{label:_vm.$tr("consequences"),checked:!1},on:{change:function($event){_vm.isConfirmed=!_vm.isConfirmed},keydown:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.handleContinue.apply(null,arguments)}}})],1),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!1,text:_vm.coreString("backAction"),appearance:"flat-button","data-test":"backButton"},on:{click:_vm.sendBack}}),_c("KButton",{attrs:{primary:!0,disabled:!_vm.isConfirmed,text:_vm.coreString("continueAction"),"data-test":"continueButton"},on:{click:_vm.handleContinue}})],1)]}))],2)],1)};ConfirmMergevue_type_template_id_87f13aba_scoped_true_render._withStripped=!0;var external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_namespaceObject=kolibriCoreAppGlobal.coreVue.components.BottomAppBar,external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_namespaceObject),external_kolibriCoreAppGlobal_utils_i18n_namespaceObject=kolibriCoreAppGlobal.utils.i18n,profileStrings=(0,external_kolibriCoreAppGlobal_utils_i18n_namespaceObject.createTranslator)("CommonProfileStrings",{createAccount:{message:"Create new account",context:"Text is used on a button or label to indicate the current step to create a new user account"},mergeAccounts:{message:"Merge accounts",context:"Text is used on a button or label to merge accounts between facilities."},useAdminAccount:{message:"Use an admin account",context:"Link to use an admin account for the target facility to do the merge"}});var commonProfileStrings={methods:{profileString:function(key,args){return profileStrings.$tr(key,args)}}},ConfirmMerge=normalizeComponent({name:"ConfirmMerge",metaInfo:function(){return{title:this.profileString("mergeAccounts")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default(),commonProfileStrings],setup:function(){var changeFacilityService=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("changeFacilityService"),isConfirmed=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1);return{isConfirmed:isConfirmed,sendBack:function(){changeFacilityService.send({type:"BACK"})},handleContinue:function(){isConfirmed.value&&changeFacilityService.send({type:"CONTINUE"})}}},$trs:{confirmMergeInfoLine:{message:"You are about to merge two accounts and their progress data. Progress data includes your interactions with resources, time spent, and points. This cannot be undone.",context:"Text explaining the consequences merging will have."},consequences:{message:"I understand the consequences of merging accounts",context:"Button to confirm the acceptance of merging."}}},ConfirmMergevue_type_template_id_87f13aba_scoped_true_render,[],!1,null,"87f13aba",null).exports,SelectFacilityvue_type_template_id_29a2191e_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("span",{staticClass:"headercontainer"},[_c("h1",[_vm._v(_vm._s(_vm.getCommonSyncString("selectFacilityTitle")))]),_c("transition",{attrs:{name:"spinner-fade"}},[_vm.isFetching?_c("div",[_c("KLabeledIcon",{scopedSlots:_vm._u([{key:"icon",fn:function(){return[_c("KCircularLoader",{attrs:{size:16,stroke:6}})]},proxy:!0}],null,!1,3543262290)})],1):_vm._e()])],1),_vm.hasFetched&&!_vm.availableFacilities.length?_c("p",[_vm._v("\n    "+_vm._s(_vm.$tr("noFacilitiesText"))+"\n  ")]):_vm._e(),_vm._l(_vm.availableFacilities,(function(f){return _c("div",{key:"div-"+f.id},[_c("KRadioButton",{key:f.id,attrs:{value:f.id,label:_vm.formatNameAndId(f.name,f.id),disabled:_vm.facilityDisabled(f)},model:{value:_vm.selectedFacilityId,callback:function($$v){_vm.selectedFacilityId=$$v},expression:"selectedFacilityId"}})],1)})),_c("KGrid",{style:{marginTop:"34px",paddingTop:"10px",borderTop:"1px solid "+_vm.$themePalette.grey.v_300}},[_c("KGridItem",[_vm._v(_vm._s(_vm.$tr("doNotSeeYourFacility")))]),_c("KGridItem",[_c("KButton",{attrs:{text:_vm.getCommonSyncString("addNewAddressAction"),appearance:"basic-link"},on:{click:function($event){_vm.showAddAddressModal=!0}}})],1)],1),_vm.showAddAddressModal?_c("AddDeviceForm",{on:{cancel:function($event){_vm.showAddAddressModal=!1},added_address:_vm.handleAddedAddress}}):_vm._e(),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!0,text:_vm.coreString("continueAction"),disabled:""===_vm.selectedFacilityId},on:{click:_vm.to_continue}})],1)]}))],2)],2)};function core_typeof(o){return core_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},core_typeof(o)}function core_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=core_unsupportedIterableToArray(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e2){throw _e2},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e3){didErr=!0,err=_e3},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function core_toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return core_arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||core_unsupportedIterableToArray(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function core_slicedToArray(arr,i){return function(arr){if(Array.isArray(arr))return arr}(arr)||function(r,l){var t=null==r?null:"undefined"!=typeof Symbol&&r[Symbol.iterator]||r["@@iterator"];if(null!=t){var e,n,i,u,a=[],f=!0,o=!1;try{if(i=(t=t.call(r)).next,0===l){if(Object(t)!==t)return;f=!1}else for(;!(f=(e=i.call(t)).done)&&(a.push(e.value),a.length!==l);f=!0);}catch(r){o=!0,n=r}finally{try{if(!f&&null!=t.return&&(u=t.return(),Object(u)!==u))return}finally{if(o)throw n}}return a}}(arr,i)||core_unsupportedIterableToArray(arr,i)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function core_unsupportedIterableToArray(o,minLen){if(o){if("string"==typeof o)return core_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);return"Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n?Array.from(o):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?core_arrayLikeToArray(o,minLen):void 0}}function core_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function core_regeneratorRuntime(){core_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==core_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw new Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(core_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function core_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function core_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){core_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){core_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}SelectFacilityvue_type_template_id_29a2191e_scoped_true_render._withStripped=!0;function unrefElement(elRef){var _a,plain=shared_resolveUnref(elRef);return null!=(_a=null==plain?void 0:plain.$el)?_a:plain}var defaultWindow=shared_isClient?window:void 0;shared_isClient&&window.document,shared_isClient&&window.navigator,shared_isClient&&window.location;function useEventListener(){for(var target,events,listeners,options,_len2=arguments.length,args=new Array(_len2),_key2=0;_key2<_len2;_key2++)args[_key2]=arguments[_key2];if(shared_isString(args[0])||Array.isArray(args[0])?(events=args[0],listeners=args[1],options=args[2],target=defaultWindow):(target=args[0],events=args[1],listeners=args[2],options=args[3]),!target)return shared_noop;Array.isArray(events)||(events=[events]),Array.isArray(listeners)||(listeners=[listeners]);var cleanups=[],cleanup=function(){cleanups.forEach((function(fn){return fn()})),cleanups.length=0},stopWatch=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.watch)((function(){return[unrefElement(target),shared_resolveUnref(options)]}),(function(_ref2){var _ref3=core_slicedToArray(_ref2,2),el=_ref3[0],options2=_ref3[1];cleanup(),el&&cleanups.push.apply(cleanups,core_toConsumableArray(events.flatMap((function(event){return listeners.map((function(listener){return function(el,event,listener,options2){return el.addEventListener(event,listener,options2),function(){return el.removeEventListener(event,listener,options2)}}(el,event,listener,options2)}))}))))}),{immediate:!0,flush:"post"}),stop=function(){stopWatch(),cleanup()};return shared_tryOnScopeDispose(stop),stop}Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var _global="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},globalKey="__vueuse_ssr_handlers__";_global[globalKey]=_global[globalKey]||{};var handlers=_global[globalKey];function getSSRHandler(key,fallback){return handlers[key]||fallback}function guessSerializerType(rawInit){return null==rawInit?"any":rawInit instanceof Set?"set":rawInit instanceof Map?"map":rawInit instanceof Date?"date":"boolean"==typeof rawInit?"boolean":"string"==typeof rawInit?"string":"object"===core_typeof(rawInit)?"object":Number.isNaN(rawInit)?"any":"number"}var __defProp$k=Object.defineProperty,__getOwnPropSymbols$m=Object.getOwnPropertySymbols,__hasOwnProp$m=Object.prototype.hasOwnProperty,__propIsEnum$m=Object.prototype.propertyIsEnumerable,__defNormalProp$k=function(obj,key,value){return key in obj?__defProp$k(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value},__spreadValues$k=function(a,b){for(var prop in b||(b={}))__hasOwnProp$m.call(b,prop)&&__defNormalProp$k(a,prop,b[prop]);if(__getOwnPropSymbols$m){var _step6,_iterator6=core_createForOfIteratorHelper(__getOwnPropSymbols$m(b));try{for(_iterator6.s();!(_step6=_iterator6.n()).done;){prop=_step6.value;__propIsEnum$m.call(b,prop)&&__defNormalProp$k(a,prop,b[prop])}}catch(err){_iterator6.e(err)}finally{_iterator6.f()}}return a},StorageSerializers={boolean:{read:function(v){return"true"===v},write:function(v){return String(v)}},object:{read:function(v){return JSON.parse(v)},write:function(v){return JSON.stringify(v)}},number:{read:function(v){return Number.parseFloat(v)},write:function(v){return String(v)}},any:{read:function(v){return v},write:function(v){return String(v)}},string:{read:function(v){return v},write:function(v){return String(v)}},map:{read:function(v){return new Map(JSON.parse(v))},write:function(v){return JSON.stringify(Array.from(v.entries()))}},set:{read:function(v){return new Set(JSON.parse(v))},write:function(v){return JSON.stringify(Array.from(v))}},date:{read:function(v){return new Date(v)},write:function(v){return v.toISOString()}}},customStorageEventName="vueuse-storage";function useStorage(key,defaults,storage){var _a,options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},_options$flush=options.flush,flush=void 0===_options$flush?"pre":_options$flush,_options$deep2=options.deep,deep=void 0===_options$deep2||_options$deep2,_options$listenToStor=options.listenToStorageChanges,listenToStorageChanges=void 0===_options$listenToStor||_options$listenToStor,_options$writeDefault=options.writeDefaults,writeDefaults=void 0===_options$writeDefault||_options$writeDefault,_options$mergeDefault=options.mergeDefaults,mergeDefaults=void 0!==_options$mergeDefault&&_options$mergeDefault,shallow=options.shallow,_options$window6=options.window,window=void 0===_options$window6?defaultWindow:_options$window6,eventFilter=options.eventFilter,_options$onError2=options.onError,onError=void 0===_options$onError2?function(e){console.error(e)}:_options$onError2,data=(shallow?external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.shallowRef:external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(defaults);if(!storage)try{storage=getSSRHandler("getDefaultStorage",(function(){var _a2;return null==(_a2=defaultWindow)?void 0:_a2.localStorage}))()}catch(e){onError(e)}if(!storage)return data;var rawInit=shared_resolveUnref(defaults),type=guessSerializerType(rawInit),serializer=null!=(_a=options.serializer)?_a:StorageSerializers[type],_pausableWatch=watchPausable(data,(function(){return function(v){try{if(null==v)storage.removeItem(key);else{var serialized=serializer.write(v),oldValue=storage.getItem(key);oldValue!==serialized&&(storage.setItem(key,serialized),window&&window.dispatchEvent(new CustomEvent(customStorageEventName,{detail:{key:key,oldValue:oldValue,newValue:serialized,storageArea:storage}})))}}catch(e){onError(e)}}(data.value)}),{flush:flush,deep:deep,eventFilter:eventFilter}),pauseWatch=_pausableWatch.pause,resumeWatch=_pausableWatch.resume;return window&&listenToStorageChanges&&(useEventListener(window,"storage",update),useEventListener(window,customStorageEventName,(function(event){update(event.detail)}))),update(),data;function update(event){if(!event||event.storageArea===storage)if(event&&null==event.key)data.value=rawInit;else if(!event||event.key===key){pauseWatch();try{data.value=function(event){var rawValue=event?event.newValue:storage.getItem(key);if(null==rawValue)return writeDefaults&&null!==rawInit&&storage.setItem(key,serializer.write(rawInit)),rawInit;if(!event&&mergeDefaults){var value=serializer.read(rawValue);return shared_isFunction(mergeDefaults)?mergeDefaults(value,rawInit):"object"!==type||Array.isArray(value)?value:__spreadValues$k(__spreadValues$k({},rawInit),value)}return"string"!=typeof rawValue?rawValue:serializer.read(rawValue)}(event)}catch(e){onError(e)}finally{event?(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.nextTick)(resumeWatch):resumeWatch()}}}}Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;new Map;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var getMapVue2Compat=function(){var data=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.reactive)({});return{get:function(key){return data[key]},set:function(key,value){return(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.set)(data,key,value)},has:function(key){return function(val,key){return Object.prototype.hasOwnProperty.call(val,key)}(data,key)},delete:function(key){return(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.del)(data,key)},clear:function(){Object.keys(data).forEach((function(key){(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.del)(data,key)}))}}};Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var SwipeDirection,SwipeDirection2;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;(SwipeDirection2=SwipeDirection||(SwipeDirection={})).UP="UP",SwipeDirection2.RIGHT="RIGHT",SwipeDirection2.DOWN="DOWN",SwipeDirection2.LEFT="LEFT",SwipeDirection2.NONE="NONE";Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;Object.defineProperty,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var core_defProp=Object.defineProperty,core_getOwnPropSymbols=Object.getOwnPropertySymbols,core_hasOwnProp=Object.prototype.hasOwnProperty,core_propIsEnum=Object.prototype.propertyIsEnumerable,core_defNormalProp=function(obj,key,value){return key in obj?core_defProp(obj,key,{enumerable:!0,configurable:!0,writable:!0,value:value}):obj[key]=value};!function(a,b){for(var prop in b||(b={}))core_hasOwnProp.call(b,prop)&&core_defNormalProp(a,prop,b[prop]);if(core_getOwnPropSymbols){var _step35,_iterator35=core_createForOfIteratorHelper(core_getOwnPropSymbols(b));try{for(_iterator35.s();!(_step35=_iterator35.n()).done;){prop=_step35.value;core_propIsEnum.call(b,prop)&&core_defNormalProp(a,prop,b[prop])}}catch(err){_iterator35.e(err)}finally{_iterator35.f()}}}({linear:function(arg){return arg}},{easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]});var external_kolibriCoreAppGlobal_coreVue_mixins_commonSyncElements_namespaceObject=kolibriCoreAppGlobal.coreVue.mixins.commonSyncElements,external_kolibriCoreAppGlobal_coreVue_mixins_commonSyncElements_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_mixins_commonSyncElements_namespaceObject),external_kolibriCoreAppGlobal_coreVue_composables_useMinimumKolibriVersion_namespaceObject=kolibriCoreAppGlobal.coreVue.composables.useMinimumKolibriVersion,external_kolibriCoreAppGlobal_coreVue_composables_useMinimumKolibriVersion_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_composables_useMinimumKolibriVersion_namespaceObject),external_kolibriCoreAppGlobal_coreVue_componentSets_sync_namespaceObject=kolibriCoreAppGlobal.coreVue.componentSets.sync;function SelectFacilityvue_type_script_lang_js_typeof(o){return SelectFacilityvue_type_script_lang_js_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},SelectFacilityvue_type_script_lang_js_typeof(o)}function SelectFacilityvue_type_script_lang_js_createForOfIteratorHelper(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function(o,minLen){if(!o)return;if("string"==typeof o)return SelectFacilityvue_type_script_lang_js_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return SelectFacilityvue_type_script_lang_js_arrayLikeToArray(o,minLen)}(o))||allowArrayLike&&o&&"number"==typeof o.length){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}function SelectFacilityvue_type_script_lang_js_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function SelectFacilityvue_type_script_lang_js_regeneratorRuntime(){SelectFacilityvue_type_script_lang_js_regeneratorRuntime=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",u=i.toStringTag||"@@toStringTag";function define(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{define({},"")}catch(t){define=function(t,e,r){return t[e]=r}}function wrap(t,e,r,n){var i=e&&e.prototype instanceof Generator?e:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(t,r,c)}),a}function tryCatch(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=wrap;var h="suspendedStart",l="suspendedYield",f="executing",s="completed",y={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var p={};define(p,a,(function(){return this}));var d=Object.getPrototypeOf,v=d&&d(d(values([])));v&&v!==r&&n.call(v,a)&&(p=v);var g=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(p);function defineIteratorMethods(t){["next","throw","return"].forEach((function(e){define(t,e,(function(t){return this._invoke(e,t)}))}))}function AsyncIterator(t,e){function invoke(r,o,i,a){var c=tryCatch(t[r],t,o);if("throw"!==c.type){var u=c.arg,h=u.value;return h&&"object"==SelectFacilityvue_type_script_lang_js_typeof(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){invoke("next",t,i,a)}),(function(t){invoke("throw",t,i,a)})):e.resolve(h).then((function(t){u.value=t,i(u)}),(function(t){return invoke("throw",t,i,a)}))}a(c.arg)}var r;o(this,"_invoke",{value:function(t,n){function callInvokeWithMethodAndArg(){return new e((function(e,r){invoke(t,n,e,r)}))}return r=r?r.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,r,n){var o=h;return function(i,a){if(o===f)throw new Error("Generator is already running");if(o===s){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var u=maybeInvokeDelegate(c,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=s,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=f;var p=tryCatch(e,r,n);if("normal"===p.type){if(o=n.done?s:l,p.arg===y)continue;return{value:p.arg,done:n.done}}"throw"===p.type&&(o=s,n.method="throw",n.arg=p.arg)}}}function maybeInvokeDelegate(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,maybeInvokeDelegate(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=tryCatch(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function pushTryEntry(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function resetTryEntry(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function Context(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function next(){for(;++o<e.length;)if(n.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=t,next.done=!0,next};return i.next=i}}throw new TypeError(SelectFacilityvue_type_script_lang_js_typeof(e)+" is not iterable")}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(g,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===GeneratorFunction||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,GeneratorFunctionPrototype):(t.__proto__=GeneratorFunctionPrototype,define(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},e.awrap=function(t){return{__await:t}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,c,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},defineIteratorMethods(g),define(g,u,"Generator"),define(g,a,(function(){return this})),define(g,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function next(){for(;r.length;){var t=r.pop();if(t in e)return next.value=t,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function handle(n,o){return a.type="throw",a.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return handle("end");if(i.tryLoc<=this.prev){var c=n.call(i,"catchLoc"),u=n.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0);if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return handle(i.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return handle(i.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;resetTryEntry(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:values(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function SelectFacilityvue_type_script_lang_js_asyncGeneratorStep(gen,resolve,reject,_next,_throw,key,arg){try{var info=gen[key](arg),value=info.value}catch(error){return void reject(error)}info.done?resolve(value):Promise.resolve(value).then(_next,_throw)}function SelectFacilityvue_type_script_lang_js_asyncToGenerator(fn){return function(){var self=this,args=arguments;return new Promise((function(resolve,reject){var gen=fn.apply(self,args);function _next(value){SelectFacilityvue_type_script_lang_js_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"next",value)}function _throw(err){SelectFacilityvue_type_script_lang_js_asyncGeneratorStep(gen,resolve,reject,_next,_throw,"throw",err)}_next(void 0)}))}}var SelectFacilityvue_type_script_lang_js={name:"SelectFacility",metaInfo:function(){return{title:this.getCommonSyncString("selectFacilityTitle")}},components:{AddDeviceForm:external_kolibriCoreAppGlobal_coreVue_componentSets_sync_namespaceObject.AddDeviceForm,BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default(),external_kolibriCoreAppGlobal_coreVue_mixins_commonSyncElements_default(),commonProfileStrings],setup:function(){var evaluationCallback,initialState,optionsOrRef,_options2,_options2$lazy,lazy,_options2$evaluating,evaluating,_options2$shallow,shallow,_options2$onError,onError,started,current,counter,_useDevices=(0,external_kolibriCoreAppGlobal_coreVue_componentSets_sync_namespaceObject.useDevices)({subset_of_users_device:!1}),_devices=_useDevices.devices,_isFetching=_useDevices.isFetching,hasFetched=_useDevices.hasFetched,fetchFailed=_useDevices.fetchFailed,forceFetch=_useDevices.forceFetch,_useDeviceDeletion=(0,external_kolibriCoreAppGlobal_coreVue_componentSets_sync_namespaceObject.useDeviceDeletion)(_devices),devices=_useDeviceDeletion.devices,isDeleting=_useDeviceDeletion.isDeleting,hasDeleted=_useDeviceDeletion.hasDeleted,deletingFailed=_useDeviceDeletion.deletingFailed,doDelete=_useDeviceDeletion.doDelete,storageFacilityId=function(key,initialValue){var options=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},_options$window15=options.window,window=void 0===_options$window15?defaultWindow:_options$window15;return useStorage(key,initialValue,null==window?void 0:window.localStorage,options)}("kolibri-lastSelectedFacilityId",""),selectedFacilityId=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(""),showAddAddressModal=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),isLoading=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),$store=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.getCurrentInstance)().proxy.$store,fetchDeviceFacilities=function(resolver,options){var cache=(null==options?void 0:options.cache)?(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.reactive)(options.cache):getMapVue2Compat(),generateKey=function(){for(var _len6=arguments.length,args=new Array(_len6),_key6=0;_key6<_len6;_key6++)args[_key6]=arguments[_key6];return(null==options?void 0:options.getKey)?options.getKey.apply(options,args):JSON.stringify(args)},_loadData=function(key){for(var _len7=arguments.length,args=new Array(_len7>1?_len7-1:0),_key7=1;_key7<_len7;_key7++)args[_key7-1]=arguments[_key7];return cache.set(key,resolver.apply(void 0,args)),cache.get(key)},memoized=function(){for(var _len9=arguments.length,args=new Array(_len9),_key9=0;_key9<_len9;_key9++)args[_key9]=arguments[_key9];var key=generateKey.apply(void 0,args);return cache.has(key)?cache.get(key):_loadData.apply(void 0,[key].concat(args))};return memoized.load=function(){for(var _len8=arguments.length,args=new Array(_len8),_key8=0;_key8<_len8;_key8++)args[_key8]=arguments[_key8];return _loadData.apply(void 0,[generateKey.apply(void 0,args)].concat(args))},memoized.delete=function(){cache.delete(generateKey.apply(void 0,arguments))},memoized.clear=function(){cache.clear()},memoized.generateKey=generateKey,memoized.cache=cache,memoized}(function(){var _ref=SelectFacilityvue_type_script_lang_js_asyncToGenerator(SelectFacilityvue_type_script_lang_js_regeneratorRuntime().mark((function _callee(device){var _yield$NetworkLocatio,facilities;return SelectFacilityvue_type_script_lang_js_regeneratorRuntime().wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.prev=0,_context.next=3,external_kolibriCoreAppGlobal_resources_namespaceObject.NetworkLocationResource.fetchFacilities(device.id);case 3:return _yield$NetworkLocatio=_context.sent,facilities=_yield$NetworkLocatio.facilities,_context.abrupt("return",facilities.map((function(facility){return{id:facility.id,name:facility.name,base_url:device.base_url,address_id:device.id,learner_can_sign_up:facility.learner_can_sign_up,learner_can_login_with_no_password:facility.learner_can_login_with_no_password,kolibri_version:device.kolibri_version}})));case 8:return _context.prev=8,_context.t0=_context.catch(0),_context.abrupt("return",[]);case 11:case"end":return _context.stop()}}),_callee,null,[[0,8]])})));return function(_x){return _ref.apply(this,arguments)}}(),{getKey:function(device){return device.id}}),isFetching=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return get(_isFetching)||get(isLoading)})),availableAddressIds=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return get(devices).filter((function(d){return d.available})).map((function(d){return d.id}))})),availableFacilities=(evaluationCallback=SelectFacilityvue_type_script_lang_js_asyncToGenerator(SelectFacilityvue_type_script_lang_js_regeneratorRuntime().mark((function _callee2(){var _devices,facilitiesFromDevices,facilities,_iterator,_step,deviceFacilities,_iterator2,_step2,facility;return SelectFacilityvue_type_script_lang_js_regeneratorRuntime().wrap((function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _devices=get(devices).filter((function(d){return get(availableAddressIds).includes(d.id)})).sort((function(deviceA,deviceB){return deviceA.since_last_accessed-deviceB.since_last_accessed})),_context2.next=3,Promise.all(_devices.map((function(d){return fetchDeviceFacilities(d)})));case 3:facilitiesFromDevices=_context2.sent,facilities={},_iterator=SelectFacilityvue_type_script_lang_js_createForOfIteratorHelper(facilitiesFromDevices);try{for(_iterator.s();!(_step=_iterator.n()).done;){deviceFacilities=_step.value,_iterator2=SelectFacilityvue_type_script_lang_js_createForOfIteratorHelper(deviceFacilities);try{for(_iterator2.s();!(_step2=_iterator2.n()).done;)(facility=_step2.value)[facility.id]||(facilities[facility.id]=facility)}catch(err){_iterator2.e(err)}finally{_iterator2.f()}}}catch(err){_iterator.e(err)}finally{_iterator.f()}return _context2.abrupt("return",Object.values(facilities).sort((function(facilityA,facilityB){return facilityA.name<facilityB.name?-1:facilityA.name>facilityB.name?1:0})));case 8:case"end":return _context2.stop()}}),_callee2)}))),initialState=[],optionsOrRef={evaluating:isLoading,shallow:!1},_options2=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.isRef)(optionsOrRef)?{evaluating:optionsOrRef}:optionsOrRef||{},_options2$lazy=_options2.lazy,lazy=void 0!==_options2$lazy&&_options2$lazy,_options2$evaluating=_options2.evaluating,evaluating=void 0===_options2$evaluating?void 0:_options2$evaluating,_options2$shallow=_options2.shallow,shallow=void 0!==_options2$shallow&&_options2$shallow,_options2$onError=_options2.onError,onError=void 0===_options2$onError?shared_noop:_options2$onError,started=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!lazy),current=shallow?(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.shallowRef)(initialState):(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(initialState),counter=0,(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.watchEffect)(function(){var _ref=core_asyncToGenerator(core_regeneratorRuntime().mark((function _callee(onInvalidate){var counterAtBeginning,hasFinished,result;return core_regeneratorRuntime().wrap((function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(started.value){_context.next=2;break}return _context.abrupt("return");case 2:return counter++,counterAtBeginning=counter,hasFinished=!1,evaluating&&Promise.resolve().then((function(){evaluating.value=!0})),_context.prev=6,_context.next=9,evaluationCallback((function(cancelCallback){onInvalidate((function(){evaluating&&(evaluating.value=!1),hasFinished||cancelCallback()}))}));case 9:result=_context.sent,counterAtBeginning===counter&&(current.value=result),_context.next=16;break;case 13:_context.prev=13,_context.t0=_context.catch(6),onError(_context.t0);case 16:return _context.prev=16,evaluating&&counterAtBeginning===counter&&(evaluating.value=!1),hasFinished=!0,_context.finish(16);case 20:case"end":return _context.stop()}}),_callee,null,[[6,13,16,20]])})));return function(_x2){return _ref.apply(this,arguments)}}()),lazy?(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return started.value=!0,current.value})):current),isMinimumKolibriVersion=external_kolibriCoreAppGlobal_coreVue_composables_useMinimumKolibriVersion_default()(0,16,0).isMinimumKolibriVersion,facilityDisabled=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return function(facility){return get(fetchFailed)||void 0===get(availableAddressIds).find((function(id){return id===facility.address_id}))||!isMinimumKolibriVersion(facility.kolibri_version)}}));function resetSelectedAddress(){var enabledFacilities=availableFacilities.value.filter((function(f){return isMinimumKolibriVersion(f.kolibri_version)}));if(0!==enabledFacilities.length){var selectedId=storageFacilityId.value||selectedFacilityId.value;selectedFacilityId.value=enabledFacilities.map((function(f){return f.id})).find((function(f){return f===selectedId}))||enabledFacilities[0].id}else selectedFacilityId.value=""}return(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.watch)(availableFacilities,(function(availableFacilities){get(availableFacilities).map((function(f){return f.id})).includes(selectedFacilityId.value)||(selectedFacilityId.value=""),selectedFacilityId.value||resetSelectedAddress()})),{devices:devices,isFetching:isFetching,hasFetched:hasFetched,fetchFailed:fetchFailed,forceFetch:forceFetch,isDeleting:isDeleting,hasDeleted:hasDeleted,deletingFailed:deletingFailed,doDelete:doDelete,fetchDeviceFacilities:fetchDeviceFacilities,availableFacilities:availableFacilities,availableAddressIds:availableAddressIds,storageFacilityId:storageFacilityId,selectedFacilityId:selectedFacilityId,showAddAddressModal:showAddAddressModal,facilityDisabled:facilityDisabled,handleAddedAddress:function(){var args;forceFetch(),args=this.$tr("addDeviceSnackbarText"),$store.dispatch("createSnackbar",args),this.showAddAddressModal=!1},resetSelectedAddress:resetSelectedAddress,to_continue:function(){this.changeFacilityService.send({type:"CONTINUE"})}}},inject:["changeFacilityService"],watch:{selectedFacilityId:function(newVal){this.storageFacilityId=newVal;var facility=this.availableFacilities.find((function(f){return f.id===newVal}));this.changeFacilityService.send({type:"SELECTFACILITY",value:{name:facility.name,url:facility.base_url,id:facility.id,learner_can_sign_up:facility.learner_can_sign_up,learner_can_login_with_no_password:facility.learner_can_login_with_no_password}})}},$trs:{addDeviceSnackbarText:{message:"Successfully added device",context:"This message appears if a device has been added correctly."},doNotSeeYourFacility:{message:"Don't see your learning facility?",context:'This text appears next to the "Add new address" link. This option allows you to add a new network address from which to sync data.'},noFacilitiesText:{message:"No learning facilities found",context:"This message displays when there are no accessible facilities found in the network. It can appear after the user selects to change to another existing facility."},noPermissionToJoinFacility:{message:"You don't have permission to join this learning facility",context:""}}},SelectFacility=normalizeComponent(SelectFacilityvue_type_script_lang_js,SelectFacilityvue_type_template_id_29a2191e_scoped_true_render,[],!1,null,"29a2191e",null).exports,ConfirmAccountUsernamevue_type_template_id_0fc1b69a_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.$tr("documentTitle")))]),_c("p",[_vm._v(_vm._s(_vm.firstLine))]),_c("p",[_vm._v(_vm._s(_vm.secondLine))]),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!1,text:_vm.profileString("createAccount"),disabled:_vm.isCreateAccountButtonDisabled,"data-test":"createNewAccountButton",appearance:"flat-button"},on:{click:_vm.to_create}}),_c("KButton",{attrs:{primary:!0,text:_vm.coreString("continueAction"),disabled:_vm.usernameExists},on:{click:_vm.to_continue}})],1)]}))],2)],1)};ConfirmAccountUsernamevue_type_template_id_0fc1b69a_render._withStripped=!0;var lodash_get=__webpack_require__(1441),get_default=__webpack_require__.n(lodash_get),ConfirmAccountUsername=normalizeComponent({name:"ConfirmAccountUsername",metaInfo:function(){return{title:this.$tr("documentTitle")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default(),commonProfileStrings],inject:["changeFacilityService","state"],computed:{targetFacility:function(){return get_default()(this.state,"value.targetFacility")},username:function(){return get_default()(this.state,"value.username")},usernameExists:function(){return get_default()(this.state,"value.accountExists")},isCreateAccountButtonDisabled:function(){return!get_default()(this.targetFacility,"learner_can_sign_up")},firstLine:function(){return this.$tr("confirmAccountLine1",{target_facility:get_default()(this.targetFacility,"name",""),username:this.username})},secondLine:function(){return this.$tr("confirmAccountLine2",{target_facility:get_default()(this.targetFacility,"name","")})}},methods:{to_continue:function(){this.changeFacilityService.send({type:"CONTINUE"})},to_create:function(){this.changeFacilityService.send({type:"NEW"})}},$trs:{documentTitle:{message:"Confirm account username",context:"Title of this step for the change facility page."},confirmAccountLine1:{message:"You are about to join '{target_facility}' learning facility as '{username}'.",context:"First line of text confirming the username and facility where the user is changing."},confirmAccountLine2:{message:"You can continue with this username or create a new account for '{target_facility}'.",context:"Second line of text confirming the username and facility where the user is changing"}}},ConfirmAccountUsernamevue_type_template_id_0fc1b69a_render,[],!1,null,null,null).exports,ConfirmChangeFacilityvue_type_template_id_ec875c24_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.coreString("changeLearningFacility")))]),_c("p",[_vm._v(_vm._s(_vm.firstLine))]),_c("p",[_vm._v(_vm._s(_vm.secondLine))]),_c("p",[_vm._v(_vm._s(_vm.thirdLine))]),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!1,text:_vm.profileString("mergeAccounts"),appearance:"flat-button"},on:{click:_vm.to_merge}}),_c("KButton",{attrs:{primary:!0,text:_vm.coreString("continueAction"),disabled:_vm.isCreateAccountDisabled},on:{click:_vm.to_continue}})],1)]}))],2)],1)};ConfirmChangeFacilityvue_type_template_id_ec875c24_render._withStripped=!0;var ConfirmChangeFacility=normalizeComponent({name:"ConfirmChangeFacility",metaInfo:function(){return{title:this.profileString("mergeAccounts")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default(),commonProfileStrings],inject:["changeFacilityService","state"],data:function(){return{lastUserOnDevice:!1}},computed:{targetFacility:function(){return this.state.value.targetFacility},role:function(){return this.state.value.role},isCreateAccountDisabled:function(){return!get_default()(this.targetFacility,"learner_can_sign_up")},firstLine:function(){return this.$tr("changeFacilityInfoLine1",{target_facility:this.targetFacility.name})},secondLine:function(){return"learner"===this.role||this.lastUserOnDevice?"":this.$tr("changeFacilityInfoLine2",{role:this.role,facility:this.targetFacility.name})},thirdLine:function(){return this.$tr("changeFacilityInfoLine3",{target_facility:this.targetFacility.name})}},created:function(){var _this=this;external_kolibriCoreAppGlobal_resources_namespaceObject.FacilityUserResource.fetchCollection({force:!0,getParams:{member_of:this.state.value.sourceFacility}}).then((function(users){1===Object.keys(users).length&&(_this.lastUserOnDevice=!0)}))},methods:{to_continue:function(){this.changeFacilityService.send({type:"CONTINUE"})},to_merge:function(){this.changeFacilityService.send({type:"MERGE"})}},$trs:{changeFacilityInfoLine1:{message:"You are about to move your account and progress data to '{target_facility}' learning facility. Your current data will still be available to you and will also be accessible to any administrators of this learning facility.",context:"First line of text explaining what changing to another learning facility means."},changeFacilityInfoLine2:{message:"Your user account type will change from '{role}' to 'learner' and you will no longer be able to manage resources on this device. You will need someone with admin permissions in '{facility}' to change your account type back to '{role}'.",context:"Second line of text explaining that changing to another learning facility will downgrade the user role to learner"},changeFacilityInfoLine3:{message:"You can also search for an account in '{target_facility}' to merge with. Progress data from both accounts will be combined into one account.",context:"Last line of text explaining what changing to another learning facility means."}}},ConfirmChangeFacilityvue_type_template_id_ec875c24_render,[],!1,null,null,null).exports,MergeAccountDialogvue_type_template_id_8a3b110e_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.profileString("mergeAccounts")))]),_c("p",{staticClass:"fullname",attrs:{"data-test":"fullName"}},[_vm._v("\n    "+_vm._s(_vm.fullName)+"\n  ")]),_c("p",{staticClass:"username",style:{color:_vm.$themeTokens.annotation},attrs:{"data-test":"username"}},[_vm._v("\n    "+_vm._s(_vm.username)+"\n  ")]),_vm.usingAdminPasswordState?_c("span",[_c("p",[_vm._v(_vm._s(_vm.mergeAccountUsingAdminAccount))]),_c("KTextbox",{attrs:{"data-test":"usernameTextbox",autofocus:!0,label:_vm.coreString("usernameLabel")},model:{value:_vm.formData.username,callback:function($$v){_vm.$set(_vm.formData,"username",$$v)},expression:"formData.username"}})],1):_c("p",[_vm._v("\n    "+_vm._s(_vm.mergeAccountUserInfo)+"\n  ")]),_vm.showPasswordTextbox?_c("KTextbox",{ref:"passwordTextbox",attrs:{"data-test":"passwordTextbox",type:"password",label:_vm.coreString("passwordLabel"),autofocus:!0,invalid:_vm.isPasswordInvalid,invalidText:_vm.$tr("incorrectPasswordError"),floatingLabel:!1},on:{keydown:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.handleContinue.apply(null,arguments)}},model:{value:_vm.formData.password,callback:function($$v){_vm.$set(_vm.formData,"password",$$v)},expression:"formData.password"}}):_vm._e(),_vm.usingAdminPasswordState?_vm._e():_c("div",[_vm._v("\n    "+_vm._s(_vm.$tr("doNotKnowPassword"))+"\n    "),_c("KButton",{attrs:{"data-test":"useAdminAccount",text:_vm.profileString("useAdminAccount"),appearance:"basic-link"},on:{click:_vm.useAdminAccount}})],1),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!1,text:_vm.coreString("backAction"),appearance:"flat-button","data-test":"backButton"},on:{click:_vm.sendBack}}),_c("KButton",{attrs:{primary:!0,text:_vm.coreString("continueAction"),"data-test":"continueButton"},on:{click:_vm.handleContinue}})],1)]}))],2)],1)};MergeAccountDialogvue_type_template_id_8a3b110e_scoped_true_render._withStripped=!0;var MergeAccountDialogvue_type_script_lang_js={name:"MergeAccountDialog",metaInfo:function(){return{title:this.profileString("mergeAccounts")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default(),commonProfileStrings],setup:function(){var changeFacilityService=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("changeFacilityService"),state=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("state"),isFormSubmitted=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),isPasswordInvalid=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),usingAdminPasswordState=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),fullName=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return get_default()(state,"value.fullname","")})),username=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return get_default()(state,"value.username","")})),formData=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)({username:get_default()(state,"value.username",""),password:""});(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.watch)(changeFacilityService,(function(currentValue){"useAdminPassword"===currentValue.state.value?(usingAdminPasswordState.value=!0,formData.value.username=""):(usingAdminPasswordState.value=!1,formData.value.username=get_default()(state,"value.username",""))}));var mergeAccountUserInfo=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)({get:function(){return this.$tr("mergeAccountUserInfo",{target_facility:get_default()(state,"value.targetFacility.name",""),username:get_default()(state,"value.targetAccount.username","")})}}),mergeAccountUsingAdminAccount=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)({get:function(){return this.$tr("mergeAccountUsingAdminAccount",{target_facility:get_default()(state,"value.targetFacility.name","")})}});function showPasswordTextbox(){return!get_default()(state,"value.targetFacility.learner_can_login_with_no_password",!1)}return{formData:formData,isFormSubmitted:isFormSubmitted,isPasswordInvalid:isPasswordInvalid,usingAdminPasswordState:usingAdminPasswordState,username:username,fullName:fullName,mergeAccountUserInfo:mergeAccountUserInfo,mergeAccountUsingAdminAccount:mergeAccountUsingAdminAccount,showPasswordTextbox:showPasswordTextbox,useAdminAccount:function(){changeFacilityService.send({type:"USEADMIN"})},sendBack:function(){changeFacilityService.send({type:"BACK"})},handleContinue:function(){var facility=get_default()(state,"value.targetFacility",{}),component=this;useRemoteFacility(facility.url,facility.id,get_default()(state,"value.targetAccount.username",""),formData.value.password,usingAdminPasswordState.value?formData.value.username:null).then((function(user_info){var data;"error"===user_info?(isPasswordInvalid.value=!0,function(component){showPasswordTextbox&&isPasswordInvalid.value&&component.$refs.passwordTextbox.focus()}(component)):(isPasswordInvalid.value=!1,isFormSubmitted.value=!0,data=user_info,usingAdminPasswordState.value?(data.username=get_default()(state,"value.targetAccount.username",""),data.password=null,data.AdminUsername=formData.value.username,data.AdminPassword=formData.value.password):data.password=formData.value.password,changeFacilityService.send({type:"CONTINUE",value:data}))}))}}},$trs:{mergeAccountUserInfo:{message:"Enter the password of the account '{username}' in '{target_facility}' learning facility that you want to merge your account with.",context:"Line of text asking for the password of the user to be merged in the target facility."},mergeAccountUsingAdminAccount:{message:"Enter the username and password of a facility admin or a super admin for '{target_facility}' learning facility.",context:"Line of text asking for the credentials of an admin account in the target facility."},doNotKnowPassword:{message:"Don't know the password?",context:"Giving an option if the user does not know the password for this user in the target facility"},incorrectPasswordError:{message:"Incorrect password",context:"Error that is shown if the user provides the wrong password."}}},MergeAccountDialog=normalizeComponent(MergeAccountDialogvue_type_script_lang_js,MergeAccountDialogvue_type_template_id_8a3b110e_scoped_true_render,[],!1,null,"8a3b110e",null).exports,ConfirmAccountDetailsvue_type_template_id_67f42158_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.$tr("documentTitle")))]),_vm._v("\n\n  "+_vm._s(_vm.confirmAccountUserInfo)+"\n  "),_c("table",[_c("tr",[_c("th",[_vm._v("\n        "+_vm._s(_vm.coreString("fullNameLabel"))+"\n      ")]),_c("td",{attrs:{"data-test":"fullname"}},[_vm._v("\n        "+_vm._s(_vm.targetAccount.full_name)+"\n      ")])]),_c("tr",[_c("th",[_vm._v("\n        "+_vm._s(_vm.coreString("usernameLabel"))+"\n      ")]),_c("td",{attrs:{"data-test":"username"}},[_vm._v("\n        "+_vm._s(_vm.targetAccount.username)+"\n      ")])]),_c("tr",[_c("th",[_vm._v("\n        "+_vm._s(_vm.coreString("identifierLabel"))+"\n      ")]),_c("td",{attrs:{dir:"auto","data-test":"idnumber"}},[_vm._v("\n        "+_vm._s(_vm.cleanValue(_vm.targetAccount.id_number))+"\n      ")])]),_c("tr",[_c("th",[_vm._v("\n        "+_vm._s(_vm.coreString("genderLabel"))+"\n      ")]),_c("td",{attrs:{dir:"auto","data-test":"gender"}},[_c("GenderDisplayText",{attrs:{gender:_vm.targetAccount.gender}})],1)]),_c("tr",[_c("th",[_vm._v("\n        "+_vm._s(_vm.coreString("birthYearLabel"))+"\n      ")]),_c("td",{attrs:{dir:"auto","data-test":"birthyear"}},[_c("BirthYearDisplayText",{attrs:{birthYear:_vm.targetAccount.birth_year}})],1)])]),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!1,text:_vm.coreString("backAction"),appearance:"flat-button","data-test":"backButton"},on:{click:_vm.sendBack}}),_c("KButton",{attrs:{primary:!0,text:_vm.coreString("continueAction"),"data-test":"continueButton"},on:{click:_vm.handleContinue}})],1)]}))],2)],1)};ConfirmAccountDetailsvue_type_template_id_67f42158_scoped_true_render._withStripped=!0;var ConfirmAccountDetails=normalizeComponent({name:"ConfirmAccountDetails",metaInfo:function(){return{title:this.$tr("documentTitle")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default(),GenderDisplayText:external_kolibriCoreAppGlobal_coreVue_components_GenderDisplayText_default(),BirthYearDisplayText:external_kolibriCoreAppGlobal_coreVue_components_BirthYearDisplayText_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default()],setup:function(){var changeFacilityService=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("changeFacilityService"),state=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("state"),targetAccount=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return get_default()(state,"value.targetAccount",{})}));return{confirmAccountUserInfo:(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)({get:function(){return this.$tr("confirmAccountUserInfo",{target_facility:get_default()(state,"value.targetFacility.name","")})}}),cleanValue:function(value){return value===external_kolibriCoreAppGlobal_coreVue_vuex_constants_namespaceObject.DemographicConstants.NOT_SPECIFIED?"":value},sendBack:function(){changeFacilityService.send({type:"BACK"})},handleContinue:function(){changeFacilityService.send({type:"CONTINUE"})},targetAccount:targetAccount}},$trs:{documentTitle:{message:"Confirm account details",context:"Title of this step for the change facility page."},confirmAccountUserInfo:{message:"Your account will be merged into this account in '{target_facility}'. You will need to use the username and password for this account from now on.",context:"Line of text asking for the password of the user to be merged in the target facility."}}},ConfirmAccountDetailsvue_type_template_id_67f42158_scoped_true_render,[],!1,null,"67f42158",null).exports,CreateAccountvue_type_template_id_0eba65aa_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.profileString("createAccount")))]),_c("p",[_vm._v(_vm._s(_vm.description))]),_c("UsernameTextbox",{ref:"usernameTextbox",attrs:{"data-test":"usernameTextbox",autofocus:!0,value:_vm.formData.username,isValid:_vm.isUsernameValid,shouldValidate:_vm.isFormSubmitted},on:{"update:value":function($event){return _vm.$set(_vm.formData,"username",$event)},"update:isValid":function($event){_vm.isUsernameValid=$event},"update:is-valid":function($event){_vm.isUsernameValid=$event}}}),_vm.showPasswordTextbox?_c("PasswordTextbox",{ref:"passwordTextbox",attrs:{"data-test":"passwordTextbox",value:_vm.formData.password,isValid:_vm.isPasswordValid,shouldValidate:_vm.isFormSubmitted},on:{"update:value":function($event){return _vm.$set(_vm.formData,"password",$event)},"update:isValid":function($event){_vm.isPasswordValid=$event},"update:is-valid":function($event){_vm.isPasswordValid=$event}}}):_vm._e(),_c("PrivacyLinkAndModal"),_c("p",{style:{color:_vm.$themeTokens.annotation}},[_vm._v("\n    "+_vm._s(_vm.coreString("rememberThisAccountInformation"))+"\n  ")]),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!1,text:_vm.coreString("backAction"),appearance:"flat-button","data-test":"backButton"},on:{click:_vm.sendBack}}),_c("KButton",{attrs:{primary:!0,text:_vm.coreString("continueAction"),"data-test":"continueButton"},on:{click:_vm.handleContinue}})],1)]}))],2)],1)};CreateAccountvue_type_template_id_0eba65aa_render._withStripped=!0;var external_kolibriCoreAppGlobal_coreVue_components_PrivacyLinkAndModal_namespaceObject=kolibriCoreAppGlobal.coreVue.components.PrivacyLinkAndModal,external_kolibriCoreAppGlobal_coreVue_components_PrivacyLinkAndModal_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_PrivacyLinkAndModal_namespaceObject);function CreateAccountvue_type_script_lang_js_typeof(o){return CreateAccountvue_type_script_lang_js_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},CreateAccountvue_type_script_lang_js_typeof(o)}function CreateAccountvue_type_script_lang_js_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function CreateAccountvue_type_script_lang_js_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?CreateAccountvue_type_script_lang_js_ownKeys(Object(t),!0).forEach((function(r){CreateAccountvue_type_script_lang_js_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):CreateAccountvue_type_script_lang_js_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function CreateAccountvue_type_script_lang_js_defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=CreateAccountvue_type_script_lang_js_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=CreateAccountvue_type_script_lang_js_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==CreateAccountvue_type_script_lang_js_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}var CreateAccount=normalizeComponent({name:"CreateAccount",metaInfo:function(){return{title:this.profileString("mergeAccounts")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default(),UsernameTextbox:external_kolibriCoreAppGlobal_coreVue_components_UsernameTextbox_default(),PasswordTextbox:external_kolibriCoreAppGlobal_coreVue_components_PasswordTextbox_default(),PrivacyLinkAndModal:external_kolibriCoreAppGlobal_coreVue_components_PrivacyLinkAndModal_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default(),commonProfileStrings],inject:["changeFacilityService","state"],data:function(){return{formData:{username:"",password:""},isUsernameValid:!1,isPasswordValid:!1,isFormSubmitted:!1}},computed:CreateAccountvue_type_script_lang_js_objectSpread(CreateAccountvue_type_script_lang_js_objectSpread({},(0,external_kolibriCoreAppGlobal_lib_vuex_namespaceObject.mapGetters)(["session"])),{},{description:function(){return this.$tr("description",{fullName:get_default()(this.session,"full_name",""),targetFacility:get_default()(this.state,"value.targetFacility.name","")})},showPasswordTextbox:function(){return!get_default()(this.state,"value.targetFacility.learner_can_login_with_no_password",!1)},isFormValid:function(){return this.isUsernameValid&&(!this.showPasswordTextbox||this.isPasswordValid)}}),methods:{handleContinue:function(){this.isFormSubmitted=!0,this.isFormValid?this.sendContinue():this.focusOnInvalidField()},focusOnInvalidField:function(){this.isUsernameValid?this.showPasswordTextbox&&!this.isPasswordValid&&this.$refs.passwordTextbox.focus():this.$refs.usernameTextbox.focus()},sendContinue:function(){this.changeFacilityService.send({type:"CONTINUE",value:this.formData})},sendBack:function(){this.changeFacilityService.send({type:"BACK"})}},$trs:{description:{message:"New account for '{fullName}' in '{targetFacility}' learning facility",context:"When they are changing facility users can choose a new account name."}}},CreateAccountvue_type_template_id_0eba65aa_render,[],!1,null,null,null).exports,CreatePasswordvue_type_template_id_34279c65_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.$tr("documentTitle")))]),_c("p",[_vm._v(_vm._s(_vm.description))]),_c("p",[_vm._v(_vm._s(_vm.$tr("hint")))]),_c("PasswordTextbox",{ref:"passwordTextbox",attrs:{"data-test":"passwordTextbox",value:_vm.formData.password,isValid:_vm.isPasswordValid,shouldValidate:_vm.isFormSubmitted},on:{"update:value":function($event){return _vm.$set(_vm.formData,"password",$event)},"update:isValid":function($event){_vm.isPasswordValid=$event},"update:is-valid":function($event){_vm.isPasswordValid=$event}}}),_c("p",{style:{color:_vm.$themeTokens.annotation}},[_vm._v("\n    "+_vm._s(_vm.coreString("rememberThisAccountInformation"))+"\n  ")]),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!1,text:_vm.coreString("backAction"),appearance:"flat-button","data-test":"backButton"},on:{click:_vm.sendBack}}),_c("KButton",{attrs:{primary:!0,text:_vm.coreString("continueAction"),"data-test":"continueButton",disabled:!_vm.isPasswordValid},on:{click:_vm.handleContinue}})],1)]}))],2)],1)};function CreatePasswordvue_type_script_lang_js_typeof(o){return CreatePasswordvue_type_script_lang_js_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},CreatePasswordvue_type_script_lang_js_typeof(o)}function CreatePasswordvue_type_script_lang_js_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function CreatePasswordvue_type_script_lang_js_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?CreatePasswordvue_type_script_lang_js_ownKeys(Object(t),!0).forEach((function(r){CreatePasswordvue_type_script_lang_js_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):CreatePasswordvue_type_script_lang_js_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function CreatePasswordvue_type_script_lang_js_defineProperty(obj,key,value){var i;return i=function(t,r){if("object"!=CreatePasswordvue_type_script_lang_js_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=CreatePasswordvue_type_script_lang_js_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(key,"string"),(key="symbol"==CreatePasswordvue_type_script_lang_js_typeof(i)?i:String(i))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}CreatePasswordvue_type_template_id_34279c65_render._withStripped=!0;var CreatePassword=normalizeComponent({name:"CreatePassword",metaInfo:function(){return{title:this.$tr("documentTitle")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default(),PasswordTextbox:external_kolibriCoreAppGlobal_coreVue_components_PasswordTextbox_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default()],inject:["changeFacilityService","state"],data:function(){return{formData:{password:""},isPasswordValid:!1,isFormSubmitted:!1}},computed:CreatePasswordvue_type_script_lang_js_objectSpread(CreatePasswordvue_type_script_lang_js_objectSpread({},(0,external_kolibriCoreAppGlobal_lib_vuex_namespaceObject.mapGetters)(["session"])),{},{description:function(){return this.$tr("description",{username:get_default()(this.session,"username",""),targetFacility:get_default()(this.state,"value.targetFacility.name","")})}}),methods:{handleContinue:function(){this.isFormSubmitted=!0,this.isPasswordValid?this.sendContinue():this.$refs.passwordTextbox.focus()},sendContinue:function(){this.changeFacilityService.send({type:"CONTINUE",value:{username:get_default()(this.state,"value.targetAccount.username",""),password:this.formData.password}})},sendBack:function(){this.changeFacilityService.send({type:"BACK"})}},$trs:{documentTitle:{message:"Create new password",context:"Title of the step for creating a new password for the user in the target facility when changing facility."},description:{message:"{targetFacility} requires accounts to have passwords. Enter a password that you would like to use for {username} in {targetFacility}",context:"Explains why a password must be created."},hint:{message:"You can enter your current password if you already have one."}}},CreatePasswordvue_type_template_id_34279c65_render,[],!1,null,null,null).exports,ChooseAdminvue_type_template_id_033862df_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.$tr("documentTitle")))]),_c("p",[_vm._v(_vm._s(_vm.$tr("description")))]),_c("PaginatedListContainer",{attrs:{items:_vm.usersWithoutCurrentUser,filterPlaceholder:_vm.coreString("searchForUser")},scopedSlots:_vm._u([{key:"default",fn:function(ref){var items=ref.items;return[_c("UserTable",{attrs:{"data-test":"userTable",users:items,selectable:"",enableMultipleSelection:!1},model:{value:_vm.selectedUsers,callback:function($$v){_vm.selectedUsers=$$v},expression:"selectedUsers"}})]}}])}),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!1,text:_vm.coreString("backAction"),appearance:"flat-button","data-test":"backButton"},on:{click:_vm.sendBack}}),_c("KButton",{attrs:{primary:!0,text:_vm.coreString("continueAction"),disabled:_vm.isContinueDisabled,"data-test":"continueButton"},on:{click:_vm.sendContinue}})],1)]}))],2)],1)};ChooseAdminvue_type_template_id_033862df_render._withStripped=!0;var external_kolibriCoreAppGlobal_coreVue_components_PaginatedListContainer_namespaceObject=kolibriCoreAppGlobal.coreVue.components.PaginatedListContainer,external_kolibriCoreAppGlobal_coreVue_components_PaginatedListContainer_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_PaginatedListContainer_namespaceObject),external_kolibriCoreAppGlobal_coreVue_components_UserTable_namespaceObject=kolibriCoreAppGlobal.coreVue.components.UserTable,external_kolibriCoreAppGlobal_coreVue_components_UserTable_default=__webpack_require__.n(external_kolibriCoreAppGlobal_coreVue_components_UserTable_namespaceObject),ChooseAdmin=normalizeComponent({name:"ChooseAdmin",metaInfo:function(){return{title:this.$tr("documentTitle")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default(),PaginatedListContainer:external_kolibriCoreAppGlobal_coreVue_components_PaginatedListContainer_default(),UserTable:external_kolibriCoreAppGlobal_coreVue_components_UserTable_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default()],setup:function(){var changeFacilityService=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("changeFacilityService"),changeFacilityContext=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("state"),usersWithoutCurrentUser=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){var currentUserId=get_default()(changeFacilityContext,"value.userId");return get_default()(changeFacilityContext,"value.sourceFacilityUsers",[]).filter((function(user){return user.id!==currentUserId}))})),selectedUsers=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)([]),isContinueDisabled=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return 0===selectedUsers.value.length}));return{usersWithoutCurrentUser:usersWithoutCurrentUser,isContinueDisabled:isContinueDisabled,selectedUsers:selectedUsers,sendContinue:function(){isContinueDisabled.value||(changeFacilityService.send({type:"SELECTNEWSUPERADMIN",value:selectedUsers.value[0]}),changeFacilityService.send({type:"CONTINUE"}))},sendBack:function(){changeFacilityService.send({type:"BACK"})}}},$trs:{documentTitle:{message:"Choose a new super admin",context:"Title of the step for choosing a new super admin in a source facility when a user changing facilities is the only super admin of the source facility."},description:{message:"Choose someone to manage channels and user accounts.",context:"Description of the step for choosing a new super admin in a source facility when a user changing facilities is the only super admin of the source facility."}}},ChooseAdminvue_type_template_id_033862df_render,[],!1,null,null,null).exports,MergeFacilityvue_type_template_id_19237c0d_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.$tr("documentTitle")))]),_c("div",{staticClass:"task-panel",class:{"task-panel-sm":_vm.windowIsSmall}},[_c("div",{staticClass:"icon"},[_vm.taskError?_vm._e():_c("transition",{attrs:{mode:"out-in"}},[_vm.taskCompleted?_c("KIcon",{style:{fill:_vm.$themePalette.green.v_500},attrs:{icon:"check","data-test":"syncStatusIcon"}}):_c("KCircularLoader",{attrs:{size:24,stroke:5}})],1)],1),_c("div",{staticClass:"details"},[_c("p",{staticClass:"details-status",style:{color:_vm.$themeTokens.annotation}},[_vm._v("\n        "+_vm._s(_vm.taskInfo())+"\n      ")]),_vm.taskCompleted?_c("div",{attrs:{"data-test":"completedMessage"}},[_vm._v("\n        "+_vm._s(_vm.successfullyJoined)+"\n      ")]):_vm._e(),_vm.taskError?_c("div",{attrs:{"data-test":"errorMessage"}},[_vm._v("\n        "+_vm._s(_vm.errorMessage)+"\n      ")]):_c("div",{staticClass:"details-progress-bar"},[_c("KLinearLoader",{staticClass:"k-linear-loader",style:{backgroundColor:_vm.$themeTokens.fineLine},attrs:{type:"determinate",delay:!1,progress:100*_vm.percentage}}),_c("span",{staticClass:"details-percentage"},[_vm._v("\n          "+_vm._s(_vm.$formatNumber(_vm.percentage,{style:"percent"}))+"\n        ")])],1)])]),_vm.taskCompleted||_vm.taskError?_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_vm.taskCompleted?_c("KButton",{attrs:{primary:!0,text:_vm.coreString("finishAction"),"data-test":"finishButton"},on:{click:_vm.to_finish}}):_vm._e(),_vm.taskError?_c("KButton",{attrs:{primary:!0,text:_vm.coreString("retryAction"),"data-test":"retryButton"},on:{click:_vm.to_retry}}):_vm._e()],1)]}))],2):_vm._e()],1)};MergeFacilityvue_type_template_id_19237c0d_scoped_true_render._withStripped=!0;var external_kolibriCoreAppGlobal_utils_syncTaskUtils_namespaceObject=kolibriCoreAppGlobal.utils.syncTaskUtils,taskStrings=(0,external_kolibriCoreAppGlobal_utils_i18n_namespaceObject.createTranslator)("TaskStrings",{taskWaitingStatus:{message:"Waiting",context:"Generic task status"},taskCanceledStatus:{message:"Canceled",context:"Generic task status"},taskCancelingStatus:{message:"Canceling",context:"Generic task status"},taskFinishedStatus:{message:"Finished",context:"Generic task status indicating that a task has been completed."},taskFailedStatus:{message:"Failed",context:"Generic task status"},taskUnknownStatus:{message:"Unknown",context:"A catch-all status for unknown task statuses"},taskStartedByLabel:{message:"Started by '{username}'",context:"Displays the user that started a task"},taskLODFinishedByLabel:{message:"Account '{fullname}' from '{facilityname}' successfully loaded to this device",context:"Displays the full name of the user that has been synced in a task"},clearCompletedTasksAction:{message:"Clear completed",context:"Label for buttons that clear completed tasks"},unknownUsername:{message:"Unknown user",context:"A placeholder username if the username is not attached to a task."},establishingConnectionStatus:{message:"Establishing connection",context:"Sync task status"},remotelyPreparingDataStatus:{message:"Remotely preparing data",context:"Sync task status"},receivingDataStatus:{message:"Receiving data",context:"Sync task status"},locallyIntegratingDataStatus:{message:"Locally integrating received data",context:"Sync task status"},locallyPreparingDataStatus:{message:"Locally preparing data to send",context:"Sync task status"},sendingDataStatus:{message:"Sending data",context:"Sync task status"},remotelyIntegratingDataStatus:{message:"Remotely integrating data",context:"Sync task status"},syncFacilityTaskLabel:{message:"Sync {facilityName}",context:"Description of sync-facility task"},syncStepAndDescription:{message:"{step, number} of {total, number}: {description}",context:'Template for message of the form "Step 1 of 7: Establishing connection"'},syncBytesSentAndReceived:{message:"{bytesSent} sent  {bytesReceived} received",context:"Amounts of data transferred in sync task"},removingFacilityStatus:{message:"Removing facility",context:"Remove facility task status"},removeFacilityTaskLabel:{message:"Remove {facilityName}",context:"Description of a remove-facility task."},removeFacilitySuccessStatus:{message:"Facility successfully removed",context:"Message that shows after Facility is successfully removed"},importFacilityTaskLabel:{message:"Import {facilityName}",context:"Description of import-facility task"},importSuccessStatus:{message:"The '{facilityName}' learning facility has been successfully loaded to this device",context:"Confirmation message displayed when a facility's data is imported successfully in the syncing process."},importFailedStatus:{message:"Could not import '{facilityName}'",context:"Error message displayed when a facility's data cannot be imported in the syncing process."}});function getTaskString(){return taskStrings.$tr.apply(taskStrings,arguments)}var MergeFacility=normalizeComponent({name:"MergeFacility",metaInfo:function(){return{title:this.$tr("documentTitle")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default(),external_kolibriCoreAppGlobal_coreVue_mixins_responsiveWindowMixin_default()],setup:function(){var changeFacilityService=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("changeFacilityService"),state=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("state"),taskId=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return get_default()(state,"value.taskId",null)})),task=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(null),taskError=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),isPolling=!0,isTaskRequested=!1,taskCompleted=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return null!==task.value&&task.value.status===external_kolibriCoreAppGlobal_utils_syncTaskUtils_namespaceObject.TaskStatuses.COMPLETED})),percentage=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return task.value?task.value.percentage:0}));function updateMachineContext(updatedTask){task.value=updatedTask,changeFacilityService.send({type:"SETTASKID",value:{task_id:updatedTask.id}})}function pollTask(){null===taskId.value?external_kolibriCoreAppGlobal_resources_namespaceObject.TaskResource.fetchCollection().then((function(allTasks){var tasks=allTasks.filter((function(t){return"kolibri.plugins.user_profile.tasks.mergeuser"===t.type}));if(tasks.length>0)updateMachineContext(tasks[0]);else if(!isTaskRequested){isTaskRequested=!0;var params={type:"kolibri.plugins.user_profile.tasks.mergeuser",baseurl:state.value.targetFacility.url,facility:state.value.targetFacility.id,username:state.value.targetAccount.username,local_user_id:state.value.userId,facility_name:state.value.targetFacility.name,user_id:state.value.targetAccount.id};""!==state.value.targetAccount.password&&(params.password=state.value.targetAccount.password),""!==state.value.newSuperAdminId&&(params.new_superuser_id=state.value.newSuperAdminId),!1!==state.value.setAsSuperAdmin&&(params.set_as_super_user=!0),void 0!==state.value.targetAccount.AdminUsername&&(params.using_admin=!0,params.username=state.value.targetAccount.AdminUsername,params.password=state.value.targetAccount.AdminPassword),external_kolibriCoreAppGlobal_resources_namespaceObject.TaskResource.startTask(params).then((function(startedTask){updateMachineContext(startedTask),isTaskRequested=!1})).catch((function(error){if(400===error.response.status){var message=get_default()(error.response,"data[0].metadata.message","");"USERNAME_ALREADY_EXISTS"===message||"PASSWORD_NOT_SPECIFIED"===message?(taskError.value=!0,isPolling=!1):changeFacilityService.send("TASKERROR")}else 410==error.response.status&&(taskError.value=!0,isPolling=!1)}))}})).catch((function(){taskError.value=!0,isPolling=!1})):external_kolibriCoreAppGlobal_resources_namespaceObject.TaskResource.fetchModel({id:taskId.value,force:!0}).then((function(startedTask){task.value=startedTask,startedTask.status==external_kolibriCoreAppGlobal_utils_syncTaskUtils_namespaceObject.TaskStatuses.COMPLETED?isPolling=!1:startedTask.status===external_kolibriCoreAppGlobal_utils_syncTaskUtils_namespaceObject.TaskStatuses.FAILED&&(external_kolibriCoreAppGlobal_resources_namespaceObject.TaskResource.clear(taskId.value),isTaskRequested=!1,taskError.value=!0)})),isPolling&&setTimeout((function(){pollTask()}),2e3)}(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.onMounted)((function(){pollTask()}));var successfullyJoined=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)({get:function(){return this.$tr("success",{target_facility:get_default()(state,"value.targetFacility.name","")})}}),errorMessage=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)({get:function(){var targetUsername=get_default()(state,"value.targetAccount.username",""),currentUsername=get_default()(state,"value.username",""),errorString="failedTaskError";return null!==task.value&&get_default()(task,"value.status","")!==external_kolibriCoreAppGlobal_utils_syncTaskUtils_namespaceObject.TaskStatuses.FAILED&&(errorString=targetUsername!==currentUsername?"userExistsError":"userAdminError"),this.$tr(errorString,{username:targetUsername,target_facility:get_default()(state,"value.targetFacility.name","")})}});return{percentage:percentage,taskError:taskError,taskId:taskId,task:task,taskCompleted:taskCompleted,taskInfo:function(){return null===task.value?"":function(task){var statusDescription=external_kolibriCoreAppGlobal_utils_syncTaskUtils_namespaceObject.syncStatusToDescriptionMap[task.extra_metadata.sync_state]||external_kolibriCoreAppGlobal_utils_syncTaskUtils_namespaceObject.syncStatusToDescriptionMap[task.status]||function(){return getTaskString("taskUnknownStatus")};return task.status===external_kolibriCoreAppGlobal_utils_syncTaskUtils_namespaceObject.TaskStatuses.COMPLETED?getTaskString("taskFinishedStatus"):task.status===external_kolibriCoreAppGlobal_utils_syncTaskUtils_namespaceObject.TaskStatuses.FAILED?"".concat(statusDescription(),": ").concat(task.exception):statusDescription()}(task.value)},to_finish:function(){var token=task.value.extra_metadata.token;external_kolibriCoreAppGlobal_resources_namespaceObject.TaskResource.clear(taskId.value),changeFacilityService.send({type:"FINISH"});var params={pk:state.value.targetAccount.id,token:token};void 0===params.pk&&(params.pk=this.task.extra_metadata.remote_user_pk),external_kolibriCoreAppGlobal_client_default()({url:external_kolibriCoreAppGlobal_urls_default()["kolibri:kolibri.plugins.user_profile:loginmergeduser"](),method:"POST",data:params}).then((function(){external_kolibriCoreAppGlobal_utils_redirectBrowser_default()(external_kolibriCoreAppGlobal_urls_default()["kolibri:kolibri.plugins.learn:learn"]())}))},to_retry:function(){null!==taskId.value&&external_kolibriCoreAppGlobal_resources_namespaceObject.TaskResource.clear(taskId.value),taskError.value=!1,changeFacilityService.send("TASKERROR")},successfullyJoined:successfullyJoined,errorMessage:errorMessage}},$trs:{documentTitle:{message:"Changing learning facility",context:"Title of this step for the change facility page."},success:{message:"Successfully joined '{target_facility}' learning facility.",context:"Status message for a successful task."},userExistsError:{message:"User '{username}' already exists in '{target_facility}'. Please choose a different username.",context:"Error message for a user already existing in the target facility."},userAdminError:{message:"User '{username}' already exists in '{target_facility}' and is not a learner. Please choose a different username.",context:"Error message for a user being other than a learner in the target facility."},failedTaskError:{message:"Merging task for '{username}' has failed due to some problem connecting to the '{target_facility}'. Please, check your network connection and try again.",context:"Error message for a connection error when merging the user"}}},MergeFacilityvue_type_template_id_19237c0d_scoped_true_render,[],!1,null,"19237c0d",null).exports,UsernameExistsvue_type_template_id_5590579b_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.coreString("changeLearningFacility")))]),_c("p",{attrs:{"data-test":"line1"}},[_vm._v("\n    "+_vm._s(_vm.mergeAccountInfoLine1)+"\n  ")]),_c("p",{attrs:{"data-test":"line2"}},[_vm._v("\n    "+_vm._s(_vm.mergeAccountInfoLine2)+"\n  ")]),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!1,text:_vm.profileString("createAccount"),disabled:_vm.isCreateAccountButtonDisabled,appearance:"flat-button","data-test":"createButton"},on:{click:_vm.to_create}}),_c("KButton",{attrs:{primary:!0,text:_vm.profileString("mergeAccounts"),"data-test":"mergeButton"},on:{click:_vm.to_merge}})],1)]}))],2)],1)};UsernameExistsvue_type_template_id_5590579b_render._withStripped=!0;var UsernameExists=normalizeComponent({name:"UsernameExists",metaInfo:function(){return{title:this.profileString("mergeAccounts")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default(),commonProfileStrings],setup:function(){var changeFacilityService=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("changeFacilityService"),state=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("state"),mergeAccountInfoLine1=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)({get:function(){return this.$tr("changeFacilityInfoLine1",{target_facility:get_default()(state,"value.targetFacility.name",""),username:get_default()(state,"value.username","")})}}),mergeAccountInfoLine2=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)({get:function(){return this.$tr("changeFacilityInfoLine2",{target_facility:get_default()(state,"value.targetFacility.name","")})}});return{isCreateAccountButtonDisabled:(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)({get:function(){return!get_default()(state,"value.targetFacility.learner_can_sign_up",!0)}}),mergeAccountInfoLine1:mergeAccountInfoLine1,mergeAccountInfoLine2:mergeAccountInfoLine2,to_create:function(){changeFacilityService.send({type:"NEW"})},to_merge:function(){changeFacilityService.send({type:"MERGE"})}}},$trs:{changeFacilityInfoLine1:{message:"An account with the username '{username}' already exists in the '{target_facility}' learning facility. You can merge your account and its progress data with this account.",context:"First line of text explaining that the username also exists in the target facility."},changeFacilityInfoLine2:{message:"Alternatively, you can create a new account and all your progress data will be moved to this new account.",context:"Second line of text explaining that the username also exists in the target facility."}}},UsernameExistsvue_type_template_id_5590579b_render,[],!1,null,null,null).exports,MergeDifferentAccountsvue_type_template_id_efc28f5a_scoped_true_render=function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("h1",[_vm._v(_vm._s(_vm.profileString("mergeAccounts")))]),_c("p",{staticClass:"fullname",attrs:{"data-test":"fullName"}},[_vm._v("\n    "+_vm._s(_vm.fullName)+"\n  ")]),_c("p",{staticClass:"username",style:{color:_vm.$themeTokens.annotation},attrs:{"data-test":"username"}},[_vm._v("\n    "+_vm._s(_vm.username)+"\n  ")]),_vm._v("\n  "+_vm._s(_vm.$tr("mergeAccountUserInfo"))+"\n\n  "),_c("KTextbox",{attrs:{"data-test":"usernameTextbox",autofocus:!0,autocomplete:"off",label:_vm.coreString("usernameLabel"),invalid:_vm.userDoesNotExist,showInvalidText:"true",invalidText:_vm.$tr("userDoesNotExist")},on:{input:function($event){_vm.userDoesNotExist=!1},keydown:function($event){return!$event.type.indexOf("key")&&_vm._k($event.keyCode,"enter",13,$event.key,"Enter")?null:_vm.handleContinue.apply(null,arguments)}},model:{value:_vm.formData.username,callback:function($$v){_vm.$set(_vm.formData,"username",$$v)},expression:"formData.username"}}),_c("BottomAppBar",[_vm._t("buttons",(function(){return[_c("KButtonGroup",[_c("KButton",{attrs:{primary:!1,text:_vm.coreString("backAction"),appearance:"flat-button","data-test":"backButton"},on:{click:_vm.sendBack}}),_c("KButton",{attrs:{primary:!0,text:_vm.coreString("continueAction"),"data-test":"continueButton"},on:{click:_vm.handleContinue}})],1)]}))],2)],1)};function preload(next){external_kolibriCoreAppGlobal_coreVue_vuex_store_default().commit("CORE_SET_PAGE_LOADING",!0),external_kolibriCoreAppGlobal_coreVue_vuex_store_default().dispatch("getFacilityConfig").then((function(){external_kolibriCoreAppGlobal_coreVue_vuex_store_default().commit("CORE_SET_PAGE_LOADING",!1),next()}))}MergeDifferentAccountsvue_type_template_id_efc28f5a_scoped_true_render._withStripped=!0;var routes=[{path:"/",name:"PROFILE",component:ProfilePage,beforeEnter:function(to,from,next){external_kolibriCoreAppGlobal_coreVue_vuex_store_default().getters.isUserLoggedIn?preload(next):external_kolibriCoreAppGlobal_utils_redirectBrowser_default()()}},{path:"/edit",name:"PROFILE_EDIT",component:ProfileEditPage,beforeEnter:function(to,from,next){external_kolibriCoreAppGlobal_coreVue_vuex_store_default().getters.isUserLoggedIn?preload(next):external_kolibriCoreAppGlobal_utils_redirectBrowser_default()()}},{path:"/change_facility",name:"CHANGE_FACILITY",component:ChangeFacility,beforeEnter:function(to,from,next){external_kolibriCoreAppGlobal_coreVue_vuex_store_default().getters.isUserLoggedIn?preload(next):external_kolibriCoreAppGlobal_utils_redirectBrowser_default()()},children:[{path:"change",name:"SELECT_FACILITY",component:SelectFacility},{path:"confirm_change",name:"CONFIRM_CHANGE_FACILITY",component:ConfirmChangeFacility},{path:"confirm_account",name:"CONFIRM_ACCOUNT_USERNAME",component:ConfirmAccountUsername},{path:"target_password",name:"TARGET_PASSWORD",component:CreatePassword},{path:"choose_admin",name:"CHOOSE_ADMIN",component:ChooseAdmin},{path:"confirm_merge",name:"CONFIRM_MERGE",component:ConfirmMerge},{path:"syncing_change_facility",name:"SYNCING_CHANGE_FACILITY",component:MergeFacility},{path:"create_account",name:"CREATE_ACCOUNT",component:CreateAccount},{path:"username_exists",name:"USERNAME_EXISTS",component:UsernameExists},{path:"require_account_credentials",name:"REQUIRE_ACCOUNT_CREDENTIALS",component:MergeAccountDialog},{path:"admin_password",name:"ADMIN_PASSWORD",component:MergeAccountDialog},{path:"show_accounts",name:"CONFIRM_DETAILS",component:ConfirmAccountDetails},{path:"merge_accounts",name:"MERGE_ACCOUNTS",component:normalizeComponent({name:"MergeDifferentAccounts",metaInfo:function(){return{title:this.profileString("mergeAccounts")}},components:{BottomAppBar:external_kolibriCoreAppGlobal_coreVue_components_BottomAppBar_default()},mixins:[external_kolibriCoreAppGlobal_coreVue_mixins_commonCoreStrings_default(),commonProfileStrings],setup:function(){var changeFacilityService=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("changeFacilityService"),state=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.inject)("state"),isFormSubmitted=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),userDoesNotExist=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)(!1),fullName=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return get_default()(state,"value.fullname","")})),username=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.computed)((function(){return get_default()(state,"value.username","")})),formData=(0,external_kolibriCoreAppGlobal_lib_vueCompositionApi_namespaceObject.ref)({username:""});return{formData:formData,isFormSubmitted:isFormSubmitted,userDoesNotExist:userDoesNotExist,username:username,fullName:fullName,sendBack:function(){changeFacilityService.send({type:"BACK"})},handleContinue:function(){var facility=get_default()(state,"value.targetFacility",{});remoteFacilityUsers(facility.url,facility.id,formData.value.username.trim()).then((function(user_info){0===user_info.users.length?userDoesNotExist.value=!0:(isFormSubmitted.value=!1,changeFacilityService.send({type:"CONTINUE",value:{username:formData.value.username.trim(),password:""}}))}))}}},$trs:{mergeAccountUserInfo:{message:"Enter the username of the account you want to merge your account into.",context:"Line of text asking for the username of the user to be merged in the target facility."},userDoesNotExist:{message:"That username does not exist in the target facility",context:"Error that is shown if the selected username does not exist in the target facility"}}},MergeDifferentAccountsvue_type_template_id_efc28f5a_scoped_true_render,[],!1,null,"efc28f5a",null).exports}]},{path:"*",redirect:"/"}],isEmpty=__webpack_require__(9328),isEmpty_default=__webpack_require__.n(isEmpty);function updateUserProfile(store,_ref){var updates=_ref.updates;return isEmpty_default()(updates)?Promise.resolve():external_kolibriCoreAppGlobal_resources_namespaceObject.FacilityUserResource.saveModel({id:store.rootGetters.currentUserId,data:updates,exists:!0}).then((function(){store.dispatch("setSession",{session:updates},{root:!0})}))}function updateUserProfilePassword(store,password){return external_kolibriCoreAppGlobal_resources_namespaceObject.FacilityUserResource.saveModel({id:store.rootGetters.currentUserId,data:{password:password},exists:!0})}var urls,pluginModule={state:function(){return{pageName:""}},actions:{reset:function(store){store.commit("CORE_SET_PAGE_LOADING",!1),store.commit("CORE_SET_ERROR",null)},resetModuleState:function(store){store.commit("profile/RESET_STATE")}},mutations:{SET_PAGE_NAME:function(state,name){state.pageName=name}},modules:{profile:{namespaced:!0,state:{},actions:profile_actions_namespaceObject,mutations:{RESET_STATE:function(){}}}}},vuex_router_sync=__webpack_require__(3226),forEach=__webpack_require__(265),forEach_default=__webpack_require__.n(forEach),external_kolibriCoreAppGlobal_lib_logging_namespaceObject=kolibriCoreAppGlobal.lib.logging,external_kolibriCoreAppGlobal_lib_logging_default=__webpack_require__.n(external_kolibriCoreAppGlobal_lib_logging_namespaceObject),external_kolibriCoreAppGlobal_heartbeat_namespaceObject=kolibriCoreAppGlobal.heartbeat,external_kolibriCoreAppGlobal_heartbeat_default=__webpack_require__.n(external_kolibriCoreAppGlobal_heartbeat_namespaceObject),external_kolibriCoreAppGlobal_namespaceObject=kolibriCoreAppGlobal,external_kolibriCoreAppGlobal_default=__webpack_require__.n(external_kolibriCoreAppGlobal_namespaceObject);function kolibri_module_typeof(o){return kolibri_module_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},kolibri_module_typeof(o)}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,kolibri_module_toPropertyKey(descriptor.key),descriptor)}}function kolibri_module_toPropertyKey(t){var i=function(t,r){if("object"!=kolibri_module_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=kolibri_module_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==kolibri_module_typeof(i)?i:String(i)}urls=external_kolibriCoreAppGlobal_urls_default(),__webpack_require__.p=urls.static("".concat("kolibri.plugins.user_profile.app","/"));var KolibriModule=function(){function KolibriModule(options){!function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,KolibriModule),this.name="kolibri.plugins.user_profile.app";var safeOptions={};this.kolibriModuleOptions.forEach((function(option){options[option]&&(safeOptions[option]=options[option])})),Object.assign(this,safeOptions);for(var _len=arguments.length,args=new Array(_len>1?_len-1:0),_key=1;_key<_len;_key++)args[_key-1]=arguments[_key];this.initialize.apply(this,[options].concat(args)),this._registerKolibriModule()}var Constructor,protoProps,staticProps;return Constructor=KolibriModule,protoProps=[{key:"kolibriModuleOptions",get:function(){return[]}},{key:"_registerKolibriModule",value:function(){external_kolibriCoreAppGlobal_default().registerKolibriModuleSync(this)}},{key:"initialize",value:function(){}},{key:"ready",value:function(){}},{key:"stopListening",value:function(event,method){external_kolibriCoreAppGlobal_default().stopListening(event,this,method)}},{key:"emit",value:function(){external_kolibriCoreAppGlobal_default().emit.apply(external_kolibriCoreAppGlobal_default(),arguments)}},{key:"Kolibri",get:function(){return external_kolibriCoreAppGlobal_default()}}],protoProps&&_defineProperties(Constructor.prototype,protoProps),staticProps&&_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),KolibriModule}();function kolibri_app_typeof(o){return kolibri_app_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},kolibri_app_typeof(o)}function kolibri_app_toConsumableArray(arr){return function(arr){if(Array.isArray(arr))return kolibri_app_arrayLikeToArray(arr)}(arr)||function(iter){if("undefined"!=typeof Symbol&&null!=iter[Symbol.iterator]||null!=iter["@@iterator"])return Array.from(iter)}(arr)||function(o,minLen){if(!o)return;if("string"==typeof o)return kolibri_app_arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);"Object"===n&&o.constructor&&(n=o.constructor.name);if("Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kolibri_app_arrayLikeToArray(o,minLen)}(arr)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function kolibri_app_arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=new Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function kolibri_app_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function kolibri_app_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?kolibri_app_ownKeys(Object(t),!0).forEach((function(r){kolibri_app_defineProperty(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):kolibri_app_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}function kolibri_app_defineProperty(obj,key,value){return(key=kolibri_app_toPropertyKey(key))in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}function kolibri_app_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,kolibri_app_toPropertyKey(descriptor.key),descriptor)}}function kolibri_app_toPropertyKey(t){var i=function(t,r){if("object"!=kolibri_app_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=kolibri_app_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==kolibri_app_typeof(i)?i:String(i)}function _callSuper(_this,derived,args){return derived=_getPrototypeOf(derived),function(self,call){if(call&&("object"===kolibri_app_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(_this,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(derived,args||[],_getPrototypeOf(_this).constructor):derived.apply(_this,args))}function _getPrototypeOf(o){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},_getPrototypeOf(o)}function _setPrototypeOf(o,p){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},_setPrototypeOf(o,p)}external_kolibriCoreAppGlobal_lib_logging_default().getLogger("kolibri/core/assets/src/kolibri_app.js");var KolibriApp=function(_KolibriModule){function KolibriApp(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,KolibriApp),_callSuper(this,KolibriApp,arguments)}var Constructor,protoProps,staticProps;return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&_setPrototypeOf(subClass,superClass)}(KolibriApp,_KolibriModule),Constructor=KolibriApp,(protoProps=[{key:"routes",get:function(){return[]}},{key:"RootVue",get:function(){return{}}},{key:"store",get:function(){return external_kolibriCoreAppGlobal_coreVue_vuex_store_default()}},{key:"stateSetters",get:function(){return[]}},{key:"pluginModule",get:function(){return{}}},{key:"setupVue",value:function(){if(external_kolibriCoreAppGlobal_coreVue_router_default()._vueRouter||external_kolibriCoreAppGlobal_coreVue_router_default().initRouter(),(0,vuex_router_sync.Z)(external_kolibriCoreAppGlobal_coreVue_vuex_store_default(),external_kolibriCoreAppGlobal_coreVue_router_default()),this.store.hotUpdate({actions:this.pluginModule.actions||{},getters:this.pluginModule.getters||{},mutations:this.pluginModule.mutations||{}}),"function"!=typeof this.pluginModule.state)throw TypeError("pluginModule.state must be a function returning a state object");this.store.replaceState(kolibri_app_objectSpread(kolibri_app_objectSpread({},this.store.state),this.pluginModule.state())),forEach_default()(this.pluginModule.modules,(function(module,name){external_kolibriCoreAppGlobal_coreVue_vuex_store_default().registerModule(name,module)}))}},{key:"startRootVue",value:function(){this.rootvue=new(external_kolibriCoreAppGlobal_lib_vue_default())(Object.assign({el:"rootvue",store:external_kolibriCoreAppGlobal_coreVue_vuex_store_default(),router:external_kolibriCoreAppGlobal_coreVue_router_default().initRoutes(this.routes)},this.RootVue))}},{key:"ready",value:function(){var _this2=this;return this.setupVue(),external_kolibriCoreAppGlobal_heartbeat_default().startPolling().then((function(){return _this2.store.dispatch("getNotifications"),Promise.all(kolibri_app_toConsumableArray(_this2.stateSetters.map((function(setter){return setter(_this2.store)})))).then((function(){_this2.startRootVue()}))}))}}])&&kolibri_app_defineProperties(Constructor.prototype,protoProps),staticProps&&kolibri_app_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),KolibriApp}(KolibriModule);function app_typeof(o){return app_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(o){return typeof o}:function(o){return o&&"function"==typeof Symbol&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},app_typeof(o)}function app_defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1,descriptor.configurable=!0,"value"in descriptor&&(descriptor.writable=!0),Object.defineProperty(target,app_toPropertyKey(descriptor.key),descriptor)}}function app_toPropertyKey(t){var i=function(t,r){if("object"!=app_typeof(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var i=e.call(t,r||"default");if("object"!=app_typeof(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===r?String:Number)(t)}(t,"string");return"symbol"==app_typeof(i)?i:String(i)}function app_callSuper(_this,derived,args){return derived=app_getPrototypeOf(derived),function(self,call){if(call&&("object"===app_typeof(call)||"function"==typeof call))return call;if(void 0!==call)throw new TypeError("Derived constructors may only return object or undefined");return function(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}(self)}(_this,function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){return!1}}()?Reflect.construct(derived,args||[],app_getPrototypeOf(_this).constructor):derived.apply(_this,args))}function _get(){return _get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(target,property,receiver){var base=function(object,property){for(;!Object.prototype.hasOwnProperty.call(object,property)&&null!==(object=app_getPrototypeOf(object)););return object}(target,property);if(base){var desc=Object.getOwnPropertyDescriptor(base,property);return desc.get?desc.get.call(arguments.length<3?target:receiver):desc.value}},_get.apply(this,arguments)}function app_getPrototypeOf(o){return app_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},app_getPrototypeOf(o)}function app_setPrototypeOf(o,p){return app_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,p){return o.__proto__=p,o},app_setPrototypeOf(o,p)}var UserProfileModule=function(_KolibriApp){function UserProfileModule(){return function(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}(this,UserProfileModule),app_callSuper(this,UserProfileModule,arguments)}var Constructor,protoProps,staticProps;return function(subClass,superClass){if("function"!=typeof superClass&&null!==superClass)throw new TypeError("Super expression must either be null or a function");subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,writable:!0,configurable:!0}}),Object.defineProperty(subClass,"prototype",{writable:!1}),superClass&&app_setPrototypeOf(subClass,superClass)}(UserProfileModule,_KolibriApp),Constructor=UserProfileModule,(protoProps=[{key:"routes",get:function(){return routes}},{key:"RootVue",get:function(){return external_kolibriCoreAppGlobal_coreVue_components_PageRoot_default()}},{key:"pluginModule",get:function(){return pluginModule}},{key:"ready",value:function(){var _this2=this;external_kolibriCoreAppGlobal_coreVue_router_default().afterEach((function(toRoute,fromRoute){_this2.store.dispatch("resetModuleState",{toRoute:toRoute,fromRoute:fromRoute})})),_get(app_getPrototypeOf(UserProfileModule.prototype),"ready",this).call(this)}}])&&app_defineProperties(Constructor.prototype,protoProps),staticProps&&app_defineProperties(Constructor,staticProps),Object.defineProperty(Constructor,"prototype",{writable:!1}),UserProfileModule}(KolibriApp);new UserProfileModule}()}();
//# sourceMappingURL=kolibri.plugins.user_profile.app-0.16.0.js.map